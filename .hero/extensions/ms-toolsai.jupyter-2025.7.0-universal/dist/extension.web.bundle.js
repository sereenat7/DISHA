"use strict";var Goe=Object.create;var RE=Object.defineProperty;var eB=Object.getOwnPropertyDescriptor;var Yoe=Object.getOwnPropertyNames;var $oe=Object.getPrototypeOf,zoe=Object.prototype.hasOwnProperty;var ge=(r,e)=>()=>(r&&(e=r(r=0)),e);var re=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Wv=(r,e)=>{for(var t in e)RE(r,t,{get:e[t],enumerable:!0})},tB=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Yoe(e))!zoe.call(r,i)&&i!==t&&RE(r,i,{get:()=>e[i],enumerable:!(n=eB(e,i))||n.enumerable});return r};var ae=(r,e,t)=>(t=r!=null?Goe($oe(r)):{},tB(e||!r||!r.__esModule?RE(t,"default",{value:r,enumerable:!0}):t,r)),cL=r=>tB(RE({},"__esModule",{value:!0}),r),U=(r,e,t,n)=>{for(var i=n>1?void 0:n?eB(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&RE(e,t,i),i},x=(r,e)=>(t,n)=>e(t,n,r);var process,p=ge(()=>{"use strict";process={platform:"web",browser:!0,cwd:()=>"",env:{NODE_ENV:"production"}}});var nB=re(()=>{p();var rB;(function(r){(function(e){var t=typeof this=="object"?this:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),n=i(r);typeof t.Reflect=="undefined"?t.Reflect=r:n=i(t.Reflect,n),e(n);function i(o,s){return function(a,l){typeof o[a]!="function"&&Object.defineProperty(o,a,{configurable:!0,writable:!0,value:l}),s&&s(a,l)}}})(function(e){var t=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",i=n&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",o=n&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",s=typeof Object.create=="function",a={__proto__:[]}instanceof Array,l=!s&&!a,u={create:s?function(){return we(Object.create(null))}:a?function(){return we({__proto__:null})}:function(){return we({})},has:l?function(G,X){return t.call(G,X)}:function(G,X){return X in G},get:l?function(G,X){return t.call(G,X)?G[X]:void 0}:function(G,X){return G[X]}},c=Object.getPrototypeOf(Function),d=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",f=!d&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:me(),m=!d&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Fe(),g=!d&&typeof WeakMap=="function"?WeakMap:Q(),b=new g;function v(G,X,ce,_e){if($(ce)){if(!Ye(G))throw new TypeError;if(!Bt(X))throw new TypeError;return h(G,X)}else{if(!Ye(G))throw new TypeError;if(!ye(X))throw new TypeError;if(!ye(_e)&&!$(_e)&&!ue(_e))throw new TypeError;return ue(_e)&&(_e=void 0),ce=Le(ce),y(G,X,ce,_e)}}e("decorate",v);function k(G,X){function ce(_e,xe){if(!ye(_e))throw new TypeError;if(!$(xe)&&!A(xe))throw new TypeError;ie(G,X,_e,xe)}return ce}e("metadata",k);function R(G,X,ce,_e){if(!ye(ce))throw new TypeError;return $(_e)||(_e=Le(_e)),ie(G,X,ce,_e)}e("defineMetadata",R);function P(G,X,ce){if(!ye(X))throw new TypeError;return $(ce)||(ce=Le(ce)),T(G,X,ce)}e("hasMetadata",P);function D(G,X,ce){if(!ye(X))throw new TypeError;return $(ce)||(ce=Le(ce)),H(G,X,ce)}e("hasOwnMetadata",D);function K(G,X,ce){if(!ye(X))throw new TypeError;return $(ce)||(ce=Le(ce)),Y(G,X,ce)}e("getMetadata",K);function L(G,X,ce){if(!ye(X))throw new TypeError;return $(ce)||(ce=Le(ce)),Z(G,X,ce)}e("getOwnMetadata",L);function B(G,X){if(!ye(G))throw new TypeError;return $(X)||(X=Le(X)),le(G,X)}e("getMetadataKeys",B);function N(G,X){if(!ye(G))throw new TypeError;return $(X)||(X=Le(X)),be(G,X)}e("getOwnMetadataKeys",N);function O(G,X,ce){if(!ye(X))throw new TypeError;$(ce)||(ce=Le(ce));var _e=w(X,ce,!1);if($(_e)||!_e.delete(G))return!1;if(_e.size>0)return!0;var xe=b.get(X);return xe.delete(ce),xe.size>0||b.delete(X),!0}e("deleteMetadata",O);function h(G,X){for(var ce=G.length-1;ce>=0;--ce){var _e=G[ce],xe=_e(X);if(!$(xe)&&!ue(xe)){if(!Bt(xe))throw new TypeError;X=xe}}return X}function y(G,X,ce,_e){for(var xe=G.length-1;xe>=0;--xe){var ee=G[xe],oe=ee(X,ce,_e);if(!$(oe)&&!ue(oe)){if(!ye(oe))throw new TypeError;_e=oe}}return _e}function w(G,X,ce){var _e=b.get(G);if($(_e)){if(!ce)return;_e=new f,b.set(G,_e)}var xe=_e.get(X);if($(xe)){if(!ce)return;xe=new f,_e.set(X,xe)}return xe}function T(G,X,ce){var _e=H(G,X,ce);if(_e)return!0;var xe=j(X);return ue(xe)?!1:T(G,xe,ce)}function H(G,X,ce){var _e=w(X,ce,!1);return $(_e)?!1:Se(_e.has(G))}function Y(G,X,ce){var _e=H(G,X,ce);if(_e)return Z(G,X,ce);var xe=j(X);if(!ue(xe))return Y(G,xe,ce)}function Z(G,X,ce){var _e=w(X,ce,!1);if(!$(_e))return _e.get(G)}function ie(G,X,ce,_e){var xe=w(ce,_e,!0);xe.set(G,X)}function le(G,X){var ce=be(G,X),_e=j(G);if(_e===null)return ce;var xe=le(_e,X);if(xe.length<=0)return ce;if(ce.length<=0)return xe;for(var ee=new m,oe=[],se=0,Ie=ce;se<Ie.length;se++){var Pe=Ie[se],Re=ee.has(Pe);Re||(ee.add(Pe),oe.push(Pe))}for(var yt=0,Yt=xe;yt<Yt.length;yt++){var Pe=Yt[yt],Re=ee.has(Pe);Re||(ee.add(Pe),oe.push(Pe))}return oe}function be(G,X){var ce=[],_e=w(G,X,!1);if($(_e))return ce;for(var xe=_e.keys(),ee=I(xe),oe=0;;){var se=_(ee);if(!se)return ce.length=oe,ce;var Ie=S(se);try{ce[oe]=Ie}catch(Pe){try{F(ee)}finally{throw Pe}}oe++}}function q(G){if(G===null)return 1;switch(typeof G){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return G===null?1:6;default:return 6}}function $(G){return G===void 0}function ue(G){return G===null}function pe(G){return typeof G=="symbol"}function ye(G){return typeof G=="object"?G!==null:typeof G=="function"}function z(G,X){switch(q(G)){case 0:return G;case 1:return G;case 2:return G;case 3:return G;case 4:return G;case 5:return G}var ce=X===3?"string":X===5?"number":"default",_e=M(G,i);if(_e!==void 0){var xe=_e.call(G,ce);if(ye(xe))throw new TypeError;return xe}return fe(G,ce==="default"?"number":ce)}function fe(G,X){if(X==="string"){var ce=G.toString;if(Je(ce)){var _e=ce.call(G);if(!ye(_e))return _e}var xe=G.valueOf;if(Je(xe)){var _e=xe.call(G);if(!ye(_e))return _e}}else{var xe=G.valueOf;if(Je(xe)){var _e=xe.call(G);if(!ye(_e))return _e}var ee=G.toString;if(Je(ee)){var _e=ee.call(G);if(!ye(_e))return _e}}throw new TypeError}function Se(G){return!!G}function Te(G){return""+G}function Le(G){var X=z(G,3);return pe(X)?X:Te(X)}function Ye(G){return Array.isArray?Array.isArray(G):G instanceof Object?G instanceof Array:Object.prototype.toString.call(G)==="[object Array]"}function Je(G){return typeof G=="function"}function Bt(G){return typeof G=="function"}function A(G){switch(q(G)){case 3:return!0;case 4:return!0;default:return!1}}function M(G,X){var ce=G[X];if(ce!=null){if(!Je(ce))throw new TypeError;return ce}}function I(G){var X=M(G,o);if(!Je(X))throw new TypeError;var ce=X.call(G);if(!ye(ce))throw new TypeError;return ce}function S(G){return G.value}function _(G){var X=G.next();return X.done?!1:X}function F(G){var X=G.return;X&&X.call(G)}function j(G){var X=Object.getPrototypeOf(G);if(typeof G!="function"||G===c||X!==c)return X;var ce=G.prototype,_e=ce&&Object.getPrototypeOf(ce);if(_e==null||_e===Object.prototype)return X;var xe=_e.constructor;return typeof xe!="function"||xe===G?X:xe}function me(){var G={},X=[],ce=function(){function oe(se,Ie,Pe){this._index=0,this._keys=se,this._values=Ie,this._selector=Pe}return oe.prototype["@@iterator"]=function(){return this},oe.prototype[o]=function(){return this},oe.prototype.next=function(){var se=this._index;if(se>=0&&se<this._keys.length){var Ie=this._selector(this._keys[se],this._values[se]);return se+1>=this._keys.length?(this._index=-1,this._keys=X,this._values=X):this._index++,{value:Ie,done:!1}}return{value:void 0,done:!0}},oe.prototype.throw=function(se){throw this._index>=0&&(this._index=-1,this._keys=X,this._values=X),se},oe.prototype.return=function(se){return this._index>=0&&(this._index=-1,this._keys=X,this._values=X),{value:se,done:!0}},oe}();return function(){function oe(){this._keys=[],this._values=[],this._cacheKey=G,this._cacheIndex=-2}return Object.defineProperty(oe.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),oe.prototype.has=function(se){return this._find(se,!1)>=0},oe.prototype.get=function(se){var Ie=this._find(se,!1);return Ie>=0?this._values[Ie]:void 0},oe.prototype.set=function(se,Ie){var Pe=this._find(se,!0);return this._values[Pe]=Ie,this},oe.prototype.delete=function(se){var Ie=this._find(se,!1);if(Ie>=0){for(var Pe=this._keys.length,Re=Ie+1;Re<Pe;Re++)this._keys[Re-1]=this._keys[Re],this._values[Re-1]=this._values[Re];return this._keys.length--,this._values.length--,se===this._cacheKey&&(this._cacheKey=G,this._cacheIndex=-2),!0}return!1},oe.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=G,this._cacheIndex=-2},oe.prototype.keys=function(){return new ce(this._keys,this._values,_e)},oe.prototype.values=function(){return new ce(this._keys,this._values,xe)},oe.prototype.entries=function(){return new ce(this._keys,this._values,ee)},oe.prototype["@@iterator"]=function(){return this.entries()},oe.prototype[o]=function(){return this.entries()},oe.prototype._find=function(se,Ie){return this._cacheKey!==se&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=se)),this._cacheIndex<0&&Ie&&(this._cacheIndex=this._keys.length,this._keys.push(se),this._values.push(void 0)),this._cacheIndex},oe}();function _e(oe,se){return oe}function xe(oe,se){return se}function ee(oe,se){return[oe,se]}}function Fe(){return function(){function G(){this._map=new f}return Object.defineProperty(G.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),G.prototype.has=function(X){return this._map.has(X)},G.prototype.add=function(X){return this._map.set(X,X),this},G.prototype.delete=function(X){return this._map.delete(X)},G.prototype.clear=function(){this._map.clear()},G.prototype.keys=function(){return this._map.keys()},G.prototype.values=function(){return this._map.values()},G.prototype.entries=function(){return this._map.entries()},G.prototype["@@iterator"]=function(){return this.keys()},G.prototype[o]=function(){return this.keys()},G}()}function Q(){var G=16,X=u.create(),ce=_e();return function(){function Ie(){this._key=_e()}return Ie.prototype.has=function(Pe){var Re=xe(Pe,!1);return Re!==void 0?u.has(Re,this._key):!1},Ie.prototype.get=function(Pe){var Re=xe(Pe,!1);return Re!==void 0?u.get(Re,this._key):void 0},Ie.prototype.set=function(Pe,Re){var yt=xe(Pe,!0);return yt[this._key]=Re,this},Ie.prototype.delete=function(Pe){var Re=xe(Pe,!1);return Re!==void 0?delete Re[this._key]:!1},Ie.prototype.clear=function(){this._key=_e()},Ie}();function _e(){var Ie;do Ie="@@WeakMap@@"+se();while(u.has(X,Ie));return X[Ie]=!0,Ie}function xe(Ie,Pe){if(!t.call(Ie,ce)){if(!Pe)return;Object.defineProperty(Ie,ce,{value:u.create()})}return Ie[ce]}function ee(Ie,Pe){for(var Re=0;Re<Pe;++Re)Ie[Re]=Math.random()*255|0;return Ie}function oe(Ie){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(Ie)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(Ie)):ee(new Uint8Array(Ie),Ie):ee(new Array(Ie),Ie)}function se(){var Ie=oe(G);Ie[6]=Ie[6]&79|64,Ie[8]=Ie[8]&191|128;for(var Pe="",Re=0;Re<G;++Re){var yt=Ie[Re];(Re===4||Re===6||Re===8)&&(Pe+="-"),yt<16&&(Pe+="0"),Pe+=yt.toString(16).toLowerCase()}return Pe}}function we(G){return G.__=void 0,delete G.__,G}})})(rB||(rB={}))});var iB={};Wv(iB,{isPreRelesVersionOfJupyterExtension:()=>Qoe});var Qoe,oB=ge(()=>{"use strict";p();Qoe=!1});var Nn=re(er=>{"use strict";p();Object.defineProperty(er,"__esModule",{value:!0});er.NON_CUSTOM_TAG_KEYS=er.PRE_DESTROY=er.POST_CONSTRUCT=er.DESIGN_PARAM_TYPES=er.PARAM_TYPES=er.TAGGED_PROP=er.TAGGED=er.MULTI_INJECT_TAG=er.INJECT_TAG=er.OPTIONAL_TAG=er.UNMANAGED_TAG=er.NAME_TAG=er.NAMED_TAG=void 0;er.NAMED_TAG="named";er.NAME_TAG="name";er.UNMANAGED_TAG="unmanaged";er.OPTIONAL_TAG="optional";er.INJECT_TAG="inject";er.MULTI_INJECT_TAG="multi_inject";er.TAGGED="inversify:tagged";er.TAGGED_PROP="inversify:tagged_props";er.PARAM_TYPES="inversify:paramtypes";er.DESIGN_PARAM_TYPES="design:paramtypes";er.POST_CONSTRUCT="post_construct";er.PRE_DESTROY="pre_destroy";function Cse(){return[er.INJECT_TAG,er.MULTI_INJECT_TAG,er.NAME_TAG,er.UNMANAGED_TAG,er.NAMED_TAG,er.OPTIONAL_TAG]}er.NON_CUSTOM_TAG_KEYS=Cse()});var Va=re(Cp=>{"use strict";p();Object.defineProperty(Cp,"__esModule",{value:!0});Cp.TargetTypeEnum=Cp.BindingTypeEnum=Cp.BindingScopeEnum=void 0;var wse={Request:"Request",Singleton:"Singleton",Transient:"Transient"};Cp.BindingScopeEnum=wse;var xse={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};Cp.BindingTypeEnum=xse;var Pse={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};Cp.TargetTypeEnum=Pse});var wp=re(LD=>{"use strict";p();Object.defineProperty(LD,"__esModule",{value:!0});LD.id=void 0;var Dse=0;function Tse(){return Dse++}LD.id=Tse});var ZB=re(KD=>{"use strict";p();Object.defineProperty(KD,"__esModule",{value:!0});KD.Binding=void 0;var XB=Va(),kse=wp(),Nse=function(){function r(e,t){this.id=(0,kse.id)(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=XB.BindingTypeEnum.Invalid,this.constraint=function(n){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return r.prototype.clone=function(){var e=new r(this.serviceIdentifier,this.scope);return e.activated=e.scope===XB.BindingScopeEnum.Singleton?this.activated:!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e},r}();KD.Binding=Nse});var ji=re(je=>{"use strict";p();Object.defineProperty(je,"__esModule",{value:!0});je.STACK_OVERFLOW=je.CIRCULAR_DEPENDENCY_IN_FACTORY=je.ON_DEACTIVATION_ERROR=je.PRE_DESTROY_ERROR=je.POST_CONSTRUCT_ERROR=je.ASYNC_UNBIND_REQUIRED=je.MULTIPLE_POST_CONSTRUCT_METHODS=je.MULTIPLE_PRE_DESTROY_METHODS=je.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=je.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=je.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=je.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=je.ARGUMENTS_LENGTH_MISMATCH=je.INVALID_DECORATOR_OPERATION=je.INVALID_TO_SELF_VALUE=je.LAZY_IN_SYNC=je.INVALID_FUNCTION_BINDING=je.INVALID_MIDDLEWARE_RETURN=je.NO_MORE_SNAPSHOTS_AVAILABLE=je.INVALID_BINDING_TYPE=je.NOT_IMPLEMENTED=je.CIRCULAR_DEPENDENCY=je.UNDEFINED_INJECT_ANNOTATION=je.MISSING_INJECT_ANNOTATION=je.MISSING_INJECTABLE_ANNOTATION=je.NOT_REGISTERED=je.CANNOT_UNBIND=je.AMBIGUOUS_MATCH=je.KEY_NOT_FOUND=je.NULL_ARGUMENT=je.DUPLICATED_METADATA=je.DUPLICATED_INJECTABLE_DECORATOR=void 0;je.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.";je.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:";je.NULL_ARGUMENT="NULL argument";je.KEY_NOT_FOUND="Key Not Found";je.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:";je.CANNOT_UNBIND="Could not unbind serviceIdentifier:";je.NOT_REGISTERED="No matching bindings found for serviceIdentifier:";je.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:";je.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var Rse=function(r){return"@inject called with undefined this could mean that the class "+r+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};je.UNDEFINED_INJECT_ANNOTATION=Rse;je.CIRCULAR_DEPENDENCY="Circular dependency found:";je.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.";je.INVALID_BINDING_TYPE="Invalid binding type:";je.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.";je.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!";je.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!";var Ase=function(r){return"You are attempting to construct '"+r+`' in a synchronous way
 but it has asynchronous dependencies.`};je.LAZY_IN_SYNC=Ase;je.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier";je.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var Mse=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return"The number of constructor arguments in the derived class "+(r[0]+" must be >= than the number of constructor arguments of its base class.")};je.ARGUMENTS_LENGTH_MISMATCH=Mse;je.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.";je.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').";je.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean";je.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean";je.MULTIPLE_PRE_DESTROY_METHODS="Cannot apply @preDestroy decorator multiple times in the same class";je.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";je.ASYNC_UNBIND_REQUIRED="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)";var Ose=function(r,e){return"@postConstruct error in class "+r+": "+e};je.POST_CONSTRUCT_ERROR=Ose;var Lse=function(r,e){return"@preDestroy error in class "+r+": "+e};je.PRE_DESTROY_ERROR=Lse;var Kse=function(r,e){return"onDeactivation() error in class "+r+": "+e};je.ON_DEACTIVATION_ERROR=Kse;var Fse=function(r,e){return"It looks like there is a circular dependency in one of the '"+r+"' bindings. Please investigate bindings with"+("service identifier '"+e+"'.")};je.CIRCULAR_DEPENDENCY_IN_FACTORY=Fse;je.STACK_OVERFLOW="Maximum call stack size exceeded"});var TL=re(lc=>{"use strict";p();var Use=lc&&lc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Wse=lc&&lc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Vse=lc&&lc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Use(e,r,t);return Wse(e,r),e};Object.defineProperty(lc,"__esModule",{value:!0});lc.MetadataReader=void 0;var DL=Vse(Nn()),jse=function(){function r(){}return r.prototype.getConstructorMetadata=function(e){var t=Reflect.getMetadata(DL.PARAM_TYPES,e),n=Reflect.getMetadata(DL.TAGGED,e);return{compilerGeneratedMetadata:t,userGeneratedMetadata:n||{}}},r.prototype.getPropertiesMetadata=function(e){var t=Reflect.getMetadata(DL.TAGGED_PROP,e)||[];return t},r}();lc.MetadataReader=jse});var eH=re(FD=>{"use strict";p();Object.defineProperty(FD,"__esModule",{value:!0});FD.BindingCount=void 0;var Bse={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};FD.BindingCount=Bse});var kL=re(Zs=>{"use strict";p();var Hse=Zs&&Zs.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),qse=Zs&&Zs.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Jse=Zs&&Zs.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Hse(e,r,t);return qse(e,r),e};Object.defineProperty(Zs,"__esModule",{value:!0});Zs.tryAndThrowErrorIfStackOverflow=Zs.isStackOverflowExeption=void 0;var Gse=Jse(ji());function tH(r){return r instanceof RangeError||r.message===Gse.STACK_OVERFLOW}Zs.isStackOverflowExeption=tH;var Yse=function(r,e){try{return r()}catch(t){throw tH(t)&&(t=e()),t}};Zs.tryAndThrowErrorIfStackOverflow=Yse});var ey=re(Rn=>{"use strict";p();var $se=Rn&&Rn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),zse=Rn&&Rn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Qse=Rn&&Rn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&$se(e,r,t);return zse(e,r),e};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.getSymbolDescription=Rn.circularDependencyToException=Rn.listMetadataForTarget=Rn.listRegisteredBindingsForServiceIdentifier=Rn.getServiceIdentifierAsString=Rn.getFunctionName=void 0;var Xse=Qse(ji());function rH(r){if(typeof r=="function"){var e=r;return e.name}else{if(typeof r=="symbol")return r.toString();var e=r;return e}}Rn.getServiceIdentifierAsString=rH;function Zse(r,e,t){var n="",i=t(r,e);return i.length!==0&&(n=`
Registered bindings:`,i.forEach(function(o){var s="Object";o.implementationType!==null&&(s=oH(o.implementationType)),n=n+`
 `+s,o.constraint.metaData&&(n=n+" - "+o.constraint.metaData)})),n}Rn.listRegisteredBindingsForServiceIdentifier=Zse;function nH(r,e){return r.parentRequest===null?!1:r.parentRequest.serviceIdentifier===e?!0:nH(r.parentRequest,e)}function eae(r){function e(n,i){i===void 0&&(i=[]);var o=rH(n.serviceIdentifier);return i.push(o),n.parentRequest!==null?e(n.parentRequest,i):i}var t=e(r);return t.reverse().join(" --> ")}function iH(r){r.childRequests.forEach(function(e){if(nH(e,e.serviceIdentifier)){var t=eae(e);throw new Error(Xse.CIRCULAR_DEPENDENCY+" "+t)}else iH(e)})}Rn.circularDependencyToException=iH;function tae(r,e){if(e.isTagged()||e.isNamed()){var t="",n=e.getNamedTag(),i=e.getCustomTags();return n!==null&&(t+=n.toString()+`
`),i!==null&&i.forEach(function(o){t+=o.toString()+`
`})," "+r+`
 `+r+" - "+t}else return" "+r}Rn.listMetadataForTarget=tae;function oH(r){if(r.name)return r.name;var e=r.toString(),t=e.match(/^function\s*([^\s(]+)/);return t?t[1]:"Anonymous function: "+e}Rn.getFunctionName=oH;function rae(r){return r.toString().slice(7,-1)}Rn.getSymbolDescription=rae});var sH=re(UD=>{"use strict";p();Object.defineProperty(UD,"__esModule",{value:!0});UD.Context=void 0;var nae=wp(),iae=function(){function r(e){this.id=(0,nae.id)(),this.container=e}return r.prototype.addPlan=function(e){this.plan=e},r.prototype.setCurrentRequest=function(e){this.currentRequest=e},r}();UD.Context=iae});var ja=re(cc=>{"use strict";p();var oae=cc&&cc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),sae=cc&&cc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),aae=cc&&cc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&oae(e,r,t);return sae(e,r),e};Object.defineProperty(cc,"__esModule",{value:!0});cc.Metadata=void 0;var lae=aae(Nn()),cae=function(){function r(e,t){this.key=e,this.value=t}return r.prototype.toString=function(){return this.key===lae.NAMED_TAG?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},r}();cc.Metadata=cae});var aH=re(WD=>{"use strict";p();Object.defineProperty(WD,"__esModule",{value:!0});WD.Plan=void 0;var uae=function(){function r(e,t){this.parentContext=e,this.rootRequest=t}return r}();WD.Plan=uae});var NL=re(VD=>{"use strict";p();Object.defineProperty(VD,"__esModule",{value:!0});VD.LazyServiceIdentifer=void 0;var dae=function(){function r(e){this._cb=e}return r.prototype.unwrap=function(){return this._cb()},r}();VD.LazyServiceIdentifer=dae});var lH=re(jD=>{"use strict";p();Object.defineProperty(jD,"__esModule",{value:!0});jD.QueryableString=void 0;var pae=function(){function r(e){this.str=e}return r.prototype.startsWith=function(e){return this.str.indexOf(e)===0},r.prototype.endsWith=function(e){var t="",n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},r.prototype.contains=function(e){return this.str.indexOf(e)!==-1},r.prototype.equals=function(e){return this.str===e},r.prototype.value=function(){return this.str},r}();jD.QueryableString=pae});var RL=re(uc=>{"use strict";p();var fae=uc&&uc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),mae=uc&&uc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),hae=uc&&uc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&fae(e,r,t);return mae(e,r),e};Object.defineProperty(uc,"__esModule",{value:!0});uc.Target=void 0;var Ku=hae(Nn()),gae=wp(),vae=ey(),cH=ja(),yae=lH(),bae=function(){function r(e,t,n,i){this.id=(0,gae.id)(),this.type=e,this.serviceIdentifier=n;var o=typeof t=="symbol"?(0,vae.getSymbolDescription)(t):t;this.name=new yae.QueryableString(o||""),this.identifier=t,this.metadata=new Array;var s=null;typeof i=="string"?s=new cH.Metadata(Ku.NAMED_TAG,i):i instanceof cH.Metadata&&(s=i),s!==null&&this.metadata.push(s)}return r.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){var i=n[t];if(i.key===e)return!0}return!1},r.prototype.isArray=function(){return this.hasTag(Ku.MULTI_INJECT_TAG)},r.prototype.matchesArray=function(e){return this.matchesTag(Ku.MULTI_INJECT_TAG)(e)},r.prototype.isNamed=function(){return this.hasTag(Ku.NAMED_TAG)},r.prototype.isTagged=function(){return this.metadata.some(function(e){return Ku.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})})},r.prototype.isOptional=function(){return this.matchesTag(Ku.OPTIONAL_TAG)(!0)},r.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(e){return e.key===Ku.NAMED_TAG})[0]:null},r.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(e){return Ku.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})}):null},r.prototype.matchesNamedTag=function(e){return this.matchesTag(Ku.NAMED_TAG)(e)},r.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,o=t.metadata;i<o.length;i++){var s=o[i];if(s.key===e&&s.value===n)return!0}return!1}},r}();uc.Target=bae});var vH=re(Bi=>{"use strict";p();var Iae=Bi&&Bi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Sae=Bi&&Bi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),uH=Bi&&Bi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Iae(e,r,t);return Sae(e,r),e},BD=Bi&&Bi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(Bi,"__esModule",{value:!0});Bi.getFunctionName=Bi.getBaseClassDependencyCount=Bi.getDependencies=void 0;var _ae=NL(),AL=uH(ji()),dH=Va(),YE=uH(Nn()),ML=ey();Object.defineProperty(Bi,"getFunctionName",{enumerable:!0,get:function(){return ML.getFunctionName}});var pH=RL();function Eae(r,e){var t=(0,ML.getFunctionName)(e);return fH(r,t,e,!1)}Bi.getDependencies=Eae;function fH(r,e,t,n){var i=r.getConstructorMetadata(t),o=i.compilerGeneratedMetadata;if(o===void 0){var s=AL.MISSING_INJECTABLE_ANNOTATION+" "+e+".";throw new Error(s)}var a=i.userGeneratedMetadata,l=Object.keys(a),u=t.length===0&&l.length>0,c=l.length>t.length,d=u||c?l.length:t.length,f=wae(n,e,o,a,d),m=mH(r,t,e),g=BD(BD([],f,!0),m,!0);return g}function Cae(r,e,t,n,i){var o=i[r.toString()]||[],s=gH(o),a=s.unmanaged!==!0,l=n[r],u=s.inject||s.multiInject;if(l=u||l,l instanceof _ae.LazyServiceIdentifer&&(l=l.unwrap()),a){var c=l===Object,d=l===Function,f=l===void 0,m=c||d||f;if(!e&&m){var g=AL.MISSING_INJECT_ANNOTATION+" argument "+r+" in class "+t+".";throw new Error(g)}var b=new pH.Target(dH.TargetTypeEnum.ConstructorArgument,s.targetName,l);return b.metadata=o,b}return null}function wae(r,e,t,n,i){for(var o=[],s=0;s<i;s++){var a=s,l=Cae(a,r,e,t,n);l!==null&&o.push(l)}return o}function xae(r,e,t,n){var i=r||e;if(i===void 0){var o=AL.MISSING_INJECTABLE_ANNOTATION+" for property "+String(t)+" in class "+n+".";throw new Error(o)}return i}function mH(r,e,t){for(var n=r.getPropertiesMetadata(e),i=[],o=Object.getOwnPropertySymbols(n),s=Object.keys(n),a=s.concat(o),l=0,u=a;l<u.length;l++){var c=u[l],d=n[c],f=gH(d),m=f.targetName||c,g=xae(f.inject,f.multiInject,c,t),b=new pH.Target(dH.TargetTypeEnum.ClassProperty,m,g);b.metadata=d,i.push(b)}var v=Object.getPrototypeOf(e.prototype).constructor;if(v!==Object){var k=mH(r,v,t);i=BD(BD([],i,!0),k,!0)}return i}function hH(r,e){var t=Object.getPrototypeOf(e.prototype).constructor;if(t!==Object){var n=(0,ML.getFunctionName)(t),i=fH(r,n,t,!0),o=i.map(function(l){return l.metadata.filter(function(u){return u.key===YE.UNMANAGED_TAG})}),s=[].concat.apply([],o).length,a=i.length-s;return a>0?a:hH(r,t)}else return 0}Bi.getBaseClassDependencyCount=hH;function gH(r){var e={};return r.forEach(function(t){e[t.key.toString()]=t.value}),{inject:e[YE.INJECT_TAG],multiInject:e[YE.MULTI_INJECT_TAG],targetName:e[YE.NAME_TAG],unmanaged:e[YE.UNMANAGED_TAG]}}});var yH=re(HD=>{"use strict";p();Object.defineProperty(HD,"__esModule",{value:!0});HD.Request=void 0;var Pae=wp(),Dae=function(){function r(e,t,n,i,o){this.id=(0,Pae.id)(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=n===null?new Map:null}return r.prototype.addChildRequest=function(e,t,n){var i=new r(e,this.parentContext,this,t,n);return this.childRequests.push(i),i},r}();HD.Request=Dae});var UL=re(Vo=>{"use strict";p();var Tae=Vo&&Vo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),kae=Vo&&Vo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),SH=Vo&&Vo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Tae(e,r,t);return kae(e,r),e};Object.defineProperty(Vo,"__esModule",{value:!0});Vo.getBindingDictionary=Vo.createMockRequest=Vo.plan=void 0;var qD=eH(),LL=SH(ji()),_H=Va(),bH=SH(Nn()),Nae=kL(),ty=ey(),EH=sH(),KL=ja(),Rae=aH(),OL=vH(),FL=yH(),CH=RL();function wH(r){return r._bindingDictionary}Vo.getBindingDictionary=wH;function Aae(r,e,t,n,i,o){var s=r?bH.MULTI_INJECT_TAG:bH.INJECT_TAG,a=new KL.Metadata(s,t),l=new CH.Target(e,n,t,a);if(i!==void 0){var u=new KL.Metadata(i,o);l.metadata.push(u)}return l}function IH(r,e,t,n,i){var o=$E(t.container,i.serviceIdentifier),s=[];return o.length===qD.BindingCount.NoBindingsAvailable&&t.container.options.autoBindInjectable&&typeof i.serviceIdentifier=="function"&&r.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(t.container.bind(i.serviceIdentifier).toSelf(),o=$E(t.container,i.serviceIdentifier)),e?s=o:s=o.filter(function(a){var l=new FL.Request(a.serviceIdentifier,t,n,a,i);return a.constraint(l)}),Mae(i.serviceIdentifier,s,i,t.container),s}function Mae(r,e,t,n){switch(e.length){case qD.BindingCount.NoBindingsAvailable:if(t.isOptional())return e;var i=(0,ty.getServiceIdentifierAsString)(r),o=LL.NOT_REGISTERED;throw o+=(0,ty.listMetadataForTarget)(i,t),o+=(0,ty.listRegisteredBindingsForServiceIdentifier)(n,i,$E),new Error(o);case qD.BindingCount.OnlyOneBindingAvailable:return e;case qD.BindingCount.MultipleBindingsAvailable:default:if(t.isArray())return e;var i=(0,ty.getServiceIdentifierAsString)(r),o=LL.AMBIGUOUS_MATCH+" "+i;throw o+=(0,ty.listRegisteredBindingsForServiceIdentifier)(n,i,$E),new Error(o)}}function xH(r,e,t,n,i,o){var s,a;if(i===null){s=IH(r,e,n,null,o),a=new FL.Request(t,n,null,s,o);var l=new Rae.Plan(n,a);n.addPlan(l)}else s=IH(r,e,n,i,o),a=i.addChildRequest(o.serviceIdentifier,s,o);s.forEach(function(u){var c=null;if(o.isArray())c=a.addChildRequest(u.serviceIdentifier,u,o);else{if(u.cache)return;c=a}if(u.type===_H.BindingTypeEnum.Instance&&u.implementationType!==null){var d=(0,OL.getDependencies)(r,u.implementationType);if(!n.container.options.skipBaseClassChecks){var f=(0,OL.getBaseClassDependencyCount)(r,u.implementationType);if(d.length<f){var m=LL.ARGUMENTS_LENGTH_MISMATCH((0,OL.getFunctionName)(u.implementationType));throw new Error(m)}}d.forEach(function(g){xH(r,!1,g.serviceIdentifier,n,c,g)})}})}function $E(r,e){var t=[],n=wH(r);return n.hasKey(e)?t=n.get(e):r.parent!==null&&(t=$E(r.parent,e)),t}function Oae(r,e,t,n,i,o,s,a){a===void 0&&(a=!1);var l=new EH.Context(e),u=Aae(t,n,i,"",o,s);try{return xH(r,a,i,l,null,u),l}catch(c){throw(0,Nae.isStackOverflowExeption)(c)&&(0,ty.circularDependencyToException)(l.plan.rootRequest),c}}Vo.plan=Oae;function Lae(r,e,t,n){var i=new CH.Target(_H.TargetTypeEnum.Variable,"",e,new KL.Metadata(t,n)),o=new EH.Context(r),s=new FL.Request(e,o,null,[],i);return s}Vo.createMockRequest=Lae});var zE=re(ry=>{"use strict";p();Object.defineProperty(ry,"__esModule",{value:!0});ry.isPromiseOrContainsPromise=ry.isPromise=void 0;function WL(r){var e=typeof r=="object"&&r!==null||typeof r=="function";return e&&typeof r.then=="function"}ry.isPromise=WL;function Kae(r){return WL(r)?!0:Array.isArray(r)&&r.some(WL)}ry.isPromiseOrContainsPromise=Kae});var PH=re(dc=>{"use strict";p();var Fae=dc&&dc.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(d){s(d)}}function l(c){try{u(n.throw(c))}catch(d){s(d)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((n=n.apply(r,e||[])).next())})},Uae=dc&&dc.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(dc,"__esModule",{value:!0});dc.saveToScope=dc.tryGetFromScope=void 0;var JD=he(),Wae=zE(),Vae=function(r,e){return e.scope===JD.BindingScopeEnum.Singleton&&e.activated?e.cache:e.scope===JD.BindingScopeEnum.Request&&r.has(e.id)?r.get(e.id):null};dc.tryGetFromScope=Vae;var jae=function(r,e,t){e.scope===JD.BindingScopeEnum.Singleton&&Hae(e,t),e.scope===JD.BindingScopeEnum.Request&&Bae(r,e,t)};dc.saveToScope=jae;var Bae=function(r,e,t){r.has(e.id)||r.set(e.id,t)},Hae=function(r,e){r.cache=e,r.activated=!0,(0,Wae.isPromise)(e)&&qae(r,e)},qae=function(r,e){return Fae(void 0,void 0,void 0,function(){var t,n;return Uae(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return t=i.sent(),r.cache=t,[3,3];case 2:throw n=i.sent(),r.cache=null,r.activated=!1,n;case 3:return[2]}})})}});var DH=re(QE=>{"use strict";p();Object.defineProperty(QE,"__esModule",{value:!0});QE.FactoryType=void 0;var Jae;(function(r){r.DynamicValue="toDynamicValue",r.Factory="toFactory",r.Provider="toProvider"})(Jae=QE.FactoryType||(QE.FactoryType={}))});var jL=re(jo=>{"use strict";p();var Gae=jo&&jo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Yae=jo&&jo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),$ae=jo&&jo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Gae(e,r,t);return Yae(e,r),e};Object.defineProperty(jo,"__esModule",{value:!0});jo.getFactoryDetails=jo.ensureFullyBound=jo.multiBindToService=void 0;var zae=he(),Qae=$ae(ji()),pc=Va(),VL=DH(),Xae=function(r){return function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.forEach(function(i){return r.bind(i).toService(e)})}}};jo.multiBindToService=Xae;var Zae=function(r){var e=null;switch(r.type){case pc.BindingTypeEnum.ConstantValue:case pc.BindingTypeEnum.Function:e=r.cache;break;case pc.BindingTypeEnum.Constructor:case pc.BindingTypeEnum.Instance:e=r.implementationType;break;case pc.BindingTypeEnum.DynamicValue:e=r.dynamicValue;break;case pc.BindingTypeEnum.Provider:e=r.provider;break;case pc.BindingTypeEnum.Factory:e=r.factory;break}if(e===null){var t=(0,zae.getServiceIdentifierAsString)(r.serviceIdentifier);throw new Error(Qae.INVALID_BINDING_TYPE+" "+t)}};jo.ensureFullyBound=Zae;var ele=function(r){switch(r.type){case pc.BindingTypeEnum.Factory:return{factory:r.factory,factoryType:VL.FactoryType.Factory};case pc.BindingTypeEnum.Provider:return{factory:r.provider,factoryType:VL.FactoryType.Provider};case pc.BindingTypeEnum.DynamicValue:return{factory:r.dynamicValue,factoryType:VL.FactoryType.DynamicValue};default:throw new Error("Unexpected factory type "+r.type)}};jo.getFactoryDetails=ele});var MH=re(pi=>{"use strict";p();var ny=pi&&pi.__assign||function(){return ny=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},ny.apply(this,arguments)},tle=pi&&pi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),rle=pi&&pi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),nle=pi&&pi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&tle(e,r,t);return rle(e,r),e},NH=pi&&pi.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(d){s(d)}}function l(c){try{u(n.throw(c))}catch(d){s(d)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((n=n.apply(r,e||[])).next())})},RH=pi&&pi.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},ile=pi&&pi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(pi,"__esModule",{value:!0});pi.resolveInstance=void 0;var BL=ji(),qL=Va(),HL=nle(Nn()),JL=zE();function ole(r,e){return r.reduce(function(t,n){var i=e(n),o=n.target.type;return o===qL.TargetTypeEnum.ConstructorArgument?t.constructorInjections.push(i):(t.propertyRequests.push(n),t.propertyInjections.push(i)),t.isAsync||(t.isAsync=(0,JL.isPromiseOrContainsPromise)(i)),t},{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}function sle(r,e,t){var n;if(e.length>0){var i=ole(e,t),o=ny(ny({},i),{constr:r});i.isAsync?n=ale(o):n=AH(o)}else n=new r;return n}function AH(r){var e,t=new((e=r.constr).bind.apply(e,ile([void 0],r.constructorInjections,!1)));return r.propertyRequests.forEach(function(n,i){var o=n.target.identifier,s=r.propertyInjections[i];t[o]=s}),t}function ale(r){return NH(this,void 0,void 0,function(){var e,t;return RH(this,function(n){switch(n.label){case 0:return[4,TH(r.constructorInjections)];case 1:return e=n.sent(),[4,TH(r.propertyInjections)];case 2:return t=n.sent(),[2,AH(ny(ny({},r),{constructorInjections:e,propertyInjections:t}))]}})})}function TH(r){return NH(this,void 0,void 0,function(){var e,t,n,i;return RH(this,function(o){for(e=[],t=0,n=r;t<n.length;t++)i=n[t],Array.isArray(i)?e.push(Promise.all(i)):e.push(i);return[2,Promise.all(e)]})})}function kH(r,e){var t=lle(r,e);return(0,JL.isPromise)(t)?t.then(function(){return e}):e}function lle(r,e){var t,n;if(Reflect.hasMetadata(HL.POST_CONSTRUCT,r)){var i=Reflect.getMetadata(HL.POST_CONSTRUCT,r);try{return(n=(t=e)[i.value])===null||n===void 0?void 0:n.call(t)}catch(o){throw new Error((0,BL.POST_CONSTRUCT_ERROR)(r.name,o.message))}}}function cle(r,e){r.scope!==qL.BindingScopeEnum.Singleton&&ule(r,e)}function ule(r,e){var t="Class cannot be instantiated in "+(r.scope===qL.BindingScopeEnum.Request?"request":"transient")+" scope.";if(typeof r.onDeactivation=="function")throw new Error((0,BL.ON_DEACTIVATION_ERROR)(e.name,t));if(Reflect.hasMetadata(HL.PRE_DESTROY,e))throw new Error((0,BL.PRE_DESTROY_ERROR)(e.name,t))}function dle(r,e,t,n){cle(r,e);var i=sle(e,t,n);return(0,JL.isPromise)(i)?i.then(function(o){return kH(e,o)}):kH(e,i)}pi.resolveInstance=dle});var UH=re(Bo=>{"use strict";p();var ple=Bo&&Bo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),fle=Bo&&Bo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),mle=Bo&&Bo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&ple(e,r,t);return fle(e,r),e},hle=Bo&&Bo.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(d){s(d)}}function l(c){try{u(n.throw(c))}catch(d){s(d)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((n=n.apply(r,e||[])).next())})},gle=Bo&&Bo.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(Bo,"__esModule",{value:!0});Bo.resolve=void 0;var vle=mle(ji()),GD=Va(),yle=UL(),OH=PH(),GL=zE(),KH=jL(),ble=kL(),Ile=MH(),YL=function(r){return function(e){e.parentContext.setCurrentRequest(e);var t=e.bindings,n=e.childRequests,i=e.target&&e.target.isArray(),o=!e.parentRequest||!e.parentRequest.target||!e.target||!e.parentRequest.target.matchesArray(e.target.serviceIdentifier);if(i&&o)return n.map(function(a){var l=YL(r);return l(a)});if(e.target.isOptional()&&t.length===0)return;var s=t[0];return Cle(r,e,s)}},Sle=function(r,e){var t=(0,KH.getFactoryDetails)(r);return(0,ble.tryAndThrowErrorIfStackOverflow)(function(){return t.factory.bind(r)(e)},function(){return new Error(vle.CIRCULAR_DEPENDENCY_IN_FACTORY(t.factoryType,e.currentRequest.serviceIdentifier.toString()))})},_le=function(r,e,t){var n,i=e.childRequests;switch((0,KH.ensureFullyBound)(t),t.type){case GD.BindingTypeEnum.ConstantValue:case GD.BindingTypeEnum.Function:n=t.cache;break;case GD.BindingTypeEnum.Constructor:n=t.implementationType;break;case GD.BindingTypeEnum.Instance:n=(0,Ile.resolveInstance)(t,t.implementationType,i,YL(r));break;default:n=Sle(t,e.parentContext)}return n},Ele=function(r,e,t){var n=(0,OH.tryGetFromScope)(r,e);return n!==null||(n=t(),(0,OH.saveToScope)(r,e,n)),n},Cle=function(r,e,t){return Ele(r,t,function(){var n=_le(r,e,t);return(0,GL.isPromise)(n)?n=n.then(function(i){return LH(e,t,i)}):n=LH(e,t,n),n})};function LH(r,e,t){var n=wle(r.parentContext,e,t),i=Dle(r.parentContext.container),o,s=i.next();do{o=s.value;var a=r.parentContext,l=r.serviceIdentifier,u=Ple(o,l);(0,GL.isPromise)(n)?n=FH(u,a,n):n=xle(u,a,n),s=i.next()}while(s.done!==!0&&!(0,yle.getBindingDictionary)(o).hasKey(r.serviceIdentifier));return n}var wle=function(r,e,t){var n;return typeof e.onActivation=="function"?n=e.onActivation(r,t):n=t,n},xle=function(r,e,t){for(var n=r.next();!n.done;){if(t=n.value(e,t),(0,GL.isPromise)(t))return FH(r,e,t);n=r.next()}return t},FH=function(r,e,t){return hle(void 0,void 0,void 0,function(){var n,i;return gle(this,function(o){switch(o.label){case 0:return[4,t];case 1:n=o.sent(),i=r.next(),o.label=2;case 2:return i.done?[3,4]:[4,i.value(e,n)];case 3:return n=o.sent(),i=r.next(),[3,2];case 4:return[2,n]}})})},Ple=function(r,e){var t=r._activations;return t.hasKey(e)?t.get(e).values():[].values()},Dle=function(r){for(var e=[r],t=r.parent;t!==null;)e.push(t),t=t.parent;var n=function(){var o=e.pop();return o!==void 0?{done:!1,value:o}:{done:!0,value:void 0}},i={next:n};return i};function Tle(r){var e=YL(r.plan.rootRequest.requestScope);return e(r.plan.rootRequest)}Bo.resolve=Tle});var $L=re(Hi=>{"use strict";p();var kle=Hi&&Hi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Nle=Hi&&Hi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Rle=Hi&&Hi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&kle(e,r,t);return Nle(e,r),e};Object.defineProperty(Hi,"__esModule",{value:!0});Hi.typeConstraint=Hi.namedConstraint=Hi.taggedConstraint=Hi.traverseAncerstors=void 0;var Ale=Rle(Nn()),Mle=ja(),WH=function(r,e){var t=r.parentRequest;return t!==null?e(t)?!0:WH(t,e):!1};Hi.traverseAncerstors=WH;var VH=function(r){return function(e){var t=function(n){return n!==null&&n.target!==null&&n.target.matchesTag(r)(e)};return t.metaData=new Mle.Metadata(r,e),t}};Hi.taggedConstraint=VH;var Ole=VH(Ale.NAMED_TAG);Hi.namedConstraint=Ole;var Lle=function(r){return function(e){var t=null;if(e!==null)if(t=e.bindings[0],typeof r=="string"){var n=t.serviceIdentifier;return n===r}else{var i=e.bindings[0].implementationType;return r===i}return!1}};Hi.typeConstraint=Lle});var $D=re(YD=>{"use strict";p();Object.defineProperty(YD,"__esModule",{value:!0});YD.BindingWhenSyntax=void 0;var ho=zD(),Gn=$L(),Kle=function(){function r(e){this._binding=e}return r.prototype.when=function(e){return this._binding.constraint=e,new ho.BindingOnSyntax(this._binding)},r.prototype.whenTargetNamed=function(e){return this._binding.constraint=(0,Gn.namedConstraint)(e),new ho.BindingOnSyntax(this._binding)},r.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){if(e===null)return!1;var t=e.target!==null&&!e.target.isNamed()&&!e.target.isTagged();return t},new ho.BindingOnSyntax(this._binding)},r.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=(0,Gn.taggedConstraint)(e)(t),new ho.BindingOnSyntax(this._binding)},r.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return t!==null&&(0,Gn.typeConstraint)(e)(t.parentRequest)},new ho.BindingOnSyntax(this._binding)},r.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return t!==null&&(0,Gn.namedConstraint)(e)(t.parentRequest)},new ho.BindingOnSyntax(this._binding)},r.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&(0,Gn.taggedConstraint)(e)(t)(n.parentRequest)},new ho.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&(0,Gn.traverseAncerstors)(t,(0,Gn.typeConstraint)(e))},new ho.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,Gn.traverseAncerstors)(t,(0,Gn.typeConstraint)(e))},new ho.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&(0,Gn.traverseAncerstors)(t,(0,Gn.namedConstraint)(e))},new ho.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,Gn.traverseAncerstors)(t,(0,Gn.namedConstraint)(e))},new ho.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&(0,Gn.traverseAncerstors)(n,(0,Gn.taggedConstraint)(e)(t))},new ho.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&!(0,Gn.traverseAncerstors)(n,(0,Gn.taggedConstraint)(e)(t))},new ho.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&(0,Gn.traverseAncerstors)(t,e)},new ho.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,Gn.traverseAncerstors)(t,e)},new ho.BindingOnSyntax(this._binding)},r}();YD.BindingWhenSyntax=Kle});var zD=re(QD=>{"use strict";p();Object.defineProperty(QD,"__esModule",{value:!0});QD.BindingOnSyntax=void 0;var jH=$D(),Fle=function(){function r(e){this._binding=e}return r.prototype.onActivation=function(e){return this._binding.onActivation=e,new jH.BindingWhenSyntax(this._binding)},r.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new jH.BindingWhenSyntax(this._binding)},r}();QD.BindingOnSyntax=Fle});var zL=re(XD=>{"use strict";p();Object.defineProperty(XD,"__esModule",{value:!0});XD.BindingWhenOnSyntax=void 0;var Ule=zD(),Wle=$D(),Vle=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new Wle.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Ule.BindingOnSyntax(this._binding)}return r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}();XD.BindingWhenOnSyntax=Vle});var BH=re(ZD=>{"use strict";p();Object.defineProperty(ZD,"__esModule",{value:!0});ZD.BindingInSyntax=void 0;var QL=Va(),XL=zL(),jle=function(){function r(e){this._binding=e}return r.prototype.inRequestScope=function(){return this._binding.scope=QL.BindingScopeEnum.Request,new XL.BindingWhenOnSyntax(this._binding)},r.prototype.inSingletonScope=function(){return this._binding.scope=QL.BindingScopeEnum.Singleton,new XL.BindingWhenOnSyntax(this._binding)},r.prototype.inTransientScope=function(){return this._binding.scope=QL.BindingScopeEnum.Transient,new XL.BindingWhenOnSyntax(this._binding)},r}();ZD.BindingInSyntax=jle});var HH=re(eT=>{"use strict";p();Object.defineProperty(eT,"__esModule",{value:!0});eT.BindingInWhenOnSyntax=void 0;var Ble=BH(),Hle=zD(),qle=$D(),Jle=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new qle.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Hle.BindingOnSyntax(this._binding),this._bindingInSyntax=new Ble.BindingInSyntax(e)}return r.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},r.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},r.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}();eT.BindingInWhenOnSyntax=Jle});var GH=re(fc=>{"use strict";p();var Gle=fc&&fc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Yle=fc&&fc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),$le=fc&&fc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Gle(e,r,t);return Yle(e,r),e};Object.defineProperty(fc,"__esModule",{value:!0});fc.BindingToSyntax=void 0;var qH=$le(ji()),go=Va(),JH=HH(),iy=zL(),zle=function(){function r(e){this._binding=e}return r.prototype.to=function(e){return this._binding.type=go.BindingTypeEnum.Instance,this._binding.implementationType=e,new JH.BindingInWhenOnSyntax(this._binding)},r.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+qH.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},r.prototype.toConstantValue=function(e){return this._binding.type=go.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=go.BindingScopeEnum.Singleton,new iy.BindingWhenOnSyntax(this._binding)},r.prototype.toDynamicValue=function(e){return this._binding.type=go.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new JH.BindingInWhenOnSyntax(this._binding)},r.prototype.toConstructor=function(e){return this._binding.type=go.BindingTypeEnum.Constructor,this._binding.implementationType=e,this._binding.scope=go.BindingScopeEnum.Singleton,new iy.BindingWhenOnSyntax(this._binding)},r.prototype.toFactory=function(e){return this._binding.type=go.BindingTypeEnum.Factory,this._binding.factory=e,this._binding.scope=go.BindingScopeEnum.Singleton,new iy.BindingWhenOnSyntax(this._binding)},r.prototype.toFunction=function(e){if(typeof e!="function")throw new Error(qH.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=go.BindingTypeEnum.Function,this._binding.scope=go.BindingScopeEnum.Singleton,t},r.prototype.toAutoFactory=function(e){return this._binding.type=go.BindingTypeEnum.Factory,this._binding.factory=function(t){var n=function(){return t.container.get(e)};return n},this._binding.scope=go.BindingScopeEnum.Singleton,new iy.BindingWhenOnSyntax(this._binding)},r.prototype.toAutoNamedFactory=function(e){return this._binding.type=go.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new iy.BindingWhenOnSyntax(this._binding)},r.prototype.toProvider=function(e){return this._binding.type=go.BindingTypeEnum.Provider,this._binding.provider=e,this._binding.scope=go.BindingScopeEnum.Singleton,new iy.BindingWhenOnSyntax(this._binding)},r.prototype.toService=function(e){this.toDynamicValue(function(t){return t.container.get(e)})},r}();fc.BindingToSyntax=zle});var YH=re(tT=>{"use strict";p();Object.defineProperty(tT,"__esModule",{value:!0});tT.ContainerSnapshot=void 0;var Qle=function(){function r(){}return r.of=function(e,t,n,i,o){var s=new r;return s.bindings=e,s.middleware=t,s.deactivations=i,s.activations=n,s.moduleActivationStore=o,s},r}();tT.ContainerSnapshot=Qle});var $H=re(rT=>{"use strict";p();Object.defineProperty(rT,"__esModule",{value:!0});rT.isClonable=void 0;function Xle(r){return typeof r=="object"&&r!==null&&"clone"in r&&typeof r.clone=="function"}rT.isClonable=Xle});var ZL=re(mc=>{"use strict";p();var Zle=mc&&mc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),ece=mc&&mc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),tce=mc&&mc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Zle(e,r,t);return ece(e,r),e};Object.defineProperty(mc,"__esModule",{value:!0});mc.Lookup=void 0;var Mm=tce(ji()),rce=$H(),nce=function(){function r(){this._map=new Map}return r.prototype.getMap=function(){return this._map},r.prototype.add=function(e,t){if(e==null)throw new Error(Mm.NULL_ARGUMENT);if(t==null)throw new Error(Mm.NULL_ARGUMENT);var n=this._map.get(e);n!==void 0?n.push(t):this._map.set(e,[t])},r.prototype.get=function(e){if(e==null)throw new Error(Mm.NULL_ARGUMENT);var t=this._map.get(e);if(t!==void 0)return t;throw new Error(Mm.KEY_NOT_FOUND)},r.prototype.remove=function(e){if(e==null)throw new Error(Mm.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(Mm.KEY_NOT_FOUND)},r.prototype.removeIntersection=function(e){var t=this;this.traverse(function(n,i){var o=e.hasKey(n)?e.get(n):void 0;if(o!==void 0){var s=i.filter(function(a){return!o.some(function(l){return a===l})});t._setValue(n,s)}})},r.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach(function(i,o){for(var s=[],a=0,l=i;a<l.length;a++){var u=l[a],c=e(u);c?n.push(u):s.push(u)}t._setValue(o,s)}),n},r.prototype.hasKey=function(e){if(e==null)throw new Error(Mm.NULL_ARGUMENT);return this._map.has(e)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){t.forEach(function(i){return e.add(n,(0,rce.isClonable)(i)?i.clone():i)})}),e},r.prototype.traverse=function(e){this._map.forEach(function(t,n){e(n,t)})},r.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},r}();mc.Lookup=nce});var QH=re(nT=>{"use strict";p();Object.defineProperty(nT,"__esModule",{value:!0});nT.ModuleActivationStore=void 0;var zH=ZL(),ice=function(){function r(){this._map=new Map}return r.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},r.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)},r.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){e._map.set(n,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()})}),e},r.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return t===void 0&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},r.prototype._getEmptyHandlersStore=function(){var e={onActivations:new zH.Lookup,onDeactivations:new zH.Lookup};return e},r}();nT.ModuleActivationStore=ice});var eK=re(fi=>{"use strict";p();var oT=fi&&fi.__assign||function(){return oT=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},oT.apply(this,arguments)},oce=fi&&fi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),sce=fi&&fi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),XH=fi&&fi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&oce(e,r,t);return sce(e,r),e},ea=fi&&fi.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(d){s(d)}}function l(c){try{u(n.throw(c))}catch(d){s(d)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((n=n.apply(r,e||[])).next())})},ta=fi&&fi.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},ace=fi&&fi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(fi,"__esModule",{value:!0});fi.Container=void 0;var lce=ZB(),Ba=XH(ji()),oy=Va(),Om=XH(Nn()),cce=TL(),iT=UL(),uce=UH(),dce=GH(),Lm=zE(),pce=wp(),fce=ey(),mce=YH(),XE=ZL(),hce=QH(),gce=function(){function r(e){var t=e||{};if(typeof t!="object")throw new Error(""+Ba.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(t.defaultScope===void 0)t.defaultScope=oy.BindingScopeEnum.Transient;else if(t.defaultScope!==oy.BindingScopeEnum.Singleton&&t.defaultScope!==oy.BindingScopeEnum.Transient&&t.defaultScope!==oy.BindingScopeEnum.Request)throw new Error(""+Ba.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(t.autoBindInjectable===void 0)t.autoBindInjectable=!1;else if(typeof t.autoBindInjectable!="boolean")throw new Error(""+Ba.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(t.skipBaseClassChecks===void 0)t.skipBaseClassChecks=!1;else if(typeof t.skipBaseClassChecks!="boolean")throw new Error(""+Ba.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=(0,pce.id)(),this._bindingDictionary=new XE.Lookup,this._snapshots=[],this._middleware=null,this._activations=new XE.Lookup,this._deactivations=new XE.Lookup,this.parent=null,this._metadataReader=new cce.MetadataReader,this._moduleActivationStore=new hce.ModuleActivationStore}return r.merge=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=new r,s=ace([e,t],n,!0).map(function(u){return(0,iT.getBindingDictionary)(u)}),a=(0,iT.getBindingDictionary)(o);function l(u,c){u.traverse(function(d,f){f.forEach(function(m){c.add(m.serviceIdentifier,m.clone())})})}return s.forEach(function(u){l(u,a)}),o},r.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,o=e;i<o.length;i++){var s=o[i],a=n(s.id);s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},r.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ea(this,void 0,void 0,function(){var n,i,o,s,a;return ta(this,function(l){switch(l.label){case 0:n=this._getContainerModuleHelpersFactory(),i=0,o=e,l.label=1;case 1:return i<o.length?(s=o[i],a=n(s.id),[4,s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)]):[3,4];case 2:l.sent(),l.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},r.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach(function(i){var o=e._removeModuleBindings(i.id);e._deactivateSingletons(o),e._removeModuleHandlers(i.id)})},r.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ea(this,void 0,void 0,function(){var n,i,o,s;return ta(this,function(a){switch(a.label){case 0:n=0,i=e,a.label=1;case 1:return n<i.length?(o=i[n],s=this._removeModuleBindings(o.id),[4,this._deactivateSingletonsAsync(s)]):[3,4];case 2:a.sent(),this._removeModuleHandlers(o.id),a.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.bind=function(e){var t=this.options.defaultScope||oy.BindingScopeEnum.Transient,n=new lce.Binding(e,t);return this._bindingDictionary.add(e,n),new dce.BindingToSyntax(n)},r.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},r.prototype.rebindAsync=function(e){return ea(this,void 0,void 0,function(){return ta(this,function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}})})},r.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},r.prototype.unbindAsync=function(e){return ea(this,void 0,void 0,function(){var t;return ta(this,function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}})})},r.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse(function(t,n){e._deactivateSingletons(n)}),this._bindingDictionary=new XE.Lookup},r.prototype.unbindAllAsync=function(){return ea(this,void 0,void 0,function(){var e,t=this;return ta(this,function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse(function(i,o){e.push(t._deactivateSingletonsAsync(o))}),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new XE.Lookup,[2]}})})},r.prototype.onActivation=function(e,t){this._activations.add(e,t)},r.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},r.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},r.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},r.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,Om.NAMED_TAG,t)},r.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var o=this._bindingDictionary.get(e),s=(0,iT.createMockRequest)(this,e,t,n);i=o.some(function(a){return a.constraint(s)})}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},r.prototype.snapshot=function(){this._snapshots.push(mce.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},r.prototype.restore=function(){var e=this._snapshots.pop();if(e===void 0)throw new Error(Ba.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},r.prototype.createChild=function(e){var t=new r(e||this.options);return t.parent=this,t},r.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce(function(i,o){return o(i)},n)},r.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},r.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},r.prototype.getAsync=function(e){return ea(this,void 0,void 0,function(){var t;return ta(this,function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]})})},r.prototype.getTagged=function(e,t,n){var i=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(i)},r.prototype.getTaggedAsync=function(e,t,n){return ea(this,void 0,void 0,function(){var i;return ta(this,function(o){return i=this._getNotAllArgs(e,!1,t,n),[2,this._get(i)]})})},r.prototype.getNamed=function(e,t){return this.getTagged(e,Om.NAMED_TAG,t)},r.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,Om.NAMED_TAG,t)},r.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},r.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},r.prototype.getAllTagged=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(i)},r.prototype.getAllTaggedAsync=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getAll(i)},r.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,Om.NAMED_TAG,t)},r.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,Om.NAMED_TAG,t)},r.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},r.prototype._preDestroy=function(e,t){if(Reflect.hasMetadata(Om.PRE_DESTROY,e)){var n=Reflect.getMetadata(Om.PRE_DESTROY,e);return t[n.value]()}},r.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},r.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition(function(t){return t.moduleId===e})},r.prototype._deactivate=function(e,t){var n=this,i=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var o=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if((0,Lm.isPromise)(o))return this._handleDeactivationError(o.then(function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,i)}),i)}var s=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,i);if((0,Lm.isPromise)(s))return this._handleDeactivationError(s,i)}catch(a){throw new Error(Ba.ON_DEACTIVATION_ERROR(i.name,a.message))}},r.prototype._handleDeactivationError=function(e,t){return ea(this,void 0,void 0,function(){var n;return ta(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return i.sent(),[3,3];case 2:throw n=i.sent(),new Error(Ba.ON_DEACTIVATION_ERROR(t.name,n.message));case 3:return[2]}})})},r.prototype._deactivateContainer=function(e,t){for(var n=this,i=t.next();i.value;){var o=i.value(e);if((0,Lm.isPromise)(o))return o.then(function(){return n._deactivateContainerAsync(e,t)});i=t.next()}},r.prototype._deactivateContainerAsync=function(e,t){return ea(this,void 0,void 0,function(){var n;return ta(this,function(i){switch(i.label){case 0:n=t.next(),i.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return i.sent(),n=t.next(),[3,1];case 3:return[2]}})})},r.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(c,d){c._binding.moduleId=d},n=function(c){return function(d){var f=e.bind(d);return t(f,c),f}},i=function(){return function(c){return e.unbind(c)}},o=function(){return function(c){return e.unbindAsync(c)}},s=function(){return function(c){return e.isBound(c)}},a=function(c){return function(d){var f=e.rebind(d);return t(f,c),f}},l=function(c){return function(d,f){e._moduleActivationStore.addActivation(c,d,f),e.onActivation(d,f)}},u=function(c){return function(d,f){e._moduleActivationStore.addDeactivation(c,d,f),e.onDeactivation(d,f)}};return function(c){return{bindFunction:n(c),isboundFunction:s(),onActivationFunction:l(c),onDeactivationFunction:u(c),rebindFunction:a(c),unbindFunction:i(),unbindAsyncFunction:o()}}},r.prototype._getAll=function(e){return Promise.all(this._get(e))},r.prototype._get=function(e){var t=oT(oT({},e),{contextInterceptor:function(i){return i},targetType:oy.TargetTypeEnum.Variable});if(this._middleware){var n=this._middleware(t);if(n==null)throw new Error(Ba.INVALID_MIDDLEWARE_RETURN);return n}return this._planAndResolve()(t)},r.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if((0,Lm.isPromiseOrContainsPromise)(t))throw new Error(Ba.LAZY_IN_SYNC(e.serviceIdentifier));return t},r.prototype._getAllArgs=function(e){var t={avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e};return t},r.prototype._getNotAllArgs=function(e,t,n,i){var o={avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:i};return o},r.prototype._planAndResolve=function(){var e=this;return function(t){var n=(0,iT.plan)(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);n=t.contextInterceptor(n);var i=(0,uce.resolve)(n);return i}},r.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return(0,Lm.isPromise)(e.cache)?e.cache.then(function(n){return t._deactivate(e,n)}):this._deactivate(e,e.cache)},r.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t],o=this._deactivateIfSingleton(i);if((0,Lm.isPromise)(o))throw new Error(Ba.ASYNC_UNBIND_REQUIRED)}},r.prototype._deactivateSingletonsAsync=function(e){return ea(this,void 0,void 0,function(){var t=this;return ta(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(i){return t._deactivateIfSingleton(i)}))];case 1:return n.sent(),[2]}})})},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return ea(this,void 0,void 0,function(){return ta(this,function(i){switch(i.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:i.sent(),i.label=4;case 4:return[2]}})})},r.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(Ba.CANNOT_UNBIND+" "+(0,fce.getServiceIdentifierAsString)(e))}},r.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var i=this;if(typeof e.onDeactivation=="function"){var o=e.onDeactivation(t);if((0,Lm.isPromise)(o))return o.then(function(){return i._preDestroy(n,t)})}return this._preDestroy(n,t)},r.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return ea(this,void 0,void 0,function(){return ta(this,function(i){switch(i.label){case 0:return typeof e.onDeactivation!="function"?[3,2]:[4,e.onDeactivation(t)];case 1:i.sent(),i.label=2;case 2:return[4,this._preDestroy(n,t)];case 3:return i.sent(),[2]}})})},r}();fi.Container=gce});var e7=re(sy=>{"use strict";p();Object.defineProperty(sy,"__esModule",{value:!0});sy.AsyncContainerModule=sy.ContainerModule=void 0;var ZH=wp(),vce=function(){function r(e){this.id=(0,ZH.id)(),this.registry=e}return r}();sy.ContainerModule=vce;var yce=function(){function r(e){this.id=(0,ZH.id)(),this.registry=e}return r}();sy.AsyncContainerModule=yce});var t7=re(sT=>{"use strict";p();Object.defineProperty(sT,"__esModule",{value:!0});sT.getFirstArrayDuplicate=void 0;function bce(r){for(var e=new Set,t=0,n=r;t<n.length;t++){var i=n[t];if(e.has(i))return i;e.add(i)}}sT.getFirstArrayDuplicate=bce});var Fu=re(qi=>{"use strict";p();var Ice=qi&&qi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Sce=qi&&qi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),n7=qi&&qi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Ice(e,r,t);return Sce(e,r),e};Object.defineProperty(qi,"__esModule",{value:!0});qi.createTaggedDecorator=qi.tagProperty=qi.tagParameter=qi.decorate=void 0;var aT=n7(ji()),i7=n7(Nn()),_ce=t7();function Ece(r){return r.prototype!==void 0}function Cce(r){if(r!==void 0)throw new Error(aT.INVALID_DECORATOR_OPERATION)}function o7(r,e,t,n){Cce(e),a7(i7.TAGGED,r,t.toString(),n)}qi.tagParameter=o7;function s7(r,e,t){if(Ece(r))throw new Error(aT.INVALID_DECORATOR_OPERATION);a7(i7.TAGGED_PROP,r.constructor,e,t)}qi.tagProperty=s7;function wce(r){var e=[];if(Array.isArray(r)){e=r;var t=(0,_ce.getFirstArrayDuplicate)(e.map(function(n){return n.key}));if(t!==void 0)throw new Error(aT.DUPLICATED_METADATA+" "+t.toString())}else e=[r];return e}function a7(r,e,t,n){var i=wce(n),o={};Reflect.hasOwnMetadata(r,e)&&(o=Reflect.getMetadata(r,e));var s=o[t];if(s===void 0)s=[];else for(var a=function(d){if(i.some(function(f){return f.key===d.key}))throw new Error(aT.DUPLICATED_METADATA+" "+d.key.toString())},l=0,u=s;l<u.length;l++){var c=u[l];a(c)}s.push.apply(s,i),o[t]=s,Reflect.defineMetadata(r,o,e)}function xce(r){return function(e,t,n){typeof n=="number"?o7(e,t,n,r):s7(e,t,r)}}qi.createTaggedDecorator=xce;function r7(r,e){Reflect.decorate(r,e)}function Pce(r,e){return function(t,n){e(t,n,r)}}function Dce(r,e,t){typeof t=="number"?r7([Pce(t,r)],e):typeof t=="string"?Reflect.decorate([r],e,t):r7([r],e)}qi.decorate=Dce});var c7=re(hc=>{"use strict";p();var Tce=hc&&hc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),kce=hc&&hc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),l7=hc&&hc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Tce(e,r,t);return kce(e,r),e};Object.defineProperty(hc,"__esModule",{value:!0});hc.injectable=void 0;var Nce=l7(ji()),tK=l7(Nn());function Rce(){return function(r){if(Reflect.hasOwnMetadata(tK.PARAM_TYPES,r))throw new Error(Nce.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata(tK.DESIGN_PARAM_TYPES,r)||[];return Reflect.defineMetadata(tK.PARAM_TYPES,e,r),r}}hc.injectable=Rce});var u7=re(lT=>{"use strict";p();Object.defineProperty(lT,"__esModule",{value:!0});lT.tagged=void 0;var Ace=ja(),Mce=Fu();function Oce(r,e){return(0,Mce.createTaggedDecorator)(new Ace.Metadata(r,e))}lT.tagged=Oce});var d7=re(gc=>{"use strict";p();var Lce=gc&&gc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Kce=gc&&gc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Fce=gc&&gc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Lce(e,r,t);return Kce(e,r),e};Object.defineProperty(gc,"__esModule",{value:!0});gc.named=void 0;var Uce=Fce(Nn()),Wce=ja(),Vce=Fu();function jce(r){return(0,Vce.createTaggedDecorator)(new Wce.Metadata(Uce.NAMED_TAG,r))}gc.named=jce});var rK=re(cT=>{"use strict";p();Object.defineProperty(cT,"__esModule",{value:!0});cT.injectBase=void 0;var Bce=ji(),Hce=ja(),qce=Fu();function Jce(r){return function(e){return function(t,n,i){if(e===void 0){var o=typeof t=="function"?t.name:t.constructor.name;throw new Error((0,Bce.UNDEFINED_INJECT_ANNOTATION)(o))}return(0,qce.createTaggedDecorator)(new Hce.Metadata(r,e))(t,n,i)}}}cT.injectBase=Jce});var p7=re(vc=>{"use strict";p();var Gce=vc&&vc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Yce=vc&&vc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),$ce=vc&&vc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Gce(e,r,t);return Yce(e,r),e};Object.defineProperty(vc,"__esModule",{value:!0});vc.inject=void 0;var zce=$ce(Nn()),Qce=rK(),Xce=(0,Qce.injectBase)(zce.INJECT_TAG);vc.inject=Xce});var f7=re(yc=>{"use strict";p();var Zce=yc&&yc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),eue=yc&&yc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),tue=yc&&yc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Zce(e,r,t);return eue(e,r),e};Object.defineProperty(yc,"__esModule",{value:!0});yc.optional=void 0;var rue=tue(Nn()),nue=ja(),iue=Fu();function oue(){return(0,iue.createTaggedDecorator)(new nue.Metadata(rue.OPTIONAL_TAG,!0))}yc.optional=oue});var m7=re(bc=>{"use strict";p();var sue=bc&&bc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),aue=bc&&bc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),lue=bc&&bc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&sue(e,r,t);return aue(e,r),e};Object.defineProperty(bc,"__esModule",{value:!0});bc.unmanaged=void 0;var cue=lue(Nn()),uue=ja(),due=Fu();function pue(){return function(r,e,t){var n=new uue.Metadata(cue.UNMANAGED_TAG,!0);(0,due.tagParameter)(r,e,t,n)}}bc.unmanaged=pue});var h7=re(Ic=>{"use strict";p();var fue=Ic&&Ic.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),mue=Ic&&Ic.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),hue=Ic&&Ic.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&fue(e,r,t);return mue(e,r),e};Object.defineProperty(Ic,"__esModule",{value:!0});Ic.multiInject=void 0;var gue=hue(Nn()),vue=rK(),yue=(0,vue.injectBase)(gue.MULTI_INJECT_TAG);Ic.multiInject=yue});var g7=re(Sc=>{"use strict";p();var bue=Sc&&Sc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Iue=Sc&&Sc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Sue=Sc&&Sc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&bue(e,r,t);return Iue(e,r),e};Object.defineProperty(Sc,"__esModule",{value:!0});Sc.targetName=void 0;var _ue=Sue(Nn()),Eue=ja(),Cue=Fu();function wue(r){return function(e,t,n){var i=new Eue.Metadata(_ue.NAME_TAG,r);(0,Cue.tagParameter)(e,t,n,i)}}Sc.targetName=wue});var nK=re(uT=>{"use strict";p();Object.defineProperty(uT,"__esModule",{value:!0});uT.propertyEventDecorator=void 0;var xue=ja();function Pue(r,e){return function(){return function(t,n){var i=new xue.Metadata(r,n);if(Reflect.hasOwnMetadata(r,t.constructor))throw new Error(e);Reflect.defineMetadata(r,i,t.constructor)}}}uT.propertyEventDecorator=Pue});var y7=re(_c=>{"use strict";p();var Due=_c&&_c.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Tue=_c&&_c.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),v7=_c&&_c.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Due(e,r,t);return Tue(e,r),e};Object.defineProperty(_c,"__esModule",{value:!0});_c.postConstruct=void 0;var kue=v7(ji()),Nue=v7(Nn()),Rue=nK(),Aue=(0,Rue.propertyEventDecorator)(Nue.POST_CONSTRUCT,kue.MULTIPLE_POST_CONSTRUCT_METHODS);_c.postConstruct=Aue});var I7=re(Ec=>{"use strict";p();var Mue=Ec&&Ec.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Oue=Ec&&Ec.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),b7=Ec&&Ec.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Mue(e,r,t);return Oue(e,r),e};Object.defineProperty(Ec,"__esModule",{value:!0});Ec.preDestroy=void 0;var Lue=b7(ji()),Kue=b7(Nn()),Fue=nK(),Uue=(0,Fue.propertyEventDecorator)(Kue.PRE_DESTROY,Lue.MULTIPLE_PRE_DESTROY_METHODS);Ec.preDestroy=Uue});var S7=re(dT=>{"use strict";p();Object.defineProperty(dT,"__esModule",{value:!0});dT.interfaces=void 0;var iK;iK||(iK={});dT.interfaces=iK});var he=re(Be=>{"use strict";p();var Wue=Be&&Be.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Vue=Be&&Be.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),jue=Be&&Be.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Wue(e,r,t);return Vue(e,r),e};Object.defineProperty(Be,"__esModule",{value:!0});Be.multiBindToService=Be.getServiceIdentifierAsString=Be.typeConstraint=Be.namedConstraint=Be.taggedConstraint=Be.traverseAncerstors=Be.decorate=Be.interfaces=Be.id=Be.MetadataReader=Be.preDestroy=Be.postConstruct=Be.targetName=Be.multiInject=Be.unmanaged=Be.optional=Be.LazyServiceIdentifer=Be.inject=Be.named=Be.tagged=Be.injectable=Be.createTaggedDecorator=Be.ContainerModule=Be.AsyncContainerModule=Be.TargetTypeEnum=Be.BindingTypeEnum=Be.BindingScopeEnum=Be.Container=Be.METADATA_KEY=void 0;var Bue=jue(Nn());Be.METADATA_KEY=Bue;var Hue=eK();Object.defineProperty(Be,"Container",{enumerable:!0,get:function(){return Hue.Container}});var oK=Va();Object.defineProperty(Be,"BindingScopeEnum",{enumerable:!0,get:function(){return oK.BindingScopeEnum}});Object.defineProperty(Be,"BindingTypeEnum",{enumerable:!0,get:function(){return oK.BindingTypeEnum}});Object.defineProperty(Be,"TargetTypeEnum",{enumerable:!0,get:function(){return oK.TargetTypeEnum}});var _7=e7();Object.defineProperty(Be,"AsyncContainerModule",{enumerable:!0,get:function(){return _7.AsyncContainerModule}});Object.defineProperty(Be,"ContainerModule",{enumerable:!0,get:function(){return _7.ContainerModule}});var que=Fu();Object.defineProperty(Be,"createTaggedDecorator",{enumerable:!0,get:function(){return que.createTaggedDecorator}});var Jue=c7();Object.defineProperty(Be,"injectable",{enumerable:!0,get:function(){return Jue.injectable}});var Gue=u7();Object.defineProperty(Be,"tagged",{enumerable:!0,get:function(){return Gue.tagged}});var Yue=d7();Object.defineProperty(Be,"named",{enumerable:!0,get:function(){return Yue.named}});var $ue=p7();Object.defineProperty(Be,"inject",{enumerable:!0,get:function(){return $ue.inject}});var zue=NL();Object.defineProperty(Be,"LazyServiceIdentifer",{enumerable:!0,get:function(){return zue.LazyServiceIdentifer}});var Que=f7();Object.defineProperty(Be,"optional",{enumerable:!0,get:function(){return Que.optional}});var Xue=m7();Object.defineProperty(Be,"unmanaged",{enumerable:!0,get:function(){return Xue.unmanaged}});var Zue=h7();Object.defineProperty(Be,"multiInject",{enumerable:!0,get:function(){return Zue.multiInject}});var ede=g7();Object.defineProperty(Be,"targetName",{enumerable:!0,get:function(){return ede.targetName}});var tde=y7();Object.defineProperty(Be,"postConstruct",{enumerable:!0,get:function(){return tde.postConstruct}});var rde=I7();Object.defineProperty(Be,"preDestroy",{enumerable:!0,get:function(){return rde.preDestroy}});var nde=TL();Object.defineProperty(Be,"MetadataReader",{enumerable:!0,get:function(){return nde.MetadataReader}});var ide=wp();Object.defineProperty(Be,"id",{enumerable:!0,get:function(){return ide.id}});var ode=S7();Object.defineProperty(Be,"interfaces",{enumerable:!0,get:function(){return ode.interfaces}});var sde=Fu();Object.defineProperty(Be,"decorate",{enumerable:!0,get:function(){return sde.decorate}});var pT=$L();Object.defineProperty(Be,"traverseAncerstors",{enumerable:!0,get:function(){return pT.traverseAncerstors}});Object.defineProperty(Be,"taggedConstraint",{enumerable:!0,get:function(){return pT.taggedConstraint}});Object.defineProperty(Be,"namedConstraint",{enumerable:!0,get:function(){return pT.namedConstraint}});Object.defineProperty(Be,"typeConstraint",{enumerable:!0,get:function(){return pT.typeConstraint}});var ade=ey();Object.defineProperty(Be,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return ade.getServiceIdentifierAsString}});var lde=jL();Object.defineProperty(Be,"multiBindToService",{enumerable:!0,get:function(){return lde.multiBindToService}})});var sK=re(xp=>{"use strict";p();Object.defineProperty(xp,"__esModule",{value:!0});xp.PythonExtension=xp.PVSC_EXTENSION_ID=void 0;var ude=require("vscode");xp.PVSC_EXTENSION_ID="ms-python.python";var dde;(function(r){async function e(){let t=ude.extensions.getExtension(xp.PVSC_EXTENSION_ID);if(t===void 0)throw new Error("Python extension is not installed or is disabled");return t.isActive||await t.activate(),t.exports}r.api=e})(dde=xp.PythonExtension||(xp.PythonExtension={}))});var uK=re((RNe,M7)=>{p();function hde(r){var e=/(%?)(%([jds]))/g,t=Array.prototype.slice.call(arguments,1);return t.length&&(r=r.replace(e,function(n,i,o,s){var a=t.shift();switch(s){case"s":a=""+a;break;case"d":a=Number(a);break;case"j":a=JSON.stringify(a);break}return i?(t.unshift(a),n):a})),t.length&&(r+=" "+t.join(" ")),r=r.replace(/%{2,2}/g,"%"),""+r}M7.exports=hde});var n8=re((l1e,mK)=>{"use strict";p();var fy=typeof Reflect=="object"?Reflect:null,G7=fy&&typeof fy.apply=="function"?fy.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},ET;fy&&typeof fy.ownKeys=="function"?ET=fy.ownKeys:Object.getOwnPropertySymbols?ET=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ET=function(e){return Object.getOwnPropertyNames(e)};function Dde(r){console&&console.warn&&console.warn(r)}var $7=Number.isNaN||function(e){return e!==e};function Dr(){Dr.init.call(this)}mK.exports=Dr;mK.exports.once=Rde;Dr.EventEmitter=Dr;Dr.prototype._events=void 0;Dr.prototype._eventsCount=0;Dr.prototype._maxListeners=void 0;var Y7=10;function CT(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Dr,"defaultMaxListeners",{enumerable:!0,get:function(){return Y7},set:function(r){if(typeof r!="number"||r<0||$7(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Y7=r}});Dr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Dr.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||$7(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function z7(r){return r._maxListeners===void 0?Dr.defaultMaxListeners:r._maxListeners}Dr.prototype.getMaxListeners=function(){return z7(this)};Dr.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")G7(l,this,t);else for(var u=l.length,c=t8(l,u),n=0;n<u;++n)G7(c[n],this,t);return!0};function Q7(r,e,t,n){var i,o,s;if(CT(t),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),o=r._events),s=o[e]),s===void 0)s=o[e]=t,++r._eventsCount;else if(typeof s=="function"?s=o[e]=n?[t,s]:[s,t]:n?s.unshift(t):s.push(t),i=z7(r),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=s.length,Dde(a)}return r}Dr.prototype.addListener=function(e,t){return Q7(this,e,t,!1)};Dr.prototype.on=Dr.prototype.addListener;Dr.prototype.prependListener=function(e,t){return Q7(this,e,t,!0)};function Tde(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function X7(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=Tde.bind(n);return i.listener=t,n.wrapFn=i,i}Dr.prototype.once=function(e,t){return CT(t),this.on(e,X7(this,e,t)),this};Dr.prototype.prependOnceListener=function(e,t){return CT(t),this.prependListener(e,X7(this,e,t)),this};Dr.prototype.removeListener=function(e,t){var n,i,o,s,a;if(CT(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():kde(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};Dr.prototype.off=Dr.prototype.removeListener;Dr.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Z7(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Nde(i):t8(i,i.length)}Dr.prototype.listeners=function(e){return Z7(this,e,!0)};Dr.prototype.rawListeners=function(e){return Z7(this,e,!1)};Dr.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):e8.call(r,e)};Dr.prototype.listenerCount=e8;function e8(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Dr.prototype.eventNames=function(){return this._eventsCount>0?ET(this._events):[]};function t8(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function kde(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Nde(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Rde(r,e){return new Promise(function(t,n){function i(s){r.removeListener(e,o),n(s)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}r8(r,e,o,{once:!0}),e!=="error"&&Ade(r,i,{once:!0})})}function Ade(r,e,t){typeof r.on=="function"&&r8(r,"error",e,t)}function r8(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(o){n.once&&r.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var s8=re((hy,o8)=>{"use strict";p();var Mde=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof ju!="undefined")return ju;throw new Error("unable to locate global object")},ju=Mde();o8.exports=hy=ju.fetch;ju.fetch&&(hy.default=ju.fetch.bind(ju));hy.Headers=ju.Headers;hy.Request=ju.Request;hy.Response=ju.Response});var a8=re(nC=>{p();nC.get=function(r){var e=Error.stackTraceLimit;Error.stackTraceLimit=1/0;var t={},n=Error.prepareStackTrace;Error.prepareStackTrace=function(o,s){return s},Error.captureStackTrace(t,r||nC.get);var i=t.stack;return Error.prepareStackTrace=n,Error.stackTraceLimit=e,i};nC.parse=function(r){if(!r.stack)return[];var e=this,t=r.stack.split(`
`).slice(1);return t.map(function(n){if(n.match(/^\s*[-]{4,}$/))return e._createParsedCallSite({fileName:n,lineNumber:null,functionName:null,typeName:null,methodName:null,columnNumber:null,native:null});var i=n.match(/at (?:(.+)\s+\()?(?:(.+?):(\d+)(?::(\d+))?|([^)]+))\)?/);if(i){var o=null,s=null,a=null,l=null,u=null,c=i[5]==="native";if(i[1]){a=i[1];var d=a.lastIndexOf(".");if(a[d-1]=="."&&d--,d>0){o=a.substr(0,d),s=a.substr(d+1);var f=o.indexOf(".Module");f>0&&(a=a.substr(f+1),o=o.substr(0,f))}l=null}s&&(l=o,u=s),s==="<anonymous>"&&(u=null,a=null);var m={fileName:i[2]||null,lineNumber:parseInt(i[3],10)||null,functionName:a,typeName:l,methodName:u,columnNumber:parseInt(i[4],10)||null,native:c};return e._createParsedCallSite(m)}}).filter(function(n){return!!n})};function rC(r){for(var e in r)this[e]=r[e]}var Ode=["this","typeName","functionName","methodName","fileName","lineNumber","columnNumber","function","evalOrigin"],Lde=["topLevel","eval","native","constructor"];Ode.forEach(function(r){rC.prototype[r]=null,rC.prototype["get"+r[0].toUpperCase()+r.substr(1)]=function(){return this[r]}});Lde.forEach(function(r){rC.prototype[r]=!1,rC.prototype["is"+r[0].toUpperCase()+r.substr(1)]=function(){return this[r]}});nC._createParsedCallSite=function(r){return new rC(r)}});var Xr,pt,$t,Mt,oC,Er,ra,Ja,xT,Io,nr,PT=ge(()=>{p();Xr="function",pt="object",$t="undefined",Mt="prototype",oC="hasOwnProperty",Er=Object,ra=Er[Mt],Ja=Er.assign,xT=Er.create,Io=Er.defineProperty,nr=ra[oC]});function An(r){r===void 0&&(r=!0);var e=r===!1?null:h8;return e||(typeof globalThis!==$t&&(e=globalThis),!e&&typeof self!==$t&&(e=self),!e&&typeof window!==$t&&(e=window),!e&&typeof this!==$t&&(e=this),h8=e),e}function na(r){throw new TypeError(r)}function So(r){var e=xT;if(e)return e(r);if(r==null)return{};var t=typeof r;t!==pt&&t!==Xr&&na("Object prototype may only be an Object:"+r);function n(){}return n[Mt]=r,new n}var h8,yK=ge(()=>{p();PT();h8=null});function In(r,e){typeof e!==Xr&&e!==null&&na("Class extends value "+String(e)+" is not a constructor or null"),bK(r,e);function t(){this.constructor=r}r[Mt]=e===null?So(e):(t[Mt]=e[Mt],new t)}function Vm(r,e){for(var t=0,n=e.length,i=r.length;t<n;t++,i++)r[i]=e[t];return r}var sRe,aRe,qde,_o,bK,g8=ge(()=>{p();PT();yK();sRe=(An()||{}).Symbol,aRe=(An()||{}).Reflect,qde=function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)ra[oC].call(e,i)&&(r[i]=e[i])}return r},_o=Ja||qde,bK=function(r,e){return bK=Er.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n[oC](i)&&(t[i]=n[i])},bK(r,e)}});var v8=ge(()=>{p()});var ir=ge(()=>{p();PT();yK();g8();v8()});var IK,y8=ge(()=>{"use strict";p();IK=100});var Ga,xi,sC,Ya,Ot,Cs,wc,DT,Ho,tt,jm,Wr,TT,Bm,Hm,SK,aC,qm,yy,lC,Bu,ws,by,Ap,$a,Iy,Jm,xs,ia,Mp,Hu,kT,Op,za,Sy,Lp,cC,Kp,NT,_y,Qa,_K,EK,RT,Mn,qo,uC,Gm,dC,Ym,Xa,AT,$m,Ey,Fp,pC,Cn=ge(()=>{p();Ga="initialize",xi="name",sC="getNotifyMgr",Ya="identifier",Ot="push",Cs="isInitialized",wc="config",DT="instrumentationKey",Ho="logger",tt="length",jm="time",Wr="processNext",TT="getProcessTelContext",Bm="addNotificationListener",Hm="removeNotificationListener",SK="stopPollingInternalLogs",aC="onComplete",qm="getPlugin",yy="flush",lC="_extensions",Bu="splice",ws="teardown",by="messageId",Ap="message",$a="isAsync",Iy="_doTeardown",Jm="update",xs="getNext",ia="diagLog",Mp="setNextPlugin",Hu="createNew",kT="cookieCfg",Op="indexOf",za="substring",Sy="userAgent",Lp="split",cC="setEnabled",Kp="substr",NT="nodeType",_y="apply",Qa="replace",_K="enableDebugExceptions",EK="logInternalMessage",RT="toLowerCase",Mn="call",qo="type",uC="handler",Gm="listeners",dC="isChildEvt",Ym="getCtx",Xa="setCtx",AT="complete",$m="traceId",Ey="spanId",Fp="traceFlags",pC="version"});var ft,CK,cn,wK,fC,Cy,b8,Jo,oa,wy,Up,xy,Wp,MT,mC,zm,mi=ge(()=>{p();ft="",CK="channels",cn="core",wK="createPerfMgr",fC="disabled",Cy="extensionConfig",b8="extensions",Jo="processTelemetry",oa="priority",wy="eventsSent",Up="eventsDiscarded",xy="eventsSendRequest",Wp="perfEvent",MT="errorToConsole",mC="warnToConsole",zm="getPerfMgr"});function ipe(r){if(r){if(LT)return LT(r);var e=r[Jde]||r[Mt]||r[OT];if(e)return e}return null}function Py(r,e){return typeof r===e}function ur(r){return r===void 0||typeof r===$t}function Ct(r){return r===null||ur(r)}function NK(r){return!Ct(r)}function qu(r,e){return!!(r&&nr[Mn](r,e))}function Pi(r){return!!(r&&typeof r===pt)}function qt(r){return!!(r&&typeof r===Xr)}function Qm(r){var e=r;return e&&un(e)&&(e=e[Qa](tpe,function(t,n){return n.toUpperCase()}),e=e[Qa](rpe,"_"),e=e[Qa](npe,function(t,n){return"_"+n})),e}function Vr(r,e){if(r)for(var t in r)nr[Mn](r,t)&&e[Mn](r,t,r[t])}function Xm(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=$de?r[D8](e):ope(r,e)),t}function ope(r,e){var t=!1,n=e?e[tt]:0,i=r?r[tt]:0;if(n&&i&&i>=n&&!(t=r===e)){for(var o=i-1,s=n-1;s>=0;s--){if(r[o]!=e[s])return!1;o--}t=!0}return t}function Dy(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=zde?r[T8](e):spe(r,e)),t}function spe(r,e){var t=!1,n=e?e[tt]:0;if(r&&n&&r[tt]>=n&&!(t=r===e)){for(var i=0;i<n;i++)if(r[i]!==e[i])return!1;t=!0}return t}function wn(r,e){return r&&e?r[Op](e)!==-1:!1}function Ty(r){return!!(r&&kK[Mn](r)==="[object Date]")}function ape(r){return!!(r&&kK[Mn](r)==="[object Array]")}function Zm(r){return!!(r&&kK[Mn](r)==="[object Error]")}function un(r){return typeof r=="string"}function Go(r){return typeof r=="number"}function Ju(r){return typeof r=="boolean"}function w8(r){var e=!1;if(r&&typeof r=="object"){var t=LT?LT(r):ipe(r);t?(t[OT]&&nr[Mn](t,OT)&&(t=t[OT]),e=typeof t===Xr&&N8[Mn](t)===epe):e=!0}return e}function sa(r){if(r)return Xde?r[P8]():lpe(r)}function lpe(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[tt]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function We(r,e,t){var n=r[tt];try{for(var i=0;i<n&&!(i in r&&e[Mn](t||r,r[i],i,r)===-1);i++);}catch(o){}}function Yn(r,e,t){if(r){if(r[I8])return r[I8](e,t);var n=r[tt],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function eh(r,e,t){var n;if(r){if(r[S8])return r[S8](e,t);var i=r[tt],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[Mn](o,r[s],r))}catch(a){}}return n}function th(r,e,t){var n;if(r){if(r[_8])return r[_8](e,t);var i=r[tt],o=0;if(arguments[tt]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function jr(r){return r&&(r=Yde&&r[PK]?r[PK]():r[Qa]?r[Qa](/^\s+|(?=\s)\s+$/g,ft):r),r}function Eo(r){var e=typeof r;if(e!==Xr&&(e!==pt||r===null)&&na("objKeys called on non-object"),!x8&&C8)return C8(r);var t=[];for(var n in r)r&&nr[Mn](r,n)&&t[Ot](n);if(x8)for(var i=xK[tt],o=0;o<i;o++)r&&nr[Mn](r,xK[o])&&t[Ot](xK[o]);return t}function Ps(r,e,t,n){if(E8)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),E8(r,e,i),!0}catch(o){}return!1}function R8(r){return r}function RK(r){return DK&&Vr(r,function(e,t){(It(t)||Pi(t))&&DK(t)}),Yo(r)}function $n(){var r=Date;return r.now?r.now():new r().getTime()}function rh(r){return Zm(r)?r[xi]:ft}function $o(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function Vp(r,e,t){var n;return r?(n=r[e],!n&&Ct(n)&&(n=ur(t)?{}:t,r[e]=n)):n=ur(t)?{}:t,n}function aa(r,e){return Ct(r)?e:r}function MK(r){return!r}function ky(r){return!!r}function zn(r){throw new Error(r)}function A8(r,e){var t=null,n=null;return qt(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][_y](n,i)}}function OK(r,e,t){if(r&&e&&Pi(r)&&Pi(e)){var n=function(o){if(un(o)){var s=e[o];qt(s)?(!t||t(o,!0,e,r))&&(r[o]=A8(e,o)):(!t||t(o,!1,e,r))&&(qu(r,o)&&delete r[o],Ps(r,o,function(){return e[o]},function(a){e[o]=a})||(r[o]=s))}};for(var i in e)n(i)}return r}function jp(r,e,t,n,i){r&&e&&t&&(i!==!1||ur(r[e]))&&(r[e]=A8(t,n))}function nh(r,e,t,n){return r&&e&&Pi(r)&&It(t)&&We(t,function(i){un(i)&&jp(r,i,e,i,n)}),r}function Gu(r){return r&&Ja&&(r=Er(Ja({},r))),r}function Ny(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[tt],u=!1,c=1;for(l>0&&Ju(a)&&(u=a,a=s[c]||{},c++),Pi(a)||(a={});c<l;c++){var d=s[c],f=It(d),m=Pi(d);for(var g in d){var b=f&&g in d||m&&nr[Mn](d,g);if(b){var v=d[g],k=void 0;if(u&&v&&((k=It(v))||w8(v))){var R=a[g];k?It(R)||(R=[]):w8(R)||(R={}),v=Ny(u,R,v)}v!==void 0&&(a[g]=v)}}}return a}var P8,D8,T8,I8,S8,_8,PK,k8,Jde,OT,E8,DK,Gde,C8,TK,Yde,$de,zde,Qde,Xde,Zde,kK,N8,epe,tpe,rpe,npe,LT,It,x8,xK,Yo,AK,xn=ge(()=>{p();ir();Cn();mi();P8="toISOString",D8="endsWith",T8="startsWith",I8="indexOf",S8="map",_8="reduce",PK="trim",k8="toString",Jde="__proto__",OT="constructor",E8=Io,DK=Er.freeze,Gde=Er.seal,C8=Er.keys,TK=String[Mt],Yde=TK[PK],$de=TK[D8],zde=TK[T8],Qde=Date[Mt],Xde=Qde[P8],Zde=Array.isArray,kK=ra[k8],N8=nr[k8],epe=N8[Mn](Er),tpe=/-([a-z])/g,rpe=/([^\w\d_$])/g,npe=/^(\d+[\w\d_$])/,LT=Object.getPrototypeOf;It=Zde||ape;x8=!{toString:null}.propertyIsEnumerable("toString"),xK=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];Yo=DK||R8,AK=Gde||R8});function Co(r){var e={};return Vr(r,function(t,n){e[t]=n,e[n]=t}),RK(e)}var KT=ge(()=>{p();xn()});var Za,M8=ge(()=>{p();KT();Za=Co({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5})});function upe(){var r;return typeof globalThis!==UT&&(r=globalThis),!r&&typeof self!==UT&&(r=self),!r&&typeof window!==UT&&(r=window),!r&&typeof this!==UT&&(r=this),r||{}}function $u(r,e){return r&&GT[Yu].hasOwnProperty.call(r,e)}function V8(r){return r&&(r===GT[Yu]||r===Array[Yu])}function jK(r){return V8(r)||r===Function[Yu]}function ih(r){var e;if(r){if(gC)return gC(r);var t=r[W8]||r[Yu]||(r[jT]?r[jT][Yu]:null);e=r[WT]||t,$u(r,WT)||(delete r[LK],e=r[WT]=r[LK]||r[WT],r[LK]=t)}return e}function qT(r,e){var t=[];if(K8)t=K8(r);else for(var n in r)typeof n=="string"&&$u(r,n)&&t.push(n);if(t&&t.length>0)for(var i=0;i<t.length;i++)e(t[i])}function BK(r,e,t){return e!==jT&&typeof r[e]===BT&&(t||$u(r,e))}function JT(r){throw new TypeError("DynamicProto: "+r)}function dpe(r){var e={};return qT(r,function(t){!e[t]&&BK(r,t,!1)&&(e[t]=r[t])}),e}function HK(r,e){for(var t=r.length-1;t>=0;t--)if(r[t]===e)return!0;return!1}function ppe(r,e,t,n){function i(l,u,c){var d=u[c];if(d[FK]&&n){var f=l[HT]||{};f[hC]!==!1&&(d=(f[u[Ry]]||{})[c]||d)}return function(){return d.apply(l,arguments)}}var o={};qT(t,function(l){o[l]=i(e,t,l)});for(var s=ih(r),a=[];s&&!jK(s)&&!HK(a,s);)qT(s,function(l){!o[l]&&BK(s,l,!gC)&&(o[l]=i(e,s,l))}),a.push(s),s=ih(s);return o}function fpe(r,e,t,n){var i=null;if(r&&$u(t,Ry)){var o=r[HT]||{};if(i=(o[t[Ry]]||{})[e],i||JT("Missing ["+e+"] "+BT),!i[UK]&&o[hC]!==!1){for(var s=!$u(r,e),a=ih(r),l=[];s&&a&&!jK(a)&&!HK(l,a);){var u=a[e];if(u){s=u===n;break}l.push(a),a=ih(a)}try{s&&(r[e]=i),i[UK]=1}catch(c){o[hC]=!1}}}return i}function mpe(r,e,t){var n=e[r];return n===t&&(n=ih(e)[r]),typeof n!==BT&&JT("["+r+"] is not a "+BT),n}function hpe(r,e,t,n,i){function o(l,u){var c=function(){var d=fpe(this,u,l,c)||mpe(u,l,c);return d.apply(this,arguments)};return c[FK]=1,c}if(!V8(r)){var s=t[HT]=t[HT]||{},a=s[e]=s[e]||{};s[hC]!==!1&&(s[hC]=!!i),qT(t,function(l){BK(t,l,!1)&&t[l]!==n[l]&&(a[l]=t[l],delete t[l],(!$u(r,l)||r[l]&&!r[l][FK])&&(r[l]=o(r,l)))})}}function gpe(r,e){if(gC){for(var t=[],n=ih(e);n&&!jK(n)&&!HK(t,n);){if(n===r)return!0;t.push(n),n=ih(n)}return!1}return!0}function KK(r,e){return $u(r,Yu)?r.name||e||O8:((r||{})[jT]||{}).name||e||O8}function He(r,e,t,n){$u(r,Yu)||JT("theClass is an invalid class definition.");var i=r[Yu];gpe(i,e)||JT("["+KK(r)+"] not in hierarchy of ["+KK(e)+"]");var o=null;$u(i,Ry)?o=i[Ry]:(o=cpe+KK(r,"_")+"$"+VK.n,VK.n++,i[Ry]=o);var s=He[U8],a=!!s[VT];a&&n&&n[VT]!==void 0&&(a=!!n[VT]);var l=dpe(e),u=ppe(i,e,l,a);t(e,u);var c=!!gC&&!!s[WK];c&&n&&(c=!!n[WK]),hpe(i,o,e,l,c!==!1)}var FT,UT,jT,Yu,BT,HT,FK,Ry,cpe,UK,hC,U8,O8,W8,WT,L8,LK,VT,WK,GT,gC,K8,F8,VK,dr=ge(()=>{p();UT="undefined",jT="constructor",Yu="prototype",BT="function",HT="_dynInstFuncs",FK="_isDynProxy",Ry="_dynClass",cpe="_dynCls$",UK="_dynInstChk",hC=UK,U8="_dfOpts",O8="_unknown_",W8="__proto__",WT="_dyn"+W8,L8="__dynProto$Gbl",LK="_dynInstProto",VT="useBaseInst",WK="setInstFuncs",GT=Object,gC=GT.getPrototypeOf,K8=GT.getOwnPropertyNames;F8=upe(),VK=F8[L8]||(F8[L8]={o:(FT={},FT[WK]=!0,FT[VT]=!0,FT),n:1e3});He[U8]=VK.o});function J8(r,e){var t=!1;if(r){try{if(t=e in r,!t){var n=r[Mt];n&&(t=e in n)}}catch(o){}if(!t)try{var i=new r;t=!ur(i[e])}catch(o){}}return t}function zK(r){q8=r}function dn(r){var e=An();return e&&e[r]?e[r]:r===j8&&vC()?window:null}function vC(){return!!(typeof window===pt&&window)}function xc(){return vC()?window:dn(j8)}function YT(){return!!(typeof document===pt&&document)}function zo(){return YT()?document:dn(vpe)}function yC(){return!!(typeof navigator===pt&&navigator)}function Ds(){return yC()?navigator:dn(bpe)}function $T(){return!!(typeof history===pt&&history)}function QK(){return $T()?history:dn(Ipe)}function oh(r){if(r&&q8){var e=dn("__mockLocation");if(e)return e}return typeof location===pt&&location?location:dn(Spe)}function bC(){return typeof console!==$t?console:dn(_pe)}function My(){return dn(Epe)}function sh(){return!!(typeof JSON===pt&&JSON||dn(B8)!==null)}function Oy(){return sh()?JSON||dn(B8):null}function IC(){return dn(Cpe)}function SC(){return dn(wpe)}function zu(){var r=Ds();return r&&r.product?r.product===xpe:!1}function el(){var r=Ds();if(r&&(r[Sy]!==JK||qK===null)){JK=r[Sy];var e=(JK||ft)[RT]();qK=wn(e,YK)||wn(e,$K)}return qK}function XK(r){if(r===void 0&&(r=null),!r){var e=Ds()||{};r=e?(e[Sy]||ft)[RT]():ft}var t=(r||ft)[RT]();if(wn(t,YK)){var n=zo()||{};return Math.max(parseInt(t[Lp](YK)[1]),n[ype]||0)}else if(wn(t,$K)){var i=parseInt(t[Lp]($K)[1]);if(i)return i+4}return null}function Zr(r){var e=Object[Mt].toString[Mn](r),t=ft;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[xi]+"'":sh()&&(t=Oy().stringify(r)),e+t}function Bp(){return GK===null&&(GK=yC()&&!!Ds().sendBeacon),GK}function Ly(r){var e=!1;try{e=!!dn("fetch");var t=dn("Request");e&&r&&t&&(e=J8(t,"keepalive"))}catch(n){}return e}function ah(){return Ay===null&&(Ay=typeof XDomainRequest!==$t,Ay&&Ky()&&(Ay=Ay&&!J8(dn(H8),"withCredentials"))),Ay}function Ky(){var r=!1;try{var e=dn(H8);r=!!e}catch(t){}return r}function G8(r,e){if(r)for(var t=0;t<r[tt];t++){var n=r[t];if(n[xi]&&n[xi]===e)return n}return{}}function ZK(r){var e=zo();return e&&r?G8(e.querySelectorAll("meta"),r).content:null}function eF(r){var e,t=My();if(t){var n=t.getEntriesByType("navigation")||[];e=G8((n[tt]>0?n[0]:{}).serverTiming,r).description}return e}var j8,vpe,ype,bpe,Ipe,Spe,_pe,Epe,B8,Cpe,wpe,xpe,YK,$K,H8,qK,JK,q8,Ay,GK,la=ge(()=>{"use strict";p();ir();Cn();xn();mi();j8="window",vpe="document",ype="documentMode",bpe="navigator",Ipe="history",Spe="location",_pe="console",Epe="performance",B8="JSON",Cpe="crypto",wpe="msCrypto",xpe="ReactNative",YK="msie",$K="trident/",H8="XMLHttpRequest",qK=null,JK=null,q8=!1,Ay=null,GK=null});function Ppe(r,e){return function(){var t=arguments,n=rF(e);if(n){var i=n.listener;i&&i[r]&&i[r][_y](i,t)}}}function Dpe(){var r=dn("Microsoft");return r&&(QT=r.ApplicationInsights),QT}function rF(r){var e=QT;return!e&&r.disableDbgExt!==!0&&(e=QT||Dpe()),e?e.ChromeDbgExt:null}function Y8(r){if(!zT){zT={};for(var e=0;e<tF[tt];e++)zT[tF[e]]=Ppe(tF[e],r)}return zT}var tF,QT,zT,nF=ge(()=>{p();Cn();la();tF=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],QT=null});function $8(r){return r?'"'+r[Qa](/\"/g,ft)+'"':ft}function z8(r,e){var t=bC();if(t){var n="log";t[r]&&(n=r),qt(t[n])&&t[n](e)}}function _C(r,e){return(r||{})[Ho]||new tl(e)}function iF(r){return r||new tl}function Yr(r,e,t,n,i,o){o===void 0&&(o=!1),iF(r).throwInternal(e,t,n,i,o)}function rl(r,e){iF(r)[mC](e)}function oF(r,e,t){iF(r)[EK](e,t)}var Tpe,kpe,Npe,lh,tl,Hp=ge(()=>{"use strict";p();dr();Cn();nF();la();xn();mi();Tpe="AI (Internal): ",kpe="AI: ",Npe="AITR_";lh=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[by]=e,o[Ap]=(n?kpe:Tpe)+e;var s=ft;sh()&&(s=Oy().stringify(i));var a=(t?" message:"+$8(t):ft)+(i?" props:"+$8(s):ft);o[Ap]+=a}return r.dataType="MessageData",r}();tl=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;He(r,this,function(l){c(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[_K]=function(){return a},l.throwInternal=function(m,g,b,v,k){k===void 0&&(k=!1);var R=new lh(g,b,k,v);if(a)throw Zr(R);var P=m===1?MT:mC;if(ur(R[Ap]))f("throw"+(m===1?"Critical":"Warning"),R);else{if(k){var D=+R[by];!n[D]&&i>=m&&(l[P](R[Ap]),n[D]=!0)}else i>=m&&l[P](R[Ap]);u(m,R)}},l[mC]=function(m){z8("warn",m),f("warning",m)},l[MT]=function(m){z8("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[EK]=u;function u(m,g){if(!d()){var b=!0,v=Npe+g[by];if(n[v]?b=!1:n[v]=!0,b&&(m<=o&&(l.queue[Ot](g),t++,f(m===1?"error":"warn",g)),t===s)){var k="Internal events throttle limit per PageView reached for this app.",R=new lh(23,k,!1);l.queue[Ot](R),m===1?l[MT](k):l[mC](k)}}}function c(m){i=aa(m.loggingLevelConsole,0),o=aa(m.loggingLevelTelemetry,1),s=aa(m.maxMessageLimit,25),a=aa(m[_K],!1)}function d(){return t>=s}function f(m,g){var b=rF(e||{});b&&b[ia]&&b[ia](m,g)}})}return r.__ieDyn=1,r}()});function Sn(r,e,t,n,i){if(r){var o=r;if(o[zm]&&(o=o[zm]()),o){var s=void 0,a=o[Ym](sF);try{if(s=o.create(e(),n,i),s){if(a&&s[Xa]&&(s[Xa](ch[aF],a),a[Ym]&&a[Xa])){var l=a[Ym](ch[EC]);l||(l=[],a[Xa](ch[EC],l)),l[Ot](s)}return o[Xa](sF,s),t(s)}}catch(u){s&&s[Xa]&&s[Xa]("exception",u)}finally{s&&o.fire(s),o[Xa](sF,a)}}}return t()}function lF(){return Rpe}var Fy,aF,EC,Rpe,ch,CC,sF,wC=ge(()=>{p();dr();Cn();xn();mi();Fy="ctx",aF="ParentContextKey",EC="ChildrenContextKey",Rpe=null,ch=function(){function r(e,t,n){var i=this,o=!1;if(i.start=$n(),i[xi]=e,i[$a]=n,i[dC]=function(){return!1},qt(t)){var s;o=Ps(i,"payload",function(){return!s&&qt(t)&&(s=t(),t=null),s})}i[Ym]=function(a){return a?a===r[aF]||a===r[EC]?i[a]:(i[Fy]||{})[a]:null},i[Xa]=function(a,l){if(a)if(a===r[aF])i[a]||(i[dC]=function(){return!0}),i[a]=l;else if(a===r[EC])i[a]=l;else{var u=i[Fy]=i[Fy]||{};u[a]=l}},i[AT]=function(){var a=0,l=i[Ym](r[EC]);if(It(l))for(var u=0;u<l[tt];u++){var c=l[u];c&&(a+=c[jm])}i[jm]=$n()-i.start,i.exTime=i[jm]-a,i[AT]=function(){},!o&&qt(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),CC=function(){function r(e){this.ctx={},He(r,this,function(t){t.create=function(n,i,o){return new ch(n,i,o)},t.fire=function(n){n&&(n[AT](),e&&qt(e[Wp])&&e[Wp](n))},t[Xa]=function(n,i){if(n){var o=t[Fy]=t[Fy]||{};o[n]=i}},t[Ym]=function(n){return(t[Fy]||{})[n]}})}return r.__ieDyn=1,r}(),sF="CoreUtils.doPerf"});function Z8(r){r<0&&(r>>>=0),xC=123456789+r&qp,PC=987654321-r&qp,X8=!0}function e6(){try{var r=$n()&2147483647;Z8((Math.random()*Q8^r)+r)}catch(e){}}function Uy(r){return r>0?Math.floor(nl()/qp*(r+1))>>>0:0}function nl(r){var e=0,t=IC()||SC();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&qp),e===0&&el()&&(X8||e6(),e=DC()&qp),e===0&&(e=Math.floor(Q8*Math.random()|0)),r||(e>>>=0),e}function XT(r){r?Z8(r):e6()}function DC(r){PC=36969*(PC&65535)+(PC>>16)&qp,xC=18e3*(xC&65535)+(xC>>16)&qp;var e=(PC<<16)+(xC&65535)>>>0&qp|0;return r||(e>>>=0),e}function Jp(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=nl()>>>0,n=0,i=ft;i[tt]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(nl()<<2&4294967295|t&3)>>>0,n=0);return i}var Q8,qp,X8,xC,PC,ZT=ge(()=>{p();Cn();la();xn();mi();Q8=4294967296,qp=4294967295,X8=!1,xC=123456789,PC=987654321});function Ope(r,e,t){if(t6)try{return t6(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function n6(r){return r[NT]===1||r[NT]===9||!+r[NT]}function Lpe(r,e){var t=e[r.id];if(!t){t={};try{n6(e)&&(Ope(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function il(r,e){return e===void 0&&(e=!1),Qm(r+Mpe+++(e?"."+r6:ft)+Ape)}function ek(r){var e={id:il("_aiData-"+(r||ft)+"."+r6),accept:function(t){return n6(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[Qm(n)]:(o&&(s=Lpe(e,t),s[Qm(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var t6,r6,Ape,Mpe,TC=ge(()=>{p();ir();Cn();xn();mi();ZT();t6=Io,r6="2.8.10",Ape="."+Jp(6),Mpe=0});function Kpe(r,e){var t=Qu[Gp]||nk[Gp];return t||(t=Qu[Gp]=Qu(r,e),nk[Gp]=t),t}function rk(r){return r?r.isEnabled():!0}function Fpe(r){var e=r[kT]=r[kT]||{};if($o(e,"domain",r.cookieDomain,NK,Ct),$o(e,"path",r.cookiePath||"/",null,Ct),Ct(e[dF])){var t=void 0;ur(r[s6])||(t=!r[s6]),ur(r[a6])||(t=!r[a6]),e[dF]=t}return e}function f6(r,e){return e&&r&&It(r.ignoreCookies)?r.ignoreCookies[Op](e)!==-1:!1}function Upe(r,e){return e&&r&&It(r.blockedCookies)&&r.blockedCookies[Op](e)!==-1?!0:f6(r,e)}function Yp(r,e){var t;if(r)t=r.getCookieMgr();else if(e){var n=e[kT];n[Gp]?t=n[Gp]:t=Qu(e)}return t||(t=Kpe(e,(r||{})[Ho])),t}function Qu(r,e){var t,n=Fpe(r||nk),i=n.path||"/",o=n.domain,s=n[dF]!==!1,a=(t={isEnabled:function(){var l=s&&ol(e),u=nk[Gp];return l&&u&&a!==u&&(l=rk(u)),l}},t[cC]=function(l){s=l!==!1},t.set=function(l,u,c,d,f){var m=!1;if(rk(a)&&!Upe(n,l)){var g={},b=jr(u||ft),v=b[Op](";");if(v!==-1&&(b=jr(u[za](0,v)),g=m6(u[za](v+1))),$o(g,"domain",d||o,ky,ur),!Ct(c)){var k=el();if(ur(g[cF])){var R=$n(),P=R+c*1e3;if(P>0){var D=new Date;D.setTime(P),$o(g,cF,u6(D,k?i6:o6)||u6(D,k?i6:o6)||ft,ky)}}k||$o(g,"max-age",ft+c,null,ur)}var K=oh();K&&K.protocol==="https:"&&($o(g,"secure",null,null,ur),uF===null&&(uF=!Wy((Ds()||{})[Sy])),uF&&$o(g,"SameSite","None",null,ur)),$o(g,"path",f||i,null,ur);var L=n.setCookie||p6;L(l,d6(b,g)),m=!0}return m},t.get=function(l){var u=ft;return rk(a)&&!f6(n,l)&&(u=(n.getCookie||Wpe)(l)),u},t.del=function(l,u){var c=!1;return rk(a)&&(c=a.purge(l,u)),c},t.purge=function(l,u){var c,d=!1;if(ol(e)){var f=(c={},c.path=u||"/",c[cF]="Thu, 01 Jan 1970 00:00:01 GMT",c);el()||(f["max-age"]="0");var m=n.delCookie||p6;m(l,d6(ft,f)),d=!0}return d},t);return a[Gp]=a,a}function ol(r){if(tk===null){tk=!1;try{var e=kC||{};tk=e[pF]!==void 0}catch(t){Yr(r,2,68,"Cannot access document.cookie - "+rh(t),{exception:Zr(t)})}}return tk}function m6(r){var e={};if(r&&r[tt]){var t=jr(r)[Lp](";");We(t,function(n){if(n=jr(n||ft),n){var i=n[Op]("=");i===-1?e[n]=null:e[jr(n[za](0,i))]=jr(n[za](i+1))}})}return e}function u6(r,e){return qt(r[e])?r[e]():null}function d6(r,e){var t=r||ft;return Vr(e,function(n,i){t+="; "+n+(Ct(i)?ft:"="+i)}),t}function Wpe(r){var e=ft;if(kC){var t=kC[pF]||ft;l6!==t&&(c6=m6(t),l6=t),e=jr(c6[r]||ft)}return e}function p6(r,e){kC&&(kC[pF]=r+"="+e)}function Wy(r){return un(r)?!!(wn(r,"CPU iPhone OS 12")||wn(r,"iPad; CPU OS 12")||wn(r,"Macintosh; Intel Mac OS X 10_14")&&wn(r,"Version/")&&wn(r,"Safari")||wn(r,"Macintosh; Intel Mac OS X 10_14")&&Xm(r,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||wn(r,"Chrome/5")||wn(r,"Chrome/6")||wn(r,"UnrealEngine")&&!wn(r,"Chrome")||wn(r,"UCBrowser/12")||wn(r,"UCBrowser/11")):!1}var i6,o6,pF,cF,dF,s6,a6,Gp,tk,uF,l6,kC,c6,nk,fF=ge(()=>{p();Cn();Hp();la();xn();mi();i6="toGMTString",o6="toUTCString",pF="cookie",cF="expires",dF="enabled",s6="isCookieUseDisabled",a6="disableCookiesUsage",Gp="_ckMgr",tk=null,uF=null,l6=null,kC=zo(),c6={},nk={}});function b6(r){return r&&r[Qa]?r[Qa](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,ft):r}function sk(r,e){var t;if(e){var n=ft;It(e)?(n=ft,We(e,function(o){o=b6(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=b6(e),n&&(n[0]!=="."&&(n="."+n),r=(r||ft)+n)}var i=Hpe.exec(r||ft)||[];return t={},t[qo]=i[1],t.ns=(i[2]||ft).replace(Vpe,".").replace(jpe,ft)[Lp](".").sort().join("."),t}function mF(r,e,t){var n=[],i=RC.get(r,ik,{},!1),o=sk(e,t);return Vr(i,function(s,a){We(a,function(l){var u;(!o[qo]||o[qo]===l.evtName[qo])&&(!o.ns||o.ns===o.ns)&&n[Ot]((u={},u[xi]=l.evtName[qo]+(l.evtName.ns?"."+l.evtName.ns:ft),u.handler=l[uC],u))})}),n}function P6(r,e,t){t===void 0&&(t=!0);var n=RC.get(r,ik,{},t),i=n[e];return i||(i=n[e]=[]),i}function D6(r,e,t,n){r&&e&&e[qo]&&(r[y6]?r[y6](e[qo],t,n):r[v6]&&r[v6](S6+e[qo],t))}function qpe(r,e,t,n){var i=!1;return r&&e&&e[qo]&&t&&(r[g6]?(r[g6](e[qo],t,n),i=!0):r[h6]&&(r[h6](S6+e[qo],t),i=!0)),i}function I6(r,e,t,n){for(var i=e[tt];i--;){var o=e[i];o&&(!t.ns||t.ns===o.evtName.ns)&&(!n||n(o))&&(D6(r,o.evtName,o[uC],o.capture),e[Bu](i,1))}}function Jpe(r,e,t){if(e[qo])I6(r,P6(r,e[qo]),e,t);else{var n=RC.get(r,ik,{});Vr(n,function(i,o){I6(r,o,e,t)}),Eo(n)[tt]===0&&RC.kill(r,ik)}}function Xu(r,e){var t;return e?(It(e)?t=[r].concat(e):t=[r,e],t=sk("xx",t).ns[Lp](".")):t=r,t}function uh(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=sk(e,n);if(s=qpe(r,a,t,i),s&&RC.accept(r)){var l=(o={guid:Bpe++,evtName:a},o[uC]=t,o.capture=i,o);P6(r,a.type)[Ot](l)}}catch(u){}return s}function dh(r,e,t,n,i){if(i===void 0&&(i=!1),r)try{var o=sk(e,n),s=!1;Jpe(r,o,function(a){return o.ns&&!t||a[uC]===t?(s=!0,!0):!1}),s||D6(r,o,t,i)}catch(a){}}function jy(r,e,t,n){return n===void 0&&(n=!1),uh(r,e,t,null,n)}function By(r,e,t,n){n===void 0&&(n=!1),dh(r,e,t,null,n)}function zp(r,e,t){var n=!1,i=xc();i&&(n=uh(i,r,e,t),n=uh(i.body,r,e,t)||n);var o=zo();return o&&(n=uh(o,r,e,t)||n),n}function ak(r,e,t){var n=xc();n&&(dh(n,r,e,t),dh(n.body,r,e,t));var i=zo();i&&dh(i,r,e,t)}function Vy(r,e,t,n){var i=!1;return e&&r&&r[tt]>0&&We(r,function(o){o&&(!t||Yn(t,o)===-1)&&(i=zp(o,e,n)||i)}),i}function lk(r,e,t,n){var i=!1;return e&&r&&It(r)&&(i=Vy(r,e,t,n),!i&&t&&t[tt]>0&&(i=Vy(r,e,null,n))),i}function $p(r,e,t){r&&It(r)&&We(r,function(n){n&&ak(n,e,t)})}function ph(r,e,t){return lk([C6,E6,ok],r,e,t)}function AC(r,e){$p([C6,E6,ok],r,e)}function Hy(r,e,t){function n(s){var a=zo();r&&a&&a.visibilityState==="hidden"&&r(s)}var i=Xu(w6,t),o=Vy([ok],r,e,i);return(!e||Yn(e,NC)===-1)&&(o=Vy([NC],n,e,i)||o),!o&&e&&(o=Hy(r,null,t)),o}function MC(r,e){var t=Xu(w6,e);$p([ok],r,t),$p([NC],null,t)}function qy(r,e,t){function n(s){var a=zo();r&&a&&a.visibilityState==="visible"&&r(s)}var i=Xu(x6,t),o=Vy([_6],r,e,i);return o=Vy([NC],n,e,i)||o,!o&&e&&(o=qy(r,null,t)),o}function OC(r,e){var t=Xu(x6,e);$p([_6],r,t),$p([NC],null,t)}var S6,h6,g6,v6,y6,ik,NC,ok,_6,E6,C6,w6,x6,Vpe,jpe,Bpe,RC,Hpe,hF=ge(()=>{p();Cn();TC();la();xn();mi();S6="on",h6="attachEvent",g6="addEventListener",v6="detachEvent",y6="removeEventListener",ik="events",NC="visibilitychange",ok="pagehide",_6="pageshow",E6="unload",C6="beforeunload",w6=il("aiEvtPageHide"),x6=il("aiEvtPageShow"),Vpe=/\.[\.]+/g,jpe=/[\.]+$/,Bpe=1,RC=ek("events"),Hpe=/^([^.]*)(?:\.(.+)|)/});function Jy(){var r=Zu();return r[za](0,8)+"-"+r[za](8,12)+"-"+r[za](12,16)+"-"+r[za](16,20)+"-"+r[za](20)}function Gy(){var r=My();return r&&r.now?r.now():$n()}function Zu(){for(var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=ft,t,n=0;n<4;n++)t=nl(),e+=r[t&15]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var i=r[8+(nl()&3)|0];return e[Kp](0,8)+e[Kp](9,4)+"4"+e[Kp](13,3)+i+e[Kp](16,3)+e[Kp](19,12)}var gF,vF=ge(()=>{"use strict";p();Cn();la();hF();xn();mi();ZT();gF={Attach:jy,AttachEvent:jy,Detach:By,DetachEvent:By}});function ed(r,e,t){return r&&r[tt]===e&&r!==t?!!r.match(/^[\da-f]*$/):!1}function k6(r,e,t){return ed(r,e)?r:t}function N6(r){(isNaN(r)||r<0||r>255)&&(r=1);for(var e=r.toString(16);e[tt]<2;)e="0"+e;return e}function IF(r,e,t,n){var i;return i={},i[pC]=ed(n,2,bF)?n:yF,i[$m]=Yy(r)?r:Zu(),i.spanId=$y(e)?e:Zu()[Kp](0,16),i.traceFlags=t>=0&&t<=255?t:1,i}function LC(r){var e;if(!r||(It(r)&&(r=r[0]||""),!r||!un(r)||r[tt]>8192))return null;var t=Gpe.exec(jr(r));return!t||t[1]===bF||t[2]===ck||t[3]===uk?null:(e={},e[pC]=t[1],e[$m]=t[2],e[Ey]=t[3],e[Fp]=parseInt(t[4],16),e)}function Yy(r){return ed(r,32,ck)}function $y(r){return ed(r,16,uk)}function dk(r){return!(!r||!ed(r[pC],2,bF)||!ed(r[$m],32,ck)||!ed(r[Ey],16,uk)||!ed(N6(r[Fp]),2))}function SF(r){return dk(r)?(r[Fp]&T6)===T6:!1}function _F(r){if(r){var e=N6(r[Fp]);ed(e,2)||(e="01");var t=r[pC]||yF;return t!=="00"&&t!=="ff"&&(t=yF),"".concat(t,"-").concat(k6(r.traceId,32,ck),"-").concat(k6(r.spanId,16,uk),"-").concat(e)}return""}function EF(){var r="traceparent",e=LC(ZK(r));return e||(e=LC(eF(r))),e}var Gpe,yF,bF,ck,uk,T6,CF=ge(()=>{p();Cn();vF();la();xn();Gpe=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-[^\s]*)?$/,yF="00",bF="ff",ck="00000000000000000000000000000000",uk="0000000000000000",T6=1});function td(r){return Ype.get(r,"state",{},!0)}function pk(r,e){for(var t=[],n=null,i=r[xs](),o;i;){var s=i[qm]();if(s){n&&qt(n[Mp])&&qt(s[Jo])&&n[Mp](s);var a=!1;qt(s[Cs])?a=s[Cs]():(o=td(s),a=o[Cs]),a||t[Ot](s),n=s,i=i[xs]()}}We(t,function(l){var u=r[cn]();l[Ga](r.getCfg(),u,e,r[xs]()),o=td(l),!l[cn]&&!o[cn]&&(o[cn]=u),o[Cs]=!0,delete o[ws]})}function fk(r){return r.sort(function(e,t){var n=0;if(t){var i=qt(t[Jo]);qt(e[Jo])?n=i?e[oa]-t[oa]:1:i&&(n=-1)}else n=e?1:-1;return n})}function R6(r){var e={};return{getName:function(){return e[xi]},setName:function(t){r&&r.setName(t),e[xi]=t},getTraceId:function(){return e[$m]},setTraceId:function(t){r&&r.setTraceId(t),Yy(t)&&(e[$m]=t)},getSpanId:function(){return e[Ey]},setSpanId:function(t){r&&r.setSpanId(t),$y(t)&&(e[Ey]=t)},getTraceFlags:function(){return e[Fp]},setTraceFlags:function(t){r&&r.setTraceFlags(t),e[Fp]=t}}}var Ype,mk=ge(()=>{"use strict";p();Cn();TC();xn();mi();CF();Ype=ek("plugin")});function zpe(r,e,t){for(;r;){if(r[qm]()===t)return r;r=r[xs]()}return Pc([t],e[wc]||{},e)}function wF(r,e,t,n){var i=null,o=[];n!==null&&(i=n?zpe(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return _C(t,e)},getCfg:function(){return e},getExtCfg:u,getConfig:c,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:d,onComplete:a}};function a(f,m){for(var g=[],b=2;b<arguments.length;b++)g[b-2]=arguments[b];f&&o[Ot]({func:f,self:ur(m)?s.ctx:m,args:g})}function l(){var f=i;if(i=f?f[xs]():null,!f){var m=o;m&&m[tt]>0&&(We(m,function(g){try{g.func[Mn](g.self,g.args)}catch(b){Yr(t[Ho],2,73,"Unexpected Exception during onComplete - "+Zr(b))}}),o=[])}return f}function u(f,m,g){m===void 0&&(m={}),g===void 0&&(g=0);var b;if(e){var v=e[Cy];v&&f&&(b=v[f])}if(!b)b=m;else if(Pi(m)&&g!==0){var k=Ny(!0,m,b);e&&g===2&&Vr(m,function(R){if(Ct(k[R])){var P=e[R];Ct(P)||(k[R]=P)}}),b=k}return b}function c(f,m,g){g===void 0&&(g=!1);var b,v=u(f,null);return v&&!Ct(v[m])?b=v[m]:e&&!Ct(e[m])&&(b=e[m]),Ct(b)?g:b}function d(f){for(var m;m=s._next();){var g=m[qm]();g&&f(g)}}return s}function Qo(r,e,t,n){var i=wF(r,e,t,n),o=i.ctx;function s(l){var u=i._next();return u&&u[Jo](l,o),!u}function a(l,u){return l===void 0&&(l=null),It(l)&&(l=Pc(l,e,t,u)),Qo(l||o[xs](),e,t,u)}return o[Wr]=s,o[Hu]=a,o}function zy(r,e,t){var n=e[wc]||{},i=wF(r,n,e,t),o=i.ctx;function s(l){var u=i._next();return u&&u.unload(o,l),!u}function a(l,u){return l===void 0&&(l=null),It(l)&&(l=Pc(l,n,e,u)),zy(l||o[xs](),e,u)}return o[Wr]=s,o[Hu]=a,o}function KC(r,e,t){var n=e[wc]||{},i=wF(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(u){qt(u[Jm])&&u[Jm](o,l)})}function a(l,u){return l===void 0&&(l=null),It(l)&&(l=Pc(l,n,e,u)),KC(l||o[xs](),e,u)}return o[Wr]=s,o[Hu]=a,o}function Pc(r,e,t,n){var i=null,o=!n;if(It(r)&&r[tt]>0){var s=null;We(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&qt(a[Jo])){var l=Qpe(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Pc([n],e,t):i}function Qpe(r,e,t){var n=null,i=qt(r[Jo]),o=qt(r[Mp]),s;r?s=r[Ya]+"-"+r[oa]+"-"+O6++:s="Unknown-0-"+O6++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:c,unload:d,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&qt(r[M6])&&(m=r[M6]()),m||(m=Qo(a,e,t)),m}function u(m,g,b,v,k){var R=!1,P=r?r[Ya]:$pe,D=m[A6];return D||(D=m[A6]={}),m.setNext(n),r&&Sn(m[cn](),function(){return P+":"+b},function(){D[s]=!0;try{var K=n?n._id:ft;K&&(D[K]=!1),R=g(m)}catch(B){var L=n?D[n._id]:!0;L&&(R=!0),(!n||!L)&&Yr(m[ia](),1,73,"Plugin ["+P+"] failed during "+b+" - "+Zr(B)+", run flags: "+Zr(D))}},v,k),R}function c(m,g){g=g||l();function b(v){if(!r||!i)return!1;var k=td(r);return k[ws]||k[fC]?!1:(o&&r[Mp](n),r[Jo](m,v),!0)}u(g,b,"processTelemetry",function(){return{item:m}},!m.sync)||g[Wr](m)}function d(m,g){function b(){var v=!1;if(r){var k=td(r),R=r[cn]||k[cn];r&&(!R||R===m.core())&&!k[ws]&&(k[cn]=null,k[ws]=!0,k[Cs]=!1,r[ws]&&r[ws](m,g)===!0&&(v=!0))}return v}u(m,b,"unload",function(){},g[$a])||m[Wr](g)}function f(m,g){function b(){var v=!1;if(r){var k=td(r),R=r[cn]||k[cn];r&&(!R||R===m.core())&&!k[ws]&&r[Jm]&&r[Jm](m,g)===!0&&(v=!0)}return v}u(m,b,"update",function(){},!1)||m[Wr](g)}return Yo(a)}var $pe,A6,M6,O6,xF,FC=ge(()=>{"use strict";p();Cn();Hp();la();xn();mi();wC();mk();$pe="TelemetryPluginChain",A6="_hasRun",M6="_getTelCtx",O6=0;xF=function(){function r(e,t,n,i){var o=this,s=Qo(e,t,n,i);nh(o,s,Eo(s))}return r}()});function L6(r,e,t){e&&It(e)&&e[tt]>0&&(e=e.sort(function(n,i){return n[oa]-i[oa]}),We(e,function(n){n[oa]<UC&&zn(Xpe+n[Ya])}),r[Ot]({queue:Yo(e),chain:Pc(e,t[wc],t)}))}function K6(r,e){function t(){return Qo(null,e[wc],e,null)}function n(u,c,d,f){var m=u?u[tt]+1:1;function g(){m--,m===0&&(f&&f(),f=null)}m>0&&We(u,function(b){if(b&&b.queue[tt]>0){var v=b.chain,k=c[Hu](v);k[aC](g),d(k)}else m--}),g()}function i(u,c){var d=c||{reason:0};return n(r,u,function(f){f[Wr](d)},function(){u[Wr](d)}),!0}function o(u,c){var d=c||{reason:0,isAsync:!1};return n(r,u,function(f){f[Wr](d)},function(){u[Wr](d),a=!1}),!0}function s(u){var c=null;return r&&r[tt]>0&&We(r,function(d){if(d&&d.queue[tt]>0&&(We(d.queue,function(f){if(f[Ya]===u)return c=f,-1}),c))return-1}),c}var a=!1,l={identifier:"ChannelControllerPlugin",priority:UC,initialize:function(u,c,d,f){a=!0,We(r,function(m){m&&m.queue[tt]>0&&pk(Qo(m.chain,u,c),d)})},isInitialized:function(){return a},processTelemetry:function(u,c){n(r,c||t(),function(d){d[Wr](u)},function(){c[Wr](u)})},update:i,pause:function(){n(r,t(),function(u){u.iterate(function(c){c.pause&&c.pause()})},null)},resume:function(){n(r,t(),function(u){u.iterate(function(c){c.resume&&c.resume()})},null)},teardown:o,getChannel:s,flush:function(u,c,d,f){var m=1,g=!1,b=null;f=f||5e3;function v(){m--,g&&m===0&&(b&&(clearTimeout(b),b=null),c&&c(g),c=null)}return n(r,t(),function(k){k.iterate(function(R){if(R[yy]){m++;var P=!1;R[yy](u,function(){P=!0,v()},d)||P||(u&&b==null?b=setTimeout(function(){b=null,v()},f):v())}})},function(){g=!0,v()}),!0},_setQueue:function(u){r=u}};return l}function F6(r,e,t){var n=[];if(r&&We(r,function(o){return L6(n,o,t)}),e){var i=[];We(e,function(o){o[oa]>UC&&i[Ot](o)}),L6(n,i,t)}return n}var UC,Xpe,U6=ge(()=>{p();Cn();xn();mi();FC();mk();UC=500,Xpe="Channel has invalid priority - "});function fh(){var r=[];function e(n){n&&r[Ot](n)}function t(n,i){We(r,function(o){try{o(n,i)}catch(s){Yr(n[ia](),2,73,"Unexpected error calling unload handler - "+Zr(s))}}),r=[]}return{add:e,run:t}}var hk=ge(()=>{p();Cn();Hp();la();xn()});var Qp,mh,PF=ge(()=>{"use strict";p();dr();Cn();xn();mi();FC();hk();Qp="getPlugin",mh=function(){function r(){var e=this,t,n,i,o,s;u(),He(r,e,function(c){c[Ga]=function(d,f,m,g){l(d,f,g),t=!0},c[ws]=function(d,f){var m,g=c[cn];if(!g||d&&g!==d[cn]())return;var b,v=!1,k=d||zy(null,g,i&&i[Qp]?i[Qp]():i),R=f||(m={reason:0},m[$a]=!1,m);function P(){if(!v){v=!0,o.run(k,f);var D=s;s=[],We(D,function(K){K.rm()}),b===!0&&k[Wr](R),u()}}return!c[Iy]||c[Iy](k,R,P)!==!0?P():b=!0,b},c[Jm]=function(d,f){var m=c[cn];if(!m||d&&m!==d[cn]())return;var g,b=!1,v=d||KC(null,m,i&&i[Qp]?i[Qp]():i),k=f||{reason:0};function R(){b||(b=!0,l(v.getCfg(),v.core(),v[xs]()))}return!c._doUpdate||c._doUpdate(v,k,R)!==!0?R():g=!0,g},c._addHook=function(d){d&&(It(d)?s=s.concat(d):s[Ot](d))},jp(c,"_addUnloadCb",function(){return o},"add")}),e[ia]=function(c){return a(c)[ia]()},e[Cs]=function(){return t},e.setInitialized=function(c){t=c},e[Mp]=function(c){i=c},e[Wr]=function(c,d){d?d[Wr](c):i&&qt(i[Jo])&&i[Jo](c,null)},e._getTelCtx=a;function a(c){c===void 0&&(c=null);var d=c;if(!d){var f=n||Qo(null,{},e[cn]);i&&i[Qp]?d=f[Hu](null,i[Qp]):d=f[Hu](null,i)}return d}function l(c,d,f){c&&$o(c,Cy,[],null,Ct),!f&&d&&(f=d[TT]()[xs]());var m=i;i&&i[Qp]&&(m=i[Qp]()),e[cn]=d,n=Qo(f,c,d,m)}function u(){t=!1,e[cn]=null,n=null,i=null,s=[],o=fh()}}return r.__ieDyn=1,r}()});var W6,V6=ge(()=>{p();ir();dr();Cn();PF();Hp();la();xn();mi();W6=function(r){In(e,r);function e(){var t=r.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var n,i;o(),He(e,t,function(s,a){s.addTelemetryInitializer=function(l){var u={id:n++,fn:l};i[Ot](u);var c={remove:function(){We(i,function(d,f){if(d.id===u.id)return i[Bu](f,1),-1})}};return c},s[Jo]=function(l,u){for(var c=!1,d=i[tt],f=0;f<d;++f){var m=i[f];if(m)try{if(m.fn[_y](null,[l])===!1){c=!0;break}}catch(g){Yr(u[ia](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+rh(g),{exception:Zr(g)},!0)}}c||s[Wr](l,u)},s[Iy]=function(){o()}});function o(){n=0,i=[]}return t}return e.__ieDyn=1,e}(mh)});function tfe(r,e){return new CC(e)}function rfe(r,e,t){var n,i=[],o={};return We(t,function(s){(Ct(s)||Ct(s[Ga]))&&zn(q6);var a=s[oa],l=s[Ya];s&&a&&(Ct(o[a])?o[a]=l:rl(r,"Two extensions have same priority #"+a+" - "+o[a]+", "+l)),(!a||a<e)&&i[Ot](s)}),n={all:t},n[cn]=i,n}function H6(r,e){var t=!1;return We(e,function(n){if(n===r)return t=!0,-1}),t}function nfe(){var r;return So((r={},r[Bm]=function(e){},r[Hm]=function(e){},r[wy]=function(e){},r[Up]=function(e,t){},r[xy]=function(e,t){},r))}var q6,j6,B6,Zpe,efe,hh,DF=ge(()=>{"use strict";p();ir();dr();ir();Cn();U6();fF();TC();nF();Hp();xn();mi();wC();FC();mk();V6();hk();q6="Plugins must provide initialize method",j6="_notificationManager",B6="SDK is still unloading...",Zpe="SDK is not initialized",efe={loggingLevelConsole:1};hh=function(){function r(){var e,t,n,i,o,s,a,l,u,c,d,f,m,g,b,v,k,R,P,D,K=0;He(r,this,function(L){B(),L[Cs]=function(){return t},L[Ga]=function(q,$,ue,pe){g&&zn(B6),L[Cs]()&&zn("Core should not be initialized more than once"),e=q||{},L[wc]=e,Ct(q[DT])&&zn("Please provide instrumentation key"),i=pe,L[j6]=pe,Y(),Z(),ie(),ue&&(L[Ho]=ue);var ye=Vp(e,b8,[]);u=[],u[Ot].apply(u,Vm(Vm([],$,!1),ye,!1)),f=Vp(e,CK,[]),O(null),(!m||m[tt]===0)&&zn("No "+CK+" available"),t=!0,L.releaseQueue()},L.getTransmissionControls=function(){var q=[];return m&&We(m,function($){q[Ot]($.queue)}),Yo(q)},L.track=function(q){q.iKey=q.iKey||e[DT],q[jm]=q[jm]||sa(new Date),q.ver=q.ver||"4.0",!g&&L[Cs]()?N()[Wr](q):n[Ot](q)},L[TT]=N,L[sC]=function(){return i||(i=nfe(),L[j6]=i),i},L[Bm]=function(q){i&&i[Bm](q)},L[Hm]=function(q){i&&i[Hm](q)},L.getCookieMgr=function(){return a||(a=Qu(e,L[Ho])),a},L.setCookieMgr=function(q){a=q},L[zm]=function(){if(!o&&!s&&aa(e.enablePerfMgr)){var q=aa(e[wK]);qt(q)&&(s=q(L,L[sC]()))}return o||s||lF()},L.setPerfMgr=function(q){o=q},L.eventCnt=function(){return n[tt]},L.releaseQueue=function(){if(t&&n[tt]>0){var q=n;n=[],We(q,function($){N()[Wr]($)})}},L.pollInternalLogs=function(q){v=q||null;var $=aa(e.diagnosticLogInterval);return(!$||!($>0))&&($=1e4),K&&clearInterval(K),K=setInterval(function(){T()},$),K},L[SK]=function(){K&&(clearInterval(K),K=0,T())},nh(L,function(){return b},["addTelemetryInitializer"]),L.unload=function(q,$,ue){var pe;q===void 0&&(q=!0),t||zn(Zpe),g&&zn(B6);var ye=(pe={reason:50},pe[$a]=q,pe.flushComplete=!1,pe),z=zy(y(),L);z[aC](function(){B(),$&&$(ye)},L);function fe(Se){ye.flushComplete=Se,g=!0,R.run(z,ye),L[SK](),z[Wr](ye)}H(q,fe,6,ue)||fe(!1)},L[qm]=h,L.addPlugin=function(q,$,ue,pe){if(!q){pe&&pe(!1),be(q6);return}var ye=h(q[Ya]);if(ye&&!$){pe&&pe(!1),be("Plugin ["+q[Ya]+"] is already loaded!");return}var z={reason:16};function fe(Le){u[Ot](q),z.added=[q],O(z),pe&&pe(!0)}if(ye){var Se=[ye.plugin],Te={reason:2,isAsync:!!ue};w(Se,Te,function(Le){Le?(z.removed=Se,z.reason|=32,fe(!0)):pe&&pe(!1)})}else fe(!1)},L.evtNamespace=function(){return k},L[yy]=H,L.getTraceCtx=function(q){return D||(D=R6()),D},L.setTraceCtx=function(q){D=q||null},jp(L,"addUnloadCb",function(){return R},"add");function B(){t=!1,e=Ny(!0,{},efe),L[wc]=e,L[Ho]=new tl(e),L[lC]=[],b=new W6,n=[],i=null,o=null,s=null,a=null,l=null,c=null,u=[],d=null,f=null,m=null,g=!1,v=null,k=il("AIBaseCore",!0),R=fh(),D=null}function N(){return Qo(y(),e,L)}function O(q){var $=rfe(L[Ho],UC,u);c=$[cn],l=null;var ue=$.all;if(m=Yo(F6(f,ue,L)),d){var pe=Yn(ue,d);pe!==-1&&ue[Bu](pe,1),pe=Yn(c,d),pe!==-1&&c[Bu](pe,1),d._setQueue(m)}else d=K6(m,L);ue[Ot](d),c[Ot](d),L[lC]=fk(ue),d[Ga](e,L,ue),pk(N(),ue),L[lC]=Yo(fk(c||[])).slice(),q&&le(q)}function h(q){var $,ue=null,pe=null;return We(L[lC],function(ye){if(ye[Ya]===q&&ye!==d&&ye!==b)return pe=ye,-1}),!pe&&d&&(pe=d.getChannel(q)),pe&&(ue=($={plugin:pe},$[cC]=function(ye){td(pe)[fC]=!ye},$.isEnabled=function(){var ye=td(pe);return!ye[ws]&&!ye[fC]},$.remove=function(ye,z){var fe;ye===void 0&&(ye=!0);var Se=[pe],Te=(fe={reason:1},fe[$a]=ye,fe);w(Se,Te,function(Le){Le&&O({reason:32,removed:Se}),z&&z(Le)})},$)),ue}function y(){if(!l){var q=(c||[]).slice();Yn(q,b)===-1&&q[Ot](b),l=Pc(fk(q),e,L)}return l}function w(q,$,ue){if(q&&q[tt]>0){var pe=Pc(q,e,L),ye=zy(pe,L);ye[aC](function(){var z=!1,fe=[];We(u,function(Te,Le){H6(Te,q)?z=!0:fe[Ot](Te)}),u=fe;var Se=[];f&&(We(f,function(Te,Le){var Ye=[];We(Te,function(Je){H6(Je,q)?z=!0:Ye[Ot](Je)}),Se[Ot](Ye)}),f=Se),ue&&ue(z)}),ye[Wr]($)}else ue(!1)}function T(){var q=L[Ho]?L[Ho].queue:[];q&&(We(q,function($){var ue,pe=(ue={},ue[xi]=v||"InternalMessageId: "+$[by],ue.iKey=aa(e[DT]),ue.time=sa(new Date),ue.baseType=lh.dataType,ue.baseData={message:$[Ap]},ue);L.track(pe)}),q[tt]=0)}function H(q,$,ue,pe){return d?d[yy](q,$,ue||6,pe):($&&$(!1),!0)}function Y(){var q=aa(e.disableDbgExt);q===!0&&P&&(i[Hm](P),P=null),i&&!P&&q!==!0&&(P=Y8(e),i[Bm](P))}function Z(){var q=aa(e.enablePerfMgr);!q&&s&&(s=null),q&&Vp(e,wK,tfe)}function ie(){var q=Vp(e,Cy,{});q.NotificationManager=i}function le(q){var $=KC(y(),L);(!L._updateHook||L._updateHook($,q)!==!0)&&$[Wr](q)}function be(q){var $=L[Ho];$?Yr($,2,73,q):zn(q)}})}return r.__ieDyn=1,r}()});function gk(r,e,t,n){We(r,function(i){if(i&&i[e])if(t)setTimeout(function(){return n(i)},0);else try{n(i)}catch(o){}})}var WC,TF=ge(()=>{p();dr();Cn();xn();mi();WC=function(){function r(e){this.listeners=[];var t=!!(e||{}).perfEvtsSendAll;He(r,this,function(n){n[Bm]=function(i){n.listeners[Ot](i)},n[Hm]=function(i){for(var o=Yn(n[Gm],i);o>-1;)n.listeners[Bu](o,1),o=Yn(n[Gm],i)},n[wy]=function(i){gk(n[Gm],wy,!0,function(o){o[wy](i)})},n[Up]=function(i,o){gk(n[Gm],Up,!0,function(s){s[Up](i,o)})},n[xy]=function(i,o){gk(n[Gm],xy,o,function(s){s[xy](i,o)})},n[Wp]=function(i){i&&(t||!i[dC]())&&gk(n[Gm],Wp,!1,function(o){i[$a]?setTimeout(function(){return o[Wp](i)},0):o[Wp](i)})}})}return r.__ieDyn=1,r}()});var VC,J6=ge(()=>{p();ir();dr();Cn();DF();Hp();xn();mi();TF();wC();VC=function(r){In(e,r);function e(){var t=r.call(this)||this;return He(e,t,function(n,i){n[Ga]=function(a,l,u,c){i[Ga](a,l,u||new tl(a),c||new WC(a))},n.track=function(a){Sn(n[zm](),function(){return"AppInsightsCore:track"},function(){a===null&&(s(a),zn("Invalid telemetry item")),o(a),i.track(a)},function(){return{item:a}},!a.sync)};function o(a){Ct(a[xi])&&(s(a),zn("telemetry name required"))}function s(a){var l=n[sC]();l&&l[Up]([a],2)}}),t}return e.__ieDyn=1,e}(hh)});var Ae,Tr,gh,sl,G6,Y6,vk,kF,jC,yk,Qy,al,Xp,rd,BC,$6,NF,HC,z6=ge(()=>{p();KT();Tr="Failed",gh=Tr+"MonitorAjax",sl="Track",G6="Start",Y6="Stop",vk="Event",kF="AuthContext",jC="Exception",yk="Local",Qy="Session",al="Storage",Xp="Browser",rd="Cannot",BC="Buffer",$6="InstrumentationKey",NF=Co({CRITICAL:1,WARNING:2}),HC=Co((Ae={},Ae[Xp+"DoesNotSupport"+yk+al]=0,Ae[Xp+rd+"Read"+yk+al]=1,Ae[Xp+rd+"Read"+Qy+al]=2,Ae[Xp+rd+"Write"+yk+al]=3,Ae[Xp+rd+"Write"+Qy+al]=4,Ae[Xp+Tr+"RemovalFrom"+yk+al]=5,Ae[Xp+Tr+"RemovalFrom"+Qy+al]=6,Ae[rd+"SendEmptyTelemetry"]=7,Ae.ClientPerformanceMathError=8,Ae["ErrorParsingAI"+Qy+"Cookie"]=9,Ae.ErrorPVCalc=10,Ae[jC+"WhileLoggingError"]=11,Ae[Tr+"AddingTelemetryTo"+BC]=12,Ae[gh+"Abort"]=13,Ae[gh+"Dur"]=14,Ae[gh+"Open"]=15,Ae[gh+"RSC"]=16,Ae[gh+"Send"]=17,Ae[gh+"GetCorrelationHeader"]=18,Ae[Tr+"ToAddHandlerForOnBeforeUnload"]=19,Ae[Tr+"ToSendQueuedTelemetry"]=20,Ae[Tr+"ToReportDataLoss"]=21,Ae["Flush"+Tr]=22,Ae.MessageLimitPerPVExceeded=23,Ae.MissingRequiredFieldSpecification=24,Ae.NavigationTimingNotSupported=25,Ae.OnError=26,Ae[Qy+"RenewalDateIsZero"]=27,Ae.SenderNotInitialized=28,Ae[G6+sl+vk+Tr]=29,Ae[Y6+sl+vk+Tr]=30,Ae[G6+sl+Tr]=31,Ae[Y6+sl+Tr]=32,Ae.TelemetrySampledAndNotSent=33,Ae[sl+vk+Tr]=34,Ae[sl+jC+Tr]=35,Ae[sl+"Metric"+Tr]=36,Ae[sl+"PV"+Tr]=37,Ae[sl+"PV"+Tr+"Calc"]=38,Ae[sl+"Trace"+Tr]=39,Ae["Transmission"+Tr]=40,Ae[Tr+"ToSet"+al+BC]=41,Ae[Tr+"ToRestore"+al+BC]=42,Ae.InvalidBackendResponse=43,Ae[Tr+"ToFixDepricatedValues"]=44,Ae.InvalidDurationValue=45,Ae.TelemetryEnvelopeInvalid=46,Ae.CreateEnvelopeError=47,Ae[rd+"SerializeObject"]=48,Ae[rd+"SerializeObjectNonSerializable"]=49,Ae.CircularReferenceDetected=50,Ae["Clear"+kF+Tr]=51,Ae[jC+"Truncated"]=52,Ae.IllegalCharsInName=53,Ae.ItemNotInArray=54,Ae.MaxAjaxPerPVExceeded=55,Ae.MessageTruncated=56,Ae.NameTooLong=57,Ae.SampleRateOutOfRange=58,Ae["Set"+kF+Tr]=59,Ae["Set"+kF+Tr+"AccountName"]=60,Ae.StringValueTooLong=61,Ae.StartCalledMoreThanOnce=62,Ae.StopCalledWithoutStart=63,Ae["TelemetryInitializer"+Tr]=64,Ae.TrackArgumentsNotSpecified=65,Ae.UrlTooLong=66,Ae[Qy+al+BC+"Full"]=67,Ae[rd+"AccessCookie"]=68,Ae.IdTooLong=69,Ae.InvalidEvent=70,Ae[gh+"SetRequestHeader"]=71,Ae["Send"+Xp+"InfoOnUserInit"]=72,Ae["Plugin"+jC]=73,Ae["Notification"+jC]=74,Ae.SnippetScriptLoadFailure=99,Ae["Invalid"+$6]=100,Ae[rd+"ParseAiBlobValue"]=101,Ae.InvalidContentBlob=102,Ae[sl+"PageAction"+vk+Tr]=103,Ae[Tr+"AddingCustomDefinedRequestContext"]=104,Ae["InMemory"+al+BC+"Full"]=105,Ae[$6+"Deprecation"]=106,Ae))});var nd=ge(()=>{p();y8();M8();J6();DF();PF();ZT();vF();xn();KT();hF();la();ir();TF();wC();Hp();FC();z6();fF();TC();hk();CF()});var Q6,X6,Z6,e5,t5,r5,n5=ge(()=>{p();ir();nd();Q6=Co({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,CustomerContent_GenericContent:32}),X6=Co({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),Z6=Co({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9}),e5=Co({Normal:1,Critical:2}),t5=Co({NONE:0,ERROR:1,WARNING:2,INFORMATION:3}),r5=Yo(_o(_o({},HC),Co({AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520})))});var ll,bk,ife,PLe,RF,Ik,qC=ge(()=>{p();ll="",bk="https://browser.events.data.microsoft.com/OneCollector/1.0/",ife="pluginVersionString",PLe=ife+"Arr",RF="version",Ik="properties"});function On(r){return!(r===ll||Ct(r))}function GC(r){if(r){var e=r.indexOf("-");if(e>-1)return r.substring(0,e)}return ll}function OF(){return AF===null&&(AF=!ur(Uint8Array)&&!cfe()&&!zu()),AF}function YC(r){return!!(r&&Go(r)&&r>=1&&r<=4)}function $C(r,e,t){if(!e&&!On(e)||typeof r!="string")return null;var n=typeof e;if(n==="string"||n==="number"||n==="boolean"||It(e))e={value:e};else if(n==="object"&&!nr.call(e,"value"))e={value:t?JSON.stringify(e):e};else if(Ct(e.value)||e.value===ll||!un(e.value)&&!Go(e.value)&&!Ju(e.value)&&!It(e.value))return null;if(It(e.value)&&!_k(e.value))return null;if(!Ct(e.kind)){if(It(e.value)||!Xy(e.kind))return null;e.value=e.value.toString()}return e}function zC(r,e,t){var n=-1;if(!ur(r))if(e>0&&(e===32?n=8192:e<=13&&(n=e<<5)),lfe(t))n===-1&&(n=0),n|=t;else{var i=afe[cl(r)]||-1;n!==-1&&i!==-1?n|=i:i===6&&(n=i)}return n}function LF(){Yp(null).setEnabled(!1)}function KF(r,e,t){ol(null)&&Yp(null).set(r,e,t*86400,null,"/")}function FF(r){ol(null)&&Yp(null).del(r)}function UF(r){return ol(null)?WF(Yp(null),r):ll}function WF(r,e,t){t===void 0&&(t=!0);var n;return r&&(n=r.get(e),t&&n&&decodeURIComponent&&(n=decodeURIComponent(n))),n||ll}function VF(r){r===void 0&&(r="D");var e=Jy();return r==="B"?e="{"+e+"}":r==="P"?e="("+e+")":r==="N"&&(e=e.replace(/-/g,ll)),e}function Zp(r,e,t,n,i){var o={},s=!1,a=0,l=arguments.length,u=Object[Mt],c=arguments;for(u.toString.call(c[0])==="[object Boolean]"&&(s=c[0],a++);a<l;a++){var r=c[a];Vr(r,function(f,m){s&&m&&Pi(m)?It(m)?(o[f]=o[f]||[],We(m,function(g,b){g&&Pi(g)?o[f][b]=Zp(!0,o[f][b],g):o[f][b]=g})):o[f]=Zp(!0,o[f],m):o[f]=m})}return o}function Xy(r){return r===0||r>0&&r<=13||r===32}function lfe(r){return r>=0&&r<=9}function cfe(){var r=Ds();if(!ur(r)&&r.userAgent){var e=r.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}function _k(r){return r.length>0}function vh(r,e){var t=r;t.timings=t.timings||{},t.timings.processTelemetryStart=t.timings.processTelemetryStart||{},t.timings.processTelemetryStart[e]=wo()}function cl(r){var e=0;if(r!=null){var t=typeof r;t==="string"?e=1:t==="number"?e=2:t==="boolean"?e=3:t===pt&&(e=4,It(r)?(e=4096,r.length>0&&(e|=cl(r[0]))):nr.call(r,"value")&&(e=8192|cl(r.value)))}return e}function Ek(){return!!dn("chrome")}function Ck(r,e,t,n,i,o){n===void 0&&(n=!1),i===void 0&&(i=!1);function s(l,u,c){try{l[u]=c}catch(d){}}var a=new XMLHttpRequest;return n&&s(a,ofe,n),t&&s(a,i5,t),a.open(r,e,!i),t&&s(a,i5,t),!i&&o&&s(a,sfe,o),a}var id,Sk,od,ofe,i5,sfe,afe,AF,JC,MF,wo,o5,s5,QC=ge(()=>{p();nd();ir();qC();Sk="3.2.9",od="1DS-Web-JS-"+Sk,ofe="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",i5="withCredentials",sfe="timeout",afe=(id={},id[0]=0,id[2]=6,id[1]=1,id[3]=7,id[4098]=6,id[4097]=1,id[4099]=7,id),AF=null,JC=!!zo(),MF=!!xc();wo=Gy;o5={Version:Sk,FullVersionString:od,strUndefined:$t,strObject:pt,Undefined:$t,arrForEach:We,arrIndexOf:Yn,arrMap:eh,arrReduce:th,objKeys:Eo,toISOString:sa,isReactNative:zu,isString:un,isNumber:Go,isBoolean:Ju,isFunction:qt,isArray:It,isObject:Pi,strTrim:jr,isDocumentObjectAvailable:JC,isWindowObjectAvailable:MF,isValueAssigned:On,getTenantId:GC,isBeaconsSupported:Bp,isUint8ArrayAvailable:OF,isLatency:YC,sanitizeProperty:$C,getISOString:sa,useXDomainRequest:ah,getCommonSchemaMetaData:zC,cookieAvailable:ol,disallowsSameSiteNone:Wy,setCookie:KF,deleteCookie:FF,getCookie:UF,createGuid:VF,extend:Zp,getTime:wo,isValueKind:Xy,isArrayValid:_k,objDefineAccessors:Ps,addPageUnloadEventListener:ph,setProcessTelemetryTimings:vh,addEventHandler:zp,getFieldValueType:cl,strEndsWith:Xm,objForEachKey:Vr},s5={_canUseCookies:void 0,isTypeof:Py,isUndefined:ur,isNullOrUndefined:Ct,hasOwnProperty:qu,isFunction:qt,isObject:Pi,isDate:Ty,isArray:It,isError:Zm,isString:un,isNumber:Go,isBoolean:Ju,toISOString:sa,arrForEach:We,arrIndexOf:Yn,arrMap:eh,arrReduce:th,strTrim:jr,objCreate:So,objKeys:Eo,objDefineAccessors:Ps,addEventHandler:zp,dateNow:$n,isIE:el,disableCookies:LF,newGuid:Jy,perfNow:Gy,newId:Jp,randomValue:Uy,random32:nl,mwcRandomSeed:XT,mwcRandom32:DC,generateW3CId:Zu}});var ufe,a5,l5=ge(()=>{p();ir();dr();nd();qC();QC();ufe=function(r){In(e,r);function e(){var t=r.call(this)||this;return t.pluginVersionStringArr=[],He(e,t,function(n,i){(!n.logger||!n.logger.queue)&&(n.logger=new tl({loggingLevelConsole:1})),n.initialize=function(o,s,a,l){Sn(n,function(){return"AppInsightsCore.initialize"},function(){var u=n.pluginVersionStringArr;if(o){o.endpointUrl||(o.endpointUrl=bk);var c=o.propertyStorageOverride;c&&(!c.getProperty||!c.setProperty)&&zn("Invalid property storage override passed."),o.channels&&We(o.channels,function(m){m&&We(m,function(g){if(g.identifier&&g.version){var b=g.identifier+"="+g.version;u.push(b)}})})}n.getWParam=function(){return typeof document!="undefined"||o.enableWParam?0:-1},s&&We(s,function(m){if(m&&m.identifier&&m.version){var g=m.identifier+"="+m.version;u.push(g)}}),n.pluginVersionString=u.join(";"),n.pluginVersionStringArr=u;try{i.initialize(o,s,a,l),n.pollInternalLogs("InternalLog")}catch(m){var d=n.logger,f=Zr(m);f.indexOf("channels")!==-1&&(f+=`
 - Channels must be provided through config.channels only!`),Yr(d,1,514,"SDK Initialization Failed - no telemetry will be sent: "+f)}},function(){return{config:o,extensions:s,logger:a,notificationManager:l}})},n.track=function(o){Sn(n,function(){return"AppInsightsCore.track"},function(){var s=o;if(s){s.timings=s.timings||{},s.timings.trackStart=wo(),YC(s.latency)||(s.latency=1);var a=s.ext=s.ext||{};a.sdk=a.sdk||{},a.sdk.ver=od;var l=s.baseData=s.baseData||{};l[Ik]=l[Ik]||{};var u=l[Ik];u[RF]=u[RF]||n.pluginVersionString||ll}i.track(s)},function(){return{item:o}},!o.sync)}}),t}return e.__ieDyn=1,e}(VC),a5=ufe});var dfe,c5,u5=ge(()=>{p();ir();dr();nd();qC();QC();dfe=function(r){In(e,r);function e(){var t=r.call(this)||this;return He(e,t,function(n,i){n.initialize=function(o,s,a,l){o&&!o.endpointUrl&&(o.endpointUrl=bk),n.getWParam=function(){return JC||o.enableWParam?0:-1};try{i.initialize(o,s,a,l)}catch(u){Yr(n.logger,1,514,"Initialization Failed: "+Zr(u)+`
 - Note: Channels must be provided through config.channels only`)}},n.track=function(o){var s=o;if(s){var a=s.ext=s.ext||{};a.sdk=a.sdk||{},a.sdk.ver=od}i.track(s)}}),t}return e.__ieDyn=1,e}(hh),c5=dfe});function pfe(r,e,t){return function(n){r[e]=n,t()}}var yh,ffe,ef,jF=ge(()=>{p();dr();nd();yh=qt;ffe=function(){function r(e){var t=0,n=null,i=[];He(r,this,function(u){u.then=function(c,d){return new r(function(f,m){o(c,d,f,m)})},u.catch=function(c){return u.then(null,c)}});function o(u,c,d,f){i.push(function(){var m;try{t===1?m=yh(u)?u(n):n:m=yh(c)?c(n):n,m instanceof r?m.then(d,f):t===2&&!yh(c)?f(m):d(m)}catch(g){f(g);return}}),t!==0&&s()}function s(){if(i.length>0){var u=i.slice();i=[],setTimeout(function(){for(var c=0,d=u.length;c<d;++c)try{u[c]()}catch(f){}},0)}}function a(u){t===0&&(n=u,t=1,s())}function l(u){t===0&&(n=u,t=2,s())}(function(){if(!yh(e))throw new TypeError("ESPromise: resolvedFunc argument is not a Function");try{e(a,l)}catch(c){l(c)}})()}return r.resolve=function(e){return e instanceof r?e:e&&yh(e.then)?new r(function(t,n){try{e.then(t,n)}catch(i){n(i)}}):new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.all=function(e){if(!(!e||!e.length))return new r(function(t,n){try{for(var i=[],o=0,s=0;s<e.length;s++){var a=e[s];a&&yh(a.then)?(o++,a.then(pfe(i,s,function(){--o===0&&t(i)}),n)):i[s]=a}o===0&&setTimeout(function(){t(i)},0)}catch(l){n(l)}})},r.race=function(e){return new r(function(t,n){if(!(!e||!e.length))try{for(var i=function(s){var a=e[s];a&&yh(a.then)?a.then(t,n):setTimeout(function(){t(a)},0)},o=0;o<e.length;o++)i(o)}catch(s){n(s)}})},r}(),ef=ffe});function Zy(){return new Date().getTime()}var mfe,d5,XC,bh,BF,hfe,p5,f5=ge(()=>{p();dr();jF();nd();mfe=6e5,d5=0,XC=[],bh=[],BF=[];hfe=function(){function r(e,t){var n=0,i=(e||"<unnamed>")+"."+d5;d5++,He(r,this,function(a){var l=null,u=0;a.scheduleEvent=function(d,f,m){var g=i+"."+u;u++,f&&(g+="-("+f+")");var b=g+"{"+n+"}";n++;var v={evt:null,tm:Zy(),id:b,isRunning:!1,isAborted:!1};return l?v.evt=B(v,l):v.evt=L(v),l=v,l.evt._schId=b,v.evt;function k(N){for(var O=Zy(),h=O-mfe,y=N.length,w=0;w<y;){var T=N[w];if(T&&T.tm<h){var H=null;T.abort?(H="Aborting ["+T.id+"] due to Excessive runtime ("+(O-T.tm)+" ms)",T.abort(H)):H="Removing ["+T.id+"] due to Excessive runtime ("+(O-T.tm)+" ms)",s(H),N.splice(w,1),y--}else w++}}function R(N,O){var h=!1,y=c(XC,N);if(y||(y=c(BF,N),h=!0),y){y.to&&(clearTimeout(y.to),y.to=null);var w=Zy()-y.tm;O?h?s("Timed out event ["+N+"] finally complete -- "+w+" ms"):o("Promise ["+N+"] Complete -- "+w+" ms"):(BF.push(y),s("Event ["+N+"] Timed out and removed -- "+w+" ms"))}else o("Failed to remove ["+N+"] from running queue");l&&l.id===N&&(l=null),k(XC),k(bh),k(BF)}function P(N,O){return function(h){return R(N,!0),O&&O(h),h}}function D(N,O,h,y){O.then(function(w){return w instanceof ef?(o("Event ["+N+"] returned a promise -- waiting"),D(N,w,h,y),w):P(N,h)(w)},P(N,y))}function K(N,O){var h=N.id;return new ef(function(y,w){o("Event ["+h+"] Starting -- waited for "+(N.wTm||"--")+" ms"),N.isRunning=!0,N.abort=function(H){N.abort=null,N.isAborted=!0,R(h,!1),w(new Error(H))};var T=O(h);T instanceof ef?(m&&(N.to=setTimeout(function(){R(h,!1),w(new Error("Timed out after ["+m+"] ms"))},m)),D(h,T,function(H){o("Event ["+h+"] Resolving after "+(Zy()-N.tm)+" ms"),y(H)},w)):(o("Promise ["+h+"] Auto completed as the start action did not return a promise"),y())})}function L(N){var O=Zy();return N.wTm=O-N.tm,N.tm=O,N.isAborted?ef.reject(new Error("["+g+"] was aborted")):(XC.push(N),K(N,d))}function B(N,O){var h=new ef(function(y,w){var T=Zy()-O.tm,H=O.id;o("["+g+"] is waiting for ["+H+":"+T+" ms] to complete before starting -- ["+bh.length+"] waiting and ["+XC.length+"] running"),N.abort=function(Y){N.abort=null,c(bh,g),N.isAborted=!0,w(new Error(Y))},O.evt.then(function(Y){c(bh,g),L(N).then(y,w)},function(Y){c(bh,g),L(N).then(y,w)})});return bh.push(N),h}};function c(d,f){for(var m=0;m<d.length;m++)if(d[m].id===f)return d.splice(m,1)[0];return null}});function o(a){var l=An();l&&l.QUnit&&console&&console.log("ESPromiseScheduler["+i+"] "+a)}function s(a){rl(t,"ESPromiseScheduler["+i+"] "+a)}}return r.incomplete=function(){return XC},r.waitingToStart=function(){return bh},r}(),p5=hfe});var m5,h5=ge(()=>{p();nd();qC();QC();m5=function(){function r(e){var t=this,n={},i=[],o=[];e&&o.push(e);function s(c,d){var f,m=n[c];if(m&&(f=m[d]),!f&&f!==null){if(un(c)&&un(d))if(o.length>0){for(var g=0;g<o.length;g++)if(o[g].handleField(c,d)){f={canHandle:!0,fieldHandler:o[g]};break}}else i.length===0&&(f={canHandle:!0});if(!f&&f!==null){f=null;for(var g=0;g<i.length;g++)if(i[g].handleField(c,d)){f={canHandle:!0,handler:i[g],fieldHandler:null};break}}m||(m=n[c]={}),m[d]=f}return f}t.addSanitizer=function(c){c&&(i.push(c),n={})},t.addFieldSanitizer=function(c){c&&(o.push(c),n={})},t.handleField=function(c,d){var f=s(c,d);return f?f.canHandle:!1},t.value=function(c,d,f,m){var g=s(c,d);if(g&&g.canHandle){if(!g||!g.canHandle)return null;if(g.handler)return g.handler.value(c,d,f,m);if(!un(d)||Ct(f)||f===ll)return null;var b=null,v=cl(f);if((v&8192)===8192){var k=v&-8193;if(b=f,!On(b.value)||k!==1&&k!==2&&k!==3&&(k&4096)!==4096)return null}else v===1||v===2||v===3||(v&4096)===4096?b=l(c,d,f):v===4&&(b=l(c,d,m?JSON.stringify(f):f));if(b)return a(g,c,d,v,b,m)}return null},t.property=function(c,d,f,m){var g=s(c,d);if(!g||!g.canHandle||!un(d)||Ct(f)||!On(f.value))return null;var b=cl(f.value);return b===0?null:a(g,c,d,b,f,m)};function a(c,d,f,m,g,b){if(c.handler)return c.handler.property(d,f,g,b);if(!Ct(g.kind)){if((m&4096)===4096||!Xy(g.kind))return null;g.value=g.value.toString()}return u(c.fieldHandler,d,f,m,g)}function l(c,d,f){return On(f)?{value:f}:null}function u(c,d,f,m,g){if(g&&c){var b=c.getSanitizer(d,f,m,g.kind,g.propertyType);if(b)if(m===4){var v={},k=g.value;Vr(k,function(P,D){var K=d+"."+f;if(On(D)){var L=l(K,P,D);L=u(c,K,P,cl(D),L),L&&(v[P]=L.value)}}),g.value=v}else{var R={path:d,name:f,type:m,prop:g,sanitizer:t};g=b.call(t,R)}}return g}}return r.getFieldType=cl,r}()});var g5={};Wv(g5,{AppInsightsCore:()=>a5,BaseCore:()=>c5,BaseTelemetryPlugin:()=>mh,CoreUtils:()=>s5,DiagnosticLogger:()=>tl,ESPromise:()=>ef,ESPromiseScheduler:()=>p5,EventHelper:()=>gF,EventLatency:()=>X6,EventPersistence:()=>e5,EventPropertyType:()=>Z6,EventsDiscardedReason:()=>Za,FullVersionString:()=>od,InternalAppInsightsCore:()=>VC,InternalBaseCore:()=>hh,LoggingSeverity:()=>NF,MinChannelPriorty:()=>IK,NotificationManager:()=>WC,PerfEvent:()=>ch,PerfManager:()=>CC,ProcessTelemetryContext:()=>xF,TraceLevel:()=>t5,Undefined:()=>$t,Utils:()=>o5,ValueKind:()=>Q6,ValueSanitizer:()=>m5,Version:()=>Sk,_ExtendedInternalMessageId:()=>r5,_InternalLogMessage:()=>lh,_InternalMessageId:()=>HC,__getRegisteredEvents:()=>mF,_logInternalMessage:()=>oF,_throwInternal:()=>Yr,_warnToConsole:()=>rl,addEventHandler:()=>zp,addEventListeners:()=>lk,addPageHideEventListener:()=>Hy,addPageShowEventListener:()=>qy,addPageUnloadEventListener:()=>ph,areCookiesSupported:()=>ol,arrForEach:()=>We,arrIndexOf:()=>Yn,arrMap:()=>eh,arrReduce:()=>th,attachEvent:()=>jy,cookieAvailable:()=>ol,createCookieMgr:()=>Qu,createEnumStyle:()=>Co,createGuid:()=>VF,createProcessTelemetryContext:()=>Qo,createTraceParent:()=>IF,createUniqueNamespace:()=>il,createUnloadHandlerContainer:()=>fh,dateNow:()=>$n,deleteCookie:()=>FF,detachEvent:()=>By,disableCookies:()=>LF,disallowsSameSiteNone:()=>Wy,doPerf:()=>Sn,dumpObj:()=>Zr,eventOff:()=>dh,eventOn:()=>uh,extend:()=>Zp,findW3cTraceParent:()=>EF,formatTraceParent:()=>_F,generateW3CId:()=>Zu,getCommonSchemaMetaData:()=>zC,getConsole:()=>bC,getCookie:()=>UF,getCookieValue:()=>WF,getCrypto:()=>IC,getDocument:()=>zo,getExceptionName:()=>rh,getFieldValueType:()=>cl,getGlobal:()=>An,getGlobalInst:()=>dn,getHistory:()=>QK,getIEVersion:()=>XK,getISOString:()=>sa,getJSON:()=>Oy,getLocation:()=>oh,getMsCrypto:()=>SC,getNavigator:()=>Ds,getPerformance:()=>My,getSetValue:()=>Vp,getTenantId:()=>GC,getTime:()=>wo,getWindow:()=>xc,hasDocument:()=>YT,hasHistory:()=>$T,hasJSON:()=>sh,hasNavigator:()=>yC,hasOwnProperty:()=>qu,hasWindow:()=>vC,isArray:()=>It,isArrayValid:()=>_k,isBeaconsSupported:()=>Bp,isBoolean:()=>Ju,isChromium:()=>Ek,isDate:()=>Ty,isDocumentObjectAvailable:()=>JC,isError:()=>Zm,isFetchSupported:()=>Ly,isFunction:()=>qt,isIE:()=>el,isLatency:()=>YC,isNotTruthy:()=>MK,isNullOrUndefined:()=>Ct,isNumber:()=>Go,isObject:()=>Pi,isReactNative:()=>zu,isSampledFlag:()=>SF,isString:()=>un,isTruthy:()=>ky,isTypeof:()=>Py,isUint8ArrayAvailable:()=>OF,isUndefined:()=>ur,isValidSpanId:()=>$y,isValidTraceId:()=>Yy,isValidTraceParent:()=>dk,isValueAssigned:()=>On,isValueKind:()=>Xy,isWindowObjectAvailable:()=>MF,isXhrSupported:()=>Ky,mergeEvtNamespace:()=>Xu,newGuid:()=>Jy,newId:()=>Jp,normalizeJsName:()=>Qm,objCreate:()=>So,objDefineAccessors:()=>Ps,objForEachKey:()=>Vr,objFreeze:()=>Yo,objKeys:()=>Eo,objSeal:()=>AK,openXhr:()=>Ck,optimizeObject:()=>Gu,parseTraceParent:()=>LC,perfNow:()=>Gy,proxyAssign:()=>OK,proxyFunctionAs:()=>jp,proxyFunctions:()=>nh,random32:()=>nl,randomValue:()=>Uy,removeEventHandler:()=>ak,removeEventListeners:()=>$p,removePageHideEventListener:()=>MC,removePageShowEventListener:()=>OC,removePageUnloadEventListener:()=>AC,safeGetCookieMgr:()=>Yp,safeGetLogger:()=>_C,sanitizeProperty:()=>$C,setCookie:()=>KF,setEnableEnvMocks:()=>zK,setProcessTelemetryTimings:()=>vh,setValue:()=>$o,strContains:()=>wn,strEndsWith:()=>Xm,strFunction:()=>Xr,strObject:()=>pt,strPrototype:()=>Mt,strStartsWith:()=>Dy,strTrim:()=>jr,strUndefined:()=>$t,throwError:()=>zn,toISOString:()=>sa,useXDomainRequest:()=>ah});var Ih=ge(()=>{p();n5();l5();u5();jF();f5();h5();nd();QC()});var Sh,wk,xk,HF=ge(()=>{p();Sh="REAL_TIME",wk="NEAR_REAL_TIME",xk="BEST_EFFORT"});var ul,Pk,v5,Dk,y5,qF,b5,I5,S5,JF,GF,Tk,_5,YF,E5,$F,kk,zF,Nk,Rk,Ak,ZC,QF,C5,eb,XF,Mk,ew=ge(()=>{p();ul="",Pk="POST",v5="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Dk="drop",y5="send",qF="requeue",b5="rspFail",I5="oth",S5="no-cache, no-store",JF="application/x-json-stream",GF="cache-control",Tk="content-type",_5="kill-tokens",YF="kill-duration",E5="kill-duration-seconds",$F="time-delta-millis",kk="client-version",zF="client-id",Nk="time-delta-to-apply-millis",Rk="upload-time",Ak="apikey",ZC="AuthMsaDeviceTicket",QF="AuthXToken",C5="NoResponseBody",eb="msfpc",XF="trace",Mk="user"});function x5(r){var e=(r.ext||{}).intweb;return e&&On(e[eb])?e[eb]:null}function w5(r){for(var e=null,t=0;e===null&&t<r.length;t++)e=x5(r[t]);return e}var tb,ZF=ge(()=>{p();Ih();ew();tb=function(){function r(e,t){var n=t?[].concat(t):[],i=this,o=w5(n);i.iKey=function(){return e},i.Msfpc=function(){return o||ul},i.count=function(){return n.length},i.events=function(){return n},i.addEvent=function(s){return s?(n.push(s),o||(o=x5(s)),!0):!1},i.split=function(s,a){var l;if(s<n.length){var u=n.length-s;Ct(a)||(u=a<u?a:u),l=n.splice(s,u),o=w5(n)}return new r(e,l)}}return r.create=function(e,t){return new r(e,t)},r}()});var gfe,P5,D5=ge(()=>{p();dr();gfe=function(){function r(){var e=!0,t=!0,n=!0,i="use-collector-delta",o=!1;He(r,this,function(s){s.allowRequestSending=function(){return e},s.firstRequestSent=function(){n&&(n=!1,o||(e=!1))},s.shouldAddClockSkewHeaders=function(){return t},s.getClockSkewHeaderValue=function(){return i},s.setClockSkew=function(a){o||(a?(i=a,t=!0,o=!0):t=!1,e=!0)}})}return r.__ieDyn=1,r}(),P5=gfe});var vfe,yfe,T5,k5=ge(()=>{p();dr();Ih();vfe=1e3,yfe=function(){function r(){var e={};function t(n){var i=[];return n&&We(n,function(o){i.push(jr(o))}),i}He(r,this,function(n){n.setKillSwitchTenants=function(i,o){if(i&&o)try{var s=t(i.split(","));if(o==="this-request-only")return s;for(var a=parseInt(o,10)*vfe,l=0;l<s.length;++l)e[s[l]]=$n()+a}catch(u){return[]}return[]},n.isTenantKilled=function(i){var o=e,s=jr(i);return o[s]!==void 0&&o[s]>$n()?!0:(delete o[s],!1)}})}return r.__ieDyn=1,r}(),T5=yfe});function R5(r){return!(r>=300&&r<500&&r!=408&&r!=429||r==501||r==505)}function Ok(r){var e=0,t=N5*bfe,n=N5*Ife,i=Math.floor(Math.random()*(n-t))+t;return e=Math.pow(2,r)*i,Math.min(e,Sfe)}var bfe,Ife,N5,Sfe,eU=ge(()=>{p();bfe=.8,Ife=1.2,N5=3e3,Sfe=6e5});function M5(r,e,t,n){if(n&&r){var i=zC(n.value,n.kind,n.propertyType);if(i>-1){var o=r[A5];o||(o=r[A5]={f:{}});var s=o[Lk];if(s||(s=o[Lk]={}),e)for(var a=0;a<e.length;a++){var l=e[a];s[l]||(s[l]={f:{}});var u=s[l][Lk];u||(u=s[l][Lk]={}),s=u}s=s[t]={},It(n.value)?s.a={t:i}:s.t=i}}}var _fe,Efe,O5,L5,Cfe,A5,Lk,wfe,K5,F5=ge(()=>{p();dr();Ih();ZF();ew();_fe=20,Efe=3984588,O5=65e3,L5=2e6,Cfe=Math.min(L5,O5),A5="metadata",Lk="f",wfe=/\./,K5=function(){function r(e,t,n,i){var o="data",s="baseData",a="ext",l=!!i,u=!0,c=t,d={};He(r,this,function(f){f.createPayload=function(b,v,k,R,P,D){return{apiKeys:[],payloadBlob:ul,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:b,isTeardown:v,isSync:k,isBeacon:R,sendType:D,sendReason:P}},f.appendPayload=function(b,v,k){var R=b&&v&&!b.overflow;return R&&Sn(e,function(){return"Serializer:appendPayload"},function(){for(var P=v.events(),D=b.payloadBlob,K=b.numEvents,L=!1,B=[],N=[],O=b.isBeacon,h=O?O5:Efe,y=O?Cfe:L5,w=0,T=0;w<P.length;){var H=P[w];if(H){if(K>=k){b.overflow=v.split(w);break}var Y=f.getEventBlob(H);if(Y&&Y.length<=y){var Z=Y.length,ie=D.length;if(ie+Z>h){b.overflow=v.split(w);break}D&&(D+=`
`),D+=Y,T++,T>_fe&&(D.substr(0,1),T=0),L=!0,K++}else Y?B.push(H):N.push(H),P.splice(w,1),w--}w++}if(B&&B.length>0&&b.sizeExceed.push(tb.create(v.iKey(),B)),N&&N.length>0&&b.failedEvts.push(tb.create(v.iKey(),N)),L){b.batches.push(v),b.payloadBlob=D,b.numEvents=K;var le=v.iKey();Yn(b.apiKeys,le)===-1&&b.apiKeys.push(le)}},function(){return{payload:b,theBatch:{iKey:v.iKey(),evts:v.events()},max:k}}),R},f.getEventBlob=function(b){try{return Sn(e,function(){return"Serializer.getEventBlob"},function(){var v={};v.name=b.name,v.time=b.time,v.ver=b.ver,v.iKey="o:"+GC(b.iKey);var k={},R=b[a];R&&(v[a]=k,Vr(R,function(K,L){var B=k[K]={};g(L,B,"ext."+K,!0,null,null,!0)}));var P=v[o]={};P.baseType=b.baseType;var D=P[s]={};return g(b.baseData,D,s,!1,[s],function(K,L,B){M5(k,K,L,B)},u),g(b.data,P,o,!1,[],function(K,L,B){M5(k,K,L,B)},u),JSON.stringify(v)},function(){return{item:b}})}catch(v){return null}};function m(b,v){var k=d[b];return k===void 0&&(b.length>=7&&(k=Dy(b,"ext.metadata")||Dy(b,"ext.web")),d[b]=k),k}function g(b,v,k,R,P,D,K){Vr(b,function(L,B){var N=null;if(B||On(B)){var O=k,h=L,y=P,w=v;if(l&&!R&&wfe.test(L)){var T=L.split("."),H=T.length;if(H>1){y&&(y=y.slice());for(var Y=0;Y<H-1;Y++){var Z=T[Y];w=w[Z]=w[Z]||{},O+="."+Z,y&&y.push(Z)}h=T[H-1]}}var ie=R&&m(O,h);if(!ie&&c&&c.handleField(O,h)?N=c.value(O,h,B,n):N=$C(h,B,n),N){var le=N.value;if(w[h]=le,D&&D(y,h,N),K&&typeof le=="object"&&!It(le)){var be=y;be&&(be=be.slice(),be.push(h)),g(B,le,O+"."+h,R,be,D,K)}}}})}})}return r.__ieDyn=1,r}()});function Eh(r,e,t){rU[r]=e,t!==!1&&(nU[e]=r)}function W5(r){try{return r.responseText}catch(e){}return ul}function V5(r,e){var t=!1;if(r&&e){var n=Eo(r);if(n&&n.length>0)for(var i=e.toLowerCase(),o=0;o<n.length;o++){var s=n[o];if(s&&qu(e,s)&&s.toLowerCase()===i){t=!0;break}}}return t}function rb(r,e,t,n){e&&t&&t.length>0&&(n&&rU[e]?(r.hdrs[rU[e]]=t,r.useHdrs=!0):r.url+="&"+e+"="+t)}function j5(r,e){return e&&(Go(e)?r=[e].concat(r):It(e)&&(r=e.concat(r))),r}var _h,tU,U5,xfe,rU,nU,B5,H5=ge(()=>{p();dr();D5();k5();Ih();ew();eU();F5();tU="sendAttempt",U5="&"+C5+"=true",xfe=(_h={},_h[1]=qF,_h[100]=qF,_h[200]="sent",_h[8004]=Dk,_h[8003]=Dk,_h),rU={},nU={};Eh(ZC,ZC,!1);Eh(kk,kk);Eh(zF,"Client-Id");Eh(Ak,Ak);Eh(Nk,Nk);Eh(Rk,Rk);Eh(QF,QF);B5=function(){function r(e,t,n,i,o){this._responseHandlers=[];var s="?cors=true&"+Tk.toLowerCase()+"="+JF,a=new T5,l=!1,u=new P5,c=!1,d=0,f,m,g,b,v=!0,k=[],R={},P=[],D=null,K=!1,L,B=!1,N=!1,O,h,y,w,T;He(r,this,function(H){var Y=!0;H.initialize=function(Q,we,G,X,ce){var _e;ce||(ce={}),s=Q+s,N=ur(ce.avoidOptions)?!0:!ce.avoidOptions,b=we,L=we.getCookieMgr(),K=!b.config.disableEventTimings;var xe=!!b.config.enableCompoundKey;f=G,m=f.diagLog();var ee=ce.valueSanitizer,oe=ce.stringifyObjects;ur(ce.enableCompoundKey)||(xe=!!ce.enableCompoundKey),O=ce.xhrTimeout,h=!!ce.disableXhrSync,y=!!ce.disableFetchKeepAlive,T=ce.addNoResponse!==!1,c=!zu(),D=new K5(b,ee,oe,xe),Ct(ce.useSendBeacon)||(c=!!ce.useSendBeacon);var se=X,Ie=ce.alwaysUseXhrOverride?X:null,Pe=ce.alwaysUseXhrOverride?X:null,Re=[3,2];if(!X){v=!1;var yt=oh();yt&&yt.protocol&&yt.protocol.toLowerCase()==="file:"&&(Y=!1);var Yt=[];zu()?(Yt=[2,1],Re=[2,1,3]):Yt=[1,2,3],Yt=j5(Yt,ce.transports),X=Z(Yt,!1),X||rl(m,"No available transport to send events"),se=Z(Yt,!0)}Ie||(Re=j5(Re,ce.unloadTransports),Ie=Z(Re,!0)),w=!v&&(c&&Bp()||!y&&Ly(!0)),g=(_e={},_e[0]=X,_e[1]=se||Z([1,2,3],!0),_e[2]=Ie||se||Z([1],!0),_e[3]=Pe||Z([2,3],!0)||se||Z([1],!0),_e)};function Z(Q,we){for(var G=0,X=null,ce=0;X==null&&ce<Q.length;)G=Q[ce],G===1?ah()?X=ie:Ky()&&(X=be):G===2&&Ly(we)&&(!we||we&&!y)?X=le:c&&G===3&&Bp()&&(X=$),ce++;return X?{_transport:G,_isSync:we,sendPOST:X}:null}H._getDbgPlgTargets=function(){return[g[0],a,D,g]};function ie(Q,we,G){var X=new XDomainRequest;X.open(Pk,Q.urlString),Q.timeout&&(X.timeout=Q.timeout),X.onload=function(){var ce=W5(X);q(we,200,{},ce),j(ce)},X.onerror=function(){q(we,400,{})},X.ontimeout=function(){q(we,500,{})},X.onprogress=function(){},G?X.send(Q.data):o.set(function(){X.send(Q.data)},0)}function le(Q,we,G){var X,ce=Q.urlString,_e=!1,xe=!1,ee=(X={body:Q.data,method:Pk},X[v5]=!0,X);G&&(ee.keepalive=!0,Q._sendReason===2&&(_e=!0,T&&(ce+=U5))),Y&&(ee.credentials="include"),Q.headers&&Eo(Q.headers).length>0&&(ee.headers=Q.headers),fetch(ce,ee).then(function(oe){var se={},Ie=ul,Pe=oe.headers;Pe&&Pe.forEach(function(Re,yt){se[yt]=Re}),oe.body&&oe.text().then(function(Re){Ie=Re}),xe||(xe=!0,q(we,oe.status,se,Ie),j(Ie))}).catch(function(oe){xe||(xe=!0,q(we,0,{}))}),_e&&!xe&&(xe=!0,q(we,200,{})),!xe&&Q.timeout>0&&o.set(function(){xe||(xe=!0,q(we,500,{}))},Q.timeout)}function be(Q,we,G){var X=Q.urlString;function ce(oe,se,Ie){if(!oe[Ie]&&se&&se.getResponseHeader){var Pe=se.getResponseHeader(Ie);Pe&&(oe[Ie]=jr(Pe))}return oe}function _e(oe){var se={};return oe.getAllResponseHeaders?se=_(oe.getAllResponseHeaders()):(se=ce(se,oe,$F),se=ce(se,oe,YF),se=ce(se,oe,E5)),se}function xe(oe,se){q(we,oe.status,_e(oe),se)}G&&Q.disableXhrSync&&(G=!1);var ee=Ck(Pk,X,Y,!0,G,Q.timeout);Vr(Q.headers,function(oe,se){ee.setRequestHeader(oe,se)}),ee.onload=function(){var oe=W5(ee);xe(ee,oe),j(oe)},ee.onerror=function(){xe(ee)},ee.ontimeout=function(){xe(ee)},ee.send(Q.data)}function q(Q,we,G,X){try{Q(we,G,X)}catch(ce){Yr(m,2,518,Zr(ce))}}function $(Q,we,G){var X=Q,ce=200,_e=X._thePayload,xe=Q.urlString+(T?U5:ul);try{var ee=Ds();if(!ee.sendBeacon(xe,Q.data))if(_e){var oe=[];We(_e.batches,function(se){if(oe&&se&&se.count()>0){for(var Ie=se.events(),Pe=0;Pe<Ie.length;Pe++)if(!ee.sendBeacon(xe,D.getEventBlob(Ie[Pe]))){oe.push(se.split(Pe));break}}else oe.push(se.split(0))}),me(oe,8003,_e.sendType,!0)}else ce=0}catch(se){rl(m,"Failed to send telemetry using sendBeacon API. Ex:"+Zr(se)),ce=0}finally{q(we,ce,{},ul)}}function ue(Q){return Q===2||Q===3}function pe(Q){return B&&ue(Q)&&(Q=2),Q}H.addQueryStringParameter=function(Q,we){for(var G=0;G<k.length;G++)if(k[G].name===Q){k[G].value=we;return}k.push({name:Q,value:we})},H.addHeader=function(Q,we){R[Q]=we},H.canSendRequest=function(){return ye()&&u.allowRequestSending()},H.sendQueuedRequests=function(Q,we){ur(Q)&&(Q=0),B&&(Q=pe(Q),we=2),fe(P,Q,0)&&Te(z(),0,!1,Q,we||0)},H.isCompletelyIdle=function(){return!l&&d===0&&P.length===0},H.setUnloading=function(Q){B=Q},H.addBatch=function(Q){if(Q&&Q.count()>0){if(a.isTenantKilled(Q.iKey()))return!1;P.push(Q)}return!0},H.teardown=function(){P.length>0&&Te(z(),0,!0,2,2)},H.pause=function(){l=!0},H.resume=function(){l=!1,H.sendQueuedRequests(0,4)},H.sendSynchronousBatch=function(Q,we,G){Q&&Q.count()>0&&(Ct(we)&&(we=1),B&&(we=pe(we),G=2),Te([Q],0,!1,we,G||0))};function ye(){return!l&&d<t}function z(){var Q=P;return P=[],Q}function fe(Q,we,G){var X=!1;return Q&&Q.length>0&&!l&&g[we]&&D&&(X=we!==0||ye()&&(G>0||u.allowRequestSending())),X}function Se(Q){var we={};return Q&&We(Q,function(G,X){we[X]={iKey:G.iKey(),evts:G.events()}}),we}function Te(Q,we,G,X,ce){if(!(!Q||Q.length===0)){if(l){me(Q,1,X);return}X=pe(X);try{var _e=Q,xe=X!==0;Sn(b,function(){return"HttpManager:_sendBatches"},function(ee){ee&&(Q=Q.slice(0));for(var oe=[],se=null,Ie=wo(),Pe=g[X]||(xe?g[1]:g[0]),Re=Pe&&Pe._transport,yt=w&&(B||ue(X)||Re===3||Pe._isSync&&Re===2);fe(Q,X,we);){var Yt=Q.shift();Yt&&Yt.count()>0&&(a.isTenantKilled(Yt.iKey())?oe.push(Yt):(se=se||D.createPayload(we,G,xe,yt,ce,X),D.appendPayload(se,Yt,e)?se.overflow!==null&&(Q=[se.overflow].concat(Q),se.overflow=null,Je(se,Ie,wo(),ce),Ie=wo(),se=null):(Je(se,Ie,wo(),ce),Ie=wo(),Q=[Yt].concat(Q),se=null)))}se&&Je(se,Ie,wo(),ce),Q.length>0&&(P=Q.concat(P)),me(oe,8004,X)},function(){return{batches:Se(_e),retryCount:we,isTeardown:G,isSynchronous:xe,sendReason:ce,useSendBeacon:ue(X),sendType:X}},!xe)}catch(ee){Yr(m,2,48,"Unexpected Exception sending batch: "+Zr(ee))}}}function Le(Q,we){var G={url:s,hdrs:{},useHdrs:!1};we?(G.hdrs=Zp(G.hdrs,R),G.useHdrs=Eo(G.hdrs).length>0):Vr(R,function(ee,oe){nU[ee]?rb(G,nU[ee],oe,!1):(G.hdrs[ee]=oe,G.useHdrs=!0)}),rb(G,zF,"NO_AUTH",we),rb(G,kk,od,we);var X=ul;We(Q.apiKeys,function(ee){X.length>0&&(X+=","),X+=ee}),rb(G,Ak,X,we),rb(G,Rk,$n().toString(),we);var ce=F(Q);if(On(ce)&&(G.url+="&ext.intweb.msfpc="+ce),u.shouldAddClockSkewHeaders()&&rb(G,Nk,u.getClockSkewHeaderValue(),we),b.getWParam){var _e=b.getWParam();_e>=0&&(G.url+="&w="+_e)}for(var xe=0;xe<k.length;xe++)G.url+="&"+k[xe].name+"="+k[xe].value;return G}function Ye(Q,we,G){Q[we]=Q[we]||{},Q[we][f.identifier]=G}function Je(Q,we,G,X){if(Q&&Q.payloadBlob&&Q.payloadBlob.length>0){var ce=!!H.sendHook,_e=g[Q.sendType];!ue(Q.sendType)&&Q.isBeacon&&Q.sendReason===2&&(_e=g[2]||g[3]||_e);var xe=N;(Q.isBeacon||_e._transport===3)&&(xe=!1);var ee=Le(Q,xe);xe=xe||ee.useHdrs;var oe=wo();Sn(b,function(){return"HttpManager:_doPayloadSend"},function(){for(var se=0;se<Q.batches.length;se++)for(var Ie=Q.batches[se],Pe=Ie.events(),Re=0;Re<Pe.length;Re++){var yt=Pe[Re];if(K){var Yt=yt.timings=yt.timings||{};Ye(Yt,"sendEventStart",oe),Ye(Yt,"serializationStart",we),Ye(Yt,"serializationCompleted",G)}yt[tU]>0?yt[tU]++:yt[tU]=1}me(Q.batches,1e3+(X||0),Q.sendType,!0);var Fr={data:Q.payloadBlob,urlString:ee.url,headers:ee.hdrs,_thePayload:Q,_sendReason:X,timeout:O,disableXhrSync:h,disableFetchKeepAlive:y};xe&&(V5(Fr.headers,GF)||(Fr.headers[GF]=S5),V5(Fr.headers,Tk)||(Fr.headers[Tk]=JF));var km=null;_e&&(km=function(Uv){u.firstRequestSent();var Nm=function(aD,Z9){A(aD,Z9,Q,X)},Ne=Q.isTeardown||Q.isSync;try{_e.sendPOST(Uv,Nm,Ne),H.sendListener&&H.sendListener(Fr,Uv,Ne,Q.isBeacon)}catch(aD){rl(m,"Unexpected exception sending payload. Ex:"+Zr(aD)),q(Nm,0,{})}}),Sn(b,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(km)if(Q.sendType===0&&d++,ce&&!Q.isBeacon&&_e._transport!==3){var Uv={data:Fr.data,urlString:Fr.urlString,headers:Zp({},Fr.headers),timeout:Fr.timeout,disableXhrSync:Fr.disableXhrSync,disableFetchKeepAlive:Fr.disableFetchKeepAlive},Nm=!1;Sn(b,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{H.sendHook(Uv,function(Ne){Nm=!0,!v&&!Ne._thePayload&&(Ne._thePayload=Ne._thePayload||Fr._thePayload,Ne._sendReason=Ne._sendReason||Fr._sendReason),km(Ne)},Q.isSync||Q.isTeardown)}catch(Ne){Nm||km(Fr)}})}else km(Fr)})},function(){return{thePayload:Q,serializationStart:we,serializationCompleted:G,sendReason:X}},Q.isSync)}Q.sizeExceed&&Q.sizeExceed.length>0&&me(Q.sizeExceed,8003,Q.sendType),Q.failedEvts&&Q.failedEvts.length>0&&me(Q.failedEvts,8002,Q.sendType)}function Bt(Q,we){K&&We(Q,function(G){var X=G.timings=G.timings||{};Ye(X,"sendEventCompleted",we)})}function A(Q,we,G,X){var ce=9e3,_e=null,xe=!1,ee=!1;try{var oe=!0;if(typeof Q!==$t){if(we){u.setClockSkew(we[$F]);var se=we[YF]||we["kill-duration-seconds"];We(a.setKillSwitchTenants(we[_5],se),function(Pe){We(G.batches,function(Re){if(Re.iKey()===Pe){_e=_e||[];var yt=Re.split(0);G.numEvents-=yt.count(),_e.push(yt)}})})}if(Q==200||Q==204){ce=200;return}(!R5(Q)||G.numEvents<=0)&&(oe=!1),ce=9e3+Q%1e3}if(oe){ce=100;var Ie=G.retryCnt;G.sendType===0&&(Ie<n?(xe=!0,S(function(){G.sendType===0&&d--,Te(G.batches,Ie+1,G.isTeardown,B?2:G.sendType,5)},B,Ok(Ie))):(ee=!0,B&&(ce=8001)))}}finally{xe||(u.setClockSkew(),M(G,ce,X,ee)),me(_e,8004,G.sendType)}}function M(Q,we,G,X){try{X&&f._backOffTransmission(),we===200&&(!X&&!Q.isSync&&f._clearBackOff(),I(Q.batches)),me(Q.batches,we,Q.sendType,!0)}finally{Q.sendType===0&&(d--,G!==5&&H.sendQueuedRequests(Q.sendType,G))}}function I(Q){if(K){var we=wo();We(Q,function(G){G&&G.count()>0&&Bt(G.events(),we)})}}function S(Q,we,G){we?Q():o.set(Q,G)}function _(Q){var we={};if(un(Q)){var G=jr(Q).split(/[\r\n]+/);We(G,function(X){if(X){var ce=X.indexOf(": ");if(ce!==-1){var _e=jr(X.substring(0,ce)).toLowerCase(),xe=jr(X.substring(ce+1));we[_e]=xe}else we[jr(X)]=1}})}return we}function F(Q){for(var we=0;we<Q.batches.length;we++){var G=Q.batches[we].Msfpc();if(G)return encodeURIComponent(G)}return ul}function j(Q){var we=H._responseHandlers;try{for(var G=0;G<we.length;G++)try{we[G](Q)}catch(ce){Yr(m,1,519,"Response handler failed: "+ce)}if(Q){var X=JSON.parse(Q);On(X.webResult)&&On(X.webResult[eb])&&L.set("MSFPC",X.webResult[eb],365*86400)}}catch(ce){}}function me(Q,we,G,X){if(Q&&Q.length>0&&i){var ce=i[Fe(we)];if(ce){var _e=G!==0;Sn(b,function(){return"HttpManager:_sendBatchesNotification"},function(){S(function(){try{ce.call(i,Q,we,_e,G)}catch(xe){Yr(m,1,74,"send request notification failed: "+xe)}},X||_e,0)},function(){return{batches:Se(Q),reason:we,isSync:_e,sendSync:X,sendType:G}},!_e)}}}function Fe(Q){var we=xfe[Q];return On(we)||(we=I5,Q>=9e3&&Q<=9999?we=b5:Q>=8e3&&Q<=8999?we=Dk:Q>=1e3&&Q<=1999&&(we=y5)),we}})}return r.__ieDyn=1,r}()});function Pfe(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setTimeout(r,e,t)}function Dfe(r){clearTimeout(r)}function tw(r,e){return{set:r||Pfe,clear:e||Dfe}}var q5=ge(()=>{p()});var Tfe,J5,kfe,G5,Y5,Nfe,$5,Rfe,Ch,Kk,z5,Q5,Afe,Mfe,X5,Z5=ge(()=>{p();ir();dr();Ih();HF();ZF();H5();ew();eU();q5();Tfe=.25,J5=500,kfe=20,G5=6,Y5=2,Nfe=4,$5=2,Rfe=1,Ch="eventsDiscarded",Kk="overrideInstrumentationKey",z5="maxEventRetryAttempts",Q5="maxUnloadEventRetryAttempts",Afe="addUnloadCb",Mfe=function(r){In(e,r);function e(){var t=r.call(this)||this;t.identifier="PostChannel",t.priority=1011,t.version="3.2.9";var n,i=!1,o=[],s=null,a=!1,l=0,u=500,c=0,d=1e4,f={},m=Sh,g=null,b=null,v=0,k=0,R,P,D={},K,L,B=-1,N,O=!0,h=!1,y=G5,w=Y5,T,H;return He(e,t,function(Y,Z){ye(),Y._getDbgPlgTargets=function(){return[P]},Y.initialize=function(ee,oe,se){Sn(oe,function(){return"PostChannel:initialize"},function(){var Ie=oe;Z.initialize(ee,oe,se);try{var Pe=!!oe[Afe];T=Xu(il(Y.identifier),oe.evtNamespace&&oe.evtNamespace());var Re=Y._getTelCtx();ee.extensionConfig[Y.identifier]=ee.extensionConfig[Y.identifier]||{},n=Re.getExtCfg(Y.identifier),H=tw(n.setTimeoutOverride,n.clearTimeoutOverride),O=!n.disableOptimizeObj&&Ek(),ie(Ie),n.eventsLimitInMem>0&&(d=n.eventsLimitInMem),n.immediateEventLimit>0&&(u=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(K=n.autoFlushEventsLimit),Go(n[z5])&&(y=n[z5]),Go(n[Q5])&&(w=n[Q5]),xe(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(R=n.httpXHROverride),On(ee.anonCookieName)&&P.addQueryStringParameter("anoncknm",ee.anonCookieName),P.sendHook=n.payloadPreprocessor,P.sendListener=n.payloadListener;var yt=n.overrideEndpointUrl?n.overrideEndpointUrl:ee.endpointUrl;Y._notificationManager=oe.getNotifyMgr(),P.initialize(yt,Y.core,Y,R,n);var Yt=ee.disablePageUnloadEvents||[];ph(le,Yt,T),Hy(le,Yt,T),qy(be,ee.disablePageShowEvents,T)}catch(Fr){throw Y.setInitialized(!1),Fr}},function(){return{coreConfig:ee,core:oe,extensions:se}})},Y.processTelemetry=function(ee,oe){vh(ee,Y.identifier),oe=Y._getTelCtx(oe);var se=oe.getExtCfg(Y.identifier),Ie=!!n.disableTelemetry;se&&(Ie=Ie||!!se.disableTelemetry);var Pe=ee;!Ie&&!i&&(n[Kk]&&(Pe.iKey=n[Kk]),se&&se[Kk]&&(Pe.iKey=se[Kk]),q(Pe,!0),h?Se(2,2):pe()),Y.processNext(Pe,oe)},Y._doTeardown=function(ee,oe){Se(2,2),i=!0,P.teardown(),AC(null,T),MC(null,T),OC(null,T),ye()};function ie(ee){var oe=ee.getWParam;ee.getWParam=function(){var se=0;return n.ignoreMc1Ms0CookieProcessing&&(se=se|2),se|oe()}}function le(ee){var oe=ee||xc().event;oe.type!=="beforeunload"&&(h=!0,P.setUnloading(h)),Se(2,2)}function be(ee){h=!1,P.setUnloading(h)}function q(ee,oe){if(ee.sendAttempt||(ee.sendAttempt=0),ee.latency||(ee.latency=1),ee.ext&&ee.ext[XF]&&delete ee.ext[XF],ee.ext&&ee.ext[Mk]&&ee.ext[Mk].id&&delete ee.ext[Mk].id,O&&(vh,ee.ext=Gu(ee.ext),ee.baseData&&(ee.baseData=Gu(ee.baseData)),ee.data&&(ee.data=Gu(ee.data))),ee.sync){if(v||a)ee.latency=3,ee.sync=!1;else if(P){O&&(ee=Gu(ee)),P.sendSynchronousBatch(tb.create(ee.iKey,[ee]),ee.sync===!0?1:ee.sync,3);return}}var se=ee.latency,Ie=c,Pe=d;se===4&&(Ie=l,Pe=u);var Re=!1;if(Ie<Pe)Re=!Je(ee,oe);else{var yt=1,Yt=kfe;se===4&&(yt=4,Yt=1),Re=!0,Bt(ee.iKey,ee.latency,yt,Yt)&&(Re=!Je(ee,oe))}Re&&Fe(Ch,[ee],Za.QueueFull)}Y.setEventQueueLimits=function(ee,oe){d=ee>0?ee:1e4,K=oe>0?oe:0,xe();var se=c>ee;if(!se&&L>0)for(var Ie=1;!se&&Ie<=3;Ie++){var Pe=D[Ie];Pe&&Pe.batches&&We(Pe.batches,function(Re){Re&&Re.count()>=L&&(se=!0)})}Ye(!0,se)},Y.pause=function(){fe(),a=!0,P.pause()},Y.resume=function(){a=!1,P.resume(),pe()},Y.addResponseHandler=function(ee){P._responseHandlers.push(ee)},Y._loadTransmitProfiles=function(ee){_(),Vr(ee,function(oe,se){var Ie=se.length;if(Ie>=2){var Pe=Ie>2?se[2]:0;if(se.splice(0,Ie-2),se[1]<0&&(se[0]=-1),se[1]>0&&se[0]>0){var Re=se[0]/se[1];se[0]=Math.ceil(Re)*se[1]}Pe>=0&&se[1]>=0&&Pe>se[1]&&(Pe=se[1]),se.push(Pe),f[oe]=se}})},Y.flush=function(ee,oe,se){if(ee===void 0&&(ee=!0),!a)if(se=se||1,ee)s==null?(fe(),M(1,0,se),s=z(function(){s=null,I(oe,se)},0)):o.push(oe);else{var Ie=fe();$(1,1,se),oe!=null&&oe(),Ie&&pe()}},Y.setMsaAuthTicket=function(ee){P.addHeader(ZC,ee)},Y.hasEvents=ue,Y._setTransmitProfile=function(ee){m!==ee&&f[ee]!==void 0&&(fe(),m=ee,pe())};function $(ee,oe,se){var Ie=M(ee,oe,se);return P.sendQueuedRequests(oe,se),Ie}function ue(){return c>0}function pe(){if(B>=0&&M(B,0,N)&&P.sendQueuedRequests(0,N),l>0&&!b&&!a){var ee=f[m][2];ee>=0&&(b=z(function(){b=null,$(4,0,1),pe()},ee))}var oe=f[m][1];!g&&!s&&oe>=0&&!a&&(ue()?g=z(function(){g=null,$(k===0?3:1,0,1),k++,k%=2,pe()},oe):k=0)}Y._backOffTransmission=function(){v<Nfe&&(v++,fe(),pe())},Y._clearBackOff=function(){v&&(v=0,fe(),pe())};function ye(){n=null,i=!1,o=[],s=null,a=!1,l=0,u=500,c=0,d=1e4,f={},m=Sh,g=null,b=null,v=0,k=0,R=null,D={},K=void 0,L=0,B=-1,N=null,O=!0,h=!1,y=G5,w=Y5,T=null,H=tw(),P=new B5(J5,$5,Rfe,{requeue:j,send:we,sent:G,drop:X,rspFail:ce,oth:_e},H),F(),Te(),xe()}function z(ee,oe){oe===0&&v&&(oe=1);var se=1e3;return v&&(se=Ok(v-1)),H.set(ee,oe*se)}function fe(){return g!==null?(H.clear(g),g=null,k=0,!0):!1}function Se(ee,oe){fe(),s&&(H.clear(s),s=null),a||$(1,ee,oe)}function Te(){D[4]={batches:[],iKeyMap:{}},D[3]={batches:[],iKeyMap:{}},D[2]={batches:[],iKeyMap:{}},D[1]={batches:[],iKeyMap:{}}}function Le(ee,oe,se){var Ie=D[oe];Ie||(oe=1,Ie=D[oe]);var Pe=Ie.iKeyMap[ee];return!Pe&&se&&(Pe=tb.create(ee),Ie.batches.push(Pe),Ie.iKeyMap[ee]=Pe),Pe}function Ye(ee,oe){P.canSendRequest()&&!v&&(K>0&&c>K&&(oe=!0),oe&&s==null&&Y.flush(ee,null,20))}function Je(ee,oe){O&&(ee=Gu(ee));var se=ee.latency,Ie=Le(ee.iKey,se,!0);return Ie.addEvent(ee)?(se!==4?(c++,oe&&ee.sendAttempt===0&&Ye(!ee.sync,L>0&&Ie.count()>=L)):l++,!0):!1}function Bt(ee,oe,se,Ie){for(;se<=oe;){var Pe=Le(ee,oe,!0);if(Pe&&Pe.count()>0){var Re=Pe.split(0,Ie),yt=Re.count();if(yt>0)return se===4?l-=yt:c-=yt,Q(Ch,[Re],Za.QueueFull),!0}se++}return A(),!1}function A(){for(var ee=0,oe=0,se=function(Pe){var Re=D[Pe];Re&&Re.batches&&We(Re.batches,function(yt){Pe===4?ee+=yt.count():oe+=yt.count()})},Ie=1;Ie<=4;Ie++)se(Ie);c=oe,l=ee}function M(ee,oe,se){var Ie=!1,Pe=oe===0;return!Pe||P.canSendRequest()?Sn(Y.core,function(){return"PostChannel._queueBatches"},function(){for(var Re=[],yt=4;yt>=ee;){var Yt=D[yt];Yt&&Yt.batches&&Yt.batches.length>0&&(We(Yt.batches,function(Fr){P.addBatch(Fr)?Ie=Ie||Fr&&Fr.count()>0:Re=Re.concat(Fr.events()),yt===4?l-=Fr.count():c-=Fr.count()}),Yt.batches=[],Yt.iKeyMap={}),yt--}Re.length>0&&Fe(Ch,Re,Za.KillSwitch),Ie&&B>=ee&&(B=-1,N=0)},function(){return{latency:ee,sendType:oe,sendReason:se}},!Pe):(B=B>=0?Math.min(B,ee):ee,N=Math.max(N,se)),Ie}function I(ee,oe){$(1,0,oe),A(),S(function(){ee&&ee(),o.length>0?s=z(function(){s=null,I(o.shift(),oe)},0):(s=null,pe())})}function S(ee){P.isCompletelyIdle()?ee():s=z(function(){s=null,S(ee)},Tfe)}function _(){fe(),F(),m=Sh,pe()}function F(){f={},f[Sh]=[2,1,0],f[wk]=[6,3,0],f[xk]=[18,9,0]}function j(ee,oe){var se=[],Ie=y;h&&(Ie=w),We(ee,function(Pe){Pe&&Pe.count()>0&&We(Pe.events(),function(Re){Re&&(Re.sync&&(Re.latency=4,Re.sync=!1),Re.sendAttempt<Ie?(vh(Re,Y.identifier),q(Re,!1)):se.push(Re))})}),se.length>0&&Fe(Ch,se,Za.NonRetryableStatus),h&&Se(2,2)}function me(ee,oe){var se=Y._notificationManager||{},Ie=se[ee];if(Ie)try{Ie.apply(se,oe)}catch(Pe){Yr(Y.diagLog(),1,74,ee+" notification failed: "+Pe)}}function Fe(ee,oe){for(var se=[],Ie=2;Ie<arguments.length;Ie++)se[Ie-2]=arguments[Ie];oe&&oe.length>0&&me(ee,[oe].concat(se))}function Q(ee,oe){for(var se=[],Ie=2;Ie<arguments.length;Ie++)se[Ie-2]=arguments[Ie];oe&&oe.length>0&&We(oe,function(Pe){Pe&&Pe.count()>0&&me(ee,[Pe.events()].concat(se))})}function we(ee,oe,se){ee&&ee.length>0&&me("eventsSendRequest",[oe>=1e3&&oe<=1999?oe-1e3:0,se!==!0])}function G(ee,oe){Q("eventsSent",ee,oe),pe()}function X(ee,oe){Q(Ch,ee,oe>=8e3&&oe<=8999?oe-8e3:Za.Unknown)}function ce(ee){Q(Ch,ee,Za.NonRetryableStatus),pe()}function _e(ee,oe){Q(Ch,ee,Za.Unknown),pe()}function xe(){!n||!n.disableAutoBatchFlushLimit?L=Math.max(J5*($5+1),d/6):L=0}Ps(Y,"_setTimeoutOverride",function(){return H.set},function(ee){H=tw(ee,H.clear)}),Ps(Y,"_clearTimeoutOverride",function(){return H.clear},function(ee){H=tw(H.set,ee)})}),t}return e.__ieDyn=1,e}(mh),X5=Mfe});var e3={};Wv(e3,{BE_PROFILE:()=>xk,NRT_PROFILE:()=>wk,PostChannel:()=>X5,RT_PROFILE:()=>Sh});var t3=ge(()=>{p();Z5();HF()});var Ofe,r3,n3=ge(()=>{p();Ofe=async(r,e,t)=>{let n=await Promise.resolve().then(()=>(Ih(),g5)),i=await Promise.resolve().then(()=>(t3(),e3)),o=new n.AppInsightsCore,s=new i.PostChannel,a={instrumentationKey:r,endpointUrl:"https://mobile.events.data.microsoft.com/OneCollector/1.0",loggingLevelTelemetry:0,loggingLevelConsole:0,disableCookiesUsage:!0,disableDbgExt:!0,disableInstrumentationKeyValidation:!0,channels:[[s]]};if(t){a.extensionConfig={};let c={alwaysUseXhrOverride:!0,httpXHROverride:t};a.extensionConfig[s.identifier]=c}let u=e.workspace.getConfiguration("telemetry").get("internalTesting");return o.initialize(a,[]),o.addTelemetryInitializer(c=>{var d,f;u&&(c.ext=(d=c.ext)!=null?d:{},c.ext.utc=(f=c.ext.utc)!=null?f:{},c.ext.utc.flags=8462029)}),o},r3=async(r,e,t)=>{let n=await Ofe(r,e,t);return{logEvent:(o,s)=>{try{n==null||n.track({name:o,baseData:{name:o,properties:s==null?void 0:s.properties,measurements:s==null?void 0:s.measurements}})}catch(a){throw new Error(`Failed to log event to app insights!
`+a.message)}},flush:async()=>{try{n==null||n.unload()}catch(o){throw new Error(`Failed to flush app insights!
`+o.message)}}}}});var sd,Fk,i3=ge(()=>{p();(function(r){r[r.NOT_INSTANTIATED=0]="NOT_INSTANTIATED",r[r.INSTANTIATING=1]="INSTANTIATING",r[r.INSTANTIATED=2]="INSTANTIATED"})(sd||(sd={}));Fk=class{constructor(e,t){this._instantiationStatus=sd.NOT_INSTANTIATED,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=t,this._key=e}sendEventData(e,t){if(!this._telemetryClient){this._instantiationStatus!==sd.INSTANTIATED&&this._eventQueue.push({eventName:e,data:t});return}this._telemetryClient.logEvent(e,t)}sendErrorData(e,t){if(!this._telemetryClient){this._instantiationStatus!==sd.INSTANTIATED&&this._exceptionQueue.push({exception:e,data:t});return}}async flush(){this._telemetryClient&&(await this._telemetryClient.flush(),this._telemetryClient=void 0)}_flushQueues(){this._eventQueue.forEach(({eventName:e,data:t})=>this.sendEventData(e,t)),this._eventQueue=[],this._exceptionQueue.forEach(({exception:e,data:t})=>this.sendErrorData(e,t)),this._exceptionQueue=[]}instantiateSender(){this._instantiationStatus===sd.NOT_INSTANTIATED&&(this._instantiationStatus=sd.INSTANTIATING,this._clientFactory(this._key).then(e=>{this._telemetryClient=e,this._instantiationStatus=sd.INSTANTIATED,this._flushQueues()}).catch(e=>{console.error(e),this._instantiationStatus=sd.INSTANTIATED}))}}});var Uk,o3=ge(()=>{p();Uk=class{constructor(e,t,n){this.telemetrySender=e,this.vscodeAPI=t,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this._onDidChangeTelemetryLevel=new this.vscodeAPI.EventEmitter,this.onDidChangeTelemetryLevel=this._onDidChangeTelemetryLevel.event,this.telemetryLogger=this.vscodeAPI.env.createTelemetryLogger(this.telemetrySender,n),this.updateUserOptIn(),this.telemetryLogger.onDidChangeEnableStates(()=>{this.updateUserOptIn()})}updateUserOptIn(){this.errorOptIn=this.telemetryLogger.isErrorsEnabled,this.userOptIn=this.telemetryLogger.isUsageEnabled,(this.telemetryLogger.isErrorsEnabled||this.telemetryLogger.isUsageEnabled)&&this.telemetrySender.instantiateSender(),this._onDidChangeTelemetryLevel.fire(this.telemetryLevel)}get telemetryLevel(){return this.errorOptIn&&this.userOptIn?"all":this.errorOptIn?"error":"off"}internalSendTelemetryEvent(e,t,n,i){i?this.telemetrySender.sendEventData(e,{properties:t,measurements:n}):this.telemetryLogger.logUsage(e,{properties:t,measurements:n})}sendTelemetryEvent(e,t,n){this.internalSendTelemetryEvent(e,t,n,!1)}sendDangerousTelemetryEvent(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryEvent(e,t,n,!0)}internalSendTelemetryErrorEvent(e,t,n,i){i?this.telemetrySender.sendEventData(e,{properties:t,measurements:n}):this.telemetryLogger.logError(e,{properties:t,measurements:n})}sendTelemetryErrorEvent(e,t,n){this.internalSendTelemetryErrorEvent(e,t,n,!1)}sendDangerousTelemetryErrorEvent(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryErrorEvent(e,t,n,!0)}internalSendTelemetryException(e,t,n,i){i?this.telemetrySender.sendErrorData(e,{properties:t,measurements:n}):this.telemetryLogger.logError(e,{properties:t,measurements:n})}sendTelemetryException(e,t,n){this.internalSendTelemetryException(e,t,n,!1)}sendDangerousTelemetryException(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryException(e,t,n,!0)}dispose(){return this.telemetryLogger.dispose(),Promise.all(this.disposables.map(e=>e.dispose()))}}});var nb,s3=ge(()=>{p();nb=class r{static applyReplacements(e,t){for(let n of Object.keys(e))for(let i of t)i.lookup.test(n)&&(i.replacementString!==void 0?e[n]=i.replacementString:delete e[n])}static shouldUseOneDataSystemSDK(e){return e.length===74&&e[32]==="-"&&e[41]==="-"&&e[46]==="-"&&e[51]==="-"&&e[56]==="-"&&e[69]==="-"}static getAdditionalCommonProperties(e){return{"common.os":e.platform,"common.nodeArch":e.architecture,"common.platformversion":(e.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),"common.telemetryclientversion":"0.7.7"}}static getInstance(){return r._instance||(r._instance=new r),r._instance}}});var Wk,ib,ad,Vk,ob,iU,rw,oU,a3,ca,jk=ge(()=>{p();Wk="name",ib="push",ad="length",Vk="messageId",ob="message",iU="diagLog",rw="replace",oU="enableDebugExceptions",a3="logInternalMessage",ca="call"});var dl,Bk,Hk,qk=ge(()=>{p();dl="",Bk="errorToConsole",Hk="warnToConsole"});function Jk(r){return r===void 0||typeof r===$t}function wh(r){return r===null||Jk(r)}function xh(r){return!!(r&&typeof r===pt)}function nw(r){return!!(r&&typeof r===Xr)}function Dc(r,e){if(r)for(var t in r)nr[ca](r,t)&&e[ca](r,t,r[t])}function Hfe(r){return!!(r&&h3[ca](r)==="[object Array]")}function iw(r){return!!(r&&h3[ca](r)==="[object Error]")}function Xo(r){return typeof r=="string"}function Gk(r){if(r)return Vfe?r[f3]():qfe(r)}function qfe(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[ad]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function ow(r,e,t){var n=r[ad];try{for(var i=0;i<n&&!(i in r&&e[ca](t||r,r[i],i,r)===-1);i++);}catch(o){}}function uU(r,e,t){if(r){if(r[l3])return r[l3](e,t);var n=r[ad],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function Dh(r,e,t){var n;if(r){if(r[c3])return r[c3](e,t);var i=r[ad],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[ca](o,r[s],r))}catch(a){}}return n}function dU(r,e,t){var n;if(r){if(r[u3])return r[u3](e,t);var i=r[ad],o=0;if(arguments[ad]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function pl(r){return r&&(r=Ufe&&r[aU]?r[aU]():r[rw]?r[rw](/^\s+|(?=\s)\s+$/g,dl):r),r}function pU(r){var e=typeof r;if(e!==Xr&&(e!==pt||r===null)&&na("objKeys called on non-object"),!p3&&d3)return d3(r);var t=[];for(var n in r)r&&nr[ca](r,n)&&t[ib](n);if(p3)for(var i=sU[ad],o=0;o<i;o++)r&&nr[ca](r,sU[o])&&t[ib](sU[o]);return t}function Jfe(r){return r}function Yk(r){return lU&&Dc(r,function(e,t){(Ph(t)||xh(t))&&lU(t)}),g3(r)}function sw(r){return iw(r)?r[Wk]:dl}function aw(r,e){return wh(r)?e:r}function fU(r){return function(){function e(){var t=this;r&&Dc(r,function(n,i){t[n]=i})}return e}()}var f3,Kfe,Ffe,l3,c3,u3,aU,m3,lU,DFe,d3,cU,Ufe,TFe,kFe,Wfe,Vfe,jfe,h3,Bfe,NFe,Ph,p3,sU,g3,$k=ge(()=>{p();ir();jk();qk();f3="toISOString",Kfe="endsWith",Ffe="startsWith",l3="indexOf",c3="map",u3="reduce",aU="trim",m3="toString",lU=Er.freeze,DFe=Er.seal,d3=Er.keys,cU=String[Mt],Ufe=cU[aU],TFe=cU[Kfe],kFe=cU[Ffe],Wfe=Date[Mt],Vfe=Wfe[f3],jfe=Array.isArray,h3=ra[m3],Bfe=nr[m3],NFe=Bfe[ca](Er);Ph=jfe||Hfe;p3=!{toString:null}.propertyIsEnumerable("toString"),sU=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];g3=lU||Jfe});function sb(r){var e={};return Dc(r,function(t,n){e[t]=n,e[n]=t}),Yk(e)}function mU(r){var e={};return Dc(r,function(t,n){e[t]=n[1],e[n[0]]=n[1]}),Yk(e)}var v3=ge(()=>{p();$k()});function ld(r){var e=An();return e&&e[r]?e[r]:r===Gfe&&b3()?window:null}function b3(){return!!(typeof window===pt&&window)}function I3(){return!!(typeof document===pt&&document)}function hU(){return I3()?document:ld(Yfe)}function gU(){return typeof console!==$t?console:ld($fe)}function Th(){return!!(typeof JSON===pt&&JSON||ld(y3)!==null)}function ab(){return Th()?JSON||ld(y3):null}function kh(r){var e=Object[Mt].toString[ca](r),t=dl;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Wk]+"'":Th()&&(t=ab().stringify(r)),e+t}var Gfe,Yfe,$fe,y3,zk=ge(()=>{"use strict";p();ir();jk();qk();Gfe="window",Yfe="document",$fe="console",y3="JSON"});function zfe(){var r=ld("Microsoft");return r&&(Qk=r.ApplicationInsights),Qk}function S3(r){var e=Qk;return!e&&r.disableDbgExt!==!0&&(e=Qk||zfe()),e?e.ChromeDbgExt:null}var Qk,_3=ge(()=>{p();zk();Qk=null});function E3(r){return r?'"'+r[rw](/\"/g,dl)+'"':dl}function C3(r,e){var t=gU();if(t){var n="log";t[r]&&(n=r),nw(t[n])&&t[n](e)}}function eme(r){return r||new w3}function fl(r,e,t,n,i,o){o===void 0&&(o=!1),eme(r).throwInternal(e,t,n,i,o)}var Qfe,Xfe,Zfe,vU,w3,x3=ge(()=>{"use strict";p();dr();jk();_3();zk();$k();qk();Qfe="AI (Internal): ",Xfe="AI: ",Zfe="AITR_";vU=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[Vk]=e,o[ob]=(n?Xfe:Qfe)+e;var s=dl;Th()&&(s=ab().stringify(i));var a=(t?" message:"+E3(t):dl)+(i?" props:"+E3(s):dl);o[ob]+=a}return r.dataType="MessageData",r}(),w3=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;He(r,this,function(l){c(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[oU]=function(){return a},l.throwInternal=function(m,g,b,v,k){k===void 0&&(k=!1);var R=new vU(g,b,k,v);if(a)throw kh(R);var P=m===1?Bk:Hk;if(Jk(R[ob]))f("throw"+(m===1?"Critical":"Warning"),R);else{if(k){var D=+R[Vk];!n[D]&&i>=m&&(l[P](R[ob]),n[D]=!0)}else i>=m&&l[P](R[ob]);u(m,R)}},l[Hk]=function(m){C3("warn",m),f("warning",m)},l[Bk]=function(m){C3("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[a3]=u;function u(m,g){if(!d()){var b=!0,v=Zfe+g[Vk];if(n[v]?b=!1:n[v]=!0,b&&(m<=o&&(l.queue[ib](g),t++,f(m===1?"error":"warn",g)),t===s)){var k="Internal events throttle limit per PageView reached for this app.",R=new vU(23,k,!1);l.queue[ib](R),m===1?l[Bk](k):l[Hk](k)}}}function c(m){i=aw(m.loggingLevelConsole,0),o=aw(m.loggingLevelTelemetry,1),s=aw(m.maxMessageLimit,25),a=aw(m[oU],!1)}function d(){return t>=s}function f(m,g){var b=S3(e||{});b&&b[iU]&&b[iU](m,g)}})}return r.__ieDyn=1,r}()});var ua=ge(()=>{p();$k();v3();zk();ir();x3()});var lw,cw,uw,Xk,Nh,cd,Di,ml=ge(()=>{p();lw="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",cw="sampleRate",uw="ProcessLegacy",Xk="http.method",Nh="https://dc.services.visualstudio.com",cd="/v2/track",Di="not_specified"});var Rh,At,Ah,dw,hl,P3,Gi,ud,D3,pw,fw,Zk,Mh,da,Yi,$i,Oh,Tc,Lh,e0,t0,yU,Kh,mw,hw,Fh,lb,cb,Uh,bU,Wh,T3,k3,N3,R3,xo=ge(()=>{p();Rh="split",At="length",Ah="toLowerCase",dw="ingestionendpoint",hl="toString",P3="removeItem",Gi="name",ud="message",D3="count",pw="stringify",fw="pathname",Zk="indexOf",Mh="exceptions",da="parsedStack",Yi="properties",$i="measurements",Oh="sizeInBytes",Tc="typeName",Lh="severityLevel",e0="problemGroup",t0="isManual",yU="CreateFromInterface",Kh="assembly",mw="hasFullStack",hw="level",Fh="method",lb="fileName",cb="line",Uh="duration",bU="receivedResponse",Wh="substring",T3="sanitizeKeyAndAddUniqueness",k3="sanitizeException",N3="sanitizeProperties",R3="sanitizeMeasurements"});function r0(r){(isNaN(r)||r<0)&&(r=0),r=Math.round(r);var e=gw+r%1e3,t=gw+Math.floor(r/1e3)%60,n=gw+Math.floor(r/(1e3*60))%60,i=gw+Math.floor(r/(1e3*60*60))%24,o=Math.floor(r/(1e3*60*60*24));return e=e[At]===1?"00"+e:e[At]===2?"0"+e:e,t=t[At]<2?"0"+t:t,n=n[At]<2?"0"+n:n,i=i[At]<2?"0"+i:i,(o>0?o+".":gw)+i+":"+n+":"+t+"."+e}var gw,IU=ge(()=>{p();xo();gw=""});var ub,A3=ge(()=>{p();ua();ub=mU({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]})});var n0,pWe,M3=ge(()=>{p();ua();n0=sb({LocalStorage:0,SessionStorage:1}),pWe=sb({AI:0,AI_AND_W3C:1,W3C:2})});function O3(r){try{if(wh(An()))return null;var e=new Date()[hl](),t=ld(r===n0.LocalStorage?"localStorage":"sessionStorage");t.setItem(e,e);var n=t.getItem(e)!==e;if(t[P3](e),!n)return t}catch(i){}return null}function L3(){return i0()?O3(n0.SessionStorage):null}function i0(r){return(r||vw===void 0)&&(vw=!!O3(n0.SessionStorage)),vw}function SU(r,e){var t=L3();if(t!==null)try{return t.getItem(e)}catch(n){vw=!1,fl(r,2,2,"Browser failed read of session storage. "+sw(n),{exception:kh(n)})}return null}function o0(r,e,t){var n=L3();if(n!==null)try{return n.setItem(e,t),!0}catch(i){vw=!1,fl(r,2,4,"Browser failed write to session storage. "+sw(i),{exception:kh(i)})}return!1}var vw,K3=ge(()=>{p();ua();M3();xo();vw=void 0});function s0(r,e,t){var n=e[At],i=_U(r,e);if(i[At]!==n){for(var o=0,s=i;t[s]!==void 0;)o++,s=i[Wh](0,147)+EU(o);i=s}return i}function _U(r,e){var t;return e&&(e=pl(e[hl]()),e[At]>150&&(t=e[Wh](0,150),fl(r,2,57,"name is too long.  It has been truncated to 150 characters.",{name:e},!0))),t||e}function $r(r,e,t){t===void 0&&(t=1024);var n;return e&&(t=t||1024,e=pl(e),e.toString()[At]>t&&(n=e[hl]()[Wh](0,t),fl(r,2,61,"string value is too long. It has been truncated to "+t+" characters.",{value:e},!0))),n||e}function tf(r,e){return c0(r,e,2048,66)}function db(r,e){var t;return e&&e[At]>32768&&(t=e[Wh](0,32768),fl(r,2,56,"message is too long, it has been truncated to 32768 characters.",{message:e},!0)),t||e}function a0(r,e){var t;if(e){var n=""+e;n[At]>32768&&(t=n[Wh](0,32768),fl(r,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:e},!0))}return t||e}function zi(r,e){if(e){var t={};Dc(e,function(n,i){if(xh(i)&&Th())try{i=ab()[pw](i)}catch(o){fl(r,2,49,"custom property is not valid",{exception:o},!0)}i=$r(r,i,8192),n=s0(r,n,t),t[n]=i}),e=t}return e}function Qi(r,e){if(e){var t={};Dc(e,function(n,i){n=s0(r,n,t),t[n]=i}),e=t}return e}function l0(r,e){return e&&c0(r,e,128,69)[hl]()}function c0(r,e,t,n){var i;return e&&(e=pl(e),e[At]>t&&(i=e[Wh](0,t),fl(r,2,n,"input is too long, it has been truncated to "+t+" characters.",{data:e},!0))),i||e}function EU(r){var e="00"+r;return e.substr(e[At]-3)}var Zo,sme,gl=ge(()=>{p();ua();xo();sme=(Zo={MAX_NAME_LENGTH:150,MAX_ID_LENGTH:128,MAX_PROPERTY_LENGTH:8192,MAX_STRING_LENGTH:1024,MAX_URL_LENGTH:2048,MAX_MESSAGE_LENGTH:32768,MAX_EXCEPTION_LENGTH:32768},Zo[T3]=s0,Zo.sanitizeKey=_U,Zo.sanitizeString=$r,Zo.sanitizeUrl=tf,Zo.sanitizeMessage=db,Zo[k3]=a0,Zo[N3]=zi,Zo[R3]=Qi,Zo.sanitizeId=l0,Zo.sanitizeInput=c0,Zo.padNumber=EU,Zo.trim=pl,Zo)});function W3(r){var e=U3,t=ame,n=t[e];return F3.createElement?t[e]||(n=t[e]=F3.createElement("a")):n={host:V3(r,!0)},n.href=r,e++,e>=t[At]&&(e=0),U3=e,n}function V3(r,e){var t=j3(r,e)||"";if(t){var n=t.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[At]>3&&Xo(n[2])&&n[2][At]>0)return n[2]+(n[3]||"")}return t}function j3(r,e){var t=null;if(r){var n=r.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[At]>2&&Xo(n[2])&&n[2][At]>0&&(t=n[2]||"",e&&n[At]>2)){var i=(n[1]||"")[Ah](),o=n[3]||"";(i==="http"&&o===":80"||i==="https"&&o===":443")&&(o=""),t+=o}}return t}var F3,U3,ame,B3=ge(()=>{p();ua();xo();F3=hU()||{},U3=0,ame=[null,null,null,null,null]});function yw(r){return uU(lme,r[Ah]())!==-1}function H3(r,e,t,n){var i,o=n,s=n;if(e&&e[At]>0){var a=W3(e);if(i=a.host,!o)if(a[fw]!=null){var l=a.pathname[At]===0?"/":a[fw];l.charAt(0)!=="/"&&(l="/"+l),s=a[fw],o=$r(r,t?t+" "+l:l)}else o=$r(r,e)}else i=n,o=n;return{target:i,name:o,data:s}}var lme,CU=ge(()=>{p();ua();ml();gl();B3();xo();lme=[Nh+cd,"https://breeze.aimon.applicationinsights.io"+cd,"https://dc-int.services.visualstudio.com"+cd]});function wU(r){if(!r)return{};var e=r[Rh](cme),t=dU(e,function(i,o){var s=o[Rh](ume);if(s[At]===2){var a=s[0][Ah](),l=s[1];i[a]=l}return i},{});if(pU(t)[At]>0){if(t.endpointsuffix){var n=t.location?t.location+".":"";t[dw]=t[dw]||"https://"+n+"dc."+t.endpointsuffix}t[dw]=t[dw]||Nh}return t}var cme,ume,q3=ge(()=>{p();ua();ml();xo();cme=";",ume="="});var xU,J3=ge(()=>{p();ua();ml();xo();gl();xU=function(){function r(e,t,n){var i=this,o=this;o.ver=1,o.sampleRate=100,o.tags={},o[Gi]=$r(e,n)||Di,o.data=t,o.time=Gk(new Date),o.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return i.sampleRate===100?4:1},tags:1,data:1}}return r}()});var dd,G3=ge(()=>{p();ml();xo();gl();dd=function(){function r(e,t,n,i){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var o=this;o.ver=2,o[Gi]=$r(e,t)||Di,o[Yi]=zi(e,n),o[$i]=Qi(e,i)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Event",r.dataType="EventData",r}()});function kU(r,e){var t=r;return t&&!Xo(t)&&(JSON&&JSON[pw]?(t=JSON[pw](r),e&&(!t||t==="{}")&&(nw(r[hl])?t=r[hl]():t=""+r)):t=""+r+" - (Missing JSON.stringify)"),t||""}function X3(r,e){var t=r;return r&&(t&&!Xo(t)&&(t=r[TU]||r[Q3]||t),t&&!Xo(t)&&(t=kU(t,!0)),r.filename&&(t=t+" @"+(r.filename||"")+":"+(r.lineno||"?")+":"+(r.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&(t||"")[Zk](e)===-1&&(t=e+": "+t),t||""}function pme(r){try{if(xh(r))return"hasFullStack"in r&&"typeName"in r}catch(e){}return!1}function fme(r){try{if(xh(r))return"ver"in r&&"exceptions"in r&&"properties"in r}catch(e){}return!1}function $3(r){return r&&r.src&&Xo(r.src)&&r.obj&&Ph(r.obj)}function Vh(r){var e=r||"";Xo(e)||(Xo(e[es])?e=e[es]:e=""+e);var t=e[Rh](`
`);return{src:e,obj:t}}function mme(r){for(var e=[],t=r[Rh](`
`),n=0;n<t[At];n++){var i=t[n];t[n+1]&&(i+="@"+t[n+1],n++),e.push(i)}return{src:r,obj:e}}function Z3(r){var e=null;if(r)try{if(r[es])e=Vh(r[es]);else if(r[pb]&&r[pb][es])e=Vh(r[pb][es]);else if(r.exception&&r.exception[es])e=Vh(r.exception[es]);else if($3(r))e=r;else if($3(r[DU]))e=r[DU];else if(window&&window.opera&&r[TU])e=mme(r[ud]);else if(r.reason&&r.reason[es])e=Vh(r.reason[es]);else if(Xo(r))e=Vh(r);else{var t=r[TU]||r[Q3]||"";Xo(r[Y3])&&(t&&(t+=`
`),t+=" from "+r[Y3]),t&&(e=Vh(t))}}catch(n){e=Vh(n)}return e||{src:"",obj:null}}function hme(r){var e="";return r&&(r.obj?ow(r.obj,function(t){e+=t+`
`}):e=r.src||""),e}function gme(r){var e,t=r.obj;if(t&&t[At]>0){e=[];var n=0,i=0;ow(t,function(g){var b=g[hl]();if(NU.regex.test(b)){var v=new NU(b,n++);i+=v[Oh],e.push(v)}});var o=32*1024;if(i>o)for(var s=0,a=e[At]-1,l=0,u=s,c=a;s<a;){var d=e[s][Oh],f=e[a][Oh];if(l+=d+f,l>o){var m=c-u+1;e.splice(u,m);break}u=s,c=a,s++,a--}}return e}function u0(r){var e="";if(r&&(e=r.typeName||r[Gi]||"",!e))try{var t=/function (.{1,200})\(/,n=t.exec(r.constructor[hl]());e=n&&n[At]>1?n[1]:""}catch(i){}return e}function PU(r){if(r)try{if(!Xo(r)){var e=u0(r),t=kU(r,!1);return(!t||t==="{}")&&(r[pb]&&(r=r[pb],e=u0(r)),t=kU(r,!0)),t[Zk](e)!==0&&e!=="String"?e+":"+t:t}}catch(n){}return""+(r||"")}var dme,pb,es,DU,Y3,TU,Q3,jh,z3,NU,eq=ge(()=>{p();ir();ua();ml();xo();gl();dme="<no_method>",pb="error",es="stack",DU="stackDetails",Y3="errorSrc",TU="message",Q3="description";jh=function(){function r(e,t,n,i,o,s){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var a=this;a.ver=2,fme(t)?(a[Mh]=t[Mh]||[],a[Yi]=t[Yi],a[$i]=t[$i],t[Lh]&&(a[Lh]=t[Lh]),t.id&&(a.id=t.id),t[e0]&&(a[e0]=t[e0]),wh(t[t0])||(a[t0]=t[t0])):(n||(n={}),a[Mh]=[new z3(e,t,n)],a[Yi]=zi(e,n),a[$i]=Qi(e,i),o&&(a[Lh]=o),s&&(a.id=s))}return r.CreateAutoException=function(e,t,n,i,o,s,a,l){var u,c=u0(o||s||e);return u={},u[ud]=X3(e,c),u.url=t,u.lineNumber=n,u.columnNumber=i,u.error=PU(o||s||e),u.evt=PU(s||e),u[Tc]=c,u.stackDetails=Z3(a||o||s),u.errorSrc=l,u},r.CreateFromInterface=function(e,t,n,i){var o=t[Mh]&&Dh(t[Mh],function(a){return z3[yU](e,a)}),s=new r(e,_o(_o({},t),{exceptions:o}),n,i);return s},r.prototype.toInterface=function(){var e,t=this,n=t.exceptions,i=t.properties,o=t.measurements,s=t.severityLevel,a=t.problemGroup,l=t.id,u=t.isManual,c=n instanceof Array&&Dh(n,function(d){return d.toInterface()})||void 0;return e={ver:"4.0"},e[Mh]=c,e.severityLevel=s,e.properties=i,e.measurements=o,e.problemGroup=a,e.id=l,e.isManual=u,e},r.CreateSimpleException=function(e,t,n,i,o,s){var a;return{exceptions:[(a={},a[mw]=!0,a.message=e,a.stack=o,a.typeName=t,a)]}},r.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",r.dataType="ExceptionData",r.formatError=PU,r}(),z3=function(){function r(e,t,n){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var i=this;if(pme(t))i[Tc]=t[Tc],i[ud]=t[ud],i[es]=t[es],i[da]=t[da]||[],i[mw]=t[mw];else{var o=t,s=o&&o.evt;iw(o)||(o=o[pb]||s||o),i[Tc]=$r(e,u0(o))||Di,i[ud]=db(e,X3(t||o,i[Tc]))||Di;var a=t[DU]||Z3(t);i[da]=gme(a),Ph(i[da])&&Dh(i[da],function(l){return l[Kh]=$r(e,l[Kh])}),i[es]=a0(e,hme(a)),i.hasFullStack=Ph(i.parsedStack)&&i.parsedStack[At]>0,n&&(n[Tc]=n[Tc]||i[Tc])}}return r.prototype.toInterface=function(){var e,t=this,n=t[da]instanceof Array&&Dh(t[da],function(o){return o.toInterface()}),i=(e={id:t.id,outerId:t.outerId,typeName:t[Tc],message:t[ud],hasFullStack:t[mw],stack:t[es]},e[da]=n||void 0,e);return i},r.CreateFromInterface=function(e,t){var n=t[da]instanceof Array&&Dh(t[da],function(o){return NU[yU](o)})||t[da],i=new r(e,_o(_o({},t),{parsedStack:n}));return i},r}(),NU=function(){function r(e,t){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var n=this;if(n[Oh]=0,typeof e=="string"){var i=e;n[hw]=t,n[Fh]=dme,n[Kh]=pl(i),n[lb]="",n[cb]=0;var o=i.match(r.regex);o&&o[At]>=5&&(n[Fh]=pl(o[2])||n[Fh],n[lb]=pl(o[4]),n[cb]=parseInt(o[5])||0)}else n[hw]=e[hw],n[Fh]=e[Fh],n[Kh]=e[Kh],n[lb]=e[lb],n[cb]=e[cb],n[Oh]=0;n.sizeInBytes+=n.method[At],n.sizeInBytes+=n.fileName[At],n.sizeInBytes+=n.assembly[At],n[Oh]+=r.baseSize,n.sizeInBytes+=n.level.toString()[At],n.sizeInBytes+=n.line.toString()[At]}return r.CreateFromInterface=function(e){return new r(e,null)},r.prototype.toInterface=function(){var e=this;return{level:e[hw],method:e[Fh],assembly:e[Kh],fileName:e[lb],line:e[cb]}},r.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,r.baseSize=58,r}()});var tq,rq=ge(()=>{p();tq=function(){function r(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return r}()});var pd,nq=ge(()=>{p();ml();xo();rq();gl();pd=function(){function r(e,t,n,i,o,s,a,l,u){this.aiDataContract={ver:1,metrics:1,properties:0};var c=this;c.ver=2;var d=new tq;d[D3]=i>0?i:void 0,d.max=isNaN(s)||s===null?void 0:s,d.min=isNaN(o)||o===null?void 0:o,d[Gi]=$r(e,t)||Di,d.value=n,d.stdDev=isNaN(a)||a===null?void 0:a,c.metrics=[d],c[Yi]=zi(e,l),c[$i]=Qi(e,u)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",r.dataType="MetricData",r}()});var Bh,iq=ge(()=>{p();ml();IU();xo();gl();Bh=function(){function r(e,t,n,i,o,s,a){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var l=this;l.ver=2,l.id=l0(e,a),l.url=tf(e,n),l[Gi]=$r(e,t)||Di,isNaN(i)||(l[Uh]=r0(i)),l[Yi]=zi(e,o),l[$i]=Qi(e,s)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",r.dataType="PageviewData",r}()});var Hh,oq=ge(()=>{p();IU();CU();xo();gl();Hh=function(){function r(e,t,n,i,o,s,a,l,u,c,d,f){u===void 0&&(u="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var m=this;m.ver=2,m.id=t,m[Uh]=r0(o),m.success=s,m.resultCode=a+"",m.type=$r(e,u);var g=H3(e,n,l,i);m.data=tf(e,i)||g.data,m.target=$r(e,g.target),c&&(m.target="".concat(m.target," | ").concat(c)),m[Gi]=$r(e,g[Gi]),m[Yi]=zi(e,d),m[$i]=Qi(e,f)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",r.dataType="RemoteDependencyData",r}()});var qh,sq=ge(()=>{p();ml();xo();gl();qh=function(){function r(e,t,n,i,o){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var s=this;s.ver=2,t=t||Di,s[ud]=db(e,t),s[Yi]=zi(e,i),s[$i]=Qi(e,o),n&&(s[Lh]=n)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Message",r.dataType="MessageData",r}()});var Jh,aq=ge(()=>{p();ml();xo();gl();Jh=function(){function r(e,t,n,i,o,s,a){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var l=this;l.ver=2,l.url=tf(e,n),l[Gi]=$r(e,t)||Di,l[Yi]=zi(e,o),l[$i]=Qi(e,s),a&&(l.domProcessing=a.domProcessing,l[Uh]=a[Uh],l.networkConnect=a.networkConnect,l.perfTotal=a.perfTotal,l[bU]=a[bU],l.sentRequest=a.sentRequest)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",r.dataType="PageviewPerformanceData",r}()});var fd,lq=ge(()=>{p();fd=function(){function r(e,t){this.aiDataContract={baseType:1,baseData:1},this.baseType=e,this.baseData=t}return r}()});var RU,cq=ge(()=>{p();ua();RU=sb({Verbose:0,Information:1,Warning:2,Error:3,Critical:4})});function nf(r){var e="ai."+r+".";return function(t){return e+t}}var bw,Qn,d0,fb,AU,rf,Gh,Iw,Sw,MU=ge(()=>{p();ir();ua();bw=nf("application"),Qn=nf("device"),d0=nf("location"),fb=nf("operation"),AU=nf("session"),rf=nf("user"),Gh=nf("cloud"),Iw=nf("internal"),Sw=function(r){In(e,r);function e(){return r.call(this)||this}return e}(fU({applicationVersion:bw("ver"),applicationBuild:bw("build"),applicationTypeId:bw("typeId"),applicationId:bw("applicationId"),applicationLayer:bw("layer"),deviceId:Qn("id"),deviceIp:Qn("ip"),deviceLanguage:Qn("language"),deviceLocale:Qn("locale"),deviceModel:Qn("model"),deviceFriendlyName:Qn("friendlyName"),deviceNetwork:Qn("network"),deviceNetworkName:Qn("networkName"),deviceOEMName:Qn("oemName"),deviceOS:Qn("os"),deviceOSVersion:Qn("osVersion"),deviceRoleInstance:Qn("roleInstance"),deviceRoleName:Qn("roleName"),deviceScreenResolution:Qn("screenResolution"),deviceType:Qn("type"),deviceMachineName:Qn("machineName"),deviceVMName:Qn("vmName"),deviceBrowser:Qn("browser"),deviceBrowserVersion:Qn("browserVersion"),locationIp:d0("ip"),locationCountry:d0("country"),locationProvince:d0("province"),locationCity:d0("city"),operationId:fb("id"),operationName:fb("name"),operationParentId:fb("parentId"),operationRootId:fb("rootId"),operationSyntheticSource:fb("syntheticSource"),operationCorrelationVector:fb("correlationVector"),sessionId:AU("id"),sessionIsFirst:AU("isFirst"),sessionIsNew:AU("isNew"),userAccountAcquisitionDate:rf("accountAcquisitionDate"),userAccountId:rf("accountId"),userAgent:rf("userAgent"),userId:rf("id"),userStoreRegion:rf("storeRegion"),userAuthUserId:rf("authUserId"),userAnonymousUserAcquisitionDate:rf("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:rf("authUserAcquisitionDate"),cloudName:Gh("name"),cloudRole:Gh("role"),cloudRoleVer:Gh("roleVer"),cloudRoleInstance:Gh("roleInstance"),cloudEnvironment:Gh("environment"),cloudLocation:Gh("location"),cloudDeploymentUnit:Gh("deploymentUnit"),internalNodeName:Iw("nodeName"),internalSdkVersion:Iw("sdkVersion"),internalAgentVersion:Iw("agentVersion"),internalSnippet:Iw("snippet"),internalSdkSrc:Iw("sdkSrc")}))});var Xn,uq=ge(()=>{p();MU();Xn=new Sw});var dq,of=ge(()=>{p();CU();q3();A3();ml();J3();G3();eq();nq();iq();oq();sq();aq();lq();cq();MU();gl();uq();K3();dq="AppInsightsChannelPlugin"});var pq,Yh,OU,Xi,p0,f0,m0,Ti,h0,vl,fq,LU,mq,md,g0,mb,hb,KU,$h,hd,kc,_w,zh,FU,v0,gb,y0,hq,gd,UU,gq,b0,Zi,Nc,I0,WU,Qh,yl,S0,bl=ge(()=>{p();pq="initialize",Yh="name",OU="identifier",Xi="push",p0="isInitialized",f0="config",m0="logger",Ti="length",h0="time",vl="processNext",fq="getProcessTelContext",LU="getPlugin",mq="splice",md="teardown",g0="messageId",mb="message",hb="isAsync",KU="_doTeardown",$h="update",hd="getNext",kc="diagLog",_w="setNextPlugin",zh="createNew",FU="indexOf",v0="userAgent",gb="split",y0="nodeType",hq="apply",gd="replace",UU="enableDebugExceptions",gq="logInternalMessage",b0="toLowerCase",Zi="call",Nc="type",I0="handler",WU="isChildEvt",Qh="getCtx",yl="setCtx",S0="complete"});var Cr,Po,vq,_0,sf,yq,VU,E0,Ew,jU,Rc=ge(()=>{p();Cr="",Po="core",vq="disabled",_0="extensionConfig",sf="processTelemetry",yq="priority",VU="perfEvent",E0="errorToConsole",Ew="warnToConsole",jU="getPerfMgr"});function Tme(r){if(r){if(w0)return w0(r);var e=r[Ime]||r[Mt]||r[C0];if(e)return e}return null}function Il(r){return r===void 0||typeof r===$t}function Ut(r){return r===null||Il(r)}function Xh(r){return!!(r&&typeof r===pt)}function tn(r){return!!(r&&typeof r===Xr)}function Cw(r){var e=r;return e&&Zh(e)&&(e=e[gd](xme,function(t,n){return n.toUpperCase()}),e=e[gd](Pme,"_"),e=e[gd](Dme,function(t,n){return"_"+n})),e}function eo(r,e){if(r)for(var t in r)nr[Zi](r,t)&&e[Zi](r,t,r[t])}function vb(r,e){return r&&e?r[FU](e)!==-1:!1}function kme(r){return!!(r&&xq[Zi](r)==="[object Array]")}function Dq(r){return!!(r&&xq[Zi](r)==="[object Error]")}function Zh(r){return typeof r=="string"}function qU(r){return typeof r=="number"}function Tq(r){return typeof r=="boolean"}function _q(r){var e=!1;if(r&&typeof r=="object"){var t=w0?w0(r):Tme(r);t?(t[C0]&&nr[Zi](t,C0)&&(t=t[C0]),e=typeof t===Xr&&Pq[Zi](t)===wme):e=!0}return e}function JU(r){if(r)return Eme?r[Cq]():Nme(r)}function Nme(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[Ti]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function ki(r,e,t){var n=r[Ti];try{for(var i=0;i<n&&!(i in r&&e[Zi](t||r,r[i],i,r)===-1);i++);}catch(o){}}function x0(r,e,t){if(r){if(r[bq])return r[bq](e,t);var n=r[Ti],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function eg(r){var e=typeof r;if(e!==Xr&&(e!==pt||r===null)&&na("objKeys called on non-object"),!Eq&&Sq)return Sq(r);var t=[];for(var n in r)r&&nr[Zi](r,n)&&t[Xi](n);if(Eq)for(var i=BU[Ti],o=0;o<i;o++)r&&nr[Zi](r,BU[o])&&t[Xi](BU[o]);return t}function GU(r,e,t,n){if(Iq)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),Iq(r,e,i),!0}catch(o){}return!1}function Rme(r){return r}function vd(){var r=Date;return r.now?r.now():new r().getTime()}function pa(r){return Dq(r)?r[Yh]:Cr}function ww(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function xw(r,e){return Ut(r)?e:r}function $U(r){return!!r}function Ame(r,e){var t=null,n=null;return tn(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][hq](n,i)}}function zU(r,e,t,n,i){r&&e&&t&&(i!==!1||Il(r[e]))&&(r[e]=Ame(t,n))}function P0(r){return r&&Ja&&(r=Er(Ja({},r))),r}function D0(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[Ti],u=!1,c=1;for(l>0&&Tq(a)&&(u=a,a=s[c]||{},c++),Xh(a)||(a={});c<l;c++){var d=s[c],f=en(d),m=Xh(d);for(var g in d){var b=f&&g in d||m&&nr[Zi](d,g);if(b){var v=d[g],k=void 0;if(u&&v&&((k=en(v))||_q(v))){var R=a[g];k?en(R)||(R=[]):_q(R)||(R={}),v=D0(u,R,v)}v!==void 0&&(a[g]=v)}}}return a}var Cq,vme,yme,bq,bme,wq,Ime,C0,Iq,Sme,XVe,Sq,HU,ZVe,eje,tje,_me,Eme,Cme,xq,Pq,wme,xme,Pme,Dme,w0,en,Eq,BU,YU,Sl=ge(()=>{p();ir();bl();Rc();Cq="toISOString",vme="endsWith",yme="startsWith",bq="indexOf",bme="trim",wq="toString",Ime="__proto__",C0="constructor",Iq=Io,Sme=Er.freeze,XVe=Er.seal,Sq=Er.keys,HU=String[Mt],ZVe=HU[bme],eje=HU[vme],tje=HU[yme],_me=Date[Mt],Eme=_me[Cq],Cme=Array.isArray,xq=ra[wq],Pq=nr[wq],wme=Pq[Zi](Er),xme=/-([a-z])/g,Pme=/([^\w\d_$])/g,Dme=/^(\d+[\w\d_$])/,w0=Object.getPrototypeOf;en=Cme||kme;Eq=!{toString:null}.propertyIsEnumerable("toString"),BU=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];YU=Sme||Rme});function Aq(r,e){var t=!1;if(r){try{if(t=e in r,!t){var n=r[Mt];n&&(t=e in n)}}catch(o){}if(!t)try{var i=new r;t=!Il(i[e])}catch(o){}}return t}function Do(r){var e=An();return e&&e[r]?e[r]:r===kq&&rW()?window:null}function rW(){return!!(typeof window===pt&&window)}function bb(){return rW()?window:Do(kq)}function Mq(){return!!(typeof document===pt&&document)}function T0(){return Mq()?document:Do(Mme)}function nW(){return!!(typeof navigator===pt&&navigator)}function af(){return nW()?navigator:Do(Lme)}function iW(){return typeof console!==$t?console:Do(Kme)}function tg(){return!!(typeof JSON===pt&&JSON||Do(Nq)!==null)}function ts(){return tg()?JSON||Do(Nq):null}function oW(){return Do(Fme)}function sW(){return Do(Ume)}function aW(){var r=af();if(r&&(r[v0]!==XU||QU===null)){XU=r[v0];var e=(XU||Cr)[b0]();QU=vb(e,eW)||vb(e,tW)}return QU}function lW(r){if(r===void 0&&(r=null),!r){var e=af()||{};r=e?(e[v0]||Cr)[b0]():Cr}var t=(r||Cr)[b0]();if(vb(t,eW)){var n=T0()||{};return Math.max(parseInt(t[gb](eW)[1]),n[Ome]||0)}else if(vb(t,tW)){var i=parseInt(t[gb](tW)[1]);if(i)return i+4}return null}function Ln(r){var e=Object[Mt].toString[Zi](r),t=Cr;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Yh]+"'":tg()&&(t=ts().stringify(r)),e+t}function Ib(){return ZU===null&&(ZU=nW()&&!!af().sendBeacon),ZU}function k0(r){var e=!1;try{e=!!Do("fetch");var t=Do("Request");e&&r&&t&&(e=Aq(t,"keepalive"))}catch(n){}return e}function N0(){return yb===null&&(yb=typeof XDomainRequest!==$t,yb&&Pw()&&(yb=yb&&!Aq(Do(Rq),"withCredentials"))),yb}function Pw(){var r=!1;try{var e=Do(Rq);r=!!e}catch(t){}return r}var kq,Mme,Ome,Lme,Kme,Nq,Fme,Ume,eW,tW,Rq,QU,XU,yb,ZU,rg=ge(()=>{"use strict";p();ir();bl();Sl();Rc();kq="window",Mme="document",Ome="documentMode",Lme="navigator",Kme="console",Nq="JSON",Fme="crypto",Ume="msCrypto",eW="msie",tW="trident/",Rq="XMLHttpRequest",QU=null,XU=null,yb=null,ZU=null});function Wme(){var r=Do("Microsoft");return r&&(R0=r.ApplicationInsights),R0}function Oq(r){var e=R0;return!e&&r.disableDbgExt!==!0&&(e=R0||Wme()),e?e.ChromeDbgExt:null}var R0,Lq=ge(()=>{p();rg();R0=null});function Kq(r){return r?'"'+r[gd](/\"/g,Cr)+'"':Cr}function Fq(r,e){var t=iW();if(t){var n="log";t[r]&&(n=r),tn(t[n])&&t[n](e)}}function Dw(r,e){return(r||{})[m0]||new uW(e)}function Uq(r){return r||new uW}function mt(r,e,t,n,i,o){o===void 0&&(o=!1),Uq(r).throwInternal(e,t,n,i,o)}function Tw(r,e){Uq(r)[Ew](e)}var Vme,jme,Bme,cW,uW,A0=ge(()=>{"use strict";p();dr();bl();Lq();rg();Sl();Rc();Vme="AI (Internal): ",jme="AI: ",Bme="AITR_";cW=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[g0]=e,o[mb]=(n?jme:Vme)+e;var s=Cr;tg()&&(s=ts().stringify(i));var a=(t?" message:"+Kq(t):Cr)+(i?" props:"+Kq(s):Cr);o[mb]+=a}return r.dataType="MessageData",r}();uW=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;He(r,this,function(l){c(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[UU]=function(){return a},l.throwInternal=function(m,g,b,v,k){k===void 0&&(k=!1);var R=new cW(g,b,k,v);if(a)throw Ln(R);var P=m===1?E0:Ew;if(Il(R[mb]))f("throw"+(m===1?"Critical":"Warning"),R);else{if(k){var D=+R[g0];!n[D]&&i>=m&&(l[P](R[mb]),n[D]=!0)}else i>=m&&l[P](R[mb]);u(m,R)}},l[Ew]=function(m){Fq("warn",m),f("warning",m)},l[E0]=function(m){Fq("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[gq]=u;function u(m,g){if(!d()){var b=!0,v=Bme+g[g0];if(n[v]?b=!1:n[v]=!0,b&&(m<=o&&(l.queue[Xi](g),t++,f(m===1?"error":"warn",g)),t===s)){var k="Internal events throttle limit per PageView reached for this app.",R=new cW(23,k,!1);l.queue[Xi](R),m===1?l[E0](k):l[Ew](k)}}}function c(m){i=xw(m.loggingLevelConsole,0),o=xw(m.loggingLevelTelemetry,1),s=xw(m.maxMessageLimit,25),a=xw(m[UU],!1)}function d(){return t>=s}function f(m,g){var b=Oq(e||{});b&&b[kc]&&b[kc](m,g)}})}return r.__ieDyn=1,r}()});function Wq(r,e,t,n,i){if(r){var o=r;if(o[jU]&&(o=o[jU]()),o){var s=void 0,a=o[Qh](dW);try{if(s=o.create(e(),n,i),s){if(a&&s[yl]&&(s[yl](M0[pW],a),a[Qh]&&a[yl])){var l=a[Qh](M0[kw]);l||(l=[],a[yl](M0[kw],l)),l[Xi](s)}return o[yl](dW,s),t(s)}}catch(u){s&&s[yl]&&s[yl]("exception",u)}finally{s&&o.fire(s),o[yl](dW,a)}}}return t()}var Sb,pW,kw,M0,wje,dW,Vq=ge(()=>{p();dr();bl();Sl();Rc();Sb="ctx",pW="ParentContextKey",kw="ChildrenContextKey",M0=function(){function r(e,t,n){var i=this,o=!1;if(i.start=vd(),i[Yh]=e,i[hb]=n,i[WU]=function(){return!1},tn(t)){var s;o=GU(i,"payload",function(){return!s&&tn(t)&&(s=t(),t=null),s})}i[Qh]=function(a){return a?a===r[pW]||a===r[kw]?i[a]:(i[Sb]||{})[a]:null},i[yl]=function(a,l){if(a)if(a===r[pW])i[a]||(i[WU]=function(){return!0}),i[a]=l;else if(a===r[kw])i[a]=l;else{var u=i[Sb]=i[Sb]||{};u[a]=l}},i[S0]=function(){var a=0,l=i[Qh](r[kw]);if(en(l))for(var u=0;u<l[Ti];u++){var c=l[u];c&&(a+=c[h0])}i[h0]=vd()-i.start,i.exTime=i[h0]-a,i[S0]=function(){},!o&&tn(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),wje=function(){function r(e){this.ctx={},He(r,this,function(t){t.create=function(n,i,o){return new M0(n,i,o)},t.fire=function(n){n&&(n[S0](),e&&tn(e[VU])&&e[VU](n))},t[yl]=function(n,i){if(n){var o=t[Sb]=t[Sb]||{};o[n]=i}},t[Qh]=function(n){return(t[Sb]||{})[n]}})}return r.__ieDyn=1,r}(),dW="CoreUtils.doPerf"});function Hme(r){r<0&&(r>>>=0),Nw=123456789+r&ng,Rw=987654321-r&ng,Hq=!0}function qme(){try{var r=vd()&2147483647;Hme((Math.random()*Bq^r)+r)}catch(e){}}function jq(r){var e=0,t=oW()||sW();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&ng),e===0&&aW()&&(Hq||qme(),e=Jme()&ng),e===0&&(e=Math.floor(Bq*Math.random()|0)),r||(e>>>=0),e}function Jme(r){Rw=36969*(Rw&65535)+(Rw>>16)&ng,Nw=18e3*(Nw&65535)+(Nw>>16)&ng;var e=(Rw<<16)+(Nw&65535)>>>0&ng|0;return r||(e>>>=0),e}function qq(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=jq()>>>0,n=0,i=Cr;i[Ti]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(jq()<<2&4294967295|t&3)>>>0,n=0);return i}var Bq,ng,Hq,Nw,Rw,Jq=ge(()=>{p();bl();rg();Sl();Rc();Bq=4294967296,ng=4294967295,Hq=!1,Nw=123456789,Rw=987654321});function $me(r,e,t){if(Gq)try{return Gq(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function $q(r){return r[y0]===1||r[y0]===9||!+r[y0]}function zme(r,e){var t=e[r.id];if(!t){t={};try{$q(e)&&($me(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function yd(r,e){return e===void 0&&(e=!1),Cw(r+Yme+++(e?"."+Yq:Cr)+Gme)}function O0(r){var e={id:yd("_aiData-"+(r||Cr)+"."+Yq),accept:function(t){return $q(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[Cw(n)]:(o&&(s=zme(e,t),s[Cw(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var Gq,Yq,Gme,Yme,L0=ge(()=>{p();ir();bl();Sl();Rc();Jq();Gq=Io,Yq="2.8.11",Gme="."+qq(6),Yme=0});function eJ(r){return r&&r[gd]?r[gd](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Cr):r}function mW(r,e){var t;if(e){var n=Cr;en(e)?(n=Cr,ki(e,function(o){o=eJ(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=eJ(e),n&&(n[0]!=="."&&(n="."+n),r=(r||Cr)+n)}var i=ehe.exec(r||Cr)||[];return t={},t[Nc]=i[1],t.ns=(i[2]||Cr).replace(Qme,".").replace(Xme,Cr)[gb](".").sort().join("."),t}function nJ(r,e,t){t===void 0&&(t=!0);var n=K0.get(r,fW,{},t),i=n[e];return i||(i=n[e]=[]),i}function iJ(r,e,t,n){r&&e&&e[Nc]&&(r[Zq]?r[Zq](e[Nc],t,n):r[Xq]&&r[Xq](rJ+e[Nc],t))}function the(r,e,t,n){var i=!1;return r&&e&&e[Nc]&&t&&(r[Qq]?(r[Qq](e[Nc],t,n),i=!0):r[zq]&&(r[zq](rJ+e[Nc],t),i=!0)),i}function tJ(r,e,t,n){for(var i=e[Ti];i--;){var o=e[i];o&&(!t.ns||t.ns===o.evtName.ns)&&(!n||n(o))&&(iJ(r,o.evtName,o[I0],o.capture),e[mq](i,1))}}function rhe(r,e,t){if(e[Nc])tJ(r,nJ(r,e[Nc]),e,t);else{var n=K0.get(r,fW,{});eo(n,function(i,o){tJ(r,o,e,t)}),eg(n)[Ti]===0&&K0.kill(r,fW)}}function Aw(r,e){var t;return e?(en(e)?t=[r].concat(e):t=[r,e],t=mW("xx",t).ns[gb](".")):t=r,t}function F0(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=mW(e,n);if(s=the(r,a,t,i),s&&K0.accept(r)){var l=(o={guid:Zme++,evtName:a},o[I0]=t,o.capture=i,o);nJ(r,a.type)[Xi](l)}}catch(u){}return s}function hW(r,e,t,n,i){if(i===void 0&&(i=!1),r)try{var o=mW(e,n),s=!1;rhe(r,o,function(a){return o.ns&&!t||a[I0]===t?(s=!0,!0):!1}),s||iJ(r,o,t,i)}catch(a){}}var rJ,zq,Qq,Xq,Zq,fW,qje,Jje,Qme,Xme,Zme,K0,ehe,oJ=ge(()=>{p();bl();L0();Sl();Rc();rJ="on",zq="attachEvent",Qq="addEventListener",Xq="detachEvent",Zq="removeEventListener",fW="events",qje=yd("aiEvtPageHide"),Jje=yd("aiEvtPageShow"),Qme=/\.[\.]+/g,Xme=/[\.]+$/,Zme=1,K0=O0("events"),ehe=/^([^.]*)(?:\.(.+)|)/});function U0(r){return nhe.get(r,"state",{},!0)}var nhe,sJ=ge(()=>{"use strict";p();L0();nhe=O0("plugin")});function she(r,e,t){for(;r;){if(r[LU]()===t)return r;r=r[hd]()}return Ow([t],e[f0]||{},e)}function gW(r,e,t,n){var i=null,o=[];n!==null&&(i=n?she(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return Dw(t,e)},getCfg:function(){return e},getExtCfg:u,getConfig:c,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:d,onComplete:a}};function a(f,m){for(var g=[],b=2;b<arguments.length;b++)g[b-2]=arguments[b];f&&o[Xi]({func:f,self:Il(m)?s.ctx:m,args:g})}function l(){var f=i;if(i=f?f[hd]():null,!f){var m=o;m&&m[Ti]>0&&(ki(m,function(g){try{g.func[Zi](g.self,g.args)}catch(b){mt(t[m0],2,73,"Unexpected Exception during onComplete - "+Ln(b))}}),o=[])}return f}function u(f,m,g){m===void 0&&(m={}),g===void 0&&(g=0);var b;if(e){var v=e[_0];v&&f&&(b=v[f])}if(!b)b=m;else if(Xh(m)&&g!==0){var k=D0(!0,m,b);e&&g===2&&eo(m,function(R){if(Ut(k[R])){var P=e[R];Ut(P)||(k[R]=P)}}),b=k}return b}function c(f,m,g){g===void 0&&(g=!1);var b,v=u(f,null);return v&&!Ut(v[m])?b=v[m]:e&&!Ut(e[m])&&(b=e[m]),Ut(b)?g:b}function d(f){for(var m;m=s._next();){var g=m[LU]();g&&f(g)}}return s}function Mw(r,e,t,n){var i=gW(r,e,t,n),o=i.ctx;function s(l){var u=i._next();return u&&u[sf](l,o),!u}function a(l,u){return l===void 0&&(l=null),en(l)&&(l=Ow(l,e,t,u)),Mw(l||o[hd](),e,t,u)}return o[vl]=s,o[zh]=a,o}function vW(r,e,t){var n=e[f0]||{},i=gW(r,n,e,t),o=i.ctx;function s(l){var u=i._next();return u&&u.unload(o,l),!u}function a(l,u){return l===void 0&&(l=null),en(l)&&(l=Ow(l,n,e,u)),vW(l||o[hd](),e,u)}return o[vl]=s,o[zh]=a,o}function yW(r,e,t){var n=e[f0]||{},i=gW(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(u){tn(u[$h])&&u[$h](o,l)})}function a(l,u){return l===void 0&&(l=null),en(l)&&(l=Ow(l,n,e,u)),yW(l||o[hd](),e,u)}return o[vl]=s,o[zh]=a,o}function Ow(r,e,t,n){var i=null,o=!n;if(en(r)&&r[Ti]>0){var s=null;ki(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&tn(a[sf])){var l=ahe(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Ow([n],e,t):i}function ahe(r,e,t){var n=null,i=tn(r[sf]),o=tn(r[_w]),s;r?s=r[OU]+"-"+r[yq]+"-"+cJ++:s="Unknown-0-"+cJ++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:c,unload:d,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&tn(r[lJ])&&(m=r[lJ]()),m||(m=Mw(a,e,t)),m}function u(m,g,b,v,k){var R=!1,P=r?r[OU]:ohe,D=m[aJ];return D||(D=m[aJ]={}),m.setNext(n),r&&Wq(m[Po](),function(){return P+":"+b},function(){D[s]=!0;try{var K=n?n._id:Cr;K&&(D[K]=!1),R=g(m)}catch(B){var L=n?D[n._id]:!0;L&&(R=!0),(!n||!L)&&mt(m[kc](),1,73,"Plugin ["+P+"] failed during "+b+" - "+Ln(B)+", run flags: "+Ln(D))}},v,k),R}function c(m,g){g=g||l();function b(v){if(!r||!i)return!1;var k=U0(r);return k[md]||k[vq]?!1:(o&&r[_w](n),r[sf](m,v),!0)}u(g,b,"processTelemetry",function(){return{item:m}},!m.sync)||g[vl](m)}function d(m,g){function b(){var v=!1;if(r){var k=U0(r),R=r[Po]||k[Po];r&&(!R||R===m.core())&&!k[md]&&(k[Po]=null,k[md]=!0,k[p0]=!1,r[md]&&r[md](m,g)===!0&&(v=!0))}return v}u(m,b,"unload",function(){},g[hb])||m[vl](g)}function f(m,g){function b(){var v=!1;if(r){var k=U0(r),R=r[Po]||k[Po];r&&(!R||R===m.core())&&!k[md]&&r[$h]&&r[$h](m,g)===!0&&(v=!0)}return v}u(m,b,"update",function(){},!1)||m[vl](g)}return YU(a)}var ohe,aJ,lJ,cJ,uJ=ge(()=>{"use strict";p();bl();A0();rg();Sl();Rc();Vq();sJ();ohe="TelemetryPluginChain",aJ="_hasRun",lJ="_getTelCtx",cJ=0});function dJ(){var r=[];function e(n){n&&r[Xi](n)}function t(n,i){ki(r,function(o){try{o(n,i)}catch(s){mt(n[kc](),2,73,"Unexpected error calling unload handler - "+Ln(s))}}),r=[]}return{add:e,run:t}}var pJ=ge(()=>{p();bl();A0();rg();Sl()});var lf,bW,fJ=ge(()=>{"use strict";p();dr();bl();Sl();Rc();uJ();pJ();lf="getPlugin",bW=function(){function r(){var e=this,t,n,i,o,s;u(),He(r,e,function(c){c[pq]=function(d,f,m,g){l(d,f,g),t=!0},c[md]=function(d,f){var m,g=c[Po];if(!g||d&&g!==d[Po]())return;var b,v=!1,k=d||vW(null,g,i&&i[lf]?i[lf]():i),R=f||(m={reason:0},m[hb]=!1,m);function P(){if(!v){v=!0,o.run(k,f);var D=s;s=[],ki(D,function(K){K.rm()}),b===!0&&k[vl](R),u()}}return!c[KU]||c[KU](k,R,P)!==!0?P():b=!0,b},c[$h]=function(d,f){var m=c[Po];if(!m||d&&m!==d[Po]())return;var g,b=!1,v=d||yW(null,m,i&&i[lf]?i[lf]():i),k=f||{reason:0};function R(){b||(b=!0,l(v.getCfg(),v.core(),v[hd]()))}return!c._doUpdate||c._doUpdate(v,k,R)!==!0?R():g=!0,g},c._addHook=function(d){d&&(en(d)?s=s.concat(d):s[Xi](d))},zU(c,"_addUnloadCb",function(){return o},"add")}),e[kc]=function(c){return a(c)[kc]()},e[p0]=function(){return t},e.setInitialized=function(c){t=c},e[_w]=function(c){i=c},e[vl]=function(c,d){d?d[vl](c):i&&tn(i[sf])&&i[sf](c,null)},e._getTelCtx=a;function a(c){c===void 0&&(c=null);var d=c;if(!d){var f=n||Mw(null,{},e[Po]);i&&i[lf]?d=f[zh](null,i[lf]):d=f[zh](null,i)}return d}function l(c,d,f){c&&ww(c,_0,[],null,Ut),!f&&d&&(f=d[fq]()[hd]());var m=i;i&&i[lf]&&(m=i[lf]()),e[Po]=d,n=Mw(f,c,d,m)}function u(){t=!1,e[Po]=null,n=null,i=null,s=[],o=dJ()}}return r.__ieDyn=1,r}()});var ig=ge(()=>{p();fJ();Sl();oJ();rg();A0();L0()});var cf,mJ=ge(()=>{p();cf="duration"});var Kn,W0,rs,Ac,og,Tt,uf,df,fa,pf,bd,Lw,sg,ff,Id,Kw,mf,ag,hf,lg,_b,gf,Eb,Sd,V0,cg,to,IW,j0,Cb,Br,ug,SW,_W,Fw,vf,EW,wb,CW,B0,H0,xb,wW,hJ,ma,q0,Uw,Ww,gJ,Pb,J0,xW,PW,DW,G0,vJ,_d=ge(()=>{p();Kn="tags",W0="deviceType",rs="data",Ac="name",og="traceID",Tt="length",uf="stringify",df="measurements",fa="dataType",pf="envelopeType",bd="toString",Lw="onLine",sg="enqueue",ff="count",Id="push",Kw="emitLineDelimitedJson",mf="clear",ag="batchPayloads",hf="markAsSent",lg="clearSent",_b="BUFFER_KEY",gf="SENT_BUFFER_KEY",Eb="MAX_BUFFER_SIZE",Sd="namePrefix",V0="maxBatchSizeInBytes",cg="triggerSend",to="diagLog",IW="onunloadDisableBeacon",j0="isBeaconApiDisabled",Cb="_sender",Br="_senderConfig",ug="_buffer",SW="enableSessionStorageBuffer",_W="samplingPercentage",Fw="instrumentationKey",vf="endpointUrl",EW="customHeaders",wb="disableXhr",CW="onunloadDisableFetch",B0="disableTelemetry",H0="baseType",xb="sampleRate",wW="convertUndefined",hJ="_xhrReadyStateChange",ma="_onError",q0="_onPartialSuccess",Uw="_onSuccess",Ww="itemsAccepted",gJ="itemsReceived",Pb="isRetryDisabled",J0="setRequestHeader",xW="maxBatchInterval",PW="eventsSendRequest",DW="disableInstrumentationKeyValidation",G0="getSamplingScore",vJ="getHashCodeScore"});function Fn(r,e,t){return ww(r,e,t,$U)}function lhe(r,e,t){var n=t[Kn]=t[Kn]||{},i=e.ext=e.ext||{},o=e[Kn]=e[Kn]||[],s=i.user;s&&(Fn(n,Xn.userAuthUserId,s.authId),Fn(n,Xn.userId,s.id||s.localId));var a=i.app;a&&Fn(n,Xn.sessionId,a.sesId);var l=i.device;l&&(Fn(n,Xn.deviceId,l.id||l.localId),Fn(n,Xn[W0],l.deviceClass),Fn(n,Xn.deviceIp,l.ip),Fn(n,Xn.deviceModel,l.model),Fn(n,Xn[W0],l[W0]));var u=e.ext.web;if(u){Fn(n,Xn.deviceLanguage,u.browserLang),Fn(n,Xn.deviceBrowserVersion,u.browserVer),Fn(n,Xn.deviceBrowser,u.browser);var c=t[rs]=t[rs]||{},d=c[rn]=c[rn]||{},f=d[hi]=d[hi]||{};Fn(f,"domain",u.domain),Fn(f,"isManual",u.isManual?yJ:null),Fn(f,"screenRes",u.screenRes),Fn(f,"userConsent",u.userConsent?yJ:null)}var m=i.os;m&&Fn(n,Xn.deviceOS,m[Ac]);var g=i.trace;g&&(Fn(n,Xn.operationParentId,g.parentID),Fn(n,Xn.operationName,$r(r,g[Ac])),Fn(n,Xn.operationId,g[og]));for(var b={},v=o[Tt]-1;v>=0;v--){var k=o[v];eo(k,function(P,D){b[P]=D}),o.splice(v,1)}eo(o,function(P,D){b[P]=D});var R=_o(_o({},n),b);R[Xn.internalSdkVersion]||(R[Xn.internalSdkVersion]="javascript:".concat(che.Version)),t[Kn]=P0(R)}function yf(r,e,t){Ut(r)||eo(r,function(n,i){qU(i)?t[n]=i:Zh(i)?e[n]=i:tg()&&(e[n]=ts()[uf](i))})}function dg(r,e){Ut(r)||eo(r,function(t,n){r[t]=n||e})}function pg(r,e,t,n){var i=new xU(r,n,e);Fn(i,"sampleRate",t[cw]),(t[rn]||{}).startTime&&(i.time=JU(t[rn].startTime)),i.iKey=t.iKey;var o=t.iKey.replace(/-/g,"");return i[Ac]=i[Ac].replace("{0}",o),lhe(r,t,i),t[Kn]=t[Kn]||[],P0(i)}function fg(r,e){Ut(e[rn])&&mt(r,1,46,"telemetryItem.baseData cannot be null.")}function bJ(r,e,t){fg(r,e);var n=e[rn][df]||{},i=e[rn][hi]||{};yf(e[rs],i,n),Ut(t)||dg(i,t);var o=e[rn];if(Ut(o))return Tw(r,"Invalid input for dependency data"),null;var s=o[hi]&&o[hi][Xk]?o[hi][Xk]:"GET",a=new Hh(r,o.id,o.target,o[Ac],o[cf],o.success,o.responseCode,s,o.type,o.correlationContext,i,n),l=new fd(Hh[fa],a);return pg(r,Hh[pf],e,l)}function kW(r,e,t){fg(r,e);var n={},i={};e[TW]!==dd[fa]&&(n.baseTypeSource=e[TW]),e[TW]===dd[fa]?(n=e[rn][hi]||{},i=e[rn][df]||{}):e[rn]&&yf(e[rn],n,i),yf(e[rs],n,i),Ut(t)||dg(n,t);var o=e[rn][Ac],s=new dd(r,o,n,i),a=new fd(dd[fa],s);return pg(r,dd[pf],e,a)}function IJ(r,e,t){fg(r,e);var n=e[rn][df]||{},i=e[rn][hi]||{};yf(e[rs],i,n),Ut(t)||dg(i,t);var o=e[rn],s=jh.CreateFromInterface(r,o,i,n),a=new fd(jh[fa],s);return pg(r,jh[pf],e,a)}function SJ(r,e,t){fg(r,e);var n=e[rn],i=n[hi]||{},o=n[df]||{};yf(e[rs],i,o),Ut(t)||dg(i,t);var s=new pd(r,n[Ac],n.average,n.sampleCount,n.min,n.max,n.stdDev,i,o),a=new fd(pd[fa],s);return pg(r,pd[pf],e,a)}function _J(r,e,t){fg(r,e);var n,i=e[rn];!Ut(i)&&!Ut(i[hi])&&!Ut(i[hi][cf])?(n=i[hi][cf],delete i[hi][cf]):!Ut(e[rs])&&!Ut(e[rs][cf])&&(n=e[rs][cf],delete e[rs][cf]);var o=e[rn],s;((e.ext||{}).trace||{})[og]&&(s=e.ext.trace[og]);var a=o.id||s,l=o[Ac],u=o.uri,c=o[hi]||{},d=o[df]||{};if(Ut(o.refUri)||(c.refUri=o.refUri),Ut(o.pageType)||(c.pageType=o.pageType),Ut(o.isLoggedIn)||(c.isLoggedIn=o.isLoggedIn[bd]()),!Ut(o[hi])){var f=o[hi];eo(f,function(b,v){c[b]=v})}yf(e[rs],c,d),Ut(t)||dg(c,t);var m=new Bh(r,l,u,n,c,d,a),g=new fd(Bh[fa],m);return pg(r,Bh[pf],e,g)}function EJ(r,e,t){fg(r,e);var n=e[rn],i=n[Ac],o=n.uri||n.url,s=n[hi]||{},a=n[df]||{};yf(e[rs],s,a),Ut(t)||dg(s,t);var l=new Jh(r,i,o,void 0,s,a,n),u=new fd(Jh[fa],l);return pg(r,Jh[pf],e,u)}function CJ(r,e,t){fg(r,e);var n=e[rn].message,i=e[rn].severityLevel,o=e[rn][hi]||{},s=e[rn][df]||{};yf(e[rs],o,s),Ut(t)||dg(o,t);var a=new qh(r,n,i,o,s),l=new fd(qh[fa],a);return pg(r,qh[pf],e,l)}var TW,rn,hi,yJ,che,wJ=ge(()=>{p();ir();of();ig();mJ();_d();TW="baseType",rn="baseData",hi="properties",yJ="true";che={Version:"2.8.11"}});function xJ(r,e){hW(r,null,null,e)}function PJ(r){var e=T0(),t=af(),n=!1,i=!0,o=Aw(yd("OfflineListener"),r);try{if(a(bb())&&(n=!0),e){var s=e.body||e;s.ononline&&a(s)&&(n=!0)}n&&t&&!Ut(t[Lw])&&(i=t[Lw])}catch(f){n=!1}function a(f){var m=!1;return f&&(m=F0(f,"online",l,o),m&&F0(f,"offline",u,o)),m}function l(){i=!0}function u(){i=!1}function c(){var f=!0;return n?f=i:t&&!Ut(t[Lw])&&(f=t[Lw]),f}function d(){var f=bb();if(f&&n){if(xJ(f,o),e){var m=e.body||e;Il(m.ononline)||xJ(m,o)}n=!1}}return{isOnline:c,isListening:function(){return n},unload:d}}var DJ=ge(()=>{p();ig();_d()});var TJ,kJ,NJ,RJ=ge(()=>{p();ir();dr();of();ig();_d();TJ=function(){function r(e,t){var n=[],i=!1;this._get=function(){return n},this._set=function(o){return n=o,n},He(r,this,function(o){o[sg]=function(s){if(o[ff]()>=t.eventsLimitInMem()){i||(mt(e,2,105,"Maximum in-memory buffer size reached: "+o[ff](),!0),i=!0);return}n[Id](s)},o[ff]=function(){return n[Tt]},o.size=function(){for(var s=n[Tt],a=0;a<n[Tt];a++)s+=n[a][Tt];return t[Kw]()||(s+=2),s},o[mf]=function(){n=[],i=!1},o.getItems=function(){return n.slice(0)},o[ag]=function(s){if(s&&s[Tt]>0){var a=t[Kw]()?s.join(`
`):"["+s.join(",")+"]";return a}return null}})}return r.__ieDyn=1,r}(),kJ=function(r){In(e,r);function e(t,n){var i=r.call(this,t,n)||this;return He(e,i,function(o,s){o[hf]=function(a){s[mf]()},o[lg]=function(a){}}),i}return e.__ieDyn=1,e}(TJ),NJ=function(r){In(e,r);function e(t,n){var i=r.call(this,t,n)||this,o=!1;return He(e,i,function(s,a){var l=f(e[_b]),u=f(e[gf]),c=s._set(l.concat(u));c[Tt]>e[Eb]&&(c[Tt]=e[Eb]),m(e[gf],[]),m(e[_b],c),s[sg]=function(g){if(s[ff]()>=e[Eb]){o||(mt(t,2,67,"Maximum buffer size reached: "+s[ff](),!0),o=!0);return}a[sg](g),m(e[_b],s._get())},s[mf]=function(){a[mf](),m(e[_b],s._get()),m(e[gf],[]),o=!1},s[hf]=function(g){m(e[_b],s._set(d(g,s._get())));var b=f(e[gf]);b instanceof Array&&g instanceof Array&&(b=b.concat(g),b[Tt]>e[Eb]&&(mt(t,1,67,"Sent buffer reached its maximum size: "+b[Tt],!0),b[Tt]=e[Eb]),m(e[gf],b))},s[lg]=function(g){var b=f(e[gf]);b=d(g,b),m(e[gf],b)};function d(g,b){var v=[];return ki(b,function(k){!tn(k)&&x0(g,k)===-1&&v[Id](k)}),v}function f(g){var b=g;try{b=n[Sd]&&n[Sd]()?n[Sd]()+"_"+b:b;var v=SU(t,b);if(v){var k=ts().parse(v);if(Zh(k)&&(k=ts().parse(k)),k&&en(k))return k}}catch(R){mt(t,1,42," storage key: "+b+", "+pa(R),{exception:Ln(R)})}return[]}function m(g,b){var v=g;try{v=n[Sd]&&n[Sd]()?n[Sd]()+"_"+v:v;var k=JSON[uf](b);o0(t,v,k)}catch(R){o0(t,v,JSON[uf]([])),mt(t,2,41," storage key: "+v+", "+pa(R)+". Buffer cleared",{exception:Ln(R)})}}}),i}return e.BUFFER_KEY="AI_buffer",e.SENT_BUFFER_KEY="AI_sentBuffer",e.MAX_BUFFER_SIZE=2e3,e}(TJ)});var AJ,MJ=ge(()=>{p();dr();ig();_d();AJ=function(){function r(e){He(r,this,function(t){t.serialize=function(s){var a=n(s,"root");try{return ts()[uf](a)}catch(l){mt(e,1,48,l&&tn(l[bd])?l[bd]():"Error serializing object",null,!0)}};function n(s,a){var l="__aiCircularRefCheck",u={};if(!s)return mt(e,1,48,"cannot serialize object because it is null or undefined",{name:a},!0),u;if(s[l])return mt(e,2,50,"Circular reference detected while serializing object",{name:a},!0),u;if(!s.aiDataContract){if(a==="measurements")u=o(s,"number",a);else if(a==="properties")u=o(s,"string",a);else if(a==="tags")u=o(s,"string",a);else if(en(s))u=i(s,a);else{mt(e,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:a},!0);try{ts()[uf](s),u=s}catch(c){mt(e,1,48,c&&tn(c[bd])?c[bd]():"Error serializing object",null,!0)}}return u}return s[l]=!0,eo(s.aiDataContract,function(c,d){var f=tn(d)?d()&1:d&1,m=tn(d)?d()&4:d&4,g=d&2,b=s[c]!==void 0,v=Xh(s[c])&&s[c]!==null;if(f&&!b&&!g)mt(e,1,24,"Missing required field specification. The field is required but not present on source",{field:c,name:a});else if(!m){var k=void 0;v?g?k=i(s[c],c):k=n(s[c],c):k=s[c],k!==void 0&&(u[c]=k)}}),delete s[l],u}function i(s,a){var l;if(s)if(!en(s))mt(e,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:a},!0);else{l=[];for(var u=0;u<s[Tt];u++){var c=s[u],d=n(c,a+"["+u+"]");l[Id](d)}}return l}function o(s,a,l){var u;return s&&(u={},eo(s,function(c,d){if(a==="string")d===void 0?u[c]="undefined":d===null?u[c]="null":d[bd]?u[c]=d[bd]():u[c]="invalid field: toString() is not defined.";else if(a==="number")if(d===void 0)u[c]="undefined";else if(d===null)u[c]="null";else{var f=parseFloat(d);isNaN(f)?u[c]="NaN":u[c]=f}else u[c]="invalid field: "+l+" is of unknown type.",mt(e,1,u[c],null,!0)})),u}})}return r.__ieDyn=1,r}()});var uhe,OJ,LJ=ge(()=>{p();_d();uhe=8,OJ=function(){function r(){}return r.prototype.getHashCodeScore=function(e){var t=this.getHashCode(e)/r.INT_MAX_VALUE;return t*100},r.prototype.getHashCode=function(e){if(e==="")return 0;for(;e[Tt]<uhe;)e=e.concat(e);for(var t=5381,n=0;n<e[Tt];++n)t=(t<<5)+t+e.charCodeAt(n),t=t&t;return Math.abs(t)},r.INT_MAX_VALUE=2147483647,r}()});var KJ,FJ=ge(()=>{p();of();_d();LJ();KJ=function(){function r(){var e=this,t=new OJ,n=new Sw;e[G0]=function(i){var o=0;return i[Kn]&&i[Kn][n.userId]?o=t.getHashCodeScore(i[Kn][n.userId]):i.ext&&i.ext.user&&i.ext.user.id?o=t[vJ](i.ext.user.id):i[Kn]&&i[Kn][n.operationId]?o=t.getHashCodeScore(i[Kn][n.operationId]):i.ext&&i.ext.telemetryTrace&&i.ext.telemetryTrace[og]?o=t.getHashCodeScore(i.ext.telemetryTrace[og]):o=Math.random()*100,o}}return r}()});var UJ,WJ=ge(()=>{p();of();ig();_d();FJ();UJ=function(){function r(e,t){this.INT_MAX_VALUE=2147483647;var n=t||Dw(null);(e>100||e<0)&&(n.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this[xb]=e,this.samplingScoreGenerator=new KJ}return r.prototype.isSampledIn=function(e){var t=this[xb],n=!1;return t==null||t>=100||e.baseType===pd[fa]?!0:(n=this.samplingScoreGenerator[G0](e)<t,n)},r}()});function Y0(r){try{return r.responseText}catch(e){}return null}function VJ(){var r,e,t;return r={endpointUrl:function(){return Nh+cd}},r[Kw]=function(){return!1},r[xW]=function(){return 15e3},r[V0]=function(){return 102400},r[B0]=function(){return!1},r[SW]=function(){return!0},r[Pb]=function(){return!1},r[j0]=function(){return!0},r[wb]=function(){return!1},r[CW]=function(){return!1},r[IW]=function(){return!1},r[Fw]=function(){return e},r[Sd]=function(){return e},r[_W]=function(){return 100},r[EW]=function(){return t},r[wW]=function(){return e},r.eventsLimitInMem=function(){return 1e4},r}var Ed,dhe,phe,Vw,jJ=ge(()=>{p();ir();dr();of();ig();wJ();DJ();RJ();MJ();WJ();_d();dhe=65e3;phe=(Ed={},Ed[dd.dataType]=kW,Ed[qh.dataType]=CJ,Ed[Bh.dataType]=_J,Ed[Jh.dataType]=EJ,Ed[jh.dataType]=IJ,Ed[pd.dataType]=SJ,Ed[Hh.dataType]=bJ,Ed),Vw=function(r){In(e,r);function e(){var t=r.call(this)||this;t.priority=1001,t.identifier=dq,t._senderConfig=VJ();var n,i,o,s,a,l,u,c,d=0,f,m,g,b;return He(e,t,function(v,k){ye(),v.pause=function(){Z(),s=!0},v.resume=function(){s&&(s=!1,i=null,v._buffer.size()>v._senderConfig[V0]()&&v[cg](!0,null,10),Y())},v.flush=function(z,fe,Se){if(z===void 0&&(z=!0),!s){Z();try{v[cg](z,null,Se||1)}catch(Te){mt(v[to](),1,22,"flush failed, telemetry will not be collected: "+pa(Te),{exception:Ln(Te)})}}},v.onunloadFlush=function(){if(!s)if((v._senderConfig[IW]()===!1||v[Br][j0]()===!1)&&Ib())try{v[cg](!0,K,2)}catch(z){mt(v[to](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+pa(z),{exception:Ln(z)})}else v.flush()},v.addHeader=function(z,fe){c[z]=fe},v.initialize=function(z,fe,Se,Te){v.isInitialized()&&mt(v[to](),1,28,"Sender is already initialized"),k.initialize(z,fe,Se,Te);var Le=v._getTelCtx(),Ye=v.identifier;l=new AJ(fe.logger),n=0,i=null,o=0,v[Cb]=null,u=0;var Je=v[to]();b=Aw(yd("Sender"),fe.evtNamespace&&fe.evtNamespace()),g=PJ(b);var Bt=VJ();eo(Bt,function(I,S){v[Br][I]=function(){var _=Le.getConfig(Ye,I,S());return!_&&I==="endpointUrl"&&(_=S()),_}}),v._buffer=v[Br][SW]()&&i0()?new NJ(Je,v[Br]):new kJ(Je,v[Br]),v._sample=new UJ(v[Br][_W](),Je),pe(z)||mt(Je,1,100,"Invalid Instrumentation key "+z[Fw]),!yw(v._senderConfig.endpointUrl())&&v._senderConfig.customHeaders()&&v._senderConfig.customHeaders()[Tt]>0&&ki(v[Br][EW](),function(I){t.addHeader(I.header,I.value)});var A=v[Br],M=null;!A[wb]()&&N0()?M=be:!A[wb]()&&Pw()&&(M=N),!M&&k0()&&(M=h),f=M||N,!A[j0]()&&Ib()&&(M=B),v[Cb]=M||N,!A[CW]()&&k0(!0)?m=O:Ib()?m=B:!A[wb]()&&N0()?m=be:!A[wb]()&&Pw()?m=N:m=f},v.processTelemetry=function(z,fe){fe=v._getTelCtx(fe);var Se=fe[to]();try{if(v[Br][B0]())return;if(!z){mt(Se,1,7,"Cannot send empty telemetry");return}if(z.baseData&&!z[H0]){mt(Se,1,70,"Cannot send telemetry without baseData and baseType");return}if(z[H0]||(z[H0]="EventData"),!v[Cb]){mt(Se,1,28,"Sender was not initialized");return}if(R(z))z[cw]=v._sample[xb];else{mt(Se,2,33,"Telemetry item was sampled out and not sent",{SampleRate:v._sample[xb]});return}var Te=v[Br][wW]()||void 0,Le=z.iKey||v[Br][Fw](),Ye=e.constructEnvelope(z,Le,Se,Te);if(!Ye){mt(Se,1,47,"Unable to create an AppInsights envelope");return}var Je=!1;if(z[Kn]&&z[Kn][uw]&&(ki(z[Kn][uw],function(I){try{I&&I(Ye)===!1&&(Je=!0,Tw(Se,"Telemetry processor check returns false"))}catch(S){mt(Se,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+pa(S),{exception:Ln(S)},!0)}}),delete z[Kn][uw]),Je)return;var Bt=l.serialize(Ye),A=v[ug],M=A.size();M+Bt[Tt]>v[Br][V0]()&&v[cg](!0,null,10),A[sg](Bt),Y()}catch(I){mt(Se,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+pa(I),{exception:Ln(I)})}v.processNext(z,fe)},v[hJ]=function(z,fe,Se){z.readyState===4&&P(z.status,fe,z.responseURL,Se,le(z),Y0(z)||z.response)},v[cg]=function(z,fe,Se){if(z===void 0&&(z=!0),!s)try{var Te=v[ug];if(v[Br][B0]())Te[mf]();else{if(Te[ff]()>0){var Le=Te.getItems();ue(Se||0,z),fe?fe.call(t,Le,z):v[Cb](Le,z)}o=+new Date}Z()}catch(Je){var Ye=lW();(!Ye||Ye>9)&&mt(v[to](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+pa(Je),{exception:Ln(Je)})}},v._doTeardown=function(z,fe){v.onunloadFlush(),g.unload(),ye()},v[ma]=function(z,fe,Se){mt(v[to](),2,26,"Failed to send telemetry.",{message:fe}),v._buffer[lg](z)},v[q0]=function(z,fe){for(var Se=[],Te=[],Le=fe.errors.reverse(),Ye=0,Je=Le;Ye<Je.length;Ye++){var Bt=Je[Ye],A=z.splice(Bt.index,1)[0];ie(Bt.statusCode)?Te[Id](A):Se[Id](A)}z[Tt]>0&&v[Uw](z,fe[Ww]),Se[Tt]>0&&v[ma](Se,le(null,["partial success",fe[Ww],"of",fe.itemsReceived].join(" "))),Te[Tt]>0&&(T(Te),mt(v[to](),2,40,"Partial success. Delivered: "+z[Tt]+", Failed: "+Se[Tt]+". Will retry to send "+Te[Tt]+" our of "+fe[gJ]+" items"))},v[Uw]=function(z,fe){v._buffer[lg](z)},v._xdrOnLoad=function(z,fe){var Se=Y0(z);if(z&&(Se+""=="200"||Se===""))n=0,v[Uw](fe,0);else{var Te=w(Se);Te&&Te.itemsReceived&&Te.itemsReceived>Te[Ww]&&!v[Br][Pb]()?v[q0](fe,Te):v[ma](fe,q(z))}};function R(z){return v._sample.isSampledIn(z)}function P(z,fe,Se,Te,Le,Ye){var Je=null;if(v._appId||(Je=w(Ye),Je&&Je.appId&&(v._appId=Je.appId)),(z<200||z>=300)&&z!==0){if((z===301||z===307||z===308)&&!D(Se)){v[ma](fe,Le);return}!v[Br][Pb]()&&ie(z)?(T(fe),mt(v[to](),2,40,". Response code "+z+". Will retry to send "+fe[Tt]+" items.")):v[ma](fe,Le)}else if(g&&!g.isOnline()){if(!v[Br][Pb]()){var Bt=10;T(fe,Bt),mt(v[to](),2,40,". Offline - Response Code: ".concat(z,". Offline status: ").concat(!g.isOnline(),". Will retry to send ").concat(fe.length," items."))}}else D(Se),z===206?(Je||(Je=w(Ye)),Je&&!v[Br][Pb]()?v[q0](fe,Je):v[ma](fe,Le)):(n=0,v[Uw](fe,Te))}function D(z){return u>=10?!1:!Ut(z)&&z!==""&&z!==v[Br][vf]()?(v[Br][vf]=function(){return z},++u,!0):!1}function K(z,fe){m?m(z,!1):B(z,fe)}function L(z){var fe=af(),Se=v[ug],Te=v[Br][vf](),Le=v._buffer[ag](z),Ye=new Blob([Le],{type:"text/plain;charset=UTF-8"}),Je=fe.sendBeacon(Te,Ye);return Je&&(Se[hf](z),v._onSuccess(z,z[Tt])),Je}function B(z,fe){if(en(z)&&z[Tt]>0&&!L(z)){for(var Se=[],Te=0;Te<z[Tt];Te++){var Le=z[Te];L([Le])||Se[Id](Le)}Se[Tt]>0&&(f&&f(Se,!0),mt(v[to](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function N(z,fe){var Se=new XMLHttpRequest,Te=v[Br][vf]();try{Se[lw]=!0}catch(Ye){}Se.open("POST",Te,fe),Se[J0]("Content-type","application/json"),yw(Te)&&Se[J0](ub[6],ub[7]),ki(eg(c),function(Ye){Se[J0](Ye,c[Ye])}),Se.onreadystatechange=function(){return v._xhrReadyStateChange(Se,z,z[Tt])},Se.onerror=function(Ye){return v[ma](z,le(Se),Ye)};var Le=v._buffer[ag](z);Se.send(Le),v._buffer[hf](z)}function O(z,fe){if(en(z)){for(var Se=z[Tt],Te=0;Te<z[Tt];Te++)Se+=z[Te][Tt];d+Se<=dhe?y(z,!1):Ib()?B(z,fe):(f&&f(z,!0),mt(v[to](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."))}}function h(z,fe){y(z,!0)}function y(z,fe){var Se,Te=v[Br][vf](),Le=v._buffer[ag](z),Ye=new Blob([Le],{type:"application/json"}),Je=new Headers,Bt=Le[Tt],A=!1,M=!1;yw(Te)&&Je.append(ub[6],ub[7]),ki(eg(c),function(_){Je.append(_,c[_])});var I=(Se={method:"POST",headers:Je,body:Ye},Se[lw]=!0,Se);fe||(I.keepalive=!0,A=!0,d+=Bt);var S=new Request(Te,I);try{S[lw]=!0}catch(_){}v._buffer[hf](z);try{fetch(S).then(function(_){fe||(d-=Bt,Bt=0),M||(M=!0,_.ok?_.text().then(function(F){P(_.status,z,_.url,z[Tt],_.statusText,F)}):v[ma](z,_.statusText))}).catch(function(_){fe||(d-=Bt,Bt=0),M||(M=!0,v[ma](z,_.message))})}catch(_){M||v[ma](z,Ln(_))}A&&!M&&(M=!0,v._onSuccess(z,z[Tt]))}function w(z){try{if(z&&z!==""){var fe=ts().parse(z);if(fe&&fe.itemsReceived&&fe.itemsReceived>=fe[Ww]&&fe.itemsReceived-fe.itemsAccepted===fe.errors[Tt])return fe}}catch(Se){mt(v[to](),1,43,"Cannot parse the response. "+pa(Se),{response:z})}return null}function T(z,fe){if(fe===void 0&&(fe=1),!(!z||z[Tt]===0)){var Se=v[ug];Se[lg](z),n++;for(var Te=0,Le=z;Te<Le.length;Te++){var Ye=Le[Te];Se[sg](Ye)}H(fe),Y()}}function H(z){var fe=10,Se;if(n<=1)Se=fe;else{var Te=(Math.pow(2,n)-1)/2,Le=Math.floor(Math.random()*Te*fe)+1;Le=z*Le,Se=Math.max(Math.min(Le,3600),fe)}var Ye=vd()+Se*1e3;i=Ye}function Y(){if(!a&&!s){var z=i?Math.max(0,i-vd()):0,fe=Math.max(v[Br][xW](),z);a=setTimeout(function(){a=null,v[cg](!0,null,1)},fe)}}function Z(){clearTimeout(a),a=null,i=null}function ie(z){return z===401||z===403||z===408||z===429||z===500||z===502||z===503||z===504}function le(z,fe){return z?"XMLHttpRequest,Status:"+z.status+",Response:"+Y0(z)||z.response||"":fe}function be(z,fe){var Se=v[ug],Te=bb(),Le=new XDomainRequest;Le.onload=function(){return v._xdrOnLoad(Le,z)},Le.onerror=function(A){return v[ma](z,q(Le),A)};var Ye=Te&&Te.location&&Te.location.protocol||"";if(v[Br][vf]().lastIndexOf(Ye,0)!==0){mt(v[to](),2,40,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),Se[mf]();return}var Je=v[Br][vf]().replace(/^(https?:)/,"");Le.open("POST",Je);var Bt=Se[ag](z);Le.send(Bt),Se[hf](z)}function q(z,fe){return z?"XDomainRequest,Response:"+Y0(z)||"":fe}function $(){var z="getNotifyMgr";return v.core[z]?v.core[z]():v.core._notificationManager}function ue(z,fe){var Se=$();if(Se&&Se[PW])try{Se[PW](z,fe)}catch(Te){mt(v[to](),1,74,"send request notification failed: "+pa(Te),{exception:Ln(Te)})}}function pe(z){var fe=Ut(z[DW])?!1:z[DW];if(fe)return!0;var Se="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",Te=new RegExp(Se);return Te.test(z[Fw])}function ye(){v[Cb]=null,v[ug]=null,v._appId=null,v._sample=null,c={},g=null,n=0,i=null,o=null,s=!1,a=null,l=null,u=0,d=0,f=null,m=null,b=null}}),t}return e.constructEnvelope=function(t,n,i,o){var s;n!==t.iKey&&!Ut(n)?s=_o(_o({},t),{iKey:n}):s=t;var a=phe[s.baseType]||kW;return a(i,s,o)},e}(bW)});var NW=ge(()=>{p();jJ()});var _l,ns,jw,El,Lt,Ts,Mc,$0,ks,_t,mg,Hr,z0,hg,gg,RW,Bw,vg,Db,Hw,bf,Ns,Tb,If,Cl,kb,yg,Rs,ha,Sf,Cd,AW,_f,wl,qw,Jw,wd,bg,Q0,Nb,xl,MW,BJ,HJ,Un,Gw,qJ,Ig,Yw,Sg,Pl,X0,Z0,eN,tN,Pn=ge(()=>{p();_l="initialize",ns="name",jw="getNotifyMgr",El="identifier",Lt="push",Ts="isInitialized",Mc="config",$0="instrumentationKey",ks="logger",_t="length",mg="time",Hr="processNext",z0="getProcessTelContext",hg="addNotificationListener",gg="removeNotificationListener",RW="stopPollingInternalLogs",Bw="onComplete",vg="getPlugin",Db="flush",Hw="_extensions",bf="splice",Ns="teardown",Tb="messageId",If="message",Cl="isAsync",kb="_doTeardown",yg="update",Rs="getNext",ha="diagLog",Sf="setNextPlugin",Cd="createNew",AW="cookieCfg",_f="indexOf",wl="substring",qw="userAgent",Jw="split",wd="setEnabled",bg="substr",Q0="nodeType",Nb="apply",xl="replace",MW="enableDebugExceptions",BJ="logInternalMessage",HJ="toLowerCase",Un="call",Gw="type",qJ="handler",Ig="listeners",Yw="isChildEvt",Sg="getCtx",Pl="setCtx",X0="complete",Z0="traceId",eN="spanId",tN="traceFlags"});var kt,OW,pn,LW,$w,Rb,JJ,is,ga,Ab,Ef,Mb,Cf,rN,zw,_g,gi=ge(()=>{p();kt="",OW="channels",pn="core",LW="createPerfMgr",$w="disabled",Rb="extensionConfig",JJ="extensions",is="processTelemetry",ga="priority",Ab="eventsSent",Ef="eventsDiscarded",Mb="eventsSendRequest",Cf="perfEvent",rN="errorToConsole",zw="warnToConsole",_g="getPerfMgr"});function Che(r){if(r){if(iN)return iN(r);var e=r[mhe]||r[Mt]||r[nN];if(e)return e}return null}function jW(r,e){return typeof r===e}function Dn(r){return r===void 0||typeof r===$t}function or(r){return r===null||Dn(r)}function BW(r){return!or(r)}function HW(r,e){return!!(r&&nr[Un](r,e))}function xd(r){return!!(r&&typeof r===pt)}function wr(r){return!!(r&&typeof r===Xr)}function Qw(r){var e=r;return e&&wf(e)&&(e=e[xl](She,function(t,n){return n.toUpperCase()}),e=e[xl](_he,"_"),e=e[xl](Ehe,function(t,n){return"_"+n})),e}function Pd(r,e){if(r)for(var t in r)nr[Un](r,t)&&e[Un](r,t,r[t])}function qW(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=ghe?r[t4](e):whe(r,e)),t}function whe(r,e){var t=!1,n=e?e[_t]:0,i=r?r[_t]:0;if(n&&i&&i>=n&&!(t=r===e)){for(var o=i-1,s=n-1;s>=0;s--){if(r[o]!=e[s])return!1;o--}t=!0}return t}function Ni(r,e){return r&&e?r[_f](e)!==-1:!1}function JW(r){return!!(r&&VW[Un](r)==="[object Date]")}function xhe(r){return!!(r&&VW[Un](r)==="[object Array]")}function oN(r){return!!(r&&VW[Un](r)==="[object Error]")}function wf(r){return typeof r=="string"}function GW(r){return typeof r=="number"}function Ob(r){return typeof r=="boolean"}function XJ(r){var e=!1;if(r&&typeof r=="object"){var t=iN?iN(r):Che(r);t?(t[nN]&&nr[Un](t,nN)&&(t=t[nN]),e=typeof t===Xr&&n4[Un](t)===Ihe):e=!0}return e}function Lb(r){if(r)return yhe?r[e4]():Phe(r)}function Phe(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[_t]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function wt(r,e,t){var n=r[_t];try{for(var i=0;i<n&&!(i in r&&e[Un](t||r,r[i],i,r)===-1);i++);}catch(o){}}function va(r,e,t){if(r){if(r[GJ])return r[GJ](e,t);var n=r[_t],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function YW(r,e,t){var n;if(r){if(r[YJ])return r[YJ](e,t);var i=r[_t],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[Un](o,r[s],r))}catch(a){}}return n}function $W(r,e,t){var n;if(r){if(r[$J])return r[$J](e,t);var i=r[_t],o=0;if(arguments[_t]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function Dl(r){return r&&(r=hhe&&r[FW]?r[FW]():r[xl]?r[xl](/^\s+|(?=\s)\s+$/g,kt):r),r}function Xw(r){var e=typeof r;if(e!==Xr&&(e!==pt||r===null)&&na("objKeys called on non-object"),!ZJ&&QJ)return QJ(r);var t=[];for(var n in r)r&&nr[Un](r,n)&&t[Lt](n);if(ZJ)for(var i=KW[_t],o=0;o<i;o++)r&&nr[Un](r,KW[o])&&t[Lt](KW[o]);return t}function Kb(r,e,t,n){if(zJ)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),zJ(r,e,i),!0}catch(o){}return!1}function Dhe(r){return r}function zW(r){return UW&&Pd(r,function(e,t){(nn(t)||xd(t))&&UW(t)}),Oc(r)}function Tl(){var r=Date;return r.now?r.now():new r().getTime()}function Zw(r){return oN(r)?r[ns]:kt}function ya(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function Fb(r,e,t){var n;return r?(n=r[e],!n&&or(n)&&(n=Dn(t)?{}:t,r[e]=n)):n=Dn(t)?{}:t,n}function ba(r,e){return or(r)?e:r}function sN(r){return!!r}function Zn(r){throw new Error(r)}function The(r,e){var t=null,n=null;return wr(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][Nb](n,i)}}function Ub(r,e,t,n,i){r&&e&&t&&(i!==!1||Dn(r[e]))&&(r[e]=The(t,n))}function xf(r,e,t,n){return r&&e&&xd(r)&&nn(t)&&wt(t,function(i){wf(i)&&Ub(r,i,e,i,n)}),r}function Wb(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[_t],u=!1,c=1;for(l>0&&Ob(a)&&(u=a,a=s[c]||{},c++),xd(a)||(a={});c<l;c++){var d=s[c],f=nn(d),m=xd(d);for(var g in d){var b=f&&g in d||m&&nr[Un](d,g);if(b){var v=d[g],k=void 0;if(u&&v&&((k=nn(v))||XJ(v))){var R=a[g];k?nn(R)||(R=[]):XJ(R)||(R={}),v=Wb(u,R,v)}v!==void 0&&(a[g]=v)}}}return a}var e4,t4,fhe,GJ,YJ,$J,FW,r4,mhe,nN,zJ,UW,xHe,QJ,WW,hhe,ghe,PHe,vhe,yhe,bhe,VW,n4,Ihe,She,_he,Ehe,iN,nn,ZJ,KW,Oc,Wn=ge(()=>{p();ir();Pn();gi();e4="toISOString",t4="endsWith",fhe="startsWith",GJ="indexOf",YJ="map",$J="reduce",FW="trim",r4="toString",mhe="__proto__",nN="constructor",zJ=Io,UW=Er.freeze,xHe=Er.seal,QJ=Er.keys,WW=String[Mt],hhe=WW[FW],ghe=WW[t4],PHe=WW[fhe],vhe=Date[Mt],yhe=vhe[e4],bhe=Array.isArray,VW=ra[r4],n4=nr[r4],Ihe=n4[Un](Er),She=/-([a-z])/g,_he=/([^\w\d_$])/g,Ehe=/^(\d+[\w\d_$])/,iN=Object.getPrototypeOf;nn=bhe||xhe;ZJ=!{toString:null}.propertyIsEnumerable("toString"),KW=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];Oc=UW||Dhe});function QW(r){var e={};return Pd(r,function(t,n){e[t]=n,e[n]=t}),zW(e)}var i4=ge(()=>{p();Wn()});function As(r){var e=An();return e&&e[r]?e[r]:r===o4&&a4()?window:null}function a4(){return!!(typeof window===pt&&window)}function l4(){return a4()?window:As(o4)}function Whe(){return!!(typeof document===pt&&document)}function aN(){return Whe()?document:As(khe)}function Vhe(){return!!(typeof navigator===pt&&navigator)}function e2(){return Vhe()?navigator:As(Nhe)}function c4(r){if(r&&Uhe){var e=As("__mockLocation");if(e)return e}return typeof location===pt&&location?location:As(Rhe)}function u4(){return typeof console!==$t?console:As(Ahe)}function d4(){return As(Mhe)}function lN(){return!!(typeof JSON===pt&&JSON||As(s4)!==null)}function t2(){return lN()?JSON||As(s4):null}function p4(){return As(Ohe)}function f4(){return As(Lhe)}function Eg(){var r=e2();if(r&&(r[qw]!==ZW||XW===null)){ZW=r[qw];var e=(ZW||kt)[HJ]();XW=Ni(e,Khe)||Ni(e,Fhe)}return XW}function Ia(r){var e=Object[Mt].toString[Un](r),t=kt;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[ns]+"'":lN()&&(t=t2().stringify(r)),e+t}var o4,khe,Nhe,Rhe,Ahe,Mhe,s4,Ohe,Lhe,Khe,Fhe,XW,ZW,Uhe,Lc=ge(()=>{"use strict";p();ir();Pn();Wn();gi();o4="window",khe="document",Nhe="navigator",Rhe="location",Ahe="console",Mhe="performance",s4="JSON",Ohe="crypto",Lhe="msCrypto",Khe="msie",Fhe="trident/",XW=null,ZW=null,Uhe=!1});function jhe(r,e){return function(){var t=arguments,n=n2(e);if(n){var i=n.listener;i&&i[r]&&i[r][Nb](i,t)}}}function Bhe(){var r=As("Microsoft");return r&&(uN=r.ApplicationInsights),uN}function n2(r){var e=uN;return!e&&r.disableDbgExt!==!0&&(e=uN||Bhe()),e?e.ChromeDbgExt:null}function m4(r){if(!cN){cN={};for(var e=0;e<r2[_t];e++)cN[r2[e]]=jhe(r2[e],r)}return cN}var r2,uN,cN,i2=ge(()=>{p();Pn();Lc();r2=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],uN=null});function h4(r){return r?'"'+r[xl](/\"/g,kt)+'"':kt}function g4(r,e){var t=u4();if(t){var n="log";t[r]&&(n=r),wr(t[n])&&t[n](e)}}function v4(r,e){return(r||{})[ks]||new Vb(e)}function y4(r){return r||new Vb}function kl(r,e,t,n,i,o){o===void 0&&(o=!1),y4(r).throwInternal(e,t,n,i,o)}function b4(r,e){y4(r)[zw](e)}var Hhe,qhe,Jhe,dN,Vb,Cg=ge(()=>{"use strict";p();dr();Pn();i2();Lc();Wn();gi();Hhe="AI (Internal): ",qhe="AI: ",Jhe="AITR_";dN=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[Tb]=e,o[If]=(n?qhe:Hhe)+e;var s=kt;lN()&&(s=t2().stringify(i));var a=(t?" message:"+h4(t):kt)+(i?" props:"+h4(s):kt);o[If]+=a}return r.dataType="MessageData",r}();Vb=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;He(r,this,function(l){c(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[MW]=function(){return a},l.throwInternal=function(m,g,b,v,k){k===void 0&&(k=!1);var R=new dN(g,b,k,v);if(a)throw Ia(R);var P=m===1?rN:zw;if(Dn(R[If]))f("throw"+(m===1?"Critical":"Warning"),R);else{if(k){var D=+R[Tb];!n[D]&&i>=m&&(l[P](R[If]),n[D]=!0)}else i>=m&&l[P](R[If]);u(m,R)}},l[zw]=function(m){g4("warn",m),f("warning",m)},l[rN]=function(m){g4("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[BJ]=u;function u(m,g){if(!d()){var b=!0,v=Jhe+g[Tb];if(n[v]?b=!1:n[v]=!0,b&&(m<=o&&(l.queue[Lt](g),t++,f(m===1?"error":"warn",g)),t===s)){var k="Internal events throttle limit per PageView reached for this app.",R=new dN(23,k,!1);l.queue[Lt](R),m===1?l[rN](k):l[zw](k)}}}function c(m){i=ba(m.loggingLevelConsole,0),o=ba(m.loggingLevelTelemetry,1),s=ba(m.maxMessageLimit,25),a=ba(m[MW],!1)}function d(){return t>=s}function f(m,g){var b=n2(e||{});b&&b[ha]&&b[ha](m,g)}})}return r.__ieDyn=1,r}()});function fN(r,e,t,n,i){if(r){var o=r;if(o[_g]&&(o=o[_g]()),o){var s=void 0,a=o[Sg](o2);try{if(s=o.create(e(),n,i),s){if(a&&s[Pl]&&(s[Pl](pN[s2],a),a[Sg]&&a[Pl])){var l=a[Sg](pN[ex]);l||(l=[],a[Pl](pN[ex],l)),l[Lt](s)}return o[Pl](o2,s),t(s)}}catch(u){s&&s[Pl]&&s[Pl]("exception",u)}finally{s&&o.fire(s),o[Pl](o2,a)}}}return t()}function S4(){return Ghe}var jb,s2,ex,Ghe,pN,I4,o2,mN=ge(()=>{p();dr();Pn();Wn();gi();jb="ctx",s2="ParentContextKey",ex="ChildrenContextKey",Ghe=null,pN=function(){function r(e,t,n){var i=this,o=!1;if(i.start=Tl(),i[ns]=e,i[Cl]=n,i[Yw]=function(){return!1},wr(t)){var s;o=Kb(i,"payload",function(){return!s&&wr(t)&&(s=t(),t=null),s})}i[Sg]=function(a){return a?a===r[s2]||a===r[ex]?i[a]:(i[jb]||{})[a]:null},i[Pl]=function(a,l){if(a)if(a===r[s2])i[a]||(i[Yw]=function(){return!0}),i[a]=l;else if(a===r[ex])i[a]=l;else{var u=i[jb]=i[jb]||{};u[a]=l}},i[X0]=function(){var a=0,l=i[Sg](r[ex]);if(nn(l))for(var u=0;u<l[_t];u++){var c=l[u];c&&(a+=c[mg])}i[mg]=Tl()-i.start,i.exTime=i[mg]-a,i[X0]=function(){},!o&&wr(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),I4=function(){function r(e){this.ctx={},He(r,this,function(t){t.create=function(n,i,o){return new pN(n,i,o)},t.fire=function(n){n&&(n[X0](),e&&wr(e[Cf])&&e[Cf](n))},t[Pl]=function(n,i){if(n){var o=t[jb]=t[jb]||{};o[n]=i}},t[Sg]=function(n){return(t[jb]||{})[n]}})}return r.__ieDyn=1,r}(),o2="CoreUtils.doPerf"});function C4(r){r<0&&(r>>>=0),tx=123456789+r&Pf,rx=987654321-r&Pf,E4=!0}function w4(){try{var r=Tl()&2147483647;C4((Math.random()*_4^r)+r)}catch(e){}}function x4(r){return r>0?Math.floor(wg()/Pf*(r+1))>>>0:0}function wg(r){var e=0,t=p4()||f4();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&Pf),e===0&&Eg()&&(E4||w4(),e=a2()&Pf),e===0&&(e=Math.floor(_4*Math.random()|0)),r||(e>>>=0),e}function P4(r){r?C4(r):w4()}function a2(r){rx=36969*(rx&65535)+(rx>>16)&Pf,tx=18e3*(tx&65535)+(tx>>16)&Pf;var e=(rx<<16)+(tx&65535)>>>0&Pf|0;return r||(e>>>=0),e}function hN(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=wg()>>>0,n=0,i=kt;i[_t]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(wg()<<2&4294967295|t&3)>>>0,n=0);return i}var _4,Pf,E4,tx,rx,l2=ge(()=>{p();Pn();Lc();Wn();gi();_4=4294967296,Pf=4294967295,E4=!1,tx=123456789,rx=987654321});function zhe(r,e,t){if(D4)try{return D4(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function k4(r){return r[Q0]===1||r[Q0]===9||!+r[Q0]}function Qhe(r,e){var t=e[r.id];if(!t){t={};try{k4(e)&&(zhe(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function Bb(r,e){return e===void 0&&(e=!1),Qw(r+$he+++(e?"."+T4:kt)+Yhe)}function gN(r){var e={id:Bb("_aiData-"+(r||kt)+"."+T4),accept:function(t){return k4(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[Qw(n)]:(o&&(s=Qhe(e,t),s[Qw(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var D4,T4,Yhe,$he,vN=ge(()=>{p();ir();Pn();Wn();gi();l2();D4=Io,T4="2.8.11",Yhe="."+hN(6),$he=0});function V4(r,e){var t=nx[Hb]||IN[Hb];return t||(t=nx[Hb]=nx(r,e),IN[Hb]=t),t}function bN(r){return r?r.isEnabled():!0}function Xhe(r){var e=r[AW]=r[AW]||{};if(ya(e,"domain",r.cookieDomain,BW,or),ya(e,"path",r.cookiePath||"/",null,or),or(e[d2])){var t=void 0;Dn(r[A4])||(t=!r[A4]),Dn(r[M4])||(t=!r[M4]),e[d2]=t}return e}function j4(r,e){return e&&r&&nn(r.ignoreCookies)?r.ignoreCookies[_f](e)!==-1:!1}function Zhe(r,e){return e&&r&&nn(r.blockedCookies)&&r.blockedCookies[_f](e)!==-1?!0:j4(r,e)}function nx(r,e){var t,n=Xhe(r||IN),i=n.path||"/",o=n.domain,s=n[d2]!==!1,a=(t={isEnabled:function(){var l=s&&K4(e),u=IN[Hb];return l&&u&&a!==u&&(l=bN(u)),l}},t[wd]=function(l){s=l!==!1},t.set=function(l,u,c,d,f){var m=!1;if(bN(a)&&!Zhe(n,l)){var g={},b=Dl(u||kt),v=b[_f](";");if(v!==-1&&(b=Dl(u[wl](0,v)),g=B4(u[wl](v+1))),ya(g,"domain",d||o,sN,Dn),!or(c)){var k=Eg();if(Dn(g[c2])){var R=Tl(),P=R+c*1e3;if(P>0){var D=new Date;D.setTime(P),ya(g,c2,F4(D,k?N4:R4)||F4(D,k?N4:R4)||kt,sN)}}k||ya(g,"max-age",kt+c,null,Dn)}var K=c4();K&&K.protocol==="https:"&&(ya(g,"secure",null,null,Dn),u2===null&&(u2=!tge((e2()||{})[qw])),u2&&ya(g,"SameSite","None",null,Dn)),ya(g,"path",f||i,null,Dn);var L=n.setCookie||W4;L(l,U4(b,g)),m=!0}return m},t.get=function(l){var u=kt;return bN(a)&&!j4(n,l)&&(u=(n.getCookie||ege)(l)),u},t.del=function(l,u){var c=!1;return bN(a)&&(c=a.purge(l,u)),c},t.purge=function(l,u){var c,d=!1;if(K4(e)){var f=(c={},c.path=u||"/",c[c2]="Thu, 01 Jan 1970 00:00:01 GMT",c);Eg()||(f["max-age"]="0");var m=n.delCookie||W4;m(l,U4(kt,f)),d=!0}return d},t);return a[Hb]=a,a}function K4(r){if(yN===null){yN=!1;try{var e=ix||{};yN=e[p2]!==void 0}catch(t){kl(r,2,68,"Cannot access document.cookie - "+Zw(t),{exception:Ia(t)})}}return yN}function B4(r){var e={};if(r&&r[_t]){var t=Dl(r)[Jw](";");wt(t,function(n){if(n=Dl(n||kt),n){var i=n[_f]("=");i===-1?e[n]=null:e[Dl(n[wl](0,i))]=Dl(n[wl](i+1))}})}return e}function F4(r,e){return wr(r[e])?r[e]():null}function U4(r,e){var t=r||kt;return Pd(e,function(n,i){t+="; "+n+(or(i)?kt:"="+i)}),t}function ege(r){var e=kt;if(ix){var t=ix[p2]||kt;O4!==t&&(L4=B4(t),O4=t),e=Dl(L4[r]||kt)}return e}function W4(r,e){ix&&(ix[p2]=r+"="+e)}function tge(r){return wf(r)?!!(Ni(r,"CPU iPhone OS 12")||Ni(r,"iPad; CPU OS 12")||Ni(r,"Macintosh; Intel Mac OS X 10_14")&&Ni(r,"Version/")&&Ni(r,"Safari")||Ni(r,"Macintosh; Intel Mac OS X 10_14")&&qW(r,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Ni(r,"Chrome/5")||Ni(r,"Chrome/6")||Ni(r,"UnrealEngine")&&!Ni(r,"Chrome")||Ni(r,"UCBrowser/12")||Ni(r,"UCBrowser/11")):!1}var N4,R4,p2,c2,d2,A4,M4,Hb,yN,u2,O4,ix,L4,IN,f2=ge(()=>{p();Pn();Cg();Lc();Wn();gi();N4="toGMTString",R4="toUTCString",p2="cookie",c2="expires",d2="enabled",A4="isCookieUseDisabled",M4="disableCookiesUsage",Hb="_ckMgr",yN=null,u2=null,O4=null,ix=aN(),L4={},IN={}});function J4(r){return r&&r[xl]?r[xl](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,kt):r}function lge(r,e){var t;if(e){var n=kt;nn(e)?(n=kt,wt(e,function(o){o=J4(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=J4(e),n&&(n[0]!=="."&&(n="."+n),r=(r||kt)+n)}var i=age.exec(r||kt)||[];return t={},t[Gw]=i[1],t.ns=(i[2]||kt).replace(ige,".").replace(oge,kt)[Jw](".").sort().join("."),t}function cge(r,e,t){t===void 0&&(t=!0);var n=G4.get(r,nge,{},t),i=n[e];return i||(i=n[e]=[]),i}function uge(r,e,t,n){var i=!1;return r&&e&&e[Gw]&&t&&(r[q4]?(r[q4](e[Gw],t,n),i=!0):r[H4]&&(r[H4](rge+e[Gw],t),i=!0)),i}function m2(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=lge(e,n);if(s=uge(r,a,t,i),s&&G4.accept(r)){var l=(o={guid:sge++,evtName:a},o[qJ]=t,o.capture=i,o);cge(r,a.type)[Lt](l)}}catch(u){}return s}function Y4(r,e,t){var n=!1,i=l4();i&&(n=m2(i,r,e,t),n=m2(i.body,r,e,t)||n);var o=aN();return o&&(n=m2(o,r,e,t)||n),n}var rge,H4,q4,nge,D7e,T7e,ige,oge,sge,G4,age,$4=ge(()=>{p();Pn();vN();Lc();Wn();gi();rge="on",H4="attachEvent",q4="addEventListener",nge="events",D7e=Bb("aiEvtPageHide"),T7e=Bb("aiEvtPageShow"),ige=/\.[\.]+/g,oge=/[\.]+$/,sge=1,G4=gN("events"),age=/^([^.]*)(?:\.(.+)|)/});function z4(){var r=h2();return r[wl](0,8)+"-"+r[wl](8,12)+"-"+r[wl](12,16)+"-"+r[wl](16,20)+"-"+r[wl](20)}function Q4(){var r=d4();return r&&r.now?r.now():Tl()}function h2(){for(var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=kt,t,n=0;n<4;n++)t=wg(),e+=r[t&15]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var i=r[8+(wg()&3)|0];return e[bg](0,8)+e[bg](9,4)+"4"+e[bg](13,3)+i+e[bg](16,3)+e[bg](19,12)}function X4(r,e){var t=V4(r,e),n=ax._canUseCookies;return ox===null&&(ox=[],sx=n,Kb(ax,"_canUseCookies",function(){return sx},function(i){sx=i,wt(ox,function(o){o[wd](i)})})),va(ox,t)===-1&&ox[Lt](t),Ob(n)&&t[wd](n),Ob(sx)&&t[wd](sx),t}function Z4(){X4()[wd](!1)}var ox,sx,ax,eG=ge(()=>{"use strict";p();ir();Pn();f2();Lc();$4();Wn();gi();l2();ox=null;ax={_canUseCookies:void 0,isTypeof:jW,isUndefined:Dn,isNullOrUndefined:or,hasOwnProperty:HW,isFunction:wr,isObject:xd,isDate:JW,isArray:nn,isError:oN,isString:wf,isNumber:GW,isBoolean:Ob,toISOString:Lb,arrForEach:wt,arrIndexOf:va,arrMap:YW,arrReduce:$W,strTrim:Dl,objCreate:So,objKeys:Xw,objDefineAccessors:Kb,addEventHandler:Y4,dateNow:Tl,isIE:Eg,disableCookies:Z4,newGuid:z4,perfNow:Q4,newId:hN,randomValue:x4,random32:wg,mwcRandomSeed:P4,mwcRandom32:a2,generateW3CId:h2}});function tG(r,e,t){return r&&r[_t]===e&&r!==t?!!r.match(/^[\da-f]*$/):!1}function rG(r){return tG(r,32,dge)}function nG(r){return tG(r,16,pge)}var dge,pge,iG=ge(()=>{p();Pn();dge="00000000000000000000000000000000",pge="0000000000000000"});function Dd(r){return fge.get(r,"state",{},!0)}function SN(r,e){for(var t=[],n=null,i=r[Rs](),o;i;){var s=i[vg]();if(s){n&&wr(n[Sf])&&wr(s[is])&&n[Sf](s);var a=!1;wr(s[Ts])?a=s[Ts]():(o=Dd(s),a=o[Ts]),a||t[Lt](s),n=s,i=i[Rs]()}}wt(t,function(l){var u=r[pn]();l[_l](r.getCfg(),u,e,r[Rs]()),o=Dd(l),!l[pn]&&!o[pn]&&(o[pn]=u),o[Ts]=!0,delete o[Ns]})}function _N(r){return r.sort(function(e,t){var n=0;if(t){var i=wr(t[is]);wr(e[is])?n=i?e[ga]-t[ga]:1:i&&(n=-1)}else n=e?1:-1;return n})}function oG(r){var e={};return{getName:function(){return e[ns]},setName:function(t){r&&r.setName(t),e[ns]=t},getTraceId:function(){return e[Z0]},setTraceId:function(t){r&&r.setTraceId(t),rG(t)&&(e[Z0]=t)},getSpanId:function(){return e[eN]},setSpanId:function(t){r&&r.setSpanId(t),nG(t)&&(e[eN]=t)},getTraceFlags:function(){return e[tN]},setTraceFlags:function(t){r&&r.setTraceFlags(t),e[tN]=t}}}var fge,EN=ge(()=>{"use strict";p();Pn();vN();Wn();gi();iG();fge=gN("plugin")});function hge(r,e,t){for(;r;){if(r[vg]()===t)return r;r=r[Rs]()}return Fc([t],e[Mc]||{},e)}function g2(r,e,t,n){var i=null,o=[];n!==null&&(i=n?hge(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return v4(t,e)},getCfg:function(){return e},getExtCfg:u,getConfig:c,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:d,onComplete:a}};function a(f,m){for(var g=[],b=2;b<arguments.length;b++)g[b-2]=arguments[b];f&&o[Lt]({func:f,self:Dn(m)?s.ctx:m,args:g})}function l(){var f=i;if(i=f?f[Rs]():null,!f){var m=o;m&&m[_t]>0&&(wt(m,function(g){try{g.func[Un](g.self,g.args)}catch(b){kl(t[ks],2,73,"Unexpected Exception during onComplete - "+Ia(b))}}),o=[])}return f}function u(f,m,g){m===void 0&&(m={}),g===void 0&&(g=0);var b;if(e){var v=e[Rb];v&&f&&(b=v[f])}if(!b)b=m;else if(xd(m)&&g!==0){var k=Wb(!0,m,b);e&&g===2&&Pd(m,function(R){if(or(k[R])){var P=e[R];or(P)||(k[R]=P)}}),b=k}return b}function c(f,m,g){g===void 0&&(g=!1);var b,v=u(f,null);return v&&!or(v[m])?b=v[m]:e&&!or(e[m])&&(b=e[m]),or(b)?g:b}function d(f){for(var m;m=s._next();){var g=m[vg]();g&&f(g)}}return s}function Kc(r,e,t,n){var i=g2(r,e,t,n),o=i.ctx;function s(l){var u=i._next();return u&&u[is](l,o),!u}function a(l,u){return l===void 0&&(l=null),nn(l)&&(l=Fc(l,e,t,u)),Kc(l||o[Rs](),e,t,u)}return o[Hr]=s,o[Cd]=a,o}function qb(r,e,t){var n=e[Mc]||{},i=g2(r,n,e,t),o=i.ctx;function s(l){var u=i._next();return u&&u.unload(o,l),!u}function a(l,u){return l===void 0&&(l=null),nn(l)&&(l=Fc(l,n,e,u)),qb(l||o[Rs](),e,u)}return o[Hr]=s,o[Cd]=a,o}function lx(r,e,t){var n=e[Mc]||{},i=g2(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(u){wr(u[yg])&&u[yg](o,l)})}function a(l,u){return l===void 0&&(l=null),nn(l)&&(l=Fc(l,n,e,u)),lx(l||o[Rs](),e,u)}return o[Hr]=s,o[Cd]=a,o}function Fc(r,e,t,n){var i=null,o=!n;if(nn(r)&&r[_t]>0){var s=null;wt(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&wr(a[is])){var l=gge(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Fc([n],e,t):i}function gge(r,e,t){var n=null,i=wr(r[is]),o=wr(r[Sf]),s;r?s=r[El]+"-"+r[ga]+"-"+lG++:s="Unknown-0-"+lG++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:c,unload:d,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&wr(r[aG])&&(m=r[aG]()),m||(m=Kc(a,e,t)),m}function u(m,g,b,v,k){var R=!1,P=r?r[El]:mge,D=m[sG];return D||(D=m[sG]={}),m.setNext(n),r&&fN(m[pn](),function(){return P+":"+b},function(){D[s]=!0;try{var K=n?n._id:kt;K&&(D[K]=!1),R=g(m)}catch(B){var L=n?D[n._id]:!0;L&&(R=!0),(!n||!L)&&kl(m[ha](),1,73,"Plugin ["+P+"] failed during "+b+" - "+Ia(B)+", run flags: "+Ia(D))}},v,k),R}function c(m,g){g=g||l();function b(v){if(!r||!i)return!1;var k=Dd(r);return k[Ns]||k[$w]?!1:(o&&r[Sf](n),r[is](m,v),!0)}u(g,b,"processTelemetry",function(){return{item:m}},!m.sync)||g[Hr](m)}function d(m,g){function b(){var v=!1;if(r){var k=Dd(r),R=r[pn]||k[pn];r&&(!R||R===m.core())&&!k[Ns]&&(k[pn]=null,k[Ns]=!0,k[Ts]=!1,r[Ns]&&r[Ns](m,g)===!0&&(v=!0))}return v}u(m,b,"unload",function(){},g[Cl])||m[Hr](g)}function f(m,g){function b(){var v=!1;if(r){var k=Dd(r),R=r[pn]||k[pn];r&&(!R||R===m.core())&&!k[Ns]&&r[yg]&&r[yg](m,g)===!0&&(v=!0)}return v}u(m,b,"update",function(){},!1)||m[Hr](g)}return Oc(a)}var mge,sG,aG,lG,CN=ge(()=>{"use strict";p();Pn();Cg();Lc();Wn();gi();mN();EN();mge="TelemetryPluginChain",sG="_hasRun",aG="_getTelCtx",lG=0});function cG(r,e,t){e&&nn(e)&&e[_t]>0&&(e=e.sort(function(n,i){return n[ga]-i[ga]}),wt(e,function(n){n[ga]<cx&&Zn(vge+n[El])}),r[Lt]({queue:Oc(e),chain:Fc(e,t[Mc],t)}))}function uG(r,e){function t(){return Kc(null,e[Mc],e,null)}function n(u,c,d,f){var m=u?u[_t]+1:1;function g(){m--,m===0&&(f&&f(),f=null)}m>0&&wt(u,function(b){if(b&&b.queue[_t]>0){var v=b.chain,k=c[Cd](v);k[Bw](g),d(k)}else m--}),g()}function i(u,c){var d=c||{reason:0};return n(r,u,function(f){f[Hr](d)},function(){u[Hr](d)}),!0}function o(u,c){var d=c||{reason:0,isAsync:!1};return n(r,u,function(f){f[Hr](d)},function(){u[Hr](d),a=!1}),!0}function s(u){var c=null;return r&&r[_t]>0&&wt(r,function(d){if(d&&d.queue[_t]>0&&(wt(d.queue,function(f){if(f[El]===u)return c=f,-1}),c))return-1}),c}var a=!1,l={identifier:"ChannelControllerPlugin",priority:cx,initialize:function(u,c,d,f){a=!0,wt(r,function(m){m&&m.queue[_t]>0&&SN(Kc(m.chain,u,c),d)})},isInitialized:function(){return a},processTelemetry:function(u,c){n(r,c||t(),function(d){d[Hr](u)},function(){c[Hr](u)})},update:i,pause:function(){n(r,t(),function(u){u.iterate(function(c){c.pause&&c.pause()})},null)},resume:function(){n(r,t(),function(u){u.iterate(function(c){c.resume&&c.resume()})},null)},teardown:o,getChannel:s,flush:function(u,c,d,f){var m=1,g=!1,b=null;f=f||5e3;function v(){m--,g&&m===0&&(b&&(clearTimeout(b),b=null),c&&c(g),c=null)}return n(r,t(),function(k){k.iterate(function(R){if(R[Db]){m++;var P=!1;R[Db](u,function(){P=!0,v()},d)||P||(u&&b==null?b=setTimeout(function(){b=null,v()},f):v())}})},function(){g=!0,v()}),!0},_setQueue:function(u){r=u}};return l}function dG(r,e,t){var n=[];if(r&&wt(r,function(o){return cG(n,o,t)}),e){var i=[];wt(e,function(o){o[ga]>cx&&i[Lt](o)}),cG(n,i,t)}return n}var cx,vge,pG=ge(()=>{p();Pn();Wn();gi();CN();EN();cx=500,vge="Channel has invalid priority - "});function wN(){var r=[];function e(n){n&&r[Lt](n)}function t(n,i){wt(r,function(o){try{o(n,i)}catch(s){kl(n[ha](),2,73,"Unexpected error calling unload handler - "+Ia(s))}}),r=[]}return{add:e,run:t}}var v2=ge(()=>{p();Pn();Cg();Lc();Wn()});var Df,fG,mG=ge(()=>{"use strict";p();dr();Pn();Wn();gi();CN();v2();Df="getPlugin",fG=function(){function r(){var e=this,t,n,i,o,s;u(),He(r,e,function(c){c[_l]=function(d,f,m,g){l(d,f,g),t=!0},c[Ns]=function(d,f){var m,g=c[pn];if(!g||d&&g!==d[pn]())return;var b,v=!1,k=d||qb(null,g,i&&i[Df]?i[Df]():i),R=f||(m={reason:0},m[Cl]=!1,m);function P(){if(!v){v=!0,o.run(k,f);var D=s;s=[],wt(D,function(K){K.rm()}),b===!0&&k[Hr](R),u()}}return!c[kb]||c[kb](k,R,P)!==!0?P():b=!0,b},c[yg]=function(d,f){var m=c[pn];if(!m||d&&m!==d[pn]())return;var g,b=!1,v=d||lx(null,m,i&&i[Df]?i[Df]():i),k=f||{reason:0};function R(){b||(b=!0,l(v.getCfg(),v.core(),v[Rs]()))}return!c._doUpdate||c._doUpdate(v,k,R)!==!0?R():g=!0,g},c._addHook=function(d){d&&(nn(d)?s=s.concat(d):s[Lt](d))},Ub(c,"_addUnloadCb",function(){return o},"add")}),e[ha]=function(c){return a(c)[ha]()},e[Ts]=function(){return t},e.setInitialized=function(c){t=c},e[Sf]=function(c){i=c},e[Hr]=function(c,d){d?d[Hr](c):i&&wr(i[is])&&i[is](c,null)},e._getTelCtx=a;function a(c){c===void 0&&(c=null);var d=c;if(!d){var f=n||Kc(null,{},e[pn]);i&&i[Df]?d=f[Cd](null,i[Df]):d=f[Cd](null,i)}return d}function l(c,d,f){c&&ya(c,Rb,[],null,or),!f&&d&&(f=d[z0]()[Rs]());var m=i;i&&i[Df]&&(m=i[Df]()),e[pn]=d,n=Kc(f,c,d,m)}function u(){t=!1,e[pn]=null,n=null,i=null,s=[],o=wN()}}return r.__ieDyn=1,r}()});var hG,gG=ge(()=>{p();ir();dr();Pn();mG();Cg();Lc();Wn();gi();hG=function(r){In(e,r);function e(){var t=r.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var n,i;o(),He(e,t,function(s,a){s.addTelemetryInitializer=function(l){var u={id:n++,fn:l};i[Lt](u);var c={remove:function(){wt(i,function(d,f){if(d.id===u.id)return i[bf](f,1),-1})}};return c},s[is]=function(l,u){for(var c=!1,d=i[_t],f=0;f<d;++f){var m=i[f];if(m)try{if(m.fn[Nb](null,[l])===!1){c=!0;break}}catch(g){kl(u[ha](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Zw(g),{exception:Ia(g)},!0)}}c||s[Hr](l,u)},s[kb]=function(){o()}});function o(){n=0,i=[]}return t}return e.__ieDyn=1,e}(fG)});function Ige(r,e){return new I4(e)}function Sge(r,e,t){var n,i=[],o={};return wt(t,function(s){(or(s)||or(s[_l]))&&Zn(IG);var a=s[ga],l=s[El];s&&a&&(or(o[a])?o[a]=l:b4(r,"Two extensions have same priority #"+a+" - "+o[a]+", "+l)),(!a||a<e)&&i[Lt](s)}),n={all:t},n[pn]=i,n}function bG(r,e){var t=!1;return wt(e,function(n){if(n===r)return t=!0,-1}),t}function _ge(){var r;return So((r={},r[hg]=function(e){},r[gg]=function(e){},r[Ab]=function(e){},r[Ef]=function(e,t){},r[Mb]=function(e,t){},r))}var IG,vG,yG,yge,bge,SG,_G=ge(()=>{"use strict";p();ir();dr();ir();Pn();pG();f2();vN();i2();Cg();Wn();gi();mN();CN();EN();gG();v2();IG="Plugins must provide initialize method",vG="_notificationManager",yG="SDK is still unloading...",yge="SDK is not initialized",bge={loggingLevelConsole:1};SG=function(){function r(){var e,t,n,i,o,s,a,l,u,c,d,f,m,g,b,v,k,R,P,D,K=0;He(r,this,function(L){B(),L[Ts]=function(){return t},L[_l]=function(q,$,ue,pe){g&&Zn(yG),L[Ts]()&&Zn("Core should not be initialized more than once"),e=q||{},L[Mc]=e,or(q[$0])&&Zn("Please provide instrumentation key"),i=pe,L[vG]=pe,Y(),Z(),ie(),ue&&(L[ks]=ue);var ye=Fb(e,JJ,[]);u=[],u[Lt].apply(u,Vm(Vm([],$,!1),ye,!1)),f=Fb(e,OW,[]),O(null),(!m||m[_t]===0)&&Zn("No "+OW+" available"),t=!0,L.releaseQueue()},L.getTransmissionControls=function(){var q=[];return m&&wt(m,function($){q[Lt]($.queue)}),Oc(q)},L.track=function(q){q.iKey=q.iKey||e[$0],q[mg]=q[mg]||Lb(new Date),q.ver=q.ver||"4.0",!g&&L[Ts]()?N()[Hr](q):n[Lt](q)},L[z0]=N,L[jw]=function(){return i||(i=_ge(),L[vG]=i),i},L[hg]=function(q){i&&i[hg](q)},L[gg]=function(q){i&&i[gg](q)},L.getCookieMgr=function(){return a||(a=nx(e,L[ks])),a},L.setCookieMgr=function(q){a=q},L[_g]=function(){if(!o&&!s&&ba(e.enablePerfMgr)){var q=ba(e[LW]);wr(q)&&(s=q(L,L[jw]()))}return o||s||S4()},L.setPerfMgr=function(q){o=q},L.eventCnt=function(){return n[_t]},L.releaseQueue=function(){if(t&&n[_t]>0){var q=n;n=[],wt(q,function($){N()[Hr]($)})}},L.pollInternalLogs=function(q){v=q||null;var $=ba(e.diagnosticLogInterval);return(!$||!($>0))&&($=1e4),K&&clearInterval(K),K=setInterval(function(){T()},$),K},L[RW]=function(){K&&(clearInterval(K),K=0,T())},xf(L,function(){return b},["addTelemetryInitializer"]),L.unload=function(q,$,ue){var pe;q===void 0&&(q=!0),t||Zn(yge),g&&Zn(yG);var ye=(pe={reason:50},pe[Cl]=q,pe.flushComplete=!1,pe),z=qb(y(),L);z[Bw](function(){B(),$&&$(ye)},L);function fe(Se){ye.flushComplete=Se,g=!0,R.run(z,ye),L[RW](),z[Hr](ye)}H(q,fe,6,ue)||fe(!1)},L[vg]=h,L.addPlugin=function(q,$,ue,pe){if(!q){pe&&pe(!1),be(IG);return}var ye=h(q[El]);if(ye&&!$){pe&&pe(!1),be("Plugin ["+q[El]+"] is already loaded!");return}var z={reason:16};function fe(Le){u[Lt](q),z.added=[q],O(z),pe&&pe(!0)}if(ye){var Se=[ye.plugin],Te={reason:2,isAsync:!!ue};w(Se,Te,function(Le){Le?(z.removed=Se,z.reason|=32,fe(!0)):pe&&pe(!1)})}else fe(!1)},L.evtNamespace=function(){return k},L[Db]=H,L.getTraceCtx=function(q){return D||(D=oG()),D},L.setTraceCtx=function(q){D=q||null},Ub(L,"addUnloadCb",function(){return R},"add");function B(){t=!1,e=Wb(!0,{},bge),L[Mc]=e,L[ks]=new Vb(e),L[Hw]=[],b=new hG,n=[],i=null,o=null,s=null,a=null,l=null,c=null,u=[],d=null,f=null,m=null,g=!1,v=null,k=Bb("AIBaseCore",!0),R=wN(),D=null}function N(){return Kc(y(),e,L)}function O(q){var $=Sge(L[ks],cx,u);c=$[pn],l=null;var ue=$.all;if(m=Oc(dG(f,ue,L)),d){var pe=va(ue,d);pe!==-1&&ue[bf](pe,1),pe=va(c,d),pe!==-1&&c[bf](pe,1),d._setQueue(m)}else d=uG(m,L);ue[Lt](d),c[Lt](d),L[Hw]=_N(ue),d[_l](e,L,ue),SN(N(),ue),L[Hw]=Oc(_N(c||[])).slice(),q&&le(q)}function h(q){var $,ue=null,pe=null;return wt(L[Hw],function(ye){if(ye[El]===q&&ye!==d&&ye!==b)return pe=ye,-1}),!pe&&d&&(pe=d.getChannel(q)),pe&&(ue=($={plugin:pe},$[wd]=function(ye){Dd(pe)[$w]=!ye},$.isEnabled=function(){var ye=Dd(pe);return!ye[Ns]&&!ye[$w]},$.remove=function(ye,z){var fe;ye===void 0&&(ye=!0);var Se=[pe],Te=(fe={reason:1},fe[Cl]=ye,fe);w(Se,Te,function(Le){Le&&O({reason:32,removed:Se}),z&&z(Le)})},$)),ue}function y(){if(!l){var q=(c||[]).slice();va(q,b)===-1&&q[Lt](b),l=Fc(_N(q),e,L)}return l}function w(q,$,ue){if(q&&q[_t]>0){var pe=Fc(q,e,L),ye=qb(pe,L);ye[Bw](function(){var z=!1,fe=[];wt(u,function(Te,Le){bG(Te,q)?z=!0:fe[Lt](Te)}),u=fe;var Se=[];f&&(wt(f,function(Te,Le){var Ye=[];wt(Te,function(Je){bG(Je,q)?z=!0:Ye[Lt](Je)}),Se[Lt](Ye)}),f=Se),ue&&ue(z)}),ye[Hr]($)}else ue(!1)}function T(){var q=L[ks]?L[ks].queue:[];q&&(wt(q,function($){var ue,pe=(ue={},ue[ns]=v||"InternalMessageId: "+$[Tb],ue.iKey=ba(e[$0]),ue.time=Lb(new Date),ue.baseType=dN.dataType,ue.baseData={message:$[If]},ue);L.track(pe)}),q[_t]=0)}function H(q,$,ue,pe){return d?d[Db](q,$,ue||6,pe):($&&$(!1),!0)}function Y(){var q=ba(e.disableDbgExt);q===!0&&P&&(i[gg](P),P=null),i&&!P&&q!==!0&&(P=m4(e),i[hg](P))}function Z(){var q=ba(e.enablePerfMgr);!q&&s&&(s=null),q&&Fb(e,LW,Ige)}function ie(){var q=Fb(e,Rb,{});q.NotificationManager=i}function le(q){var $=lx(y(),L);(!L._updateHook||L._updateHook($,q)!==!0)&&$[Hr](q)}function be(q){var $=L[ks];$?kl($,2,73,q):Zn(q)}})}return r.__ieDyn=1,r}()});function xN(r,e,t,n){wt(r,function(i){if(i&&i[e])if(t)setTimeout(function(){return n(i)},0);else try{n(i)}catch(o){}})}var EG,CG=ge(()=>{p();dr();Pn();Wn();gi();EG=function(){function r(e){this.listeners=[];var t=!!(e||{}).perfEvtsSendAll;He(r,this,function(n){n[hg]=function(i){n.listeners[Lt](i)},n[gg]=function(i){for(var o=va(n[Ig],i);o>-1;)n.listeners[bf](o,1),o=va(n[Ig],i)},n[Ab]=function(i){xN(n[Ig],Ab,!0,function(o){o[Ab](i)})},n[Ef]=function(i,o){xN(n[Ig],Ef,!0,function(s){s[Ef](i,o)})},n[Mb]=function(i,o){xN(n[Ig],Mb,o,function(s){s[Mb](i,o)})},n[Cf]=function(i){i&&(t||!i[Yw]())&&xN(n[Ig],Cf,!1,function(o){i[Cl]?setTimeout(function(){return o[Cf](i)},0):o[Cf](i)})}})}return r.__ieDyn=1,r}()});var ux,wG=ge(()=>{p();ir();dr();Pn();_G();Cg();Wn();gi();CG();mN();ux=function(r){In(e,r);function e(){var t=r.call(this)||this;return He(e,t,function(n,i){n[_l]=function(a,l,u,c){i[_l](a,l,u||new Vb(a),c||new EG(a))},n.track=function(a){fN(n[_g](),function(){return"AppInsightsCore:track"},function(){a===null&&(s(a),Zn("Invalid telemetry item")),o(a),i.track(a)},function(){return{item:a}},!a.sync)};function o(a){or(a[ns])&&(s(a),Zn("telemetry name required"))}function s(a){var l=n[jw]();l&&l[Ef]([a],2)}}),t}return e.__ieDyn=1,e}(SG)});var Me,kr,xg,Nl,xG,PG,PN,y2,dx,DN,Jb,Rl,Tf,Td,px,DG,Ege,b2,TG=ge(()=>{p();i4();kr="Failed",xg=kr+"MonitorAjax",Nl="Track",xG="Start",PG="Stop",PN="Event",y2="AuthContext",dx="Exception",DN="Local",Jb="Session",Rl="Storage",Tf="Browser",Td="Cannot",px="Buffer",DG="InstrumentationKey",Ege=QW({CRITICAL:1,WARNING:2}),b2=QW((Me={},Me[Tf+"DoesNotSupport"+DN+Rl]=0,Me[Tf+Td+"Read"+DN+Rl]=1,Me[Tf+Td+"Read"+Jb+Rl]=2,Me[Tf+Td+"Write"+DN+Rl]=3,Me[Tf+Td+"Write"+Jb+Rl]=4,Me[Tf+kr+"RemovalFrom"+DN+Rl]=5,Me[Tf+kr+"RemovalFrom"+Jb+Rl]=6,Me[Td+"SendEmptyTelemetry"]=7,Me.ClientPerformanceMathError=8,Me["ErrorParsingAI"+Jb+"Cookie"]=9,Me.ErrorPVCalc=10,Me[dx+"WhileLoggingError"]=11,Me[kr+"AddingTelemetryTo"+px]=12,Me[xg+"Abort"]=13,Me[xg+"Dur"]=14,Me[xg+"Open"]=15,Me[xg+"RSC"]=16,Me[xg+"Send"]=17,Me[xg+"GetCorrelationHeader"]=18,Me[kr+"ToAddHandlerForOnBeforeUnload"]=19,Me[kr+"ToSendQueuedTelemetry"]=20,Me[kr+"ToReportDataLoss"]=21,Me["Flush"+kr]=22,Me.MessageLimitPerPVExceeded=23,Me.MissingRequiredFieldSpecification=24,Me.NavigationTimingNotSupported=25,Me.OnError=26,Me[Jb+"RenewalDateIsZero"]=27,Me.SenderNotInitialized=28,Me[xG+Nl+PN+kr]=29,Me[PG+Nl+PN+kr]=30,Me[xG+Nl+kr]=31,Me[PG+Nl+kr]=32,Me.TelemetrySampledAndNotSent=33,Me[Nl+PN+kr]=34,Me[Nl+dx+kr]=35,Me[Nl+"Metric"+kr]=36,Me[Nl+"PV"+kr]=37,Me[Nl+"PV"+kr+"Calc"]=38,Me[Nl+"Trace"+kr]=39,Me["Transmission"+kr]=40,Me[kr+"ToSet"+Rl+px]=41,Me[kr+"ToRestore"+Rl+px]=42,Me.InvalidBackendResponse=43,Me[kr+"ToFixDepricatedValues"]=44,Me.InvalidDurationValue=45,Me.TelemetryEnvelopeInvalid=46,Me.CreateEnvelopeError=47,Me[Td+"SerializeObject"]=48,Me[Td+"SerializeObjectNonSerializable"]=49,Me.CircularReferenceDetected=50,Me["Clear"+y2+kr]=51,Me[dx+"Truncated"]=52,Me.IllegalCharsInName=53,Me.ItemNotInArray=54,Me.MaxAjaxPerPVExceeded=55,Me.MessageTruncated=56,Me.NameTooLong=57,Me.SampleRateOutOfRange=58,Me["Set"+y2+kr]=59,Me["Set"+y2+kr+"AccountName"]=60,Me.StringValueTooLong=61,Me.StartCalledMoreThanOnce=62,Me.StopCalledWithoutStart=63,Me["TelemetryInitializer"+kr]=64,Me.TrackArgumentsNotSpecified=65,Me.UrlTooLong=66,Me[Jb+Rl+px+"Full"]=67,Me[Td+"AccessCookie"]=68,Me.IdTooLong=69,Me.InvalidEvent=70,Me[xg+"SetRequestHeader"]=71,Me["Send"+Tf+"InfoOnUserInit"]=72,Me["Plugin"+dx]=73,Me["Notification"+dx]=74,Me.SnippetScriptLoadFailure=99,Me["Invalid"+DG]=100,Me[Td+"ParseAiBlobValue"]=101,Me.InvalidContentBlob=102,Me[Nl+"PageAction"+PN+kr]=103,Me[kr+"AddingCustomDefinedRequestContext"]=104,Me["InMemory"+Rl+px+"Full"]=105,Me[DG+"Deprecation"]=106,Me))});var I2=ge(()=>{p();wG();eG();Wn();TG()});var TN,kN,fx,kG=ge(()=>{p();TN="instrumentationKey",kN="connectionString",fx="diagnosticLogInterval"});var NG={};Wv(NG,{AppInsightsCore:()=>ux,ApplicationInsights:()=>Cge,CoreUtils:()=>ax,Sender:()=>Vw,SeverityLevel:()=>RU,_InternalMessageId:()=>b2,arrForEach:()=>wt,isNullOrUndefined:()=>or,proxyFunctions:()=>xf,throwError:()=>Zn});var Cge,RG=ge(()=>{p();dr();NW();of();I2();kG();I2();of();NW();Cge=function(){function r(e){var t=new ux;(or(e)||or(e[TN])&&or(e[kN]))&&Zn("Invalid input configuration"),He(r,this,function(n){if(e[kN]){var i=wU(e[kN]),o=i.ingestionendpoint;e.endpointUrl=o?o+cd:e.endpointUrl,e[TN]=i.instrumentationkey||e[TN]}n.config=e,s(),n.initialize=s,n.getSKUDefaults=function(){n.config[fx]=n.config[fx]&&n.config[fx]>0?n.config[fx]:1e4},n.getSKUDefaults(),xf(n,t,["track","flush","pollInternalLogs","stopPollingInternalLogs","unload","getPlugin","addPlugin","evtNamespace","addUnloadCb"]);function s(){t.initialize(n.config,[new Vw]),t.pollInternalLogs()}})}return r.__ieDyn=1,r}()});var MG={};Wv(MG,{default:()=>NN});function xge(r){if(r.userAgentData){let e=r.userAgentData.brands[r.userAgentData.brands.length-1];return`${r.userAgentData.platform} - ${e==null?void 0:e.brand} v${e==null?void 0:e.version}}`}else return r.appVersion}var AG,wge,NN,OG=ge(()=>{p();AG=ae(require("vscode"));n3();i3();o3();s3();wge=async(r,e)=>{let t;try{let i=await Promise.resolve().then(()=>(RG(),NG));t=new i.ApplicationInsights({instrumentationKey:r,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!1,disableInstrumentationKeyValidation:!0})}catch(i){return Promise.reject(i)}return{logEvent:(i,o)=>{let s={...o==null?void 0:o.properties,...o==null?void 0:o.measurements};e!=null&&e.length&&nb.applyReplacements(s,e),t==null||t.track({name:i,data:s})},flush:async()=>{t==null||t.flush()}}};NN=class extends Uk{constructor(e,t){let n=s=>wge(s,t);nb.shouldUseOneDataSystemSDK(e)&&(n=s=>r3(s,AG));let i={release:xge(navigator),platform:"web",architecture:"web"},o=new Fk(e,n);if(e&&e.indexOf("AIF")===0)throw new Error("AIF keys are no longer supported. Please switch to 1DS keys for 1st party extensions");super(o,AG,{additionalCommonProperties:nb.getAdditionalCommonProperties(i)})}}});var GN=re((ht,aQ)=>{p();ht=aQ.exports=zt;var xr;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?xr=function(){var r=Array.prototype.slice.call(arguments,0);r.unshift("SEMVER"),console.log.apply(console,r)}:xr=function(){};ht.SEMVER_SPEC_VERSION="2.0.0";var mx=256,FN=Number.MAX_SAFE_INTEGER||9007199254740991,C2=16,kge=mx-6,hx=ht.re=[],qr=ht.safeRe=[],De=ht.src=[],Jt=0,T2="[a-zA-Z0-9-]",w2=[["\\s",1],["\\d",mx],[T2,kge]];function HN(r){for(var e=0;e<w2.length;e++){var t=w2[e][0],n=w2[e][1];r=r.split(t+"*").join(t+"{0,"+n+"}").split(t+"+").join(t+"{1,"+n+"}")}return r}var zb=Jt++;De[zb]="0|[1-9]\\d*";var Qb=Jt++;De[Qb]="\\d+";var k2=Jt++;De[k2]="\\d*[a-zA-Z-]"+T2+"*";var Gz=Jt++;De[Gz]="("+De[zb]+")\\.("+De[zb]+")\\.("+De[zb]+")";var Yz=Jt++;De[Yz]="("+De[Qb]+")\\.("+De[Qb]+")\\.("+De[Qb]+")";var x2=Jt++;De[x2]="(?:"+De[zb]+"|"+De[k2]+")";var P2=Jt++;De[P2]="(?:"+De[Qb]+"|"+De[k2]+")";var N2=Jt++;De[N2]="(?:-("+De[x2]+"(?:\\."+De[x2]+")*))";var R2=Jt++;De[R2]="(?:-?("+De[P2]+"(?:\\."+De[P2]+")*))";var D2=Jt++;De[D2]=T2+"+";var vx=Jt++;De[vx]="(?:\\+("+De[D2]+"(?:\\."+De[D2]+")*))";var A2=Jt++,$z="v?"+De[Gz]+De[N2]+"?"+De[vx]+"?";De[A2]="^"+$z+"$";var M2="[v=\\s]*"+De[Yz]+De[R2]+"?"+De[vx]+"?",O2=Jt++;De[O2]="^"+M2+"$";var rI=Jt++;De[rI]="((?:<|>)?=?)";var UN=Jt++;De[UN]=De[Qb]+"|x|X|\\*";var WN=Jt++;De[WN]=De[zb]+"|x|X|\\*";var Dg=Jt++;De[Dg]="[v=\\s]*("+De[WN]+")(?:\\.("+De[WN]+")(?:\\.("+De[WN]+")(?:"+De[N2]+")?"+De[vx]+"?)?)?";var Zb=Jt++;De[Zb]="[v=\\s]*("+De[UN]+")(?:\\.("+De[UN]+")(?:\\.("+De[UN]+")(?:"+De[R2]+")?"+De[vx]+"?)?)?";var zz=Jt++;De[zz]="^"+De[rI]+"\\s*"+De[Dg]+"$";var Qz=Jt++;De[Qz]="^"+De[rI]+"\\s*"+De[Zb]+"$";var Xz=Jt++;De[Xz]="(?:^|[^\\d])(\\d{1,"+C2+"})(?:\\.(\\d{1,"+C2+"}))?(?:\\.(\\d{1,"+C2+"}))?(?:$|[^\\d])";var qN=Jt++;De[qN]="(?:~>?)";var eI=Jt++;De[eI]="(\\s*)"+De[qN]+"\\s+";hx[eI]=new RegExp(De[eI],"g");qr[eI]=new RegExp(HN(De[eI]),"g");var Nge="$1~",Zz=Jt++;De[Zz]="^"+De[qN]+De[Dg]+"$";var eQ=Jt++;De[eQ]="^"+De[qN]+De[Zb]+"$";var JN=Jt++;De[JN]="(?:\\^)";var tI=Jt++;De[tI]="(\\s*)"+De[JN]+"\\s+";hx[tI]=new RegExp(De[tI],"g");qr[tI]=new RegExp(HN(De[tI]),"g");var Rge="$1^",tQ=Jt++;De[tQ]="^"+De[JN]+De[Dg]+"$";var rQ=Jt++;De[rQ]="^"+De[JN]+De[Zb]+"$";var L2=Jt++;De[L2]="^"+De[rI]+"\\s*("+M2+")$|^$";var K2=Jt++;De[K2]="^"+De[rI]+"\\s*("+$z+")$|^$";var Tg=Jt++;De[Tg]="(\\s*)"+De[rI]+"\\s*("+M2+"|"+De[Dg]+")";hx[Tg]=new RegExp(De[Tg],"g");qr[Tg]=new RegExp(HN(De[Tg]),"g");var Age="$1$2$3",nQ=Jt++;De[nQ]="^\\s*("+De[Dg]+")\\s+-\\s+("+De[Dg]+")\\s*$";var iQ=Jt++;De[iQ]="^\\s*("+De[Zb]+")\\s+-\\s+("+De[Zb]+")\\s*$";var oQ=Jt++;De[oQ]="(<|>)?=?\\s*\\*";for(Wc=0;Wc<Jt;Wc++)xr(Wc,De[Wc]),hx[Wc]||(hx[Wc]=new RegExp(De[Wc]),qr[Wc]=new RegExp(HN(De[Wc])));var Wc;ht.parse=kg;function kg(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof zt)return r;if(typeof r!="string"||r.length>mx)return null;var t=e.loose?qr[O2]:qr[A2];if(!t.test(r))return null;try{return new zt(r,e)}catch(n){return null}}ht.valid=Mge;function Mge(r,e){var t=kg(r,e);return t?t.version:null}ht.clean=Oge;function Oge(r,e){var t=kg(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null}ht.SemVer=zt;function zt(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof zt){if(r.loose===e.loose)return r;r=r.version}else if(typeof r!="string")throw new TypeError("Invalid Version: "+r);if(r.length>mx)throw new TypeError("version is longer than "+mx+" characters");if(!(this instanceof zt))return new zt(r,e);xr("SemVer",r,e),this.options=e,this.loose=!!e.loose;var t=r.trim().match(e.loose?qr[O2]:qr[A2]);if(!t)throw new TypeError("Invalid Version: "+r);if(this.raw=r,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>FN||this.major<0)throw new TypeError("Invalid major version");if(this.minor>FN||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>FN||this.patch<0)throw new TypeError("Invalid patch version");t[4]?this.prerelease=t[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var i=+n;if(i>=0&&i<FN)return i}return n}):this.prerelease=[],this.build=t[5]?t[5].split("."):[],this.format()}zt.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};zt.prototype.toString=function(){return this.version};zt.prototype.compare=function(r){return xr("SemVer.compare",this.version,this.options,r),r instanceof zt||(r=new zt(r,this.options)),this.compareMain(r)||this.comparePre(r)};zt.prototype.compareMain=function(r){return r instanceof zt||(r=new zt(r,this.options)),Xb(this.major,r.major)||Xb(this.minor,r.minor)||Xb(this.patch,r.patch)};zt.prototype.comparePre=function(r){if(r instanceof zt||(r=new zt(r,this.options)),this.prerelease.length&&!r.prerelease.length)return-1;if(!this.prerelease.length&&r.prerelease.length)return 1;if(!this.prerelease.length&&!r.prerelease.length)return 0;var e=0;do{var t=this.prerelease[e],n=r.prerelease[e];if(xr("prerelease compare",e,t,n),t===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(t===void 0)return-1;if(t===n)continue;return Xb(t,n)}while(++e)};zt.prototype.inc=function(r,e){switch(r){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var t=this.prerelease.length;--t>=0;)typeof this.prerelease[t]=="number"&&(this.prerelease[t]++,t=-2);t===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+r)}return this.format(),this.raw=this.version,this};ht.inc=Lge;function Lge(r,e,t,n){typeof t=="string"&&(n=t,t=void 0);try{return new zt(r,t).inc(e,n).version}catch(i){return null}}ht.diff=Kge;function Kge(r,e){if(F2(r,e))return null;var t=kg(r),n=kg(e),i="";if(t.prerelease.length||n.prerelease.length){i="pre";var o="prerelease"}for(var s in t)if((s==="major"||s==="minor"||s==="patch")&&t[s]!==n[s])return i+s;return o}ht.compareIdentifiers=Xb;var Jz=/^[0-9]+$/;function Xb(r,e){var t=Jz.test(r),n=Jz.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1}ht.rcompareIdentifiers=Fge;function Fge(r,e){return Xb(e,r)}ht.major=Uge;function Uge(r,e){return new zt(r,e).major}ht.minor=Wge;function Wge(r,e){return new zt(r,e).minor}ht.patch=Vge;function Vge(r,e){return new zt(r,e).patch}ht.compare=Nd;function Nd(r,e,t){return new zt(r,t).compare(new zt(e,t))}ht.compareLoose=jge;function jge(r,e){return Nd(r,e,!0)}ht.rcompare=Bge;function Bge(r,e,t){return Nd(e,r,t)}ht.sort=Hge;function Hge(r,e){return r.sort(function(t,n){return ht.compare(t,n,e)})}ht.rsort=qge;function qge(r,e){return r.sort(function(t,n){return ht.rcompare(t,n,e)})}ht.gt=gx;function gx(r,e,t){return Nd(r,e,t)>0}ht.lt=VN;function VN(r,e,t){return Nd(r,e,t)<0}ht.eq=F2;function F2(r,e,t){return Nd(r,e,t)===0}ht.neq=sQ;function sQ(r,e,t){return Nd(r,e,t)!==0}ht.gte=U2;function U2(r,e,t){return Nd(r,e,t)>=0}ht.lte=W2;function W2(r,e,t){return Nd(r,e,t)<=0}ht.cmp=jN;function jN(r,e,t,n){switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return F2(r,t,n);case"!=":return sQ(r,t,n);case">":return gx(r,t,n);case">=":return U2(r,t,n);case"<":return VN(r,t,n);case"<=":return W2(r,t,n);default:throw new TypeError("Invalid operator: "+e)}}ht.Comparator=Sa;function Sa(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof Sa){if(r.loose===!!e.loose)return r;r=r.value}if(!(this instanceof Sa))return new Sa(r,e);r=r.trim().split(/\s+/).join(" "),xr("comparator",r,e),this.options=e,this.loose=!!e.loose,this.parse(r),this.semver===yx?this.value="":this.value=this.operator+this.semver.version,xr("comp",this)}var yx={};Sa.prototype.parse=function(r){var e=this.options.loose?qr[L2]:qr[K2],t=r.match(e);if(!t)throw new TypeError("Invalid comparator: "+r);this.operator=t[1],this.operator==="="&&(this.operator=""),t[2]?this.semver=new zt(t[2],this.options.loose):this.semver=yx};Sa.prototype.toString=function(){return this.value};Sa.prototype.test=function(r){return xr("Comparator.test",r,this.options.loose),this.semver===yx?!0:(typeof r=="string"&&(r=new zt(r,this.options)),jN(r,this.operator,this.semver,this.options))};Sa.prototype.intersects=function(r,e){if(!(r instanceof Sa))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var t;if(this.operator==="")return t=new fn(r.value,e),BN(this.value,t,e);if(r.operator==="")return t=new fn(this.value,e),BN(r.semver,t,e);var n=(this.operator===">="||this.operator===">")&&(r.operator===">="||r.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(r.operator==="<="||r.operator==="<"),o=this.semver.version===r.semver.version,s=(this.operator===">="||this.operator==="<=")&&(r.operator===">="||r.operator==="<="),a=jN(this.semver,"<",r.semver,e)&&(this.operator===">="||this.operator===">")&&(r.operator==="<="||r.operator==="<"),l=jN(this.semver,">",r.semver,e)&&(this.operator==="<="||this.operator==="<")&&(r.operator===">="||r.operator===">");return n||i||o&&s||a||l};ht.Range=fn;function fn(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof fn)return r.loose===!!e.loose&&r.includePrerelease===!!e.includePrerelease?r:new fn(r.raw,e);if(r instanceof Sa)return new fn(r.value,e);if(!(this instanceof fn))return new fn(r,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=r.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(t){return this.parseRange(t.trim())},this).filter(function(t){return t.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}fn.prototype.format=function(){return this.range=this.set.map(function(r){return r.join(" ").trim()}).join("||").trim(),this.range};fn.prototype.toString=function(){return this.range};fn.prototype.parseRange=function(r){var e=this.options.loose,t=e?qr[iQ]:qr[nQ];r=r.replace(t,tve),xr("hyphen replace",r),r=r.replace(qr[Tg],Age),xr("comparator trim",r,qr[Tg]),r=r.replace(qr[eI],Nge),r=r.replace(qr[tI],Rge);var n=e?qr[L2]:qr[K2],i=r.split(" ").map(function(o){return Gge(o,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(o){return!!o.match(n)})),i=i.map(function(o){return new Sa(o,this.options)},this),i};fn.prototype.intersects=function(r,e){if(!(r instanceof fn))throw new TypeError("a Range is required");return this.set.some(function(t){return t.every(function(n){return r.set.some(function(i){return i.every(function(o){return n.intersects(o,e)})})})})};ht.toComparators=Jge;function Jge(r,e){return new fn(r,e).set.map(function(t){return t.map(function(n){return n.value}).join(" ").trim().split(" ")})}function Gge(r,e){return xr("comp",r,e),r=zge(r,e),xr("caret",r),r=Yge(r,e),xr("tildes",r),r=Xge(r,e),xr("xrange",r),r=eve(r,e),xr("stars",r),r}function To(r){return!r||r.toLowerCase()==="x"||r==="*"}function Yge(r,e){return r.trim().split(/\s+/).map(function(t){return $ge(t,e)}).join(" ")}function $ge(r,e){var t=e.loose?qr[eQ]:qr[Zz];return r.replace(t,function(n,i,o,s,a){xr("tilde",r,n,i,o,s,a);var l;return To(i)?l="":To(o)?l=">="+i+".0.0 <"+(+i+1)+".0.0":To(s)?l=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0":a?(xr("replaceTilde pr",a),l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+(+o+1)+".0"):l=">="+i+"."+o+"."+s+" <"+i+"."+(+o+1)+".0",xr("tilde return",l),l})}function zge(r,e){return r.trim().split(/\s+/).map(function(t){return Qge(t,e)}).join(" ")}function Qge(r,e){xr("caret",r,e);var t=e.loose?qr[rQ]:qr[tQ];return r.replace(t,function(n,i,o,s,a){xr("caret",r,n,i,o,s,a);var l;return To(i)?l="":To(o)?l=">="+i+".0.0 <"+(+i+1)+".0.0":To(s)?i==="0"?l=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+".0 <"+(+i+1)+".0.0":a?(xr("replaceCaret pr",a),i==="0"?o==="0"?l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+o+"."+(+s+1):l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+"."+s+"-"+a+" <"+(+i+1)+".0.0"):(xr("no pr"),i==="0"?o==="0"?l=">="+i+"."+o+"."+s+" <"+i+"."+o+"."+(+s+1):l=">="+i+"."+o+"."+s+" <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+"."+s+" <"+(+i+1)+".0.0"),xr("caret return",l),l})}function Xge(r,e){return xr("replaceXRanges",r,e),r.split(/\s+/).map(function(t){return Zge(t,e)}).join(" ")}function Zge(r,e){r=r.trim();var t=e.loose?qr[Qz]:qr[zz];return r.replace(t,function(n,i,o,s,a,l){xr("xRange",r,n,i,o,s,a,l);var u=To(o),c=u||To(s),d=c||To(a),f=d;return i==="="&&f&&(i=""),u?i===">"||i==="<"?n="<0.0.0":n="*":i&&f?(c&&(s=0),a=0,i===">"?(i=">=",c?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):i==="<="&&(i="<",c?o=+o+1:s=+s+1),n=i+o+"."+s+"."+a):c?n=">="+o+".0.0 <"+(+o+1)+".0.0":d&&(n=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0"),xr("xRange return",n),n})}function eve(r,e){return xr("replaceStars",r,e),r.trim().replace(qr[oQ],"")}function tve(r,e,t,n,i,o,s,a,l,u,c,d,f){return To(t)?e="":To(n)?e=">="+t+".0.0":To(i)?e=">="+t+"."+n+".0":e=">="+e,To(l)?a="":To(u)?a="<"+(+l+1)+".0.0":To(c)?a="<"+l+"."+(+u+1)+".0":d?a="<="+l+"."+u+"."+c+"-"+d:a="<="+a,(e+" "+a).trim()}fn.prototype.test=function(r){if(!r)return!1;typeof r=="string"&&(r=new zt(r,this.options));for(var e=0;e<this.set.length;e++)if(rve(this.set[e],r,this.options))return!0;return!1};function rve(r,e,t){for(var n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(n=0;n<r.length;n++)if(xr(r[n].semver),r[n].semver!==yx&&r[n].semver.prerelease.length>0){var i=r[n].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}ht.satisfies=BN;function BN(r,e,t){try{e=new fn(e,t)}catch(n){return!1}return e.test(r)}ht.maxSatisfying=nve;function nve(r,e,t){var n=null,i=null;try{var o=new fn(e,t)}catch(s){return null}return r.forEach(function(s){o.test(s)&&(!n||i.compare(s)===-1)&&(n=s,i=new zt(n,t))}),n}ht.minSatisfying=ive;function ive(r,e,t){var n=null,i=null;try{var o=new fn(e,t)}catch(s){return null}return r.forEach(function(s){o.test(s)&&(!n||i.compare(s)===1)&&(n=s,i=new zt(n,t))}),n}ht.minVersion=ove;function ove(r,e){r=new fn(r,e);var t=new zt("0.0.0");if(r.test(t)||(t=new zt("0.0.0-0"),r.test(t)))return t;t=null;for(var n=0;n<r.set.length;++n){var i=r.set[n];i.forEach(function(o){var s=new zt(o.semver.version);switch(o.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!t||gx(t,s))&&(t=s);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+o.operator)}})}return t&&r.test(t)?t:null}ht.validRange=sve;function sve(r,e){try{return new fn(r,e).range||"*"}catch(t){return null}}ht.ltr=ave;function ave(r,e,t){return V2(r,e,"<",t)}ht.gtr=lve;function lve(r,e,t){return V2(r,e,">",t)}ht.outside=V2;function V2(r,e,t,n){r=new zt(r,n),e=new fn(e,n);var i,o,s,a,l;switch(t){case">":i=gx,o=W2,s=VN,a=">",l=">=";break;case"<":i=VN,o=U2,s=gx,a="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(BN(r,e,n))return!1;for(var u=0;u<e.set.length;++u){var c=e.set[u],d=null,f=null;if(c.forEach(function(m){m.semver===yx&&(m=new Sa(">=0.0.0")),d=d||m,f=f||m,i(m.semver,d.semver,n)?d=m:s(m.semver,f.semver,n)&&(f=m)}),d.operator===a||d.operator===l||(!f.operator||f.operator===a)&&o(r,f.semver))return!1;if(f.operator===l&&s(r,f.semver))return!1}return!0}ht.prerelease=cve;function cve(r,e){var t=kg(r,e);return t&&t.prerelease.length?t.prerelease:null}ht.intersects=uve;function uve(r,e,t){return r=new fn(r,t),e=new fn(e,t),r.intersects(e)}ht.coerce=dve;function dve(r){if(r instanceof zt)return r;if(typeof r!="string")return null;var e=r.match(qr[Xz]);return e==null?null:kg(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var Y2=re((n1,TQ)=>{p();(function(r,e){typeof n1=="object"&&typeof TQ!="undefined"?e(n1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(n1,function(r){"use strict";r.ArrayExt=void 0,function(h){function y(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(A[me]===M)return me}return-1}h.firstIndexOf=y;function w(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(A[me]===M)return me}return-1}h.lastIndexOf=w;function T(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(M(A[me],me))return me}return-1}h.findFirstIndex=T;function H(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(M(A[me],me))return me}return-1}h.findLastIndex=H;function Y(A,M,I=0,S=-1){let _=T(A,M,I,S);return _!==-1?A[_]:void 0}h.findFirstValue=Y;function Z(A,M,I=-1,S=0){let _=H(A,M,I,S);return _!==-1?A[_]:void 0}h.findLastValue=Z;function ie(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function le(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=le;function be(A,M,I){if(A===M)return!0;if(A.length!==M.length)return!1;for(let S=0,_=A.length;S<_;++S)if(I?!I(A[S],M[S]):A[S]!==M[S])return!1;return!0}h.shallowEqual=be;function q(A,M={}){let{start:I,stop:S,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=A.length;I===void 0?I=_<0?F-1:0:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F),S===void 0?S=_<0?-1:F:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F);let j;_<0&&S>=I||_>0&&I>=S?j=0:_<0?j=Math.floor((S-I+1)/_+1):j=Math.floor((S-I-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=A[I+Fe*_];return me}h.slice=q;function $(A,M,I){let S=A.length;if(S<=1||(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1),M===I))return;let _=A[M],F=M<I?1:-1;for(let j=M;j!==I;j+=F)A[j]=A[j+F];A[I]=_}h.move=$;function ue(A,M=0,I=-1){let S=A.length;if(!(S<=1))for(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1);M<I;){let _=A[M],F=A[I];A[M++]=F,A[I--]=_}}h.reverse=ue;function pe(A,M,I=0,S=-1){let _=A.length;if(_<=1||(I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I>=S))return;let F=S-I+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=I+M;ue(A,I,j-1),ue(A,j,S),ue(A,I,S)}h.rotate=pe;function ye(A,M,I=0,S=-1){let _=A.length;if(_===0)return;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j)A[(I+j)%_]=M}h.fill=ye;function z(A,M,I){let S=A.length;M<0?M=Math.max(0,M+S):M=Math.min(M,S);for(let _=S;_>M;--_)A[_]=A[_-1];A[M]=I}h.insert=z;function fe(A,M){let I=A.length;if(M<0&&(M+=I),M<0||M>=I)return;let S=A[M];for(let _=M+1;_<I;++_)A[_-1]=A[_];return A.length=I-1,S}h.removeAt=fe;function Se(A,M,I=0,S=-1){let _=y(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeFirstOf=Se;function Te(A,M,I=-1,S=0){let _=w(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeLastOf=Te;function Le(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&A[j]===M||S<I&&(j<=S||j>=I)&&A[j]===M?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllOf=Le;function Ye(A,M,I=0,S=-1){let _,F=T(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeFirstWhere=Ye;function Je(A,M,I=-1,S=0){let _,F=H(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeLastWhere=Je;function Bt(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&M(A[j],j)||S<I&&(j<=S||j>=I)&&M(A[j],j)?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let y of h)yield*y}function*t(){}function*n(h,y=0){for(let w of h)yield[y++,w]}function*i(h,y){let w=0;for(let T of h)y(T,w++)&&(yield T)}function o(h,y){let w=0;for(let T of h)if(y(T,w++))return T}function s(h,y){let w=0;for(let T of h)if(y(T,w++))return w-1;return-1}function a(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)<0&&(w=T)}return w}function l(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)>0&&(w=T)}return w}function u(h,y){let w=!0,T,H;for(let Y of h)w?(T=Y,H=Y,w=!1):y(Y,T)<0?T=Y:y(Y,H)>0&&(H=Y);return w?void 0:[T,H]}function c(h){return Array.from(h)}function d(h){let y={};for(let[w,T]of h)y[w]=T;return y}function f(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return}function m(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return!1;return!0}function g(h,y){let w=0;for(let T of h)if(y(T,w++))return!0;return!1}function*b(h,y){let w=0;for(let T of h)yield y(T,w++)}function*v(h,y,w){y===void 0?(y=h,h=0,w=1):w===void 0&&(w=1);let T=k.rangeLength(h,y,w);for(let H=0;H<T;H++)yield h+w*H}var k;(function(h){function y(w,T,H){return H===0?1/0:w>T&&H>0||w<T&&H<0?0:Math.ceil((T-w)/H)}h.rangeLength=y})(k||(k={}));function R(h,y,w){let T=h[Symbol.iterator](),H=0,Y=T.next();if(Y.done&&w===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return w;let Z=T.next();if(Z.done&&w===void 0)return Y.value;if(Z.done)return y(w,Y.value,H++);let ie;w===void 0?ie=y(Y.value,Z.value,H++):ie=y(y(w,Y.value,H++),Z.value,H++);let le;for(;!(le=T.next()).done;)ie=y(ie,le.value,H++);return ie}function*P(h,y){for(;0<y--;)yield h}function*D(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let y=h.length-1;y>-1;y--)yield h[y]}function L(h){let y=[],w=new Set,T=new Map;for(let Z of h)H(Z);for(let[Z]of T)Y(Z);return y;function H(Z){let[ie,le]=Z,be=T.get(le);be?be.push(ie):T.set(le,[ie])}function Y(Z){if(w.has(Z))return;w.add(Z);let ie=T.get(Z);if(ie)for(let le of ie)Y(le);y.push(Z)}}function*B(h,y){let w=0;for(let T of h)w++%y===0&&(yield T)}r.StringExt=void 0,function(h){function y(Z,ie,le=0){let be=new Array(ie.length);for(let q=0,$=le,ue=ie.length;q<ue;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=y;function w(Z,ie,le=0){let be=y(Z,ie,le);if(!be)return null;let q=0;for(let $=0,ue=be.length;$<ue;++$){let pe=be[$]-le;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=w;function T(Z,ie,le=0){let be=y(Z,ie,le);if(!be)return null;let q=0,$=le-1;for(let ue=0,pe=be.length;ue<pe;++ue){let ye=be[ue];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=T;function H(Z,ie,le){let be=[],q=0,$=0,ue=ie.length;for(;q<ue;){let pe=ie[q],ye=ie[q];for(;++q<ue&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(le(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,y){if(y<1)return;let w=h[Symbol.iterator](),T;for(;0<y--&&!(T=w.next()).done;)yield T.value}function*O(...h){let y=h.map(T=>T[Symbol.iterator]()),w=y.map(T=>T.next());for(;m(w,T=>!T.done);w=y.map(T=>T.next()))yield w.map(T=>T.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=D,r.range=v,r.reduce=R,r.repeat=P,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var Hc=re((i1,kQ)=>{p();(function(r,e){typeof i1=="object"&&typeof kQ!="undefined"?e(i1,Y2()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(i1,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(P){return P===null||typeof P=="boolean"||typeof P=="number"||typeof P=="string"}u.isPrimitive=c;function d(P){return Array.isArray(P)}u.isArray=d;function f(P){return!c(P)&&!d(P)}u.isObject=f;function m(P,D){if(P===D)return!0;if(c(P)||c(D))return!1;let K=d(P),L=d(D);return K!==L?!1:K&&L?b(P,D):v(P,D)}u.deepEqual=m;function g(P){return c(P)?P:d(P)?k(P):R(P)}u.deepCopy=g;function b(P,D){if(P===D)return!0;if(P.length!==D.length)return!1;for(let K=0,L=P.length;K<L;++K)if(!m(P[K],D[K]))return!1;return!0}function v(P,D){if(P===D)return!0;for(let K in P)if(P[K]!==void 0&&!(K in D))return!1;for(let K in D)if(D[K]!==void 0&&!(K in P))return!1;for(let K in P){let L=P[K],B=D[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function k(P){let D=new Array(P.length);for(let K=0,L=P.length;K<L;++K)D[K]=g(P[K]);return D}function R(P){let D={};for(let K in P){let L=P[K];L!==void 0&&(D[K]=g(L))}return D}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(v=>{let k=this._services.get(v);return k?this._plugins.get(k).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(v){var k,R,P,D;this._activated=!1,this._promise=null,this._service=null,this.id=v.id,this.description=(k=v.description)!==null&&k!==void 0?k:"",this.activate=v.activate,this.deactivate=(R=v.deactivate)!==null&&R!==void 0?R:null,this.provides=(P=v.provides)!==null&&P!==void 0?P:null,this.autoStart=(D=v.autoStart)!==null&&D!==void 0?D:!1,this.requires=v.requires?v.requires.slice():[],this.optional=v.optional?v.optional.slice():[]}get activated(){return this._activated}set activated(v){this._activated=v}get service(){return this._service}set service(v){this._service=v}get promise(){return this._promise}set promise(v){this._promise=v}}function d(b){return new c(b)}u.createPluginData=d;function f(b,v,k){let R=[...b.requires,...b.optional],P=K=>{if(K===b.provides)return!0;let L=k.get(K);if(!L)return!1;let B=v.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(D.push(L),N.some(P)?!0:(D.pop(),!1))};if(!b.provides||R.length===0)return;let D=[b.id];if(R.some(P))throw new ReferenceError(`Cycle detected: ${D.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,v,k){let R=new Array,P=N=>{let O=v.get(N),h=[...O.requires,...O.optional];R.push(...h.reduce((y,w)=>{let T=k.get(w);return T&&y.push([N,T]),y},[]))};for(let N of v.keys())P(N);let D=R.filter(N=>N[1]===b),K=0;for(;D.length>K;){let N=D.length,O=new Set(D.map(h=>h[0]));for(let h of O)R.filter(y=>y[1]===h).forEach(y=>{D.includes(y)||D.push(y)});K=N}let L=e.topologicSort(D),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,v){let k=new Set;for(let R of b.keys())b.get(R).autoStart===!0&&k.add(R);if(v.startPlugins)for(let R of v.startPlugins)k.add(R);if(v.ignorePlugins)for(let R of v.ignorePlugins)k.delete(R);return Array.from(k)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var Ms=re((o1,NQ)=>{p();(function(r,e){typeof o1=="object"&&typeof NQ!="undefined"?e(o1,Y2(),Hc()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(o1,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let y=g.get(N.sender);if(y||(y=[],g.set(N.sender,y)),R(y,N,O,h))return!1;let w=h||O,T=b.get(w);T||(T=[],b.set(w,T));let H={signal:N,slot:O,thisArg:h};return y.push(H),T.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let y=g.get(N.sender);if(!y||y.length===0)return!1;let w=R(y,N,O,h);if(!w)return!1;let T=h||O,H=b.get(T);return w.signal=null,D(y),D(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let y=b.get(O);if(!(!y||y.length===0)){for(let w of y)w.signal&&w.signal.sender===N&&(w.signal=null);D(h),D(y)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.thisArg||h.slot;h.signal=null,D(b.get(y))}D(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.signal.sender;h.signal=null,D(g.get(y))}D(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let y=0,w=h.length;y<w;++y){let T=h[y];T.signal===N&&P(T,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,v=new Set,k=typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate;function R(N,O,h,y){return e.find(N,w=>w.signal===O&&w.slot===h&&w.thisArg===y)}function P(N,O){let{signal:h,slot:y,thisArg:w}=N;try{y.call(w,h.sender,O)}catch(T){s.exceptionHandler(T)}}function D(N){v.size===0&&k(K),v.add(N)}function K(){v.forEach(L),v.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var $2=re((s1,RQ)=>{p();(function(r,e){typeof s1=="object"&&typeof RQ!="undefined"?e(s1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(s1,function(r){"use strict";r.ArrayExt=void 0,function(h){function y(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(A[me]===M)return me}return-1}h.firstIndexOf=y;function w(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(A[me]===M)return me}return-1}h.lastIndexOf=w;function T(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(M(A[me],me))return me}return-1}h.findFirstIndex=T;function H(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(M(A[me],me))return me}return-1}h.findLastIndex=H;function Y(A,M,I=0,S=-1){let _=T(A,M,I,S);return _!==-1?A[_]:void 0}h.findFirstValue=Y;function Z(A,M,I=-1,S=0){let _=H(A,M,I,S);return _!==-1?A[_]:void 0}h.findLastValue=Z;function ie(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function le(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=le;function be(A,M,I){if(A===M)return!0;if(A.length!==M.length)return!1;for(let S=0,_=A.length;S<_;++S)if(I?!I(A[S],M[S]):A[S]!==M[S])return!1;return!0}h.shallowEqual=be;function q(A,M={}){let{start:I,stop:S,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=A.length;I===void 0?I=_<0?F-1:0:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F),S===void 0?S=_<0?-1:F:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F);let j;_<0&&S>=I||_>0&&I>=S?j=0:_<0?j=Math.floor((S-I+1)/_+1):j=Math.floor((S-I-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=A[I+Fe*_];return me}h.slice=q;function $(A,M,I){let S=A.length;if(S<=1||(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1),M===I))return;let _=A[M],F=M<I?1:-1;for(let j=M;j!==I;j+=F)A[j]=A[j+F];A[I]=_}h.move=$;function ue(A,M=0,I=-1){let S=A.length;if(!(S<=1))for(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1);M<I;){let _=A[M],F=A[I];A[M++]=F,A[I--]=_}}h.reverse=ue;function pe(A,M,I=0,S=-1){let _=A.length;if(_<=1||(I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I>=S))return;let F=S-I+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=I+M;ue(A,I,j-1),ue(A,j,S),ue(A,I,S)}h.rotate=pe;function ye(A,M,I=0,S=-1){let _=A.length;if(_===0)return;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j)A[(I+j)%_]=M}h.fill=ye;function z(A,M,I){let S=A.length;M<0?M=Math.max(0,M+S):M=Math.min(M,S);for(let _=S;_>M;--_)A[_]=A[_-1];A[M]=I}h.insert=z;function fe(A,M){let I=A.length;if(M<0&&(M+=I),M<0||M>=I)return;let S=A[M];for(let _=M+1;_<I;++_)A[_-1]=A[_];return A.length=I-1,S}h.removeAt=fe;function Se(A,M,I=0,S=-1){let _=y(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeFirstOf=Se;function Te(A,M,I=-1,S=0){let _=w(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeLastOf=Te;function Le(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&A[j]===M||S<I&&(j<=S||j>=I)&&A[j]===M?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllOf=Le;function Ye(A,M,I=0,S=-1){let _,F=T(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeFirstWhere=Ye;function Je(A,M,I=-1,S=0){let _,F=H(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeLastWhere=Je;function Bt(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&M(A[j],j)||S<I&&(j<=S||j>=I)&&M(A[j],j)?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let y of h)yield*y}function*t(){}function*n(h,y=0){for(let w of h)yield[y++,w]}function*i(h,y){let w=0;for(let T of h)y(T,w++)&&(yield T)}function o(h,y){let w=0;for(let T of h)if(y(T,w++))return T}function s(h,y){let w=0;for(let T of h)if(y(T,w++))return w-1;return-1}function a(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)<0&&(w=T)}return w}function l(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)>0&&(w=T)}return w}function u(h,y){let w=!0,T,H;for(let Y of h)w?(T=Y,H=Y,w=!1):y(Y,T)<0?T=Y:y(Y,H)>0&&(H=Y);return w?void 0:[T,H]}function c(h){return Array.from(h)}function d(h){let y={};for(let[w,T]of h)y[w]=T;return y}function f(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return}function m(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return!1;return!0}function g(h,y){let w=0;for(let T of h)if(y(T,w++))return!0;return!1}function*b(h,y){let w=0;for(let T of h)yield y(T,w++)}function*v(h,y,w){y===void 0?(y=h,h=0,w=1):w===void 0&&(w=1);let T=k.rangeLength(h,y,w);for(let H=0;H<T;H++)yield h+w*H}var k;(function(h){function y(w,T,H){return H===0?1/0:w>T&&H>0||w<T&&H<0?0:Math.ceil((T-w)/H)}h.rangeLength=y})(k||(k={}));function R(h,y,w){let T=h[Symbol.iterator](),H=0,Y=T.next();if(Y.done&&w===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return w;let Z=T.next();if(Z.done&&w===void 0)return Y.value;if(Z.done)return y(w,Y.value,H++);let ie;w===void 0?ie=y(Y.value,Z.value,H++):ie=y(y(w,Y.value,H++),Z.value,H++);let le;for(;!(le=T.next()).done;)ie=y(ie,le.value,H++);return ie}function*P(h,y){for(;0<y--;)yield h}function*D(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let y=h.length-1;y>-1;y--)yield h[y]}function L(h){let y=[],w=new Set,T=new Map;for(let Z of h)H(Z);for(let[Z]of T)Y(Z);return y;function H(Z){let[ie,le]=Z,be=T.get(le);be?be.push(ie):T.set(le,[ie])}function Y(Z){if(w.has(Z))return;w.add(Z);let ie=T.get(Z);if(ie)for(let le of ie)Y(le);y.push(Z)}}function*B(h,y){let w=0;for(let T of h)w++%y===0&&(yield T)}r.StringExt=void 0,function(h){function y(Z,ie,le=0){let be=new Array(ie.length);for(let q=0,$=le,ue=ie.length;q<ue;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=y;function w(Z,ie,le=0){let be=y(Z,ie,le);if(!be)return null;let q=0;for(let $=0,ue=be.length;$<ue;++$){let pe=be[$]-le;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=w;function T(Z,ie,le=0){let be=y(Z,ie,le);if(!be)return null;let q=0,$=le-1;for(let ue=0,pe=be.length;ue<pe;++ue){let ye=be[ue];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=T;function H(Z,ie,le){let be=[],q=0,$=0,ue=ie.length;for(;q<ue;){let pe=ie[q],ye=ie[q];for(;++q<ue&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(le(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,y){if(y<1)return;let w=h[Symbol.iterator](),T;for(;0<y--&&!(T=w.next()).done;)yield T.value}function*O(...h){let y=h.map(T=>T[Symbol.iterator]()),w=y.map(T=>T.next());for(;m(w,T=>!T.done);w=y.map(T=>T.next()))yield w.map(T=>T.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=D,r.range=v,r.reduce=R,r.repeat=P,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var l1=re((a1,AQ)=>{p();(function(r,e){typeof a1=="object"&&typeof AQ!="undefined"?e(a1,$2()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(a1,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(P){return P===null||typeof P=="boolean"||typeof P=="number"||typeof P=="string"}u.isPrimitive=c;function d(P){return Array.isArray(P)}u.isArray=d;function f(P){return!c(P)&&!d(P)}u.isObject=f;function m(P,D){if(P===D)return!0;if(c(P)||c(D))return!1;let K=d(P),L=d(D);return K!==L?!1:K&&L?b(P,D):v(P,D)}u.deepEqual=m;function g(P){return c(P)?P:d(P)?k(P):R(P)}u.deepCopy=g;function b(P,D){if(P===D)return!0;if(P.length!==D.length)return!1;for(let K=0,L=P.length;K<L;++K)if(!m(P[K],D[K]))return!1;return!0}function v(P,D){if(P===D)return!0;for(let K in P)if(P[K]!==void 0&&!(K in D))return!1;for(let K in D)if(D[K]!==void 0&&!(K in P))return!1;for(let K in P){let L=P[K],B=D[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function k(P){let D=new Array(P.length);for(let K=0,L=P.length;K<L;++K)D[K]=g(P[K]);return D}function R(P){let D={};for(let K in P){let L=P[K];L!==void 0&&(D[K]=g(L))}return D}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(v=>{let k=this._services.get(v);return k?this._plugins.get(k).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(v){var k,R,P,D;this._activated=!1,this._promise=null,this._service=null,this.id=v.id,this.description=(k=v.description)!==null&&k!==void 0?k:"",this.activate=v.activate,this.deactivate=(R=v.deactivate)!==null&&R!==void 0?R:null,this.provides=(P=v.provides)!==null&&P!==void 0?P:null,this.autoStart=(D=v.autoStart)!==null&&D!==void 0?D:!1,this.requires=v.requires?v.requires.slice():[],this.optional=v.optional?v.optional.slice():[]}get activated(){return this._activated}set activated(v){this._activated=v}get service(){return this._service}set service(v){this._service=v}get promise(){return this._promise}set promise(v){this._promise=v}}function d(b){return new c(b)}u.createPluginData=d;function f(b,v,k){let R=[...b.requires,...b.optional],P=K=>{if(K===b.provides)return!0;let L=k.get(K);if(!L)return!1;let B=v.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(D.push(L),N.some(P)?!0:(D.pop(),!1))};if(!b.provides||R.length===0)return;let D=[b.id];if(R.some(P))throw new ReferenceError(`Cycle detected: ${D.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,v,k){let R=new Array,P=N=>{let O=v.get(N),h=[...O.requires,...O.optional];R.push(...h.reduce((y,w)=>{let T=k.get(w);return T&&y.push([N,T]),y},[]))};for(let N of v.keys())P(N);let D=R.filter(N=>N[1]===b),K=0;for(;D.length>K;){let N=D.length,O=new Set(D.map(h=>h[0]));for(let h of O)R.filter(y=>y[1]===h).forEach(y=>{D.includes(y)||D.push(y)});K=N}let L=e.topologicSort(D),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,v){let k=new Set;for(let R of b.keys())b.get(R).autoStart===!0&&k.add(R);if(v.startPlugins)for(let R of v.startPlugins)k.add(R);if(v.ignorePlugins)for(let R of v.ignorePlugins)k.delete(R);return Array.from(k)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var OQ=re((c1,MQ)=>{p();(function(r,e){typeof c1=="object"&&typeof MQ!="undefined"?e(c1,$2(),l1()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(c1,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let y=g.get(N.sender);if(y||(y=[],g.set(N.sender,y)),R(y,N,O,h))return!1;let w=h||O,T=b.get(w);T||(T=[],b.set(w,T));let H={signal:N,slot:O,thisArg:h};return y.push(H),T.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let y=g.get(N.sender);if(!y||y.length===0)return!1;let w=R(y,N,O,h);if(!w)return!1;let T=h||O,H=b.get(T);return w.signal=null,D(y),D(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let y=b.get(O);if(!(!y||y.length===0)){for(let w of y)w.signal&&w.signal.sender===N&&(w.signal=null);D(h),D(y)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.thisArg||h.slot;h.signal=null,D(b.get(y))}D(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.signal.sender;h.signal=null,D(g.get(y))}D(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let y=0,w=h.length;y<w;++y){let T=h[y];T.signal===N&&P(T,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,v=new Set,k=typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate;function R(N,O,h,y){return e.find(N,w=>w.signal===O&&w.slot===h&&w.thisArg===y)}function P(N,O){let{signal:h,slot:y,thisArg:w}=N;try{y.call(w,h.sender,O)}catch(T){s.exceptionHandler(T)}}function D(N){v.size===0&&k(K),v.add(N)}function K(){v.forEach(L),v.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var KQ=re(u1=>{"use strict";p();Object.defineProperty(u1,"__esModule",{value:!0});u1.ActivityMonitor=void 0;var LQ=OQ(),z2=class{constructor(e){this._timer=-1,this._timeout=-1,this._isDisposed=!1,this._activityStopped=new LQ.Signal(this),e.signal.connect(this._onSignalFired,this),this._timeout=e.timeout||1e3}get activityStopped(){return this._activityStopped}get timeout(){return this._timeout}set timeout(e){this._timeout=e}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,LQ.Signal.clearData(this))}_onSignalFired(e,t){clearTimeout(this._timer),this._sender=e,this._args=t,this._timer=setTimeout(()=>{this._activityStopped.emit({sender:this._sender,args:this._args})},this._timeout)}};u1.ActivityMonitor=z2});var UQ=re(FQ=>{"use strict";p();Object.defineProperty(FQ,"__esModule",{value:!0})});var WQ=re(d1=>{"use strict";p();Object.defineProperty(d1,"__esModule",{value:!0});d1.LruCache=void 0;var xve=128,Q2=class{constructor(e={}){this._map=new Map,this._maxSize=(e==null?void 0:e.maxSize)||xve}get size(){return this._map.size}clear(){this._map.clear()}get(e){let t=this._map.get(e)||null;return t!=null&&(this._map.delete(e),this._map.set(e,t)),t}set(e,t){this._map.size>=this._maxSize&&this._map.delete(this._map.keys().next().value),this._map.set(e,t)}};d1.LruCache=Q2});var jQ=re(p1=>{"use strict";p();Object.defineProperty(p1,"__esModule",{value:!0});p1.MarkdownCodeBlocks=void 0;var VQ;(function(r){r.CODE_BLOCK_MARKER="```";let e=[".markdown",".mdown",".mkdn",".md",".mkd",".mdwn",".mdtxt",".mdtext",".text",".txt",".Rmd"];class t{constructor(s){this.startLine=s,this.code="",this.endLine=-1}}r.MarkdownCodeBlock=t;function n(o){return e.indexOf(o)>-1}r.isMarkdown=n;function i(o){if(!o||o==="")return[];let s=o.split(`
`),a=[],l=null;for(let u=0;u<s.length;u++){let c=s[u],d=c.indexOf(r.CODE_BLOCK_MARKER)===0,f=l!=null;if(!(!d&&!f))if(f)l&&(d?(l.endLine=u-1,a.push(l),l=null):l.code+=c+`
`);else{l=new t(u);let m=c.indexOf(r.CODE_BLOCK_MARKER),g=c.lastIndexOf(r.CODE_BLOCK_MARKER);m!==g&&(l.code=c.substring(m+r.CODE_BLOCK_MARKER.length,g),l.endLine=u,a.push(l),l=null)}}return a}r.findMarkdownCodeBlocks=i})(VQ||(p1.MarkdownCodeBlocks=VQ={}))});var JQ=re((jqe,qQ)=>{"use strict";p();function Pve(r,e){var t=r;e.slice(0,-1).forEach(function(i){t=t[i]||{}});var n=e[e.length-1];return n in t}function BQ(r){return typeof r=="number"||/^0x[0-9a-f]+$/i.test(r)?!0:/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(r)}function HQ(r,e){return e==="constructor"&&typeof r[e]=="function"||e==="__proto__"}qQ.exports=function(r,e){e||(e={});var t={bools:{},strings:{},unknownFn:null};typeof e.unknown=="function"&&(t.unknownFn=e.unknown),typeof e.boolean=="boolean"&&e.boolean?t.allBools=!0:[].concat(e.boolean).filter(Boolean).forEach(function(D){t.bools[D]=!0});var n={};function i(D){return n[D].some(function(K){return t.bools[K]})}Object.keys(e.alias||{}).forEach(function(D){n[D]=[].concat(e.alias[D]),n[D].forEach(function(K){n[K]=[D].concat(n[D].filter(function(L){return K!==L}))})}),[].concat(e.string).filter(Boolean).forEach(function(D){t.strings[D]=!0,n[D]&&[].concat(n[D]).forEach(function(K){t.strings[K]=!0})});var o=e.default||{},s={_:[]};function a(D,K){return t.allBools&&/^--[^=]+$/.test(K)||t.strings[D]||t.bools[D]||n[D]}function l(D,K,L){for(var B=D,N=0;N<K.length-1;N++){var O=K[N];if(HQ(B,O))return;B[O]===void 0&&(B[O]={}),(B[O]===Object.prototype||B[O]===Number.prototype||B[O]===String.prototype)&&(B[O]={}),B[O]===Array.prototype&&(B[O]=[]),B=B[O]}var h=K[K.length-1];HQ(B,h)||((B===Object.prototype||B===Number.prototype||B===String.prototype)&&(B={}),B===Array.prototype&&(B=[]),B[h]===void 0||t.bools[h]||typeof B[h]=="boolean"?B[h]=L:Array.isArray(B[h])?B[h].push(L):B[h]=[B[h],L])}function u(D,K,L){if(!(L&&t.unknownFn&&!a(D,L)&&t.unknownFn(L)===!1)){var B=!t.strings[D]&&BQ(K)?Number(K):K;l(s,D.split("."),B),(n[D]||[]).forEach(function(N){l(s,N.split("."),B)})}}Object.keys(t.bools).forEach(function(D){u(D,o[D]===void 0?!1:o[D])});var c=[];r.indexOf("--")!==-1&&(c=r.slice(r.indexOf("--")+1),r=r.slice(0,r.indexOf("--")));for(var d=0;d<r.length;d++){var f=r[d],m,g;if(/^--.+=/.test(f)){var b=f.match(/^--([^=]+)=([\s\S]*)$/);m=b[1];var v=b[2];t.bools[m]&&(v=v!=="false"),u(m,v,f)}else if(/^--no-.+/.test(f))m=f.match(/^--no-(.+)/)[1],u(m,!1,f);else if(/^--.+/.test(f))m=f.match(/^--(.+)/)[1],g=r[d+1],g!==void 0&&!/^(-|--)[^-]/.test(g)&&!t.bools[m]&&!t.allBools&&(!n[m]||!i(m))?(u(m,g,f),d+=1):/^(true|false)$/.test(g)?(u(m,g==="true",f),d+=1):u(m,t.strings[m]?"":!0,f);else if(/^-[^-]+/.test(f)){for(var k=f.slice(1,-1).split(""),R=!1,P=0;P<k.length;P++){if(g=f.slice(P+2),g==="-"){u(k[P],g,f);continue}if(/[A-Za-z]/.test(k[P])&&g[0]==="="){u(k[P],g.slice(1),f),R=!0;break}if(/[A-Za-z]/.test(k[P])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(g)){u(k[P],g,f),R=!0;break}if(k[P+1]&&k[P+1].match(/\W/)){u(k[P],f.slice(P+2),f),R=!0;break}else u(k[P],t.strings[k[P]]?"":!0,f)}m=f.slice(-1)[0],!R&&m!=="-"&&(r[d+1]&&!/^(-|--)[^-]/.test(r[d+1])&&!t.bools[m]&&(!n[m]||!i(m))?(u(m,r[d+1],f),d+=1):r[d+1]&&/^(true|false)$/.test(r[d+1])?(u(m,r[d+1]==="true",f),d+=1):u(m,t.strings[m]?"":!0,f))}else if((!t.unknownFn||t.unknownFn(f)!==!1)&&s._.push(t.strings._||!BQ(f)?f:Number(f)),e.stopEarly){s._.push.apply(s._,r.slice(d+1));break}}return Object.keys(o).forEach(function(D){Pve(s,D.split("."))||(l(s,D.split("."),o[D]),(n[D]||[]).forEach(function(K){l(s,K.split("."),o[D])}))}),e["--"]?s["--"]=c.slice():c.forEach(function(D){s._.push(D)}),s}});var f1=re((Hqe,YQ)=>{"use strict";p();function qc(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function GQ(r,e){for(var t="",n=0,i=-1,o=0,s,a=0;a<=r.length;++a){if(a<r.length)s=r.charCodeAt(a);else{if(s===47)break;s=47}if(s===47){if(!(i===a-1||o===1))if(i!==a-1&&o===2){if(t.length<2||n!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",n=0):(t=t.slice(0,l),n=t.length-1-t.lastIndexOf("/")),i=a,o=0;continue}}else if(t.length===2||t.length===1){t="",n=0,i=a,o=0;continue}}e&&(t.length>0?t+="/..":t="..",n=2)}else t.length>0?t+="/"+r.slice(i+1,a):t=r.slice(i+1,a),n=a-i-1;i=a,o=0}else s===46&&o!==-1?++o:o=-1}return t}function Dve(r,e){var t=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+n:t+r+n:n}var cI={resolve:function(){for(var e="",t=!1,n,i=arguments.length-1;i>=-1&&!t;i--){var o;i>=0?o=arguments[i]:(n===void 0&&(n=process.cwd()),o=n),qc(o),o.length!==0&&(e=o+"/"+e,t=o.charCodeAt(0)===47)}return e=GQ(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(qc(e),e.length===0)return".";var t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=GQ(e,!t),e.length===0&&!t&&(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return qc(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];qc(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":cI.normalize(e)},relative:function(e,t){if(qc(e),qc(t),e===t||(e=cI.resolve(e),t=cI.resolve(t),e===t))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var i=e.length,o=i-n,s=1;s<t.length&&t.charCodeAt(s)===47;++s);for(var a=t.length,l=a-s,u=o<l?o:l,c=-1,d=0;d<=u;++d){if(d===u){if(l>u){if(t.charCodeAt(s+d)===47)return t.slice(s+d+1);if(d===0)return t.slice(s+d)}else o>u&&(e.charCodeAt(n+d)===47?c=d:d===0&&(c=0));break}var f=e.charCodeAt(n+d),m=t.charCodeAt(s+d);if(f!==m)break;f===47&&(c=d)}var g="";for(d=n+c+1;d<=i;++d)(d===i||e.charCodeAt(d)===47)&&(g.length===0?g+="..":g+="/..");return g.length>0?g+t.slice(s+c):(s+=c,t.charCodeAt(s)===47&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(qc(e),e.length===0)return".";for(var t=e.charCodeAt(0),n=t===47,i=-1,o=!0,s=e.length-1;s>=1;--s)if(t=e.charCodeAt(s),t===47){if(!o){i=s;break}}else o=!1;return i===-1?n?"/":".":n&&i===1?"//":e.slice(0,i)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');qc(e);var n=0,i=-1,o=!0,s;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,l=-1;for(s=e.length-1;s>=0;--s){var u=e.charCodeAt(s);if(u===47){if(!o){n=s+1;break}}else l===-1&&(o=!1,l=s+1),a>=0&&(u===t.charCodeAt(a)?--a===-1&&(i=s):(a=-1,i=l))}return n===i?i=l:i===-1&&(i=e.length),e.slice(n,i)}else{for(s=e.length-1;s>=0;--s)if(e.charCodeAt(s)===47){if(!o){n=s+1;break}}else i===-1&&(o=!1,i=s+1);return i===-1?"":e.slice(n,i)}},extname:function(e){qc(e);for(var t=-1,n=0,i=-1,o=!0,s=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!o){n=a+1;break}continue}i===-1&&(o=!1,i=a+1),l===46?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":e.slice(t,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return Dve("/",e)},parse:function(e){qc(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var n=e.charCodeAt(0),i=n===47,o;i?(t.root="/",o=1):o=0;for(var s=-1,a=0,l=-1,u=!0,c=e.length-1,d=0;c>=o;--c){if(n=e.charCodeAt(c),n===47){if(!u){a=c+1;break}continue}l===-1&&(u=!1,l=c+1),n===46?s===-1?s=c:d!==1&&(d=1):s!==-1&&(d=-1)}return s===-1||l===-1||d===0||d===1&&s===l-1&&s===a+1?l!==-1&&(a===0&&i?t.base=t.name=e.slice(1,l):t.base=t.name=e.slice(a,l)):(a===0&&i?(t.name=e.slice(1,s),t.base=e.slice(1,l)):(t.name=e.slice(a,s),t.base=e.slice(a,l)),t.ext=e.slice(s,l)),a>0?t.dir=e.slice(0,a-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};cI.posix=cI;YQ.exports=cI});var zQ=re((Jqe,$Q)=>{"use strict";p();$Q.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}});var ZQ=re(X2=>{"use strict";p();var Tve=Object.prototype.hasOwnProperty,kve;function QQ(r){try{return decodeURIComponent(r.replace(/\+/g," "))}catch(e){return null}}function XQ(r){try{return encodeURIComponent(r)}catch(e){return null}}function Nve(r){for(var e=/([^=?#&]+)=?([^&]*)/g,t={},n;n=e.exec(r);){var i=QQ(n[1]),o=QQ(n[2]);i===null||o===null||i in t||(t[i]=o)}return t}function Rve(r,e){e=e||"";var t=[],n,i;typeof e!="string"&&(e="?");for(i in r)if(Tve.call(r,i)){if(n=r[i],!n&&(n===null||n===kve||isNaN(n))&&(n=""),i=XQ(i),n=XQ(n),i===null||n===null)continue;t.push(i+"="+n)}return t.length?e+t.join("&"):""}X2.stringify=Rve;X2.parse=Nve});var tV=re((zqe,sX)=>{"use strict";p();var tX=zQ(),m1=ZQ(),Ave=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,rX=/[\n\r\t]/g,Mve=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,nX=/:\d+$/,Ove=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,Lve=/^[a-zA-Z]:/;function eV(r){return(r||"").toString().replace(Ave,"")}var Z2=[["#","hash"],["?","query"],function(e,t){return Jc(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],eX={hash:1,query:1};function iX(r){var e;typeof window!="undefined"?e=window:typeof this!="undefined"?e=this:typeof self!="undefined"?e=self:e={};var t=e.location||{};r=r||t;var n={},i=typeof r,o;if(r.protocol==="blob:")n=new Gc(unescape(r.pathname),{});else if(i==="string"){n=new Gc(r,{});for(o in eX)delete n[o]}else if(i==="object"){for(o in r)o in eX||(n[o]=r[o]);n.slashes===void 0&&(n.slashes=Mve.test(r.href))}return n}function Jc(r){return r==="file:"||r==="ftp:"||r==="http:"||r==="https:"||r==="ws:"||r==="wss:"}function oX(r,e){r=eV(r),r=r.replace(rX,""),e=e||{};var t=Ove.exec(r),n=t[1]?t[1].toLowerCase():"",i=!!t[2],o=!!t[3],s=0,a;return i?o?(a=t[2]+t[3]+t[4],s=t[2].length+t[3].length):(a=t[2]+t[4],s=t[2].length):o?(a=t[3]+t[4],s=t[3].length):a=t[4],n==="file:"?s>=2&&(a=a.slice(2)):Jc(n)?a=t[4]:n?i&&(a=a.slice(2)):s>=2&&Jc(e.protocol)&&(a=t[4]),{protocol:n,slashes:i||Jc(n),slashesCount:s,rest:a}}function Kve(r,e){if(r==="")return e;for(var t=(e||"/").split("/").slice(0,-1).concat(r.split("/")),n=t.length,i=t[n-1],o=!1,s=0;n--;)t[n]==="."?t.splice(n,1):t[n]===".."?(t.splice(n,1),s++):s&&(n===0&&(o=!0),t.splice(n,1),s--);return o&&t.unshift(""),(i==="."||i==="..")&&t.push(""),t.join("/")}function Gc(r,e,t){if(r=eV(r),r=r.replace(rX,""),!(this instanceof Gc))return new Gc(r,e,t);var n,i,o,s,a,l,u=Z2.slice(),c=typeof e,d=this,f=0;for(c!=="object"&&c!=="string"&&(t=e,e=null),t&&typeof t!="function"&&(t=m1.parse),e=iX(e),i=oX(r||"",e),n=!i.protocol&&!i.slashes,d.slashes=i.slashes||n&&e.slashes,d.protocol=i.protocol||e.protocol||"",r=i.rest,(i.protocol==="file:"&&(i.slashesCount!==2||Lve.test(r))||!i.slashes&&(i.protocol||i.slashesCount<2||!Jc(d.protocol)))&&(u[3]=[/(.*)/,"pathname"]);f<u.length;f++){if(s=u[f],typeof s=="function"){r=s(r,d);continue}o=s[0],l=s[1],o!==o?d[l]=r:typeof o=="string"?(a=o==="@"?r.lastIndexOf(o):r.indexOf(o),~a&&(typeof s[2]=="number"?(d[l]=r.slice(0,a),r=r.slice(a+s[2])):(d[l]=r.slice(a),r=r.slice(0,a)))):(a=o.exec(r))&&(d[l]=a[1],r=r.slice(0,a.index)),d[l]=d[l]||n&&s[3]&&e[l]||"",s[4]&&(d[l]=d[l].toLowerCase())}t&&(d.query=t(d.query)),n&&e.slashes&&d.pathname.charAt(0)!=="/"&&(d.pathname!==""||e.pathname!=="")&&(d.pathname=Kve(d.pathname,e.pathname)),d.pathname.charAt(0)!=="/"&&Jc(d.protocol)&&(d.pathname="/"+d.pathname),tX(d.port,d.protocol)||(d.host=d.hostname,d.port=""),d.username=d.password="",d.auth&&(a=d.auth.indexOf(":"),~a?(d.username=d.auth.slice(0,a),d.username=encodeURIComponent(decodeURIComponent(d.username)),d.password=d.auth.slice(a+1),d.password=encodeURIComponent(decodeURIComponent(d.password))):d.username=encodeURIComponent(decodeURIComponent(d.auth)),d.auth=d.password?d.username+":"+d.password:d.username),d.origin=d.protocol!=="file:"&&Jc(d.protocol)&&d.host?d.protocol+"//"+d.host:"null",d.href=d.toString()}function Fve(r,e,t){var n=this;switch(r){case"query":typeof e=="string"&&e.length&&(e=(t||m1.parse)(e)),n[r]=e;break;case"port":n[r]=e,tX(e,n.protocol)?e&&(n.host=n.hostname+":"+e):(n.host=n.hostname,n[r]="");break;case"hostname":n[r]=e,n.port&&(e+=":"+n.port),n.host=e;break;case"host":n[r]=e,nX.test(e)?(e=e.split(":"),n.port=e.pop(),n.hostname=e.join(":")):(n.hostname=e,n.port="");break;case"protocol":n.protocol=e.toLowerCase(),n.slashes=!t;break;case"pathname":case"hash":if(e){var i=r==="pathname"?"/":"#";n[r]=e.charAt(0)!==i?i+e:e}else n[r]=e;break;case"username":case"password":n[r]=encodeURIComponent(e);break;case"auth":var o=e.indexOf(":");~o?(n.username=e.slice(0,o),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=e.slice(o+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(e))}for(var s=0;s<Z2.length;s++){var a=Z2[s];a[4]&&(n[a[1]]=n[a[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&Jc(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function Uve(r){(!r||typeof r!="function")&&(r=m1.stringify);var e,t=this,n=t.host,i=t.protocol;i&&i.charAt(i.length-1)!==":"&&(i+=":");var o=i+(t.protocol&&t.slashes||Jc(t.protocol)?"//":"");return t.username?(o+=t.username,t.password&&(o+=":"+t.password),o+="@"):t.password?(o+=":"+t.password,o+="@"):t.protocol!=="file:"&&Jc(t.protocol)&&!n&&t.pathname!=="/"&&(o+="@"),(n[n.length-1]===":"||nX.test(t.hostname)&&!t.port)&&(n+=":"),o+=n+t.pathname,e=typeof t.query=="object"?r(t.query):t.query,e&&(o+=e.charAt(0)!=="?"?"?"+e:e),t.hash&&(o+=t.hash),o}Gc.prototype={set:Fve,toString:Uve};Gc.extractProtocol=oX;Gc.location=iX;Gc.trimLeft=eV;Gc.qs=m1;sX.exports=Gc});var rV=re(uI=>{"use strict";p();var Wve=uI&&uI.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(uI,"__esModule",{value:!0});uI.URLExt=void 0;var Vve=f1(),h1=Wve(tV()),aX;(function(r){function e(u){if(typeof document!="undefined"&&document){let c=document.createElement("a");return c.href=u,c}return(0,h1.default)(u)}r.parse=e;function t(u){return(0,h1.default)(u).hostname}r.getHostName=t;function n(u){return u&&e(u).toString()}r.normalize=n;function i(...u){let c=(0,h1.default)(u[0],{}),d=c.protocol===""&&c.slashes;d&&(c=(0,h1.default)(u[0],"https:"+u[0]));let f=`${d?"":c.protocol}${c.slashes?"//":""}${c.auth}${c.auth?"@":""}${c.host}`,m=Vve.posix.join(`${f&&c.pathname[0]!=="/"?"/":""}${c.pathname}`,...u.slice(1));return`${f}${m==="."?"":m}`}r.join=i;function o(u){return i(...u.split("/").map(encodeURIComponent))}r.encodeParts=o;function s(u){let c=Object.keys(u).filter(d=>d.length>0);return c.length?"?"+c.map(d=>{let f=encodeURIComponent(String(u[d]));return d+(f?"="+f:"")}).join("&"):""}r.objectToQueryString=s;function a(u){return u.replace(/^\?/,"").split("&").reduce((c,d)=>{let[f,m]=d.split("=");return f.length>0&&(c[f]=decodeURIComponent(m||"")),c},{})}r.queryStringToObject=a;function l(u,c=!1){let{protocol:d}=e(u);return(!d||u.toLowerCase().indexOf(d)!==0)&&(c?u.indexOf("//")!==0:u.indexOf("/")!==0)}r.isLocal=l})(aX||(uI.URLExt=aX={}))});var lX=re((exports,module)=>{"use strict";p();var __importDefault=exports&&exports.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(exports,"__esModule",{value:!0});exports.PageConfig=void 0;var coreutils_1=l1(),minimist_1=__importDefault(JQ()),url_1=rV(),PageConfig;(function(PageConfig){function getOption(name){if(configData)return configData[name]||getBodyData(name);configData=Object.create(null);let found=!1;if(typeof document!="undefined"&&document){let r=document.getElementById("jupyter-config-data");r&&(configData=JSON.parse(r.textContent||""),found=!0)}if(!found&&typeof process!="undefined"&&process.argv)try{let cli=(0,minimist_1.default)(process.argv.slice(2)),path=f1(),fullPath="";"jupyter-config-data"in cli?fullPath=path.resolve(cli["jupyter-config-data"]):"JUPYTER_CONFIG_DATA"in process.env&&(fullPath=path.resolve(process.env.JUPYTER_CONFIG_DATA)),fullPath&&(configData=eval("require")(fullPath))}catch(r){console.error(r)}if(!coreutils_1.JSONExt.isObject(configData))configData=Object.create(null);else for(let r in configData)typeof configData[r]!="string"&&(configData[r]=JSON.stringify(configData[r]));return configData[name]||getBodyData(name)}PageConfig.getOption=getOption;function setOption(r,e){let t=getOption(r);return configData[r]=e,t}PageConfig.setOption=setOption;function getBaseUrl(){return url_1.URLExt.normalize(getOption("baseUrl")||"/")}PageConfig.getBaseUrl=getBaseUrl;function getTreeUrl(){return url_1.URLExt.join(getBaseUrl(),getOption("treeUrl"))}PageConfig.getTreeUrl=getTreeUrl;function getShareUrl(){return url_1.URLExt.normalize(getOption("shareUrl")||getBaseUrl())}PageConfig.getShareUrl=getShareUrl;function getTreeShareUrl(){return url_1.URLExt.normalize(url_1.URLExt.join(getShareUrl(),getOption("treeUrl")))}PageConfig.getTreeShareUrl=getTreeShareUrl;function getUrl(r){var e,t,n,i;let o=r.toShare?getShareUrl():getBaseUrl(),s=(e=r.mode)!==null&&e!==void 0?e:getOption("mode"),a=(t=r.workspace)!==null&&t!==void 0?t:getOption("workspace"),l=s==="single-document"?"doc":"lab";o=url_1.URLExt.join(o,l),a!==PageConfig.defaultWorkspace&&(o=url_1.URLExt.join(o,"workspaces",encodeURIComponent((n=getOption("workspace"))!==null&&n!==void 0?n:PageConfig.defaultWorkspace)));let u=(i=r.treePath)!==null&&i!==void 0?i:getOption("treePath");return u&&(o=url_1.URLExt.join(o,"tree",url_1.URLExt.encodeParts(u))),o}PageConfig.getUrl=getUrl,PageConfig.defaultWorkspace="default";function getWsUrl(r){let e=getOption("wsUrl");if(!e){if(r=r?url_1.URLExt.normalize(r):getBaseUrl(),r.indexOf("http")!==0)return"";e="ws"+r.slice(4)}return url_1.URLExt.normalize(e)}PageConfig.getWsUrl=getWsUrl;function getNBConvertURL({path:r,format:e,download:t}){let n=url_1.URLExt.encodeParts(r),i=url_1.URLExt.join(getBaseUrl(),"nbconvert",e,n);return t?i+"?download=true":i}PageConfig.getNBConvertURL=getNBConvertURL;function getToken(){return getOption("token")||getBodyData("jupyterApiToken")}PageConfig.getToken=getToken;function getNotebookVersion(){let r=getOption("notebookVersion");return r===""?[0,0,0]:JSON.parse(r)}PageConfig.getNotebookVersion=getNotebookVersion;let configData=null;function getBodyData(r){if(typeof document=="undefined"||!document.body)return"";let e=document.body.dataset[r];return typeof e=="undefined"?"":decodeURIComponent(e)}let Extension;(function(r){function e(i){try{let o=getOption(i);if(o)return JSON.parse(o)}catch(o){console.warn(`Unable to parse ${i}.`,o)}return[]}r.deferred=e("deferredExtensions"),r.disabled=e("disabledExtensions");function t(i){let o=i.indexOf(":"),s="";return o!==-1&&(s=i.slice(0,o)),r.deferred.some(a=>a===i||s&&a===s)}r.isDeferred=t;function n(i){let o=i.indexOf(":"),s="";return o!==-1&&(s=i.slice(0,o)),r.disabled.some(a=>a===i||s&&a===s)}r.isDisabled=n})(Extension=PageConfig.Extension||(PageConfig.Extension={}))})(PageConfig||(exports.PageConfig=PageConfig={}))});var uX=re(g1=>{"use strict";p();Object.defineProperty(g1,"__esModule",{value:!0});g1.PathExt=void 0;var Af=f1(),cX;(function(r){function e(...d){let f=Af.posix.join(...d);return f==="."?"":c(f)}r.join=e;function t(...d){let f=Af.posix.join(...d);return f==="."?"":f}r.joinWithLeadingSlash=t;function n(d,f){return Af.posix.basename(d,f)}r.basename=n;function i(d){let f=c(Af.posix.dirname(d));return f==="."?"":f}r.dirname=i;function o(d){return Af.posix.extname(d)}r.extname=o;function s(d){return d===""?"":c(Af.posix.normalize(d))}r.normalize=s;function a(...d){return c(Af.posix.resolve(...d))}r.resolve=a;function l(d,f){return c(Af.posix.relative(d,f))}r.relative=l;function u(d){return d.length>0&&d.indexOf(".")!==0&&(d=`.${d}`),d}r.normalizeExtension=u;function c(d){return d.indexOf("/")===0&&(d=d.slice(1)),d}r.removeSlash=c})(cX||(g1.PathExt=cX={}))});var dX=re(v1=>{"use strict";p();Object.defineProperty(v1,"__esModule",{value:!0});v1.signalToPromise=void 0;var jve=l1();function Bve(r,e){let t=new jve.PromiseDelegate;function n(){r.disconnect(i)}function i(o,s){n(),t.resolve([o,s])}return r.connect(i),(e!=null?e:0)>0&&setTimeout(()=>{n(),t.reject(`Signal not emitted within ${e} ms.`)},e),t.promise}v1.signalToPromise=Bve});var fX=re(y1=>{"use strict";p();Object.defineProperty(y1,"__esModule",{value:!0});y1.Text=void 0;var pX;(function(r){function t(s,a){return s}r.jsIndexToCharIndex=t;function n(s,a){return s}r.charIndexToJsIndex=n;function i(s,a=!1){return s.replace(/^(\w)|[\s-_:]+(\w)/g,function(l,u,c){return c?c.toUpperCase():a?u.toUpperCase():u.toLowerCase()})}r.camelCase=i;function o(s){return(s||"").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")}r.titleCase=o})(pX||(y1.Text=pX={}))});var hX=re(b1=>{"use strict";p();Object.defineProperty(b1,"__esModule",{value:!0});b1.Time=void 0;var Hve=[{name:"years",milliseconds:365*24*60*60*1e3},{name:"months",milliseconds:30*24*60*60*1e3},{name:"days",milliseconds:24*60*60*1e3},{name:"hours",milliseconds:60*60*1e3},{name:"minutes",milliseconds:60*1e3},{name:"seconds",milliseconds:1e3}],mX;(function(r){function e(n,i="long"){let o=document.documentElement.lang||"en",s=new Intl.RelativeTimeFormat(o,{numeric:"auto",style:i}),a=new Date(n).getTime()-Date.now();for(let l of Hve){let u=Math.ceil(a/l.milliseconds);if(u!==0)return s.format(u,l.name)}return s.format(0,"seconds")}r.formatHuman=e;function t(n){let i=document.documentElement.lang||"en";return new Intl.DateTimeFormat(i,{dateStyle:"short",timeStyle:"short"}).format(new Date(n))}r.format=t})(mX||(b1.Time=mX={}))});var io=re(no=>{"use strict";p();var qve=no&&no.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Yc=no&&no.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&qve(e,r,t)};Object.defineProperty(no,"__esModule",{value:!0});Yc(KQ(),no);Yc(UQ(),no);Yc(WQ(),no);Yc(jQ(),no);Yc(lX(),no);Yc(uX(),no);Yc(dX(),no);Yc(fX(),no);Yc(hX(),no);Yc(rV(),no)});var dI=re(xt=>{"use strict";p();Object.defineProperty(xt,"__esModule",{value:!0});xt.supportedKernelWebSocketProtocols=xt.isInputReplyMsg=xt.isInputRequestMsg=xt.isDebugReplyMsg=xt.isDebugRequestMsg=xt.isExecuteReplyMsg=xt.isInfoRequestMsg=xt.isCommMsgMsg=xt.isCommCloseMsg=xt.isCommOpenMsg=xt.isDebugEventMsg=xt.isClearOutputMsg=xt.isStatusMsg=xt.isErrorMsg=xt.isExecuteResultMsg=xt.isExecuteInputMsg=xt.isUpdateDisplayDataMsg=xt.isDisplayDataMsg=xt.isStreamMsg=xt.createMessage=void 0;var Jve=Hc();function Gve(r){var e,t,n,i,o;return{buffers:(e=r.buffers)!==null&&e!==void 0?e:[],channel:r.channel,content:r.content,header:{date:new Date().toISOString(),msg_id:(t=r.msgId)!==null&&t!==void 0?t:Jve.UUID.uuid4(),msg_type:r.msgType,session:r.session,username:(n=r.username)!==null&&n!==void 0?n:"",version:"5.2"},metadata:(i=r.metadata)!==null&&i!==void 0?i:{},parent_header:(o=r.parentHeader)!==null&&o!==void 0?o:{}}}xt.createMessage=Gve;function Yve(r){return r.header.msg_type==="stream"}xt.isStreamMsg=Yve;function $ve(r){return r.header.msg_type==="display_data"}xt.isDisplayDataMsg=$ve;function zve(r){return r.header.msg_type==="update_display_data"}xt.isUpdateDisplayDataMsg=zve;function Qve(r){return r.header.msg_type==="execute_input"}xt.isExecuteInputMsg=Qve;function Xve(r){return r.header.msg_type==="execute_result"}xt.isExecuteResultMsg=Xve;function Zve(r){return r.header.msg_type==="error"}xt.isErrorMsg=Zve;function eye(r){return r.header.msg_type==="status"}xt.isStatusMsg=eye;function tye(r){return r.header.msg_type==="clear_output"}xt.isClearOutputMsg=tye;function rye(r){return r.header.msg_type==="debug_event"}xt.isDebugEventMsg=rye;function nye(r){return r.header.msg_type==="comm_open"}xt.isCommOpenMsg=nye;function iye(r){return r.header.msg_type==="comm_close"}xt.isCommCloseMsg=iye;function oye(r){return r.header.msg_type==="comm_msg"}xt.isCommMsgMsg=oye;function sye(r){return r.header.msg_type==="kernel_info_request"}xt.isInfoRequestMsg=sye;function aye(r){return r.header.msg_type==="execute_reply"}xt.isExecuteReplyMsg=aye;function lye(r){return r.header.msg_type==="debug_request"}xt.isDebugRequestMsg=lye;function cye(r){return r.header.msg_type==="debug_reply"}xt.isDebugReplyMsg=cye;function uye(r){return r.header.msg_type==="input_request"}xt.isInputRequestMsg=uye;function dye(r){return r.header.msg_type==="input_reply"}xt.isInputReplyMsg=dye;var gX;(function(r){r.v1KernelWebsocketJupyterOrg="v1.kernel.websocket.jupyter.org"})(gX||(xt.supportedKernelWebSocketProtocols=gX={}))});var nV=re(wa=>{"use strict";p();var pye=wa&&wa.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),fye=wa&&wa.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),mye=wa&&wa.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&pye(e,r,t);return fye(e,r),e};Object.defineProperty(wa,"__esModule",{value:!0});wa.deserialize=wa.serialize=void 0;var vX=mye(dI());function hye(r,e=""){switch(e){case vX.supportedKernelWebSocketProtocols.v1KernelWebsocketJupyterOrg:return pI.serializeV1KernelWebsocketJupyterOrg(r);default:return pI.serializeDefault(r)}}wa.serialize=hye;function gye(r,e=""){switch(e){case vX.supportedKernelWebSocketProtocols.v1KernelWebsocketJupyterOrg:return pI.deserializeV1KernelWebsocketJupyterOrg(r);default:return pI.deserializeDefault(r)}}wa.deserialize=gye;var pI;(function(r){function e(a){let l,u=new DataView(a),c=Number(u.getBigUint64(0,!0)),d=[];for(let P=0;P<c;P++)d.push(Number(u.getBigUint64(8*(P+1),!0)));let f=new TextDecoder("utf8"),m=f.decode(a.slice(d[0],d[1])),g=JSON.parse(f.decode(a.slice(d[1],d[2]))),b=JSON.parse(f.decode(a.slice(d[2],d[3]))),v=JSON.parse(f.decode(a.slice(d[3],d[4]))),k=JSON.parse(f.decode(a.slice(d[4],d[5]))),R=[];for(let P=5;P<d.length-1;P++)R.push(new DataView(a.slice(d[P],d[P+1])));return l={channel:m,header:g,parent_header:b,metadata:v,content:k,buffers:R},l}r.deserializeV1KernelWebsocketJupyterOrg=e;function t(a){let l=JSON.stringify(a.header),u=a.parent_header==null?"{}":JSON.stringify(a.parent_header),c=JSON.stringify(a.metadata),d=JSON.stringify(a.content),f=a.buffers!==void 0?a.buffers:[],m=5+f.length+1,g=[];g.push(8*(1+m)),g.push(a.channel.length+g[g.length-1]);let b=new TextEncoder,v=b.encode(a.channel),k=b.encode(l),R=b.encode(u),P=b.encode(c),D=b.encode(d),K=new Uint8Array(v.length+k.length+R.length+P.length+D.length);K.set(v),K.set(k,v.length),K.set(R,v.length+k.length),K.set(P,v.length+k.length+R.length),K.set(D,v.length+k.length+R.length+P.length);for(let h of[k.length,R.length,P.length,D.length])g.push(h+g[g.length-1]);let L=0;for(let h of f){let y=h.byteLength;g.push(y+g[g.length-1]),L+=y}let B=new Uint8Array(8*(1+m)+K.byteLength+L),N=new ArrayBuffer(8),O=new DataView(N);O.setBigUint64(0,BigInt(m),!0),B.set(new Uint8Array(N),0);for(let h=0;h<g.length;h++)O.setBigUint64(0,BigInt(g[h]),!0),B.set(new Uint8Array(N),8*(h+1));B.set(K,g[0]);for(let h=0;h<f.length;h++){let y=f[h];B.set(new Uint8Array(ArrayBuffer.isView(y)?y.buffer:y),g[5+h])}return B.buffer}r.serializeV1KernelWebsocketJupyterOrg=t;function n(a){let l;return typeof a=="string"?l=JSON.parse(a):l=o(a),l}r.deserializeDefault=n;function i(a){var l;let u;return!((l=a.buffers)===null||l===void 0)&&l.length?u=s(a):u=JSON.stringify(a),u}r.serializeDefault=i;function o(a){let l=new DataView(a),u=l.getUint32(0),c=[];if(u<2)throw new Error("Invalid incoming Kernel Message");for(let m=1;m<=u;m++)c.push(l.getUint32(m*4));let d=new Uint8Array(a.slice(c[0],c[1])),f=JSON.parse(new TextDecoder("utf8").decode(d));f.buffers=[];for(let m=1;m<u;m++){let g=c[m],b=c[m+1]||a.byteLength;f.buffers.push(new DataView(a.slice(g,b)))}return f}function s(a){let l=[],u=[],c=new TextEncoder,d=[];a.buffers!==void 0&&(d=a.buffers,delete a.buffers);let f=c.encode(JSON.stringify(a));u.push(f.buffer);for(let v=0;v<d.length;v++){let k=d[v];u.push(ArrayBuffer.isView(k)?k.buffer:k)}let m=u.length;l.push(4*(m+1));for(let v=0;v+1<u.length;v++)l.push(l[l.length-1]+u[v].byteLength);let g=new Uint8Array(l[l.length-1]+u[u.length-1].byteLength),b=new DataView(g.buffer);b.setUint32(0,m);for(let v=0;v<l.length;v++)b.setUint32(4*(v+1),l[v]);for(let v=0;v<u.length;v++)g.set(new Uint8Array(u[v]),l[v]);return g.buffer}})(pI||(pI={}))});var yX=re(iV=>{"use strict";p();Object.defineProperty(iV,"__esModule",{value:!0});iV.default=WebSocket});var ko=re(S1=>{"use strict";p();Object.defineProperty(S1,"__esModule",{value:!0});S1.ServerConnection=void 0;var Mf=io(),bX=nV(),oV;typeof window=="undefined"?oV=yX():oV=WebSocket;var sV;(function(r){function e(o){return I1.makeSettings(o)}r.makeSettings=e;function t(o,s,a){return I1.handleRequest(o,s,a)}r.makeRequest=t;class n extends Error{static async create(s){try{let a=await s.json(),{message:l,traceback:u}=a;return u&&console.error(u),new n(s,l!=null?l:n._defaultMessage(s),u!=null?u:"")}catch(a){return console.debug(a),new n(s)}}constructor(s,a=n._defaultMessage(s),l=""){super(a),this.response=s,this.traceback=l}static _defaultMessage(s){return`Invalid response: ${s.status} ${s.statusText}`}}r.ResponseError=n;class i extends TypeError{constructor(s){super(s.message),this.stack=s.stack}}r.NetworkError=i})(sV||(S1.ServerConnection=sV={}));var I1;(function(r){function e(i={}){var o;let s=Mf.PageConfig.getBaseUrl(),a=Mf.PageConfig.getWsUrl(),l=Mf.URLExt.normalize(i.baseUrl)||s,u=i.wsUrl;!u&&l===s&&(u=a),!u&&l.indexOf("http")===0&&(u="ws"+l.slice(4)),u=u!=null?u:a;let c=Mf.PageConfig.getOption("appendToken").toLowerCase(),d;return c===""?d=typeof window=="undefined"||typeof process!="undefined"&&((o=process===null||process===void 0?void 0:process.env)===null||o===void 0?void 0:o.JEST_WORKER_ID)!==void 0||Mf.URLExt.getHostName(s)!==Mf.URLExt.getHostName(u):d=c==="true",{init:{cache:"no-store",credentials:"same-origin"},fetch,Headers,Request,WebSocket:oV,token:Mf.PageConfig.getToken(),appUrl:Mf.PageConfig.getOption("appUrl"),appendToken:d,serializer:{serialize:bX.serialize,deserialize:bX.deserialize},...i,baseUrl:l,wsUrl:u}}r.makeSettings=e;function t(i,o,s){var a;if(i.indexOf(s.baseUrl)!==0)throw new Error("Can only be used for notebook server requests");((a=o.cache)!==null&&a!==void 0?a:s.init.cache)==="no-store"&&(i+=(/\?/.test(i)?"&":"?")+new Date().getTime());let u=new s.Request(i,{...s.init,...o}),c=!1;if(s.token&&(c=!0,u.headers.append("Authorization",`token ${s.token}`)),typeof document!="undefined"){let d=n("_xsrf");d!==void 0&&(c=!0,u.headers.append("X-XSRFToken",d))}return!u.headers.has("Content-Type")&&c&&u.headers.set("Content-Type","application/json"),s.fetch.call(null,u).catch(d=>{throw new sV.NetworkError(d)})}r.handleRequest=t;function n(i){let o="";try{o=document.cookie}catch(a){return}let s=o.match("\\b"+i+"=([^;]*)\\b");return s==null?void 0:s[1]}})(I1||(I1={}))});var Fg=re(_1=>{"use strict";p();Object.defineProperty(_1,"__esModule",{value:!0});_1.BaseManager=void 0;var IX=Ms(),vye=ko(),aV=class{constructor(e){var t;this._isDisposed=!1,this._disposed=new IX.Signal(this),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:vye.ServerConnection.makeSettings()}get disposed(){return this._disposed}get isDisposed(){return this._isDisposed}get isActive(){return!0}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(void 0),IX.Signal.clearData(this))}};_1.BaseManager=aV});var _X=re(fI=>{"use strict";p();Object.defineProperty(fI,"__esModule",{value:!0});fI.ConfigWithDefaults=fI.ConfigSection=void 0;var yye=io(),Ex=Bn(),bye="api/config",SX;(function(r){function e(t){let n=new lV(t);return n.load().then(()=>n)}r.create=e})(SX||(fI.ConfigSection=SX={}));var lV=class{constructor(e){var t;this._url="unknown";let n=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Ex.ServerConnection.makeSettings();this._url=yye.URLExt.join(n.baseUrl,bye,encodeURIComponent(e.name))}get data(){return this._data}async load(){let e=await Ex.ServerConnection.makeRequest(this._url,{},this.serverSettings);if(e.status!==200)throw await Ex.ServerConnection.ResponseError.create(e);this._data=await e.json()}async update(e){this._data={...this._data,...e};let t={method:"PATCH",body:JSON.stringify(e)},n=await Ex.ServerConnection.makeRequest(this._url,t,this.serverSettings);if(n.status!==200)throw await Ex.ServerConnection.ResponseError.create(n);return this._data=await n.json(),this._data}},cV=class{constructor(e){var t,n;this._className="",this._section=e.section,this._defaults=(t=e.defaults)!==null&&t!==void 0?t:{},this._className=(n=e.className)!==null&&n!==void 0?n:""}get(e){let t=this._classData();return e in t?t[e]:this._defaults[e]}set(e,t){let n={};if(n[e]=t,this._className){let i={};return i[this._className]=n,this._section.update(i)}else return this._section.update(n)}_classData(){let e=this._section.data;return this._className&&this._className in e?e[this._className]:e}};fI.ConfigWithDefaults=cV});var Cx=re(E1=>{"use strict";p();Object.defineProperty(E1,"__esModule",{value:!0});E1.validateProperty=void 0;function Iye(r,e,t,n=[]){if(!r.hasOwnProperty(e))throw Error(`Missing property '${e}'`);let i=r[e];if(t!==void 0){let o=!0;switch(t){case"array":o=Array.isArray(i);break;case"object":o=typeof i!="undefined";break;default:o=typeof i===t}if(!o)throw new Error(`Property '${e}' is not of type '${t}'`);if(n.length>0){let s=!0;switch(t){case"string":case"number":case"boolean":s=n.includes(i);break;default:s=n.findIndex(a=>a===i)>=0;break}if(!s)throw new Error(`Property '${e}' is not one of the valid values ${JSON.stringify(n)}`)}}}E1.validateProperty=Iye});var EX=re(mI=>{"use strict";p();Object.defineProperty(mI,"__esModule",{value:!0});mI.validateCheckpointModel=mI.validateContentsModel=void 0;var $c=Cx();function Sye(r){(0,$c.validateProperty)(r,"name","string"),(0,$c.validateProperty)(r,"path","string"),(0,$c.validateProperty)(r,"type","string"),(0,$c.validateProperty)(r,"created","string"),(0,$c.validateProperty)(r,"last_modified","string"),(0,$c.validateProperty)(r,"mimetype","object"),(0,$c.validateProperty)(r,"content","object"),(0,$c.validateProperty)(r,"format","object")}mI.validateContentsModel=Sye;function _ye(r){(0,$c.validateProperty)(r,"id","string"),(0,$c.validateProperty)(r,"last_modified","string")}mI.validateCheckpointModel=_ye});var pV=re(ss=>{"use strict";p();var Eye=ss&&ss.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Cye=ss&&ss.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),wye=ss&&ss.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Eye(e,r,t);return Cye(e,r),e};Object.defineProperty(ss,"__esModule",{value:!0});ss.Drive=ss.ContentsManager=ss.Contents=void 0;var Os=io(),C1=Ms(),_n=Bn(),Rd=wye(EX()),xye="api/contents",Pye="files",CX;(function(r){function e(n){Rd.validateContentsModel(n)}r.validateContentsModel=e;function t(n){Rd.validateCheckpointModel(n)}r.validateCheckpointModel=t})(CX||(ss.Contents=CX={}));var uV=class{constructor(e={}){var t,n;this._isDisposed=!1,this._additionalDrives=new Map,this._fileChanged=new C1.Signal(this);let i=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:_n.ServerConnection.makeSettings();this._defaultDrive=(n=e.defaultDrive)!==null&&n!==void 0?n:new w1({serverSettings:i}),this._defaultDrive.fileChanged.connect(this._onFileChanged,this)}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,C1.Signal.clearData(this))}addDrive(e){this._additionalDrives.set(e.name,e),e.fileChanged.connect(this._onFileChanged,this)}getSharedModelFactory(e){var t;let[n]=this._driveForPath(e);return(t=n==null?void 0:n.sharedModelFactory)!==null&&t!==void 0?t:null}localPath(e){let t=e.split("/"),n=t[0].split(":");return n.length===1||!this._additionalDrives.has(n[0])?Os.PathExt.removeSlash(e):Os.PathExt.join(n.slice(1).join(":"),...t.slice(1))}normalize(e){let t=e.split(":");return t.length===1?Os.PathExt.normalize(e):`${t[0]}:${Os.PathExt.normalize(t.slice(1).join(":"))}`}resolvePath(e,t){let n=this.driveName(e),i=this.localPath(e),o=Os.PathExt.resolve("/",i,t);return n?`${n}:${o}`:o}driveName(e){let n=e.split("/")[0].split(":");return n.length===1?"":this._additionalDrives.has(n[0])?n[0]:""}get(e,t){let[n,i]=this._driveForPath(e);return n.get(i,t).then(o=>{let s=[];if(o.type==="directory"&&o.content){for(let a of o.content)s.push({...a,path:this._toGlobalPath(n,a.path)});return{...o,path:this._toGlobalPath(n,i),content:s,serverPath:o.path}}else return{...o,path:this._toGlobalPath(n,i),serverPath:o.path}})}getDownloadUrl(e){let[t,n]=this._driveForPath(e);return t.getDownloadUrl(n)}newUntitled(e={}){if(e.path){let t=this.normalize(e.path),[n,i]=this._driveForPath(t);return n.newUntitled({...e,path:i}).then(o=>({...o,path:Os.PathExt.join(t,o.name),serverPath:o.path}))}else return this._defaultDrive.newUntitled(e)}delete(e){let[t,n]=this._driveForPath(e);return t.delete(n)}rename(e,t){let[n,i]=this._driveForPath(e),[o,s]=this._driveForPath(t);if(n!==o)throw Error("ContentsManager: renaming files must occur within a Drive");return n.rename(i,s).then(a=>({...a,path:this._toGlobalPath(n,s),serverPath:a.path}))}save(e,t={}){let n=this.normalize(e),[i,o]=this._driveForPath(e);return i.save(o,{...t,path:o}).then(s=>({...s,path:n,serverPath:s.path}))}copy(e,t){let[n,i]=this._driveForPath(e),[o,s]=this._driveForPath(t);if(n===o)return n.copy(i,s).then(a=>({...a,path:this._toGlobalPath(n,a.path),serverPath:a.path}));throw Error("Copying files between drives is not currently implemented")}createCheckpoint(e){let[t,n]=this._driveForPath(e);return t.createCheckpoint(n)}listCheckpoints(e){let[t,n]=this._driveForPath(e);return t.listCheckpoints(n)}restoreCheckpoint(e,t){let[n,i]=this._driveForPath(e);return n.restoreCheckpoint(i,t)}deleteCheckpoint(e,t){let[n,i]=this._driveForPath(e);return n.deleteCheckpoint(i,t)}_toGlobalPath(e,t){return e===this._defaultDrive?Os.PathExt.removeSlash(t):`${e.name}:${Os.PathExt.removeSlash(t)}`}_driveForPath(e){let t=this.driveName(e),n=this.localPath(e);return t?[this._additionalDrives.get(t),n]:[this._defaultDrive,n]}_onFileChanged(e,t){var n,i;if(e===this._defaultDrive)this._fileChanged.emit(t);else{let o=null,s=null;!((n=t.newValue)===null||n===void 0)&&n.path&&(o={...t.newValue,path:this._toGlobalPath(e,t.newValue.path)}),!((i=t.oldValue)===null||i===void 0)&&i.path&&(s={...t.oldValue,path:this._toGlobalPath(e,t.oldValue.path)}),this._fileChanged.emit({type:t.type,newValue:o,oldValue:s})}}};ss.ContentsManager=uV;var w1=class{constructor(e={}){var t,n,i;this._isDisposed=!1,this._fileChanged=new C1.Signal(this),this.name=(t=e.name)!==null&&t!==void 0?t:"Default",this._apiEndpoint=(n=e.apiEndpoint)!==null&&n!==void 0?n:xye,this.serverSettings=(i=e.serverSettings)!==null&&i!==void 0?i:_n.ServerConnection.makeSettings()}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,C1.Signal.clearData(this))}async get(e,t){let n=this._getUrl(e);if(t){t.type==="notebook"&&delete t.format;let a=t.content?"1":"0",l=t.hash?"1":"0",u={...t,content:a,hash:l};n+=Os.URLExt.objectToQueryString(u)}let i=this.serverSettings,o=await _n.ServerConnection.makeRequest(n,{},i);if(o.status!==200)throw await _n.ServerConnection.ResponseError.create(o);let s=await o.json();return Rd.validateContentsModel(s),s}getDownloadUrl(e){let t=this.serverSettings.baseUrl,n=Os.URLExt.join(t,Pye,Os.URLExt.encodeParts(e)),i="";try{i=document.cookie}catch(s){}let o=i.match("\\b_xsrf=([^;]*)\\b");if(o){let s=new URL(n);s.searchParams.append("_xsrf",o[1]),n=s.toString()}return Promise.resolve(n)}async newUntitled(e={}){var t;let n="{}";e&&(e.ext&&(e.ext=dV.normalizeExtension(e.ext)),n=JSON.stringify(e));let i=this.serverSettings,o=this._getUrl((t=e.path)!==null&&t!==void 0?t:""),s={method:"POST",body:n},a=await _n.ServerConnection.makeRequest(o,s,i);if(a.status!==201)throw await _n.ServerConnection.ResponseError.create(a);let l=await a.json();return Rd.validateContentsModel(l),this._fileChanged.emit({type:"new",oldValue:null,newValue:l}),l}async delete(e){let t=this._getUrl(e),n=this.serverSettings,i={method:"DELETE"},o=await _n.ServerConnection.makeRequest(t,i,n);if(o.status!==204)throw await _n.ServerConnection.ResponseError.create(o);this._fileChanged.emit({type:"delete",oldValue:{path:e},newValue:null})}async rename(e,t){let n=this.serverSettings,i=this._getUrl(e),o={method:"PATCH",body:JSON.stringify({path:t})},s=await _n.ServerConnection.makeRequest(i,o,n);if(s.status!==200)throw await _n.ServerConnection.ResponseError.create(s);let a=await s.json();return Rd.validateContentsModel(a),this._fileChanged.emit({type:"rename",oldValue:{path:e},newValue:a}),a}async save(e,t={}){let n=this.serverSettings,i=this._getUrl(e),o={method:"PUT",body:JSON.stringify(t)},s=await _n.ServerConnection.makeRequest(i,o,n);if(s.status!==200&&s.status!==201)throw await _n.ServerConnection.ResponseError.create(s);let a=await s.json();return Rd.validateContentsModel(a),this._fileChanged.emit({type:"save",oldValue:null,newValue:a}),a}async copy(e,t){let n=this.serverSettings,i=this._getUrl(t),o={method:"POST",body:JSON.stringify({copy_from:e})},s=await _n.ServerConnection.makeRequest(i,o,n);if(s.status!==201)throw await _n.ServerConnection.ResponseError.create(s);let a=await s.json();return Rd.validateContentsModel(a),this._fileChanged.emit({type:"new",oldValue:null,newValue:a}),a}async createCheckpoint(e){let t=this._getUrl(e,"checkpoints"),n={method:"POST"},i=await _n.ServerConnection.makeRequest(t,n,this.serverSettings);if(i.status!==201)throw await _n.ServerConnection.ResponseError.create(i);let o=await i.json();return Rd.validateCheckpointModel(o),o}async listCheckpoints(e){let t=this._getUrl(e,"checkpoints"),n=await _n.ServerConnection.makeRequest(t,{},this.serverSettings);if(n.status!==200)throw await _n.ServerConnection.ResponseError.create(n);let i=await n.json();if(!Array.isArray(i))throw new Error("Invalid Checkpoint list");for(let o=0;o<i.length;o++)Rd.validateCheckpointModel(i[o]);return i}async restoreCheckpoint(e,t){let n=this._getUrl(e,"checkpoints",t),i={method:"POST"},o=await _n.ServerConnection.makeRequest(n,i,this.serverSettings);if(o.status!==204)throw await _n.ServerConnection.ResponseError.create(o)}async deleteCheckpoint(e,t){let n=this._getUrl(e,"checkpoints",t),i={method:"DELETE"},o=await _n.ServerConnection.makeRequest(n,i,this.serverSettings);if(o.status!==204)throw await _n.ServerConnection.ResponseError.create(o)}_getUrl(...e){let t=e.map(i=>Os.URLExt.encodeParts(i)),n=this.serverSettings.baseUrl;return Os.URLExt.join(n,this._apiEndpoint,...t)}};ss.Drive=w1;var dV;(function(r){function e(t){return t.length>0&&t.indexOf(".")!==0&&(t=`.${t}`),t}r.normalizeExtension=e})(dV||(dV={}))});var fV=re((x1,wX)=>{p();(function(r,e){typeof x1=="object"&&typeof wX!="undefined"?e(x1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(x1,function(r){"use strict";r.ArrayExt=void 0,function(h){function y(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(A[me]===M)return me}return-1}h.firstIndexOf=y;function w(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(A[me]===M)return me}return-1}h.lastIndexOf=w;function T(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(M(A[me],me))return me}return-1}h.findFirstIndex=T;function H(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(M(A[me],me))return me}return-1}h.findLastIndex=H;function Y(A,M,I=0,S=-1){let _=T(A,M,I,S);return _!==-1?A[_]:void 0}h.findFirstValue=Y;function Z(A,M,I=-1,S=0){let _=H(A,M,I,S);return _!==-1?A[_]:void 0}h.findLastValue=Z;function ie(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function le(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=le;function be(A,M,I){if(A===M)return!0;if(A.length!==M.length)return!1;for(let S=0,_=A.length;S<_;++S)if(I?!I(A[S],M[S]):A[S]!==M[S])return!1;return!0}h.shallowEqual=be;function q(A,M={}){let{start:I,stop:S,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=A.length;I===void 0?I=_<0?F-1:0:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F),S===void 0?S=_<0?-1:F:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F);let j;_<0&&S>=I||_>0&&I>=S?j=0:_<0?j=Math.floor((S-I+1)/_+1):j=Math.floor((S-I-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=A[I+Fe*_];return me}h.slice=q;function $(A,M,I){let S=A.length;if(S<=1||(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1),M===I))return;let _=A[M],F=M<I?1:-1;for(let j=M;j!==I;j+=F)A[j]=A[j+F];A[I]=_}h.move=$;function ue(A,M=0,I=-1){let S=A.length;if(!(S<=1))for(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1);M<I;){let _=A[M],F=A[I];A[M++]=F,A[I--]=_}}h.reverse=ue;function pe(A,M,I=0,S=-1){let _=A.length;if(_<=1||(I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I>=S))return;let F=S-I+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=I+M;ue(A,I,j-1),ue(A,j,S),ue(A,I,S)}h.rotate=pe;function ye(A,M,I=0,S=-1){let _=A.length;if(_===0)return;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j)A[(I+j)%_]=M}h.fill=ye;function z(A,M,I){let S=A.length;M<0?M=Math.max(0,M+S):M=Math.min(M,S);for(let _=S;_>M;--_)A[_]=A[_-1];A[M]=I}h.insert=z;function fe(A,M){let I=A.length;if(M<0&&(M+=I),M<0||M>=I)return;let S=A[M];for(let _=M+1;_<I;++_)A[_-1]=A[_];return A.length=I-1,S}h.removeAt=fe;function Se(A,M,I=0,S=-1){let _=y(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeFirstOf=Se;function Te(A,M,I=-1,S=0){let _=w(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeLastOf=Te;function Le(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&A[j]===M||S<I&&(j<=S||j>=I)&&A[j]===M?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllOf=Le;function Ye(A,M,I=0,S=-1){let _,F=T(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeFirstWhere=Ye;function Je(A,M,I=-1,S=0){let _,F=H(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeLastWhere=Je;function Bt(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&M(A[j],j)||S<I&&(j<=S||j>=I)&&M(A[j],j)?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let y of h)yield*y}function*t(){}function*n(h,y=0){for(let w of h)yield[y++,w]}function*i(h,y){let w=0;for(let T of h)y(T,w++)&&(yield T)}function o(h,y){let w=0;for(let T of h)if(y(T,w++))return T}function s(h,y){let w=0;for(let T of h)if(y(T,w++))return w-1;return-1}function a(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)<0&&(w=T)}return w}function l(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)>0&&(w=T)}return w}function u(h,y){let w=!0,T,H;for(let Y of h)w?(T=Y,H=Y,w=!1):y(Y,T)<0?T=Y:y(Y,H)>0&&(H=Y);return w?void 0:[T,H]}function c(h){return Array.from(h)}function d(h){let y={};for(let[w,T]of h)y[w]=T;return y}function f(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return}function m(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return!1;return!0}function g(h,y){let w=0;for(let T of h)if(y(T,w++))return!0;return!1}function*b(h,y){let w=0;for(let T of h)yield y(T,w++)}function*v(h,y,w){y===void 0?(y=h,h=0,w=1):w===void 0&&(w=1);let T=k.rangeLength(h,y,w);for(let H=0;H<T;H++)yield h+w*H}var k;(function(h){function y(w,T,H){return H===0?1/0:w>T&&H>0||w<T&&H<0?0:Math.ceil((T-w)/H)}h.rangeLength=y})(k||(k={}));function R(h,y,w){let T=h[Symbol.iterator](),H=0,Y=T.next();if(Y.done&&w===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return w;let Z=T.next();if(Z.done&&w===void 0)return Y.value;if(Z.done)return y(w,Y.value,H++);let ie;w===void 0?ie=y(Y.value,Z.value,H++):ie=y(y(w,Y.value,H++),Z.value,H++);let le;for(;!(le=T.next()).done;)ie=y(ie,le.value,H++);return ie}function*P(h,y){for(;0<y--;)yield h}function*D(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let y=h.length-1;y>-1;y--)yield h[y]}function L(h){let y=[],w=new Set,T=new Map;for(let Z of h)H(Z);for(let[Z]of T)Y(Z);return y;function H(Z){let[ie,le]=Z,be=T.get(le);be?be.push(ie):T.set(le,[ie])}function Y(Z){if(w.has(Z))return;w.add(Z);let ie=T.get(Z);if(ie)for(let le of ie)Y(le);y.push(Z)}}function*B(h,y){let w=0;for(let T of h)w++%y===0&&(yield T)}r.StringExt=void 0,function(h){function y(Z,ie,le=0){let be=new Array(ie.length);for(let q=0,$=le,ue=ie.length;q<ue;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=y;function w(Z,ie,le=0){let be=y(Z,ie,le);if(!be)return null;let q=0;for(let $=0,ue=be.length;$<ue;++$){let pe=be[$]-le;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=w;function T(Z,ie,le=0){let be=y(Z,ie,le);if(!be)return null;let q=0,$=le-1;for(let ue=0,pe=be.length;ue<pe;++ue){let ye=be[ue];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=T;function H(Z,ie,le){let be=[],q=0,$=0,ue=ie.length;for(;q<ue;){let pe=ie[q],ye=ie[q];for(;++q<ue&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(le(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,y){if(y<1)return;let w=h[Symbol.iterator](),T;for(;0<y--&&!(T=w.next()).done;)yield T.value}function*O(...h){let y=h.map(T=>T[Symbol.iterator]()),w=y.map(T=>T.next());for(;m(w,T=>!T.done);w=y.map(T=>T.next()))yield w.map(T=>T.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=D,r.range=v,r.reduce=R,r.repeat=P,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var mV=re((P1,xX)=>{p();(function(r,e){typeof P1=="object"&&typeof xX!="undefined"?e(P1,fV()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(P1,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(P){return P===null||typeof P=="boolean"||typeof P=="number"||typeof P=="string"}u.isPrimitive=c;function d(P){return Array.isArray(P)}u.isArray=d;function f(P){return!c(P)&&!d(P)}u.isObject=f;function m(P,D){if(P===D)return!0;if(c(P)||c(D))return!1;let K=d(P),L=d(D);return K!==L?!1:K&&L?b(P,D):v(P,D)}u.deepEqual=m;function g(P){return c(P)?P:d(P)?k(P):R(P)}u.deepCopy=g;function b(P,D){if(P===D)return!0;if(P.length!==D.length)return!1;for(let K=0,L=P.length;K<L;++K)if(!m(P[K],D[K]))return!1;return!0}function v(P,D){if(P===D)return!0;for(let K in P)if(P[K]!==void 0&&!(K in D))return!1;for(let K in D)if(D[K]!==void 0&&!(K in P))return!1;for(let K in P){let L=P[K],B=D[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function k(P){let D=new Array(P.length);for(let K=0,L=P.length;K<L;++K)D[K]=g(P[K]);return D}function R(P){let D={};for(let K in P){let L=P[K];L!==void 0&&(D[K]=g(L))}return D}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(v=>{let k=this._services.get(v);return k?this._plugins.get(k).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(v){var k,R,P,D;this._activated=!1,this._promise=null,this._service=null,this.id=v.id,this.description=(k=v.description)!==null&&k!==void 0?k:"",this.activate=v.activate,this.deactivate=(R=v.deactivate)!==null&&R!==void 0?R:null,this.provides=(P=v.provides)!==null&&P!==void 0?P:null,this.autoStart=(D=v.autoStart)!==null&&D!==void 0?D:!1,this.requires=v.requires?v.requires.slice():[],this.optional=v.optional?v.optional.slice():[]}get activated(){return this._activated}set activated(v){this._activated=v}get service(){return this._service}set service(v){this._service=v}get promise(){return this._promise}set promise(v){this._promise=v}}function d(b){return new c(b)}u.createPluginData=d;function f(b,v,k){let R=[...b.requires,...b.optional],P=K=>{if(K===b.provides)return!0;let L=k.get(K);if(!L)return!1;let B=v.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(D.push(L),N.some(P)?!0:(D.pop(),!1))};if(!b.provides||R.length===0)return;let D=[b.id];if(R.some(P))throw new ReferenceError(`Cycle detected: ${D.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,v,k){let R=new Array,P=N=>{let O=v.get(N),h=[...O.requires,...O.optional];R.push(...h.reduce((y,w)=>{let T=k.get(w);return T&&y.push([N,T]),y},[]))};for(let N of v.keys())P(N);let D=R.filter(N=>N[1]===b),K=0;for(;D.length>K;){let N=D.length,O=new Set(D.map(h=>h[0]));for(let h of O)R.filter(y=>y[1]===h).forEach(y=>{D.includes(y)||D.push(y)});K=N}let L=e.topologicSort(D),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,v){let k=new Set;for(let R of b.keys())b.get(R).autoStart===!0&&k.add(R);if(v.startPlugins)for(let R of v.startPlugins)k.add(R);if(v.ignorePlugins)for(let R of v.ignorePlugins)k.delete(R);return Array.from(k)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var DX=re((D1,PX)=>{p();(function(r,e){typeof D1=="object"&&typeof PX!="undefined"?e(D1,fV(),mV()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(D1,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let y=g.get(N.sender);if(y||(y=[],g.set(N.sender,y)),R(y,N,O,h))return!1;let w=h||O,T=b.get(w);T||(T=[],b.set(w,T));let H={signal:N,slot:O,thisArg:h};return y.push(H),T.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let y=g.get(N.sender);if(!y||y.length===0)return!1;let w=R(y,N,O,h);if(!w)return!1;let T=h||O,H=b.get(T);return w.signal=null,D(y),D(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let y=b.get(O);if(!(!y||y.length===0)){for(let w of y)w.signal&&w.signal.sender===N&&(w.signal=null);D(h),D(y)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.thisArg||h.slot;h.signal=null,D(b.get(y))}D(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.signal.sender;h.signal=null,D(g.get(y))}D(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let y=0,w=h.length;y<w;++y){let T=h[y];T.signal===N&&P(T,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,v=new Set,k=typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate;function R(N,O,h,y){return e.find(N,w=>w.signal===O&&w.slot===h&&w.thisArg===y)}function P(N,O){let{signal:h,slot:y,thisArg:w}=N;try{y.call(w,h.sender,O)}catch(T){s.exceptionHandler(T)}}function D(N){v.size===0&&k(K),v.add(N)}function K(){v.forEach(L),v.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var Ug=re((T1,TX)=>{p();(function(r,e){typeof T1=="object"&&typeof TX!="undefined"?e(T1,mV(),DX()):typeof define=="function"&&define.amd?define(["exports","@lumino/coreutils","@lumino/signaling"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_polling={},r.lumino_coreutils,r.lumino_signaling))})(T1,function(r,e,t){"use strict";class n{constructor(u){var c;this._disposed=new t.Signal(this),this._lingered=0,this._tick=new e.PromiseDelegate,this._ticked=new t.Signal(this),this._factory=u.factory,this._linger=(c=u.linger)!==null&&c!==void 0?c:i.DEFAULT_LINGER,this._standby=u.standby||i.DEFAULT_STANDBY,this._state={...i.DEFAULT_STATE,timestamp:new Date().getTime()};let d=u.frequency||{},f=Math.max(d.interval||0,d.max||0,i.DEFAULT_FREQUENCY.max);this.frequency={...i.DEFAULT_FREQUENCY,...d,max:f},this.name=u.name||i.DEFAULT_NAME,(!("auto"in u)||u.auto)&&setTimeout(()=>this.start())}get disposed(){return this._disposed}get frequency(){return this._frequency}set frequency(u){if(this.isDisposed||e.JSONExt.deepEqual(u,this.frequency||{}))return;let{backoff:c,interval:d,max:f}=u;if(d=Math.round(d),f=Math.round(f),typeof c=="number"&&c<1)throw new Error("Poll backoff growth factor must be at least 1");if((d<0||d>f)&&d!==n.NEVER)throw new Error("Poll interval must be between 0 and max");if(f>n.MAX_INTERVAL&&f!==n.NEVER)throw new Error(`Max interval must be less than ${n.MAX_INTERVAL}`);this._frequency={backoff:c,interval:d,max:f}}get isDisposed(){return this.state.phase==="disposed"}get standby(){return this._standby}set standby(u){this.isDisposed||this.standby===u||(this._standby=u)}get state(){return this._state}get tick(){return this._tick.promise}get ticked(){return this._ticked}async*[Symbol.asyncIterator](){for(;!this.isDisposed;)yield this.state,await this.tick.catch(()=>{})}dispose(){this.isDisposed||(this._state={...i.DISPOSED_STATE,timestamp:new Date().getTime()},this._tick.promise.catch(u=>{}),this._tick.reject(new Error(`Poll (${this.name}) is disposed.`)),this._disposed.emit(void 0),t.Signal.clearData(this))}refresh(){return this.schedule({cancel:({phase:u})=>u==="refreshed",interval:n.IMMEDIATE,phase:"refreshed"})}async schedule(u={}){if(this.isDisposed||u.cancel&&u.cancel(this.state))return;let c=this._tick,d=new e.PromiseDelegate,f={interval:this.frequency.interval,payload:null,phase:"standby",timestamp:new Date().getTime(),...u};if(this._state=f,this._tick=d,clearTimeout(this._timeout),this._ticked.emit(this.state),c.resolve(this),await c.promise,f.interval===n.NEVER){this._timeout=void 0;return}let m=()=>{this.isDisposed||this.tick!==d.promise||this._execute()};this._timeout=setTimeout(m,f.interval)}start(){return this.schedule({cancel:({phase:u})=>u!=="constructed"&&u!=="standby"&&u!=="stopped",interval:n.IMMEDIATE,phase:"started"})}stop(){return this.schedule({cancel:({phase:u})=>u==="stopped",interval:n.NEVER,phase:"stopped"})}get hidden(){return i.hidden}_execute(){let u=typeof this.standby=="function"?this.standby():this.standby;if(u==="never"?u=!1:u==="when-hidden"&&(this.hidden?u=++this._lingered>this._linger:(this._lingered=0,u=!1)),u){this.schedule();return}let c=this.tick;this._factory(this.state).then(d=>{this.isDisposed||this.tick!==c||this.schedule({payload:d,phase:this.state.phase==="rejected"?"reconnected":"resolved"})}).catch(d=>{this.isDisposed||this.tick!==c||this.schedule({interval:i.sleep(this.frequency,this.state),payload:d,phase:"rejected"})})}}(function(l){l.IMMEDIATE=0,l.MAX_INTERVAL=2147483647,l.NEVER=1/0})(n||(n={}));var i;(function(l){l.DEFAULT_BACKOFF=3,l.DEFAULT_FREQUENCY={backoff:!0,interval:1e3,max:30*1e3},l.DEFAULT_LINGER=1,l.DEFAULT_NAME="unknown",l.DEFAULT_STANDBY="when-hidden",l.DEFAULT_STATE={interval:n.NEVER,payload:null,phase:"constructed",timestamp:new Date(0).getTime()},l.DISPOSED_STATE={interval:n.NEVER,payload:null,phase:"disposed",timestamp:new Date(0).getTime()};function u(d,f){let{backoff:m,interval:g,max:b}=d;if(g===n.NEVER)return g;let v=m===!0?l.DEFAULT_BACKOFF:m===!1?1:m,k=c(g,f.interval*v);return Math.min(b,k)}l.sleep=u,l.hidden=typeof document=="undefined"?!1:(document.addEventListener("visibilitychange",()=>{l.hidden=document.visibilityState==="hidden"}),document.addEventListener("pagehide",()=>{l.hidden=document.visibilityState==="hidden"}),document.visibilityState==="hidden");function c(d,f){return d=Math.ceil(d),f=Math.floor(f),Math.floor(Math.random()*(f-d+1))+d}})(i||(i={}));class o{constructor(u,c=500){this.args=void 0,this.payload=null,this.limit=c,this.poll=new n({auto:!1,factory:async()=>{let{args:d}=this;return this.args=void 0,u(...d)},frequency:{backoff:!1,interval:n.NEVER,max:n.NEVER},standby:"never"}),this.payload=new e.PromiseDelegate,this.poll.ticked.connect((d,f)=>{let{payload:m}=this;if(f.phase==="resolved"){this.payload=new e.PromiseDelegate,m.resolve(f.payload);return}if(f.phase==="rejected"||f.phase==="stopped"){this.payload=new e.PromiseDelegate,m.promise.catch(g=>{}),m.reject(f.payload);return}},this)}get isDisposed(){return this.payload===null}dispose(){this.isDisposed||(this.args=void 0,this.payload=null,this.poll.dispose())}async stop(){return this.poll.stop()}}class s extends o{invoke(...u){return this.args=u,this.poll.schedule({interval:this.limit,phase:"invoked"}),this.payload.promise}}class a extends o{constructor(u,c){super(u,typeof c=="number"?c:c&&c.limit),this._trailing=!1,typeof c!="number"&&c&&c.edge==="trailing"&&(this._trailing=!0),this._interval=this._trailing?this.limit:n.IMMEDIATE}invoke(...u){let c=this.poll.state.phase!=="invoked";return(c||this._trailing)&&(this.args=u),c&&this.poll.schedule({interval:this._interval,phase:"invoked"}),this.payload.promise}}r.Debouncer=s,r.Poll=n,r.RateLimiter=o,r.Throttler=a})});var gV=re(k1=>{"use strict";p();Object.defineProperty(k1,"__esModule",{value:!0});k1.EventManager=void 0;var kX=io(),Dye=Ug(),NX=Ms(),RX=ko(),AX="api/events",hV=class{constructor(e={}){var t;this._socket=null,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:RX.ServerConnection.makeSettings(),this._poll=new Dye.Poll({factory:()=>this._subscribe()}),this._stream=new NX.Stream(this),this._poll.start()}get isDisposed(){return this._poll.isDisposed}get stream(){return this._stream}dispose(){if(this.isDisposed)return;this._poll.dispose();let e=this._socket;e&&(this._socket=null,e.onopen=()=>{},e.onerror=()=>{},e.onmessage=()=>{},e.onclose=()=>{},e.close()),NX.Signal.clearData(this),this._stream.stop()}async emit(e){let{serverSettings:t}=this,{baseUrl:n}=t,{makeRequest:i,ResponseError:o}=RX.ServerConnection,s=kX.URLExt.join(n,AX),a={body:JSON.stringify(e),method:"POST"},l=await i(s,a,t);if(l.status!==204)throw new o(l)}_subscribe(){return new Promise((e,t)=>{if(this.isDisposed)return;let{appendToken:n,token:i,WebSocket:o,wsUrl:s}=this.serverSettings,a=kX.URLExt.join(s,AX,"subscribe");n&&i!==""&&(a+=`?token=${encodeURIComponent(i)}`);let l=this._socket=new o(a),u=this._stream;l.onclose=()=>t(new Error("EventManager socket closed")),l.onmessage=c=>c.data&&u.emit(JSON.parse(c.data))})}};k1.EventManager=hV});var OX=re(MX=>{"use strict";p();Object.defineProperty(MX,"__esModule",{value:!0})});var N1=re(Of=>{"use strict";p();Object.defineProperty(Of,"__esModule",{value:!0});Of.validateModels=Of.validateModel=Of.validateMessage=void 0;var Wg=Cx(),LX=["username","version","session","msg_id","msg_type"],Tye={stream:{name:"string",text:"string"},display_data:{data:"object",metadata:"object"},execute_input:{code:"string",execution_count:"number"},execute_result:{execution_count:"number",data:"object",metadata:"object"},error:{ename:"string",evalue:"string",traceback:"object"},status:{execution_state:["string",["starting","idle","busy","restarting","dead"]]},clear_output:{wait:"boolean"},comm_open:{comm_id:"string",target_name:"string",data:"object"},comm_msg:{comm_id:"string",data:"object"},comm_close:{comm_id:"string"},shutdown_reply:{restart:"boolean"}};function kye(r){for(let e=0;e<LX.length;e++)(0,Wg.validateProperty)(r,LX[e],"string")}function Nye(r){(0,Wg.validateProperty)(r,"metadata","object"),(0,Wg.validateProperty)(r,"content","object"),(0,Wg.validateProperty)(r,"channel","string"),kye(r.header),r.channel==="iopub"&&Rye(r)}Of.validateMessage=Nye;function Rye(r){if(r.channel==="iopub"){let e=Tye[r.header.msg_type];if(e===void 0)return;let t=Object.keys(e),n=r.content;for(let i=0;i<t.length;i++){let o=e[t[i]];Array.isArray(o)||(o=[o]),(0,Wg.validateProperty)(n,t[i],...o)}}}function KX(r){(0,Wg.validateProperty)(r,"name","string"),(0,Wg.validateProperty)(r,"id","string")}Of.validateModel=KX;function Aye(r){if(!Array.isArray(r))throw new Error("Invalid kernel list");r.forEach(e=>KX(e))}Of.validateModels=Aye});var A1=re(En=>{"use strict";p();Object.defineProperty(En,"__esModule",{value:!0});En.getKernelModel=En.shutdownKernel=En.interruptKernel=En.restartKernel=En.startNew=En.listRunning=En.KERNEL_SERVICE_URL=void 0;var vi=ko(),hI=io(),R1=N1();En.KERNEL_SERVICE_URL="api/kernels";async function Mye(r=vi.ServerConnection.makeSettings()){let e=hI.URLExt.join(r.baseUrl,En.KERNEL_SERVICE_URL),t=await vi.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await vi.ServerConnection.ResponseError.create(t);let n=await t.json();return(0,R1.validateModels)(n),n}En.listRunning=Mye;async function Oye(r={},e=vi.ServerConnection.makeSettings()){let t=hI.URLExt.join(e.baseUrl,En.KERNEL_SERVICE_URL),n={method:"POST",body:JSON.stringify(r)},i=await vi.ServerConnection.makeRequest(t,n,e);if(i.status!==201)throw await vi.ServerConnection.ResponseError.create(i);let o=await i.json();return(0,R1.validateModel)(o),o}En.startNew=Oye;async function Lye(r,e=vi.ServerConnection.makeSettings()){let t=hI.URLExt.join(e.baseUrl,En.KERNEL_SERVICE_URL,encodeURIComponent(r),"restart"),n={method:"POST"},i=await vi.ServerConnection.makeRequest(t,n,e);if(i.status!==200)throw await vi.ServerConnection.ResponseError.create(i);let o=await i.json();(0,R1.validateModel)(o)}En.restartKernel=Lye;async function Kye(r,e=vi.ServerConnection.makeSettings()){let t=hI.URLExt.join(e.baseUrl,En.KERNEL_SERVICE_URL,encodeURIComponent(r),"interrupt"),n={method:"POST"},i=await vi.ServerConnection.makeRequest(t,n,e);if(i.status!==204)throw await vi.ServerConnection.ResponseError.create(i)}En.interruptKernel=Kye;async function Fye(r,e=vi.ServerConnection.makeSettings()){let t=hI.URLExt.join(e.baseUrl,En.KERNEL_SERVICE_URL,encodeURIComponent(r)),n={method:"DELETE"},i=await vi.ServerConnection.makeRequest(t,n,e);if(i.status===404){let o=`The kernel "${r}" does not exist on the server`;console.warn(o)}else if(i.status!==204)throw await vi.ServerConnection.ResponseError.create(i)}En.shutdownKernel=Fye;async function Uye(r,e=vi.ServerConnection.makeSettings()){let t=hI.URLExt.join(e.baseUrl,En.KERNEL_SERVICE_URL,encodeURIComponent(r)),n=await vi.ServerConnection.makeRequest(t,{},e);if(n.status===404)return;if(n.status!==200)throw await vi.ServerConnection.ResponseError.create(n);let i=await n.json();return(0,R1.validateModel)(i),i}En.getKernelModel=Uye});var vV=re((M1,FX)=>{p();(function(r,e){typeof M1=="object"&&typeof FX!="undefined"?e(M1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(M1,function(r){"use strict";r.ArrayExt=void 0,function(h){function y(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(A[me]===M)return me}return-1}h.firstIndexOf=y;function w(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(A[me]===M)return me}return-1}h.lastIndexOf=w;function T(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(M(A[me],me))return me}return-1}h.findFirstIndex=T;function H(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(M(A[me],me))return me}return-1}h.findLastIndex=H;function Y(A,M,I=0,S=-1){let _=T(A,M,I,S);return _!==-1?A[_]:void 0}h.findFirstValue=Y;function Z(A,M,I=-1,S=0){let _=H(A,M,I,S);return _!==-1?A[_]:void 0}h.findLastValue=Z;function ie(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function le(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=le;function be(A,M,I){if(A===M)return!0;if(A.length!==M.length)return!1;for(let S=0,_=A.length;S<_;++S)if(I?!I(A[S],M[S]):A[S]!==M[S])return!1;return!0}h.shallowEqual=be;function q(A,M={}){let{start:I,stop:S,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=A.length;I===void 0?I=_<0?F-1:0:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F),S===void 0?S=_<0?-1:F:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F);let j;_<0&&S>=I||_>0&&I>=S?j=0:_<0?j=Math.floor((S-I+1)/_+1):j=Math.floor((S-I-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=A[I+Fe*_];return me}h.slice=q;function $(A,M,I){let S=A.length;if(S<=1||(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1),M===I))return;let _=A[M],F=M<I?1:-1;for(let j=M;j!==I;j+=F)A[j]=A[j+F];A[I]=_}h.move=$;function ue(A,M=0,I=-1){let S=A.length;if(!(S<=1))for(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1);M<I;){let _=A[M],F=A[I];A[M++]=F,A[I--]=_}}h.reverse=ue;function pe(A,M,I=0,S=-1){let _=A.length;if(_<=1||(I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I>=S))return;let F=S-I+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=I+M;ue(A,I,j-1),ue(A,j,S),ue(A,I,S)}h.rotate=pe;function ye(A,M,I=0,S=-1){let _=A.length;if(_===0)return;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j)A[(I+j)%_]=M}h.fill=ye;function z(A,M,I){let S=A.length;M<0?M=Math.max(0,M+S):M=Math.min(M,S);for(let _=S;_>M;--_)A[_]=A[_-1];A[M]=I}h.insert=z;function fe(A,M){let I=A.length;if(M<0&&(M+=I),M<0||M>=I)return;let S=A[M];for(let _=M+1;_<I;++_)A[_-1]=A[_];return A.length=I-1,S}h.removeAt=fe;function Se(A,M,I=0,S=-1){let _=y(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeFirstOf=Se;function Te(A,M,I=-1,S=0){let _=w(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeLastOf=Te;function Le(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&A[j]===M||S<I&&(j<=S||j>=I)&&A[j]===M?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllOf=Le;function Ye(A,M,I=0,S=-1){let _,F=T(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeFirstWhere=Ye;function Je(A,M,I=-1,S=0){let _,F=H(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeLastWhere=Je;function Bt(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&M(A[j],j)||S<I&&(j<=S||j>=I)&&M(A[j],j)?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let y of h)yield*y}function*t(){}function*n(h,y=0){for(let w of h)yield[y++,w]}function*i(h,y){let w=0;for(let T of h)y(T,w++)&&(yield T)}function o(h,y){let w=0;for(let T of h)if(y(T,w++))return T}function s(h,y){let w=0;for(let T of h)if(y(T,w++))return w-1;return-1}function a(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)<0&&(w=T)}return w}function l(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)>0&&(w=T)}return w}function u(h,y){let w=!0,T,H;for(let Y of h)w?(T=Y,H=Y,w=!1):y(Y,T)<0?T=Y:y(Y,H)>0&&(H=Y);return w?void 0:[T,H]}function c(h){return Array.from(h)}function d(h){let y={};for(let[w,T]of h)y[w]=T;return y}function f(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return}function m(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return!1;return!0}function g(h,y){let w=0;for(let T of h)if(y(T,w++))return!0;return!1}function*b(h,y){let w=0;for(let T of h)yield y(T,w++)}function*v(h,y,w){y===void 0?(y=h,h=0,w=1):w===void 0&&(w=1);let T=k.rangeLength(h,y,w);for(let H=0;H<T;H++)yield h+w*H}var k;(function(h){function y(w,T,H){return H===0?1/0:w>T&&H>0||w<T&&H<0?0:Math.ceil((T-w)/H)}h.rangeLength=y})(k||(k={}));function R(h,y,w){let T=h[Symbol.iterator](),H=0,Y=T.next();if(Y.done&&w===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return w;let Z=T.next();if(Z.done&&w===void 0)return Y.value;if(Z.done)return y(w,Y.value,H++);let ie;w===void 0?ie=y(Y.value,Z.value,H++):ie=y(y(w,Y.value,H++),Z.value,H++);let le;for(;!(le=T.next()).done;)ie=y(ie,le.value,H++);return ie}function*P(h,y){for(;0<y--;)yield h}function*D(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let y=h.length-1;y>-1;y--)yield h[y]}function L(h){let y=[],w=new Set,T=new Map;for(let Z of h)H(Z);for(let[Z]of T)Y(Z);return y;function H(Z){let[ie,le]=Z,be=T.get(le);be?be.push(ie):T.set(le,[ie])}function Y(Z){if(w.has(Z))return;w.add(Z);let ie=T.get(Z);if(ie)for(let le of ie)Y(le);y.push(Z)}}function*B(h,y){let w=0;for(let T of h)w++%y===0&&(yield T)}r.StringExt=void 0,function(h){function y(Z,ie,le=0){let be=new Array(ie.length);for(let q=0,$=le,ue=ie.length;q<ue;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=y;function w(Z,ie,le=0){let be=y(Z,ie,le);if(!be)return null;let q=0;for(let $=0,ue=be.length;$<ue;++$){let pe=be[$]-le;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=w;function T(Z,ie,le=0){let be=y(Z,ie,le);if(!be)return null;let q=0,$=le-1;for(let ue=0,pe=be.length;ue<pe;++ue){let ye=be[ue];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=T;function H(Z,ie,le){let be=[],q=0,$=0,ue=ie.length;for(;q<ue;){let pe=ie[q],ye=ie[q];for(;++q<ue&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(le(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,y){if(y<1)return;let w=h[Symbol.iterator](),T;for(;0<y--&&!(T=w.next()).done;)yield T.value}function*O(...h){let y=h.map(T=>T[Symbol.iterator]()),w=y.map(T=>T.next());for(;m(w,T=>!T.done);w=y.map(T=>T.next()))yield w.map(T=>T.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=D,r.range=v,r.reduce=R,r.repeat=P,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var WX=re((O1,UX)=>{p();(function(r,e){typeof O1=="object"&&typeof UX!="undefined"?e(O1,vV()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(O1,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(P){return P===null||typeof P=="boolean"||typeof P=="number"||typeof P=="string"}u.isPrimitive=c;function d(P){return Array.isArray(P)}u.isArray=d;function f(P){return!c(P)&&!d(P)}u.isObject=f;function m(P,D){if(P===D)return!0;if(c(P)||c(D))return!1;let K=d(P),L=d(D);return K!==L?!1:K&&L?b(P,D):v(P,D)}u.deepEqual=m;function g(P){return c(P)?P:d(P)?k(P):R(P)}u.deepCopy=g;function b(P,D){if(P===D)return!0;if(P.length!==D.length)return!1;for(let K=0,L=P.length;K<L;++K)if(!m(P[K],D[K]))return!1;return!0}function v(P,D){if(P===D)return!0;for(let K in P)if(P[K]!==void 0&&!(K in D))return!1;for(let K in D)if(D[K]!==void 0&&!(K in P))return!1;for(let K in P){let L=P[K],B=D[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function k(P){let D=new Array(P.length);for(let K=0,L=P.length;K<L;++K)D[K]=g(P[K]);return D}function R(P){let D={};for(let K in P){let L=P[K];L!==void 0&&(D[K]=g(L))}return D}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(v=>{let k=this._services.get(v);return k?this._plugins.get(k).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(v){var k,R,P,D;this._activated=!1,this._promise=null,this._service=null,this.id=v.id,this.description=(k=v.description)!==null&&k!==void 0?k:"",this.activate=v.activate,this.deactivate=(R=v.deactivate)!==null&&R!==void 0?R:null,this.provides=(P=v.provides)!==null&&P!==void 0?P:null,this.autoStart=(D=v.autoStart)!==null&&D!==void 0?D:!1,this.requires=v.requires?v.requires.slice():[],this.optional=v.optional?v.optional.slice():[]}get activated(){return this._activated}set activated(v){this._activated=v}get service(){return this._service}set service(v){this._service=v}get promise(){return this._promise}set promise(v){this._promise=v}}function d(b){return new c(b)}u.createPluginData=d;function f(b,v,k){let R=[...b.requires,...b.optional],P=K=>{if(K===b.provides)return!0;let L=k.get(K);if(!L)return!1;let B=v.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(D.push(L),N.some(P)?!0:(D.pop(),!1))};if(!b.provides||R.length===0)return;let D=[b.id];if(R.some(P))throw new ReferenceError(`Cycle detected: ${D.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,v,k){let R=new Array,P=N=>{let O=v.get(N),h=[...O.requires,...O.optional];R.push(...h.reduce((y,w)=>{let T=k.get(w);return T&&y.push([N,T]),y},[]))};for(let N of v.keys())P(N);let D=R.filter(N=>N[1]===b),K=0;for(;D.length>K;){let N=D.length,O=new Set(D.map(h=>h[0]));for(let h of O)R.filter(y=>y[1]===h).forEach(y=>{D.includes(y)||D.push(y)});K=N}let L=e.topologicSort(D),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,v){let k=new Set;for(let R of b.keys())b.get(R).autoStart===!0&&k.add(R);if(v.startPlugins)for(let R of v.startPlugins)k.add(R);if(v.ignorePlugins)for(let R of v.ignorePlugins)k.delete(R);return Array.from(k)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var jX=re((L1,VX)=>{p();(function(r,e){typeof L1=="object"&&typeof VX!="undefined"?e(L1,vV(),WX()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(L1,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let y=g.get(N.sender);if(y||(y=[],g.set(N.sender,y)),R(y,N,O,h))return!1;let w=h||O,T=b.get(w);T||(T=[],b.set(w,T));let H={signal:N,slot:O,thisArg:h};return y.push(H),T.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let y=g.get(N.sender);if(!y||y.length===0)return!1;let w=R(y,N,O,h);if(!w)return!1;let T=h||O,H=b.get(T);return w.signal=null,D(y),D(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let y=b.get(O);if(!(!y||y.length===0)){for(let w of y)w.signal&&w.signal.sender===N&&(w.signal=null);D(h),D(y)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.thisArg||h.slot;h.signal=null,D(b.get(y))}D(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.signal.sender;h.signal=null,D(g.get(y))}D(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let y=0,w=h.length;y<w;++y){let T=h[y];T.signal===N&&P(T,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,v=new Set,k=typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate;function R(N,O,h,y){return e.find(N,w=>w.signal===O&&w.slot===h&&w.thisArg===y)}function P(N,O){let{signal:h,slot:y,thisArg:w}=N;try{y.call(w,h.sender,O)}catch(T){s.exceptionHandler(T)}}function D(N){v.size===0&&k(K),v.add(N)}function K(){v.forEach(L),v.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var yV=re((K1,BX)=>{p();(function(r,e){typeof K1=="object"&&typeof BX!="undefined"?e(K1,jX()):typeof define=="function"&&define.amd?define(["exports","@lumino/signaling"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_disposable={},r.lumino_signaling))})(K1,function(r,e){"use strict";class t{constructor(a){this._fn=a}get isDisposed(){return!this._fn}dispose(){if(!this._fn)return;let a=this._fn;this._fn=null,a()}}class n extends t{constructor(){super(...arguments),this._disposed=new e.Signal(this)}get disposed(){return this._disposed}dispose(){this.isDisposed||(super.dispose(),this._disposed.emit(void 0),e.Signal.clearData(this))}}class i{constructor(){this._isDisposed=!1,this._items=new Set}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,this._items.forEach(a=>{a.dispose()}),this._items.clear())}contains(a){return this._items.has(a)}add(a){this._items.add(a)}remove(a){this._items.delete(a)}clear(){this._items.clear()}}(function(s){function a(l){let u=new s;for(let c of l)u.add(c);return u}s.from=a})(i||(i={}));class o extends i{constructor(){super(...arguments),this._disposed=new e.Signal(this)}get disposed(){return this._disposed}dispose(){this.isDisposed||(super.dispose(),this._disposed.emit(void 0),e.Signal.clearData(this))}}(function(s){function a(l){let u=new s;for(let c of l)u.add(c);return u}s.from=a})(o||(o={})),r.DisposableDelegate=t,r.DisposableSet=i,r.ObservableDisposableDelegate=n,r.ObservableDisposableSet=o})});var HX=re(zc=>{"use strict";p();var Wye=zc&&zc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Vye=zc&&zc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),jye=zc&&zc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Wye(e,r,t);return Vye(e,r),e};Object.defineProperty(zc,"__esModule",{value:!0});zc.CommHandler=void 0;var Bye=yV(),F1=jye(dI()),bV=class extends Bye.DisposableDelegate{constructor(e,t,n,i){super(i),this._target="",this._id="",this._id=t,this._target=e,this._kernel=n}get commId(){return this._id}get targetName(){return this._target}get onClose(){return this._onClose}set onClose(e){this._onClose=e}get onMsg(){return this._onMsg}set onMsg(e){this._onMsg=e}open(e,t,n=[]){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot open");let i=F1.createMessage({msgType:"comm_open",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,target_name:this._target,data:e!=null?e:{}},metadata:t,buffers:n});return this._kernel.sendShellMessage(i,!1,!0)}send(e,t,n=[],i=!0){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot send");let o=F1.createMessage({msgType:"comm_msg",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e},metadata:t,buffers:n});return this._kernel.sendShellMessage(o,!1,i)}close(e,t,n=[]){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot close");let i=F1.createMessage({msgType:"comm_close",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e!=null?e:{}},metadata:t,buffers:n}),o=this._kernel.sendShellMessage(i,!1,!0),s=this._onClose;if(s){let a=F1.createMessage({msgType:"comm_close",channel:"iopub",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e!=null?e:{}},metadata:t,buffers:n});s(a)}return this.dispose(),o}};zc.CommHandler=bV});var JX=re(as=>{"use strict";p();var Hye=as&&as.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),qye=as&&as.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Jye=as&&as.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Hye(e,r,t);return qye(e,r),e};Object.defineProperty(as,"__esModule",{value:!0});as.KernelShellFutureHandler=as.KernelControlFutureHandler=as.KernelFutureHandler=void 0;var qX=Hc(),Gye=yV(),Yye=Jye(dI()),wx=class extends Gye.DisposableDelegate{constructor(e,t,n,i,o){super(e),this._status=0,this._stdin=Ri.noOp,this._iopub=Ri.noOp,this._reply=Ri.noOp,this._done=new qX.PromiseDelegate,this._hooks=new Ri.HookList,this._disposeOnDone=!0,this._msg=t,n||this._setFlag(Ri.KernelFutureFlag.GotReply),this._disposeOnDone=i,this._kernel=o}get msg(){return this._msg}get done(){return this._done.promise}get onReply(){return this._reply}set onReply(e){this._reply=e}get onIOPub(){return this._iopub}set onIOPub(e){this._iopub=e}get onStdin(){return this._stdin}set onStdin(e){this._stdin=e}registerMessageHook(e){if(this.isDisposed)throw new Error("Kernel future is disposed");this._hooks.add(e)}removeMessageHook(e){this.isDisposed||this._hooks.remove(e)}sendInputReply(e,t){this._kernel.sendInputReply(e,t)}dispose(){this._stdin=Ri.noOp,this._iopub=Ri.noOp,this._reply=Ri.noOp,this._hooks=null,this._testFlag(Ri.KernelFutureFlag.IsDone)||(this._done.promise.catch(()=>{}),this._done.reject(new Error(`Canceled future for ${this.msg.header.msg_type} message before replies were done`))),super.dispose()}async handleMsg(e){switch(e.channel){case"control":case"shell":e.channel===this.msg.channel&&e.parent_header.msg_id===this.msg.header.msg_id&&await this._handleReply(e);break;case"stdin":await this._handleStdin(e);break;case"iopub":await this._handleIOPub(e);break;default:break}}async _handleReply(e){let t=this._reply;t&&await t(e),this._replyMsg=e,this._setFlag(Ri.KernelFutureFlag.GotReply),this._testFlag(Ri.KernelFutureFlag.GotIdle)&&this._handleDone()}async _handleStdin(e){this._kernel.hasPendingInput=!0;let t=this._stdin;t&&await t(e)}async _handleIOPub(e){let t=await this._hooks.process(e),n=this._iopub;t&&n&&await n(e),Yye.isStatusMsg(e)&&e.content.execution_state==="idle"&&(this._setFlag(Ri.KernelFutureFlag.GotIdle),this._testFlag(Ri.KernelFutureFlag.GotReply)&&this._handleDone())}_handleDone(){this._testFlag(Ri.KernelFutureFlag.IsDone)||(this._setFlag(Ri.KernelFutureFlag.IsDone),this._done.resolve(this._replyMsg),this._disposeOnDone&&this.dispose())}_testFlag(e){return(this._status&e)!==0}_setFlag(e){this._status|=e}};as.KernelFutureHandler=wx;var IV=class extends wx{};as.KernelControlFutureHandler=IV;var SV=class extends wx{};as.KernelShellFutureHandler=SV;var Ri;(function(r){r.noOp=()=>{};let e=typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate;class t{constructor(){this._hooks=[]}add(o){this.remove(o),this._hooks.push(o)}remove(o){let s=this._hooks.indexOf(o);s>=0&&(this._hooks[s]=null,this._scheduleCompact())}async process(o){await this._processing;let s=new qX.PromiseDelegate;this._processing=s.promise;let a;for(let l=this._hooks.length-1;l>=0;l--){let u=this._hooks[l];if(u!==null){try{a=await u(o)}catch(c){a=!0,console.error(c)}if(a===!1)return s.resolve(void 0),!1}}return s.resolve(void 0),!0}_scheduleCompact(){this._compactScheduled||(this._compactScheduled=!0,e(()=>{this._processing=this._processing.then(()=>{this._compactScheduled=!1,this._compact()})}))}_compact(){let o=0;for(let s=0,a=this._hooks.length;s<a;s++){let l=this._hooks[s];this._hooks[s]===null?o++:this._hooks[s-o]=l}this._hooks.length-=o}}r.HookList=t;let n;(function(i){i[i.GotReply=1]="GotReply",i[i.GotIdle=2]="GotIdle",i[i.IsDone=4]="IsDone",i[i.DisposeOnDone=8]="DisposeOnDone"})(n=r.KernelFutureFlag||(r.KernelFutureFlag={}))})(Ri||(Ri={}))});var YX=re(GX=>{"use strict";p();Object.defineProperty(GX,"__esModule",{value:!0})});var zX=re(gI=>{"use strict";p();Object.defineProperty(gI,"__esModule",{value:!0});gI.validateSpecModels=gI.validateSpecModel=void 0;var Vg=Cx();function $X(r){let e=r.spec;if(!e)throw new Error("Invalid kernel spec");(0,Vg.validateProperty)(r,"name","string"),(0,Vg.validateProperty)(r,"resources","object"),(0,Vg.validateProperty)(e,"language","string"),(0,Vg.validateProperty)(e,"display_name","string"),(0,Vg.validateProperty)(e,"argv","array");let t=null;e.hasOwnProperty("metadata")&&((0,Vg.validateProperty)(e,"metadata","object"),t=e.metadata);let n=null;return e.hasOwnProperty("env")&&((0,Vg.validateProperty)(e,"env","object"),n=e.env),{name:r.name,resources:r.resources,language:e.language,display_name:e.display_name,argv:e.argv,metadata:t,env:n}}gI.validateSpecModel=$X;function $ye(r){if(!r.hasOwnProperty("kernelspecs"))throw new Error("No kernelspecs found");let e=Object.keys(r.kernelspecs),t=Object.create(null),n=r.default;for(let i=0;i<e.length;i++){let o=r.kernelspecs[e[i]];try{t[e[i]]=$X(o)}catch(s){console.warn(`Removing errant kernel spec: ${e[i]}`)}}if(e=Object.keys(t),!e.length)throw new Error("No valid kernelspecs found");return(!n||typeof n!="string"||!(n in t))&&(n=e[0],console.warn(`Default kernel not found, using '${e[0]}'`)),{default:n,kernelspecs:t}}gI.validateSpecModels=$ye});var EV=re(U1=>{"use strict";p();Object.defineProperty(U1,"__esModule",{value:!0});U1.getSpecs=void 0;var _V=ko(),zye=zX(),Qye=io(),Xye="api/kernelspecs";async function Zye(r=_V.ServerConnection.makeSettings()){let e=Qye.URLExt.join(r.baseUrl,Xye),t=await _V.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await _V.ServerConnection.ResponseError.create(t);let n=await t.json();return(0,zye.validateSpecModels)(n)}U1.getSpecs=Zye});var XX=re(Qc=>{"use strict";p();var ebe=Qc&&Qc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),tbe=Qc&&Qc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),rbe=Qc&&Qc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&ebe(e,r,t);return tbe(e,r),e};Object.defineProperty(Qc,"__esModule",{value:!0});Qc.KernelSpecManager=void 0;var nbe=Hc(),ibe=Ug(),QX=Ms(),obe=rbe(EV()),sbe=Fg(),CV=class extends sbe.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._connectionFailure=new QX.Signal(this),this._specs=null,this._specsChanged=new QX.Signal(this),this._ready=Promise.all([this.requestSpecs()]).then(n=>{}).catch(n=>{}).then(()=>{this.isDisposed||(this._isReady=!0)}),this._pollSpecs=new ibe.Poll({auto:!1,factory:()=>this.requestSpecs(),frequency:{interval:61*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:KernelSpecManager#specs",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this.ready.then(()=>{this._pollSpecs.start()})}get isReady(){return this._isReady}get ready(){return this._ready}get specs(){return this._specs}get specsChanged(){return this._specsChanged}get connectionFailure(){return this._connectionFailure}dispose(){this._pollSpecs.dispose(),super.dispose()}async refreshSpecs(){await this._pollSpecs.refresh(),await this._pollSpecs.tick}async requestSpecs(){let e=await obe.getSpecs(this.serverSettings);this.isDisposed||nbe.JSONExt.deepEqual(e,this._specs)||(this._specs=e,this._specsChanged.emit(e))}};Qc.KernelSpecManager=CV});var W1=re(No=>{"use strict";p();var ZX=No&&No.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),abe=No&&No.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),eZ=No&&No.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&ZX(e,r,t);return abe(e,r),e},lbe=No&&No.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ZX(e,r,t)};Object.defineProperty(No,"__esModule",{value:!0});No.KernelSpecAPI=No.KernelSpec=void 0;var cbe=eZ(YX());No.KernelSpec=cbe;var ube=eZ(EV());No.KernelSpecAPI=ube;lbe(XX(),No)});var PV=re(Xc=>{"use strict";p();var dbe=Xc&&Xc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),pbe=Xc&&Xc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),xV=Xc&&Xc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&dbe(e,r,t);return pbe(e,r),e};Object.defineProperty(Xc,"__esModule",{value:!0});Xc.KernelConnection=void 0;var tZ=io(),Lf=Hc(),Kf=Ms(),rZ=Bn(),nZ=HX(),ls=xV(dI()),iZ=JX(),fbe=xV(N1()),mbe=W1(),xx=xV(A1()),hbe=3e3,vI="_RESTARTING_",gbe="",wV=class r{constructor(e){var t,n,i,o;this._createSocket=(s=!0)=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");let a=this.serverSettings,l=tZ.URLExt.join(a.wsUrl,xx.KERNEL_SERVICE_URL,encodeURIComponent(this._id)),u=l.replace(/^((?:\w+:)?\/\/)(?:[^@\/]+@)/,"$1"),c=tZ.URLExt.join(l,"channels?session_id="+encodeURIComponent(this._clientId)),d=a.token;a.appendToken&&d!==""&&(c=c+`&token=${encodeURIComponent(d)}`);let f=s?this._supportedProtocols:[];this._ws=new a.WebSocket(c,f),this._ws.binaryType="arraybuffer";let m=!1,g=async v=>{var k,R;if(!this._isDisposed){this._reason="",this._model=void 0;try{let P=await xx.getKernelModel(this._id,a);this._model=P,(P==null?void 0:P.execution_state)==="dead"?this._updateStatus("dead"):this._onWSClose(v)}catch(P){if(P instanceof rZ.ServerConnection.NetworkError||((k=P.response)===null||k===void 0?void 0:k.status)===503||((R=P.response)===null||R===void 0?void 0:R.status)===424){let D=xa.getRandomIntInclusive(10,30)*1e3;setTimeout(g,D,v)}else this._reason="Kernel died unexpectedly",this._updateStatus("dead")}}},b=async v=>{m||(m=!0,await g(v))};this._ws.onmessage=this._onWSMessage,this._ws.onopen=this._onWSOpen,this._ws.onclose=b,this._ws.onerror=b},this._onWSOpen=s=>{if(this._ws.protocol!==""&&!this._supportedProtocols.includes(this._ws.protocol))throw console.log("Server selected unknown kernel wire protocol:",this._ws.protocol),this._updateStatus("dead"),new Error(`Unknown kernel wire protocol:  ${this._ws.protocol}`);this._selectedProtocol=this._ws.protocol,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose,this._updateConnectionStatus("connected")},this._onWSMessage=s=>{let a;try{a=this.serverSettings.serializer.deserialize(s.data,this._ws.protocol),fbe.validateMessage(a)}catch(l){throw l.message=`Kernel message validation error: ${l.message}`,l}this._kernelSession=a.header.session,this._msgChain=this._msgChain.then(()=>this._handleMessage(a)).catch(l=>{l.message.startsWith("Canceled future for ")&&console.error(l)}),this._anyMessage.emit({msg:a,direction:"recv"})},this._onWSClose=s=>{this.isDisposed||this._reconnect()},this._id="",this._name="",this._status="unknown",this._connectionStatus="connecting",this._kernelSession="",this._isDisposed=!1,this._ws=null,this._username="",this._reconnectLimit=7,this._reconnectAttempt=0,this._reconnectTimeout=null,this._supportedProtocols=Object.values(ls.supportedKernelWebSocketProtocols),this._selectedProtocol="",this._futures=new Map,this._comms=new Map,this._targetRegistry=Object.create(null),this._info=new Lf.PromiseDelegate,this._pendingMessages=[],this._statusChanged=new Kf.Signal(this),this._connectionStatusChanged=new Kf.Signal(this),this._disposed=new Kf.Signal(this),this._iopubMessage=new Kf.Signal(this),this._anyMessage=new Kf.Signal(this),this._pendingInput=new Kf.Signal(this),this._unhandledMessage=new Kf.Signal(this),this._displayIdToParentIds=new Map,this._msgIdToDisplayIds=new Map,this._msgChain=Promise.resolve(),this._hasPendingInput=!1,this._reason="",this._noOp=()=>{},this._name=e.model.name,this._id=e.model.id,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:rZ.ServerConnection.makeSettings(),this._clientId=(n=e.clientId)!==null&&n!==void 0?n:Lf.UUID.uuid4(),this._username=(i=e.username)!==null&&i!==void 0?i:"",this.handleComms=(o=e.handleComms)!==null&&o!==void 0?o:!0,this._createSocket()}get disposed(){return this._disposed}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get model(){return this._model||{id:this.id,name:this.name,reason:this._reason}}get anyMessage(){return this._anyMessage}get pendingInput(){return this._pendingInput}get id(){return this._id}get name(){return this._name}get username(){return this._username}get clientId(){return this._clientId}get status(){return this._status}get connectionStatus(){return this._connectionStatus}get isDisposed(){return this._isDisposed}get info(){return this._info.promise}get spec(){return this._specPromise?this._specPromise:(this._specPromise=mbe.KernelSpecAPI.getSpecs(this.serverSettings).then(e=>e.kernelspecs[this._name]),this._specPromise)}clone(e={}){return new r({model:this.model,username:this.username,serverSettings:this.serverSettings,handleComms:!1,...e})}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearKernelState(),this._pendingMessages=[],this._clearSocket(),Kf.Signal.clearData(this))}sendShellMessage(e,t=!1,n=!0){return this._sendKernelShellControl(iZ.KernelShellFutureHandler,e,t,n)}sendControlMessage(e,t=!1,n=!0){return this._sendKernelShellControl(iZ.KernelControlFutureHandler,e,t,n)}_sendKernelShellControl(e,t,n=!1,i=!0){this._sendMessage(t),this._anyMessage.emit({msg:t,direction:"send"});let o=new e(()=>{let s=t.header.msg_id;this._futures.delete(s);let a=this._msgIdToDisplayIds.get(s);a&&(a.forEach(l=>{let u=this._displayIdToParentIds.get(l);if(u){let c=u.indexOf(s);if(c===-1)return;u.length===1?this._displayIdToParentIds.delete(l):(u.splice(c,1),this._displayIdToParentIds.set(l,u))}}),this._msgIdToDisplayIds.delete(s))},t,n,i,this);return this._futures.set(t.header.msg_id,o),o}_sendMessage(e,t=!0){if(this.status==="dead")throw new Error("Kernel is dead");if((this._kernelSession===gbe||this._kernelSession===vI)&&ls.isInfoRequestMsg(e))if(this.connectionStatus==="connected"){this._ws.send(this.serverSettings.serializer.serialize(e,this._ws.protocol));return}else throw new Error("Could not send message: status is not connected");if(t&&this._pendingMessages.length>0){this._pendingMessages.push(e);return}if(this.connectionStatus==="connected"&&this._kernelSession!==vI)this._ws.send(this.serverSettings.serializer.serialize(e,this._ws.protocol));else if(t)this._pendingMessages.push(e);else throw new Error("Could not send message")}async interrupt(){if(this.hasPendingInput=!1,this.status==="dead")throw new Error("Kernel is dead");return xx.interruptKernel(this.id,this.serverSettings)}async restart(){if(this.status==="dead")throw new Error("Kernel is dead");this._updateStatus("restarting"),this._clearKernelState(),this._kernelSession=vI,await xx.restartKernel(this.id,this.serverSettings),await this.reconnect(),this.hasPendingInput=!1}reconnect(){this._errorIfDisposed();let e=new Lf.PromiseDelegate,t=(n,i)=>{i==="connected"?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):i==="disconnected"&&(e.reject(new Error("Kernel connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}async shutdown(){this.status!=="dead"&&await xx.shutdownKernel(this.id,this.serverSettings),this.handleShutdown()}handleShutdown(){this._updateStatus("dead"),this.dispose()}async requestKernelInfo(){let e=ls.createMessage({msgType:"kernel_info_request",channel:"shell",username:this._username,session:this._clientId,content:{}}),t;try{t=await xa.handleShellMessage(this,e)}catch(n){if(this.isDisposed)return;throw n}if(this._errorIfDisposed(),!!t)return t.content.status===void 0&&(t.content.status="ok"),t.content.status!=="ok"?(this._info.reject("Kernel info reply errored"),t):(this._info.resolve(t.content),this._kernelSession=t.header.session,t)}requestComplete(e){let t=ls.createMessage({msgType:"complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}requestInspect(e){let t=ls.createMessage({msgType:"inspect_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}requestHistory(e){let t=ls.createMessage({msgType:"history_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}requestExecute(e,t=!0,n){let i={silent:!1,store_history:!0,user_expressions:{},allow_stdin:!0,stop_on_error:!1},o=ls.createMessage({msgType:"execute_request",channel:"shell",username:this._username,session:this._clientId,content:{...i,...e},metadata:n});return this.sendShellMessage(o,!0,t)}requestDebug(e,t=!0){let n=ls.createMessage({msgType:"debug_request",channel:"control",username:this._username,session:this._clientId,content:e});return this.sendControlMessage(n,!0,t)}requestIsComplete(e){let t=ls.createMessage({msgType:"is_complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}requestCommInfo(e){let t=ls.createMessage({msgType:"comm_info_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}sendInputReply(e,t){let n=ls.createMessage({msgType:"input_reply",channel:"stdin",username:this._username,session:this._clientId,content:e});n.parent_header=t,this._sendMessage(n),this._anyMessage.emit({msg:n,direction:"send"}),this.hasPendingInput=!1}createComm(e,t=Lf.UUID.uuid4()){if(!this.handleComms)throw new Error("Comms are disabled on this kernel connection");if(this._comms.has(t))throw new Error("Comm is already created");let n=new nZ.CommHandler(e,t,this,()=>{this._unregisterComm(t)});return this._comms.set(t,n),n}hasComm(e){return this._comms.has(e)}registerCommTarget(e,t){this.handleComms&&(this._targetRegistry[e]=t)}removeCommTarget(e,t){this.handleComms&&!this.isDisposed&&this._targetRegistry[e]===t&&delete this._targetRegistry[e]}registerMessageHook(e,t){var n;let i=(n=this._futures)===null||n===void 0?void 0:n.get(e);i&&i.registerMessageHook(t)}removeMessageHook(e,t){var n;let i=(n=this._futures)===null||n===void 0?void 0:n.get(e);i&&i.removeMessageHook(t)}removeInputGuard(){this.hasPendingInput=!1}async _handleDisplayId(e,t){var n,i;let o=t.parent_header.msg_id,s=this._displayIdToParentIds.get(e);if(s){let l={header:Lf.JSONExt.deepCopy(t.header),parent_header:Lf.JSONExt.deepCopy(t.parent_header),metadata:Lf.JSONExt.deepCopy(t.metadata),content:Lf.JSONExt.deepCopy(t.content),channel:t.channel,buffers:t.buffers?t.buffers.slice():[]};l.header.msg_type="update_display_data",await Promise.all(s.map(async u=>{let c=this._futures&&this._futures.get(u);c&&await c.handleMsg(l)}))}if(t.header.msg_type==="update_display_data")return!0;s=(n=this._displayIdToParentIds.get(e))!==null&&n!==void 0?n:[],s.indexOf(o)===-1&&s.push(o),this._displayIdToParentIds.set(e,s);let a=(i=this._msgIdToDisplayIds.get(o))!==null&&i!==void 0?i:[];return a.indexOf(o)===-1&&a.push(o),this._msgIdToDisplayIds.set(o,a),!1}_clearSocket(){this._ws!==null&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}_updateStatus(e){this._status===e||this._status==="dead"||(this._status=e,xa.logKernelStatus(this),this._statusChanged.emit(e),e==="dead"&&this.dispose())}_sendPending(){for(;this.connectionStatus==="connected"&&this._kernelSession!==vI&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}_clearKernelState(){this._kernelSession="",this._pendingMessages=[],this._futures.forEach(e=>{e.dispose()}),this._comms.forEach(e=>{e.dispose()}),this._msgChain=Promise.resolve(),this._futures=new Map,this._comms=new Map,this._displayIdToParentIds.clear(),this._msgIdToDisplayIds.clear()}_assertCurrentMessage(e){if(this._errorIfDisposed(),e.header.session!==this._kernelSession)throw new Error(`Canceling handling of old message: ${e.header.msg_type}`)}async _handleCommOpen(e){this._assertCurrentMessage(e);let t=e.content,n=new nZ.CommHandler(t.target_name,t.comm_id,this,()=>{this._unregisterComm(t.comm_id)});this._comms.set(t.comm_id,n);try{await(await xa.loadObject(t.target_name,t.target_module,this._targetRegistry))(n,e)}catch(i){throw n.close(),console.error("Exception opening new comm"),i}}async _handleCommClose(e){this._assertCurrentMessage(e);let t=e.content,n=this._comms.get(t.comm_id);if(!n){console.error("Comm not found for comm id "+t.comm_id);return}this._unregisterComm(n.commId);let i=n.onClose;i&&await i(e),n.dispose()}async _handleCommMsg(e){this._assertCurrentMessage(e);let t=e.content,n=this._comms.get(t.comm_id);if(!n)return;let i=n.onMsg;i&&await i(e)}_unregisterComm(e){this._comms.delete(e)}_updateConnectionStatus(e){if(this._connectionStatus!==e){if(this._connectionStatus=e,e!=="connecting"&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),this.status!=="dead")if(e==="connected"){let t=this._kernelSession===vI,n=this.requestKernelInfo(),i=!1,o=()=>{i||(i=!0,t&&this._kernelSession===vI&&(this._kernelSession=""),clearTimeout(s),this._pendingMessages.length>0&&this._sendPending())};n.then(o);let s=setTimeout(o,hbe)}else this._updateStatus("unknown");this._connectionStatusChanged.emit(e)}}async _handleMessage(e){var t,n;let i=!1;if(e.parent_header&&e.channel==="iopub"&&(ls.isDisplayDataMsg(e)||ls.isUpdateDisplayDataMsg(e)||ls.isExecuteResultMsg(e))){let s=((t=e.content.transient)!==null&&t!==void 0?t:{}).display_id;s&&(i=await this._handleDisplayId(s,e),this._assertCurrentMessage(e))}if(!i&&e.parent_header){let o=e.parent_header,s=(n=this._futures)===null||n===void 0?void 0:n.get(o.msg_id);if(s)await s.handleMsg(e),this._assertCurrentMessage(e);else{let a=o.session===this.clientId;e.channel!=="iopub"&&a&&this._unhandledMessage.emit(e)}}if(e.channel==="iopub"){switch(e.header.msg_type){case"status":{let o=e.content.execution_state;o==="restarting"&&Promise.resolve().then(async()=>{this._updateStatus("autorestarting"),this._clearKernelState(),await this.reconnect()}),this._updateStatus(o);break}case"comm_open":this.handleComms&&await this._handleCommOpen(e);break;case"comm_msg":this.handleComms&&await this._handleCommMsg(e);break;case"comm_close":this.handleComms&&await this._handleCommClose(e);break;default:break}this.isDisposed||(this._assertCurrentMessage(e),this._iopubMessage.emit(e))}}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");let e=xa.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.warn(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`);let t=this._selectedProtocol!=="";this._reconnectTimeout=setTimeout(this._createSocket,e,t),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_errorIfDisposed(){if(this.isDisposed)throw new Error("Kernel connection is disposed")}get hasPendingInput(){return this._hasPendingInput}set hasPendingInput(e){this._hasPendingInput=e,this._pendingInput.emit(e)}};Xc.KernelConnection=wV;var xa;(function(r){function e(o){switch(o.status){case"idle":case"busy":case"unknown":return;default:console.debug(`Kernel: ${o.status} (${o.id})`);break}}r.logKernelStatus=e;async function t(o,s){return o.sendShellMessage(s,!0).done}r.handleShellMessage=t;function n(o,s,a){return new Promise((l,u)=>{if(s){if(typeof requirejs=="undefined")throw new Error("requirejs not found");requirejs([s],c=>{if(c[o]===void 0){let d=`Object '${o}' not found in module '${s}'`;u(new Error(d))}else l(c[o])},u)}else a!=null&&a[o]?l(a[o]):u(new Error(`Object '${o}' not found in registry`))})}r.loadObject=n;function i(o,s){return o=Math.ceil(o),s=Math.floor(s),Math.floor(Math.random()*(s-o+1))+o}r.getRandomIntInclusive=i})(xa||(xa={}))});var sZ=re(Dx=>{"use strict";p();Object.defineProperty(Dx,"__esModule",{value:!0});Dx.KernelManager=void 0;var vbe=Ug(),oZ=Ms(),ybe=Bn(),bbe=Fg(),V1=A1(),Ibe=PV(),Px=class extends bbe.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._kernelConnections=new Set,this._models=new Map,this._runningChanged=new oZ.Signal(this),this._connectionFailure=new oZ.Signal(this),this._pollModels=new vbe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:KernelManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._models.clear(),this._kernelConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}connectTo(e){var t;let{id:n}=e.model,i=(t=e.handleComms)!==null&&t!==void 0?t:!0;if(e.handleComms===void 0){for(let s of this._kernelConnections)if(s.id===n&&s.handleComms){i=!1;break}}let o=new Ibe.KernelConnection({handleComms:i,...e,serverSettings:this.serverSettings});return this._onStarted(o),this._models.has(n)||this.refreshRunning().catch(()=>{}),o}running(){return this._models.values()}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e={},t={}){let n=await(0,V1.startNew)(e,this.serverSettings);return this.connectTo({...t,model:n})}async shutdown(e){await(0,V1.shutdownKernel)(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all([...this._models.keys()].map(e=>(0,V1.shutdownKernel)(e,this.serverSettings))),await this.refreshRunning()}async findById(e){return this._models.has(e)?this._models.get(e):(await this.refreshRunning(),this._models.get(e))}async requestRunning(){var e,t;let n;try{n=await(0,V1.listRunning)(this.serverSettings)}catch(i){throw(i instanceof ybe.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(i),i}this.isDisposed||this._models.size===n.length&&n.every(i=>{let o=this._models.get(i.id);return o?o.connections===i.connections&&o.execution_state===i.execution_state&&o.last_activity===i.last_activity&&o.name===i.name&&o.reason===i.reason&&o.traceback===i.traceback:!1})||(this._models=new Map(n.map(i=>[i.id,i])),this._kernelConnections.forEach(i=>{this._models.has(i.id)||i.handleShutdown()}),this._runningChanged.emit(n))}_onStarted(e){this._kernelConnections.add(e),e.statusChanged.connect(this._onStatusChanged,this),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._kernelConnections.delete(e),this.refreshRunning().catch(()=>{})}_onStatusChanged(e,t){t==="dead"&&this.refreshRunning().catch(()=>{})}};Dx.KernelManager=Px;(function(r){class e extends r{constructor(){super(...arguments),this._readyPromise=new Promise(()=>{})}get isActive(){return!1}get parentReady(){return super.ready}async startNew(n={},i={}){return Promise.reject(new Error("Not implemented in no-op Kernel Manager"))}connectTo(n){throw new Error("Not implemented in no-op Kernel Manager")}async shutdown(n){return Promise.reject(new Error("Not implemented in no-op Kernel Manager"))}get ready(){return this.parentReady.then(()=>this._readyPromise)}async requestRunning(){return Promise.resolve()}}r.NoopManager=e})(Px||(Dx.KernelManager=Px={}))});var TV=re(ei=>{"use strict";p();var aZ=ei&&ei.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Sbe=ei&&ei.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),DV=ei&&ei.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&aZ(e,r,t);return Sbe(e,r),e},_be=ei&&ei.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&aZ(e,r,t)};Object.defineProperty(ei,"__esModule",{value:!0});ei.KernelConnection=ei.KernelAPI=ei.KernelMessage=ei.Kernel=void 0;var Ebe=DV(OX());ei.Kernel=Ebe;var Cbe=DV(dI());ei.KernelMessage=Cbe;var wbe=DV(A1());ei.KernelAPI=wbe;var xbe=PV();Object.defineProperty(ei,"KernelConnection",{enumerable:!0,get:function(){return xbe.KernelConnection}});_be(sZ(),ei)});var lZ=re(j1=>{"use strict";p();Object.defineProperty(j1,"__esModule",{value:!0});j1.BuildManager=void 0;var kV=io(),Ff=ko(),Pbe="api/build",NV=class{constructor(e={}){var t;this._url="",this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Ff.ServerConnection.makeSettings();let{baseUrl:n,appUrl:i}=this.serverSettings;this._url=kV.URLExt.join(n,i,Pbe)}get isAvailable(){return kV.PageConfig.getOption("buildAvailable").toLowerCase()==="true"}get shouldCheck(){return kV.PageConfig.getOption("buildCheck").toLowerCase()==="true"}getStatus(){let{_url:e,serverSettings:t}=this;return Ff.ServerConnection.makeRequest(e,{},t).then(i=>{if(i.status!==200)throw new Ff.ServerConnection.ResponseError(i);return i.json()}).then(i=>{if(typeof i.status!="string")throw new Error("Invalid data");if(typeof i.message!="string")throw new Error("Invalid data");return i})}build(){let{_url:e,serverSettings:t}=this,n={method:"POST"};return Ff.ServerConnection.makeRequest(e,n,t).then(o=>{if(o.status===400)throw new Ff.ServerConnection.ResponseError(o,"Build aborted");if(o.status!==200){let s=`Build failed with ${o.status}.

        If you are experiencing the build failure after installing an extension (or trying to include previously installed extension after updating JupyterLab) please check the extension repository for new installation instructions as many extensions migrated to the prebuilt extensions system which no longer requires rebuilding JupyterLab (but uses a different installation procedure, typically involving a package manager such as 'pip' or 'conda').

        If you specifically intended to install a source extension, please run 'jupyter lab build' on the server for full output.`;throw new Ff.ServerConnection.ResponseError(o,s)}})}cancel(){let{_url:e,serverSettings:t}=this,n={method:"DELETE"};return Ff.ServerConnection.makeRequest(e,n,t).then(o=>{if(o.status!==204)throw new Ff.ServerConnection.ResponseError(o)})}};j1.BuildManager=NV});var MV=re(B1=>{"use strict";p();Object.defineProperty(B1,"__esModule",{value:!0});B1.NbConvertManager=void 0;var Dbe=io(),RV=ko(),Tbe=Hc(),kbe="api/nbconvert",AV=class{constructor(e={}){var t;this._exportFormats=null,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:RV.ServerConnection.makeSettings()}async fetchExportFormats(){this._requestingFormats=new Tbe.PromiseDelegate,this._exportFormats=null;let e=this.serverSettings.baseUrl,t=Dbe.URLExt.join(e,kbe),{serverSettings:n}=this,i=await RV.ServerConnection.makeRequest(t,{},n);if(i.status!==200)throw await RV.ServerConnection.ResponseError.create(i);let o=await i.json(),s={};return Object.keys(o).forEach(function(l){let u=o[l].output_mimetype;s[l]={output_mimetype:u}}),this._exportFormats=s,this._requestingFormats.resolve(s),s}async getExportFormats(e=!0){return this._requestingFormats?this._requestingFormats.promise:e||!this._exportFormats?await this.fetchExportFormats():this._exportFormats}};B1.NbConvertManager=AV});var uZ=re(cZ=>{"use strict";p();Object.defineProperty(cZ,"__esModule",{value:!0})});var pZ=re(Uf=>{"use strict";p();Object.defineProperty(Uf,"__esModule",{value:!0});Uf.validateModels=Uf.updateLegacySessionModel=Uf.validateModel=void 0;var Nbe=N1(),Tx=Cx();function dZ(r){(0,Tx.validateProperty)(r,"id","string"),(0,Tx.validateProperty)(r,"type","string"),(0,Tx.validateProperty)(r,"name","string"),(0,Tx.validateProperty)(r,"path","string"),(0,Tx.validateProperty)(r,"kernel","object"),(0,Nbe.validateModel)(r.kernel)}Uf.validateModel=dZ;function Rbe(r){r.path===void 0&&r.notebook!==void 0&&(r.path=r.notebook.path,r.type="notebook",r.name="")}Uf.updateLegacySessionModel=Rbe;function Abe(r){if(!Array.isArray(r))throw new Error("Invalid session list");r.forEach(e=>dZ(e))}Uf.validateModels=Abe});var J1=re(ti=>{"use strict";p();Object.defineProperty(ti,"__esModule",{value:!0});ti.updateSession=ti.startSession=ti.getSessionModel=ti.shutdownSession=ti.getSessionUrl=ti.listRunning=ti.SESSION_SERVICE_URL=void 0;var oo=ko(),H1=io(),Wf=pZ();ti.SESSION_SERVICE_URL="api/sessions";async function Mbe(r=oo.ServerConnection.makeSettings()){let e=H1.URLExt.join(r.baseUrl,ti.SESSION_SERVICE_URL),t=await oo.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await oo.ServerConnection.ResponseError.create(t);let n=await t.json();if(!Array.isArray(n))throw new Error("Invalid Session list");return n.forEach(i=>{(0,Wf.updateLegacySessionModel)(i),(0,Wf.validateModel)(i)}),n}ti.listRunning=Mbe;function q1(r,e){let t=H1.URLExt.join(r,ti.SESSION_SERVICE_URL),n=H1.URLExt.join(t,e);if(!n.startsWith(t))throw new Error("Can only be used for services requests");return n}ti.getSessionUrl=q1;async function Obe(r,e=oo.ServerConnection.makeSettings()){var t;let n=q1(e.baseUrl,r),i={method:"DELETE"},o=await oo.ServerConnection.makeRequest(n,i,e);if(o.status===404){let a=(t=(await o.json()).message)!==null&&t!==void 0?t:`The session "${r}"" does not exist on the server`;console.warn(a)}else{if(o.status===410)throw new oo.ServerConnection.ResponseError(o,"The kernel was deleted but the session was not");if(o.status!==204)throw await oo.ServerConnection.ResponseError.create(o)}}ti.shutdownSession=Obe;async function Lbe(r,e=oo.ServerConnection.makeSettings()){let t=q1(e.baseUrl,r),n=await oo.ServerConnection.makeRequest(t,{},e);if(n.status!==200)throw await oo.ServerConnection.ResponseError.create(n);let i=await n.json();return(0,Wf.updateLegacySessionModel)(i),(0,Wf.validateModel)(i),i}ti.getSessionModel=Lbe;async function Kbe(r,e=oo.ServerConnection.makeSettings()){let t=H1.URLExt.join(e.baseUrl,ti.SESSION_SERVICE_URL),n={method:"POST",body:JSON.stringify(r)},i=await oo.ServerConnection.makeRequest(t,n,e);if(i.status!==201)throw await oo.ServerConnection.ResponseError.create(i);let o=await i.json();return(0,Wf.updateLegacySessionModel)(o),(0,Wf.validateModel)(o),o}ti.startSession=Kbe;async function Fbe(r,e=oo.ServerConnection.makeSettings()){let t=q1(e.baseUrl,r.id),n={method:"PATCH",body:JSON.stringify(r)},i=await oo.ServerConnection.makeRequest(t,n,e);if(i.status!==200)throw await oo.ServerConnection.ResponseError.create(i);let o=await i.json();return(0,Wf.updateLegacySessionModel)(o),(0,Wf.validateModel)(o),o}ti.updateSession=Fbe});var mZ=re(G1=>{"use strict";p();Object.defineProperty(G1,"__esModule",{value:!0});G1.SessionConnection=void 0;var Zc=Ms(),Ube=Bn(),fZ=J1(),Wbe=Hc(),OV=class{constructor(e){var t,n,i,o;this._id="",this._path="",this._name="",this._type="",this._kernel=null,this._isDisposed=!1,this._disposed=new Zc.Signal(this),this._kernelChanged=new Zc.Signal(this),this._statusChanged=new Zc.Signal(this),this._connectionStatusChanged=new Zc.Signal(this),this._pendingInput=new Zc.Signal(this),this._iopubMessage=new Zc.Signal(this),this._unhandledMessage=new Zc.Signal(this),this._anyMessage=new Zc.Signal(this),this._propertyChanged=new Zc.Signal(this),this._id=e.model.id,this._name=e.model.name,this._path=e.model.path,this._type=e.model.type,this._username=(t=e.username)!==null&&t!==void 0?t:"",this._clientId=(n=e.clientId)!==null&&n!==void 0?n:Wbe.UUID.uuid4(),this._connectToKernel=e.connectToKernel,this._kernelConnectionOptions=(i=e.kernelConnectionOptions)!==null&&i!==void 0?i:{},this.serverSettings=(o=e.serverSettings)!==null&&o!==void 0?o:Ube.ServerConnection.makeSettings(),this.setupKernel(e.model.kernel)}get disposed(){return this._disposed}get kernelChanged(){return this._kernelChanged}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get pendingInput(){return this._pendingInput}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get anyMessage(){return this._anyMessage}get propertyChanged(){return this._propertyChanged}get id(){return this._id}get kernel(){return this._kernel}get path(){return this._path}get type(){return this._type}get name(){return this._name}get model(){return{id:this.id,kernel:this.kernel&&{id:this.kernel.id,name:this.kernel.name},path:this._path,type:this._type,name:this._name}}get isDisposed(){return this._isDisposed}update(e){let t=this.model;if(this._path=e.path,this._name=e.name,this._type=e.type,this._kernel===null&&e.kernel!==null||this._kernel!==null&&e.kernel===null||this._kernel!==null&&e.kernel!==null&&this._kernel.id!==e.kernel.id){this._kernel!==null&&this._kernel.dispose();let n=this._kernel||null;this.setupKernel(e.kernel);let i=this._kernel||null;this._kernelChanged.emit({name:"kernel",oldValue:n,newValue:i})}this._handleModelChange(t)}dispose(){if(!this.isDisposed){if(this._isDisposed=!0,this._disposed.emit(),this._kernel){this._kernel.dispose();let e=this._kernel;this._kernel=null;let t=this._kernel;this._kernelChanged.emit({name:"kernel",oldValue:e,newValue:t})}Zc.Signal.clearData(this)}}async setPath(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({path:e})}async setName(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({name:e})}async setType(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({type:e})}async changeKernel(e){if(this.isDisposed)throw new Error("Session is disposed");return await this._patch({kernel:e}),this.kernel}async shutdown(){if(this.isDisposed)throw new Error("Session is disposed");await(0,fZ.shutdownSession)(this.id,this.serverSettings),this.dispose()}setupKernel(e){if(e===null){this._kernel=null;return}let t=this._connectToKernel({...this._kernelConnectionOptions,model:e,username:this._username,clientId:this._clientId,serverSettings:this.serverSettings});this._kernel=t,t.statusChanged.connect(this.onKernelStatus,this),t.connectionStatusChanged.connect(this.onKernelConnectionStatus,this),t.pendingInput.connect(this.onPendingInput,this),t.unhandledMessage.connect(this.onUnhandledMessage,this),t.iopubMessage.connect(this.onIOPubMessage,this),t.anyMessage.connect(this.onAnyMessage,this)}onKernelStatus(e,t){this._statusChanged.emit(t)}onKernelConnectionStatus(e,t){this._connectionStatusChanged.emit(t)}onPendingInput(e,t){this._pendingInput.emit(t)}onIOPubMessage(e,t){this._iopubMessage.emit(t)}onUnhandledMessage(e,t){this._unhandledMessage.emit(t)}onAnyMessage(e,t){this._anyMessage.emit(t)}async _patch(e){let t=await(0,fZ.updateSession)({...e,id:this._id},this.serverSettings);return this.update(t),t}_handleModelChange(e){e.name!==this._name&&this._propertyChanged.emit("name"),e.type!==this._type&&this._propertyChanged.emit("type"),e.path!==this._path&&this._propertyChanged.emit("path")}};G1.SessionConnection=OV});var gZ=re(Rx=>{"use strict";p();Object.defineProperty(Rx,"__esModule",{value:!0});Rx.SessionManager=void 0;var Vbe=Ug(),hZ=Ms(),jbe=ko(),Bbe=Fg(),Hbe=mZ(),kx=J1(),Nx=class extends Bbe.BaseManager{constructor(e){var t;super(e),this._isReady=!1,this._sessionConnections=new Set,this._models=new Map,this._runningChanged=new hZ.Signal(this),this._connectionFailure=new hZ.Signal(this),this._connectToKernel=n=>this._kernelManager.connectTo(n),this._kernelManager=e.kernelManager,this._pollModels=new Vbe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:SessionManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._kernelManager.isActive&&await this._kernelManager.ready,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._models.clear(),this._sessionConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}connectTo(e){let t=new Hbe.SessionConnection({...e,connectToKernel:this._connectToKernel,serverSettings:this.serverSettings});return this._onStarted(t),this._models.has(e.model.id)||this.refreshRunning().catch(()=>{}),t}running(){return this._models.values()}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e,t={}){let n=await(0,kx.startSession)(e,this.serverSettings);return await this.refreshRunning(),this.connectTo({...t,model:n})}async shutdown(e){await(0,kx.shutdownSession)(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all([...this._models.keys()].map(e=>(0,kx.shutdownSession)(e,this.serverSettings))),await this.refreshRunning()}async stopIfNeeded(e){try{let n=(await(0,kx.listRunning)(this.serverSettings)).filter(i=>i.path===e);if(n.length===1){let i=n[0].id;await this.shutdown(i)}}catch(t){}}async findById(e){return this._models.has(e)?this._models.get(e):(await this.refreshRunning(),this._models.get(e))}async findByPath(e){for(let t of this._models.values())if(t.path===e)return t;await this.refreshRunning();for(let t of this._models.values())if(t.path===e)return t}async requestRunning(){var e,t;let n;try{n=await(0,kx.listRunning)(this.serverSettings)}catch(i){throw(i instanceof jbe.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(i),i}this.isDisposed||this._models.size===n.length&&n.every(i=>{var o,s,a,l;let u=this._models.get(i.id);return u?((o=u.kernel)===null||o===void 0?void 0:o.id)===((s=i.kernel)===null||s===void 0?void 0:s.id)&&((a=u.kernel)===null||a===void 0?void 0:a.name)===((l=i.kernel)===null||l===void 0?void 0:l.name)&&u.name===i.name&&u.path===i.path&&u.type===i.type:!1})||(this._models=new Map(n.map(i=>[i.id,i])),this._sessionConnections.forEach(i=>{this._models.has(i.id)?i.update(this._models.get(i.id)):i.dispose()}),this._runningChanged.emit(n))}_onStarted(e){this._sessionConnections.add(e),e.disposed.connect(this._onDisposed,this),e.propertyChanged.connect(this._onChanged,this),e.kernelChanged.connect(this._onChanged,this)}_onDisposed(e){this._sessionConnections.delete(e),this.refreshRunning().catch(()=>{})}_onChanged(){this.refreshRunning().catch(()=>{})}};Rx.SessionManager=Nx;(function(r){class e extends r{constructor(){super(...arguments),this._readyPromise=new Promise(()=>{})}get isActive(){return!1}get parentReady(){return super.ready}async startNew(n,i={}){return Promise.reject(new Error("Not implemented in no-op Session Manager"))}connectTo(n){throw Error("Not implemented in no-op Session Manager")}get ready(){return this.parentReady.then(()=>this._readyPromise)}async shutdown(n){return Promise.reject(new Error("Not implemented in no-op Session Manager"))}async requestRunning(){return Promise.resolve()}}r.NoopManager=e})(Nx||(Rx.SessionManager=Nx={}))});var LV=re(Ro=>{"use strict";p();var vZ=Ro&&Ro.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),qbe=Ro&&Ro.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),yZ=Ro&&Ro.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&vZ(e,r,t);return qbe(e,r),e},Jbe=Ro&&Ro.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&vZ(e,r,t)};Object.defineProperty(Ro,"__esModule",{value:!0});Ro.SessionAPI=Ro.Session=void 0;var Gbe=yZ(uZ());Ro.Session=Gbe;var Ybe=yZ(J1());Ro.SessionAPI=Ybe;Jbe(gZ(),Ro)});var bZ=re(Y1=>{"use strict";p();Object.defineProperty(Y1,"__esModule",{value:!0});Y1.DataConnector=void 0;var KV=class{async list(e){throw new Error("DataConnector#list method has not been implemented.")}async remove(e){throw new Error("DataConnector#remove method has not been implemented.")}async save(e,t){throw new Error("DataConnector#save method has not been implemented.")}};Y1.DataConnector=KV});var SZ=re(IZ=>{"use strict";p();Object.defineProperty(IZ,"__esModule",{value:!0})});var FV=re(($1,_Z)=>{p();(function(r,e){typeof $1=="object"&&typeof _Z!="undefined"?e($1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})($1,function(r){"use strict";r.ArrayExt=void 0,function(h){function y(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(A[me]===M)return me}return-1}h.firstIndexOf=y;function w(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(A[me]===M)return me}return-1}h.lastIndexOf=w;function T(A,M,I=0,S=-1){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(I+j)%_;if(M(A[me],me))return me}return-1}h.findFirstIndex=T;function H(A,M,I=-1,S=0){let _=A.length;if(_===0)return-1;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(I-j+_)%_;if(M(A[me],me))return me}return-1}h.findLastIndex=H;function Y(A,M,I=0,S=-1){let _=T(A,M,I,S);return _!==-1?A[_]:void 0}h.findFirstValue=Y;function Z(A,M,I=-1,S=0){let _=H(A,M,I,S);return _!==-1?A[_]:void 0}h.findLastValue=Z;function ie(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function le(A,M,I,S=0,_=-1){let F=A.length;if(F===0)return 0;S<0?S=Math.max(0,S+F):S=Math.min(S,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=S,me=_-S+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;I(A[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=le;function be(A,M,I){if(A===M)return!0;if(A.length!==M.length)return!1;for(let S=0,_=A.length;S<_;++S)if(I?!I(A[S],M[S]):A[S]!==M[S])return!1;return!0}h.shallowEqual=be;function q(A,M={}){let{start:I,stop:S,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=A.length;I===void 0?I=_<0?F-1:0:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F),S===void 0?S=_<0?-1:F:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F);let j;_<0&&S>=I||_>0&&I>=S?j=0:_<0?j=Math.floor((S-I+1)/_+1):j=Math.floor((S-I-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=A[I+Fe*_];return me}h.slice=q;function $(A,M,I){let S=A.length;if(S<=1||(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1),M===I))return;let _=A[M],F=M<I?1:-1;for(let j=M;j!==I;j+=F)A[j]=A[j+F];A[I]=_}h.move=$;function ue(A,M=0,I=-1){let S=A.length;if(!(S<=1))for(M<0?M=Math.max(0,M+S):M=Math.min(M,S-1),I<0?I=Math.max(0,I+S):I=Math.min(I,S-1);M<I;){let _=A[M],F=A[I];A[M++]=F,A[I--]=_}}h.reverse=ue;function pe(A,M,I=0,S=-1){let _=A.length;if(_<=1||(I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I>=S))return;let F=S-I+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=I+M;ue(A,I,j-1),ue(A,j,S),ue(A,I,S)}h.rotate=pe;function ye(A,M,I=0,S=-1){let _=A.length;if(_===0)return;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j)A[(I+j)%_]=M}h.fill=ye;function z(A,M,I){let S=A.length;M<0?M=Math.max(0,M+S):M=Math.min(M,S);for(let _=S;_>M;--_)A[_]=A[_-1];A[M]=I}h.insert=z;function fe(A,M){let I=A.length;if(M<0&&(M+=I),M<0||M>=I)return;let S=A[M];for(let _=M+1;_<I;++_)A[_-1]=A[_];return A.length=I-1,S}h.removeAt=fe;function Se(A,M,I=0,S=-1){let _=y(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeFirstOf=Se;function Te(A,M,I=-1,S=0){let _=w(A,M,I,S);return _!==-1&&fe(A,_),_}h.removeLastOf=Te;function Le(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&A[j]===M||S<I&&(j<=S||j>=I)&&A[j]===M?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllOf=Le;function Ye(A,M,I=0,S=-1){let _,F=T(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeFirstWhere=Ye;function Je(A,M,I=-1,S=0){let _,F=H(A,M,I,S);return F!==-1&&(_=fe(A,F)),{index:F,value:_}}h.removeLastWhere=Je;function Bt(A,M,I=0,S=-1){let _=A.length;if(_===0)return 0;I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S<0?S=Math.max(0,S+_):S=Math.min(S,_-1);let F=0;for(let j=0;j<_;++j)I<=S&&j>=I&&j<=S&&M(A[j],j)||S<I&&(j<=S||j>=I)&&M(A[j],j)?F++:F>0&&(A[j-F]=A[j]);return F>0&&(A.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let y of h)yield*y}function*t(){}function*n(h,y=0){for(let w of h)yield[y++,w]}function*i(h,y){let w=0;for(let T of h)y(T,w++)&&(yield T)}function o(h,y){let w=0;for(let T of h)if(y(T,w++))return T}function s(h,y){let w=0;for(let T of h)if(y(T,w++))return w-1;return-1}function a(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)<0&&(w=T)}return w}function l(h,y){let w;for(let T of h){if(w===void 0){w=T;continue}y(T,w)>0&&(w=T)}return w}function u(h,y){let w=!0,T,H;for(let Y of h)w?(T=Y,H=Y,w=!1):y(Y,T)<0?T=Y:y(Y,H)>0&&(H=Y);return w?void 0:[T,H]}function c(h){return Array.from(h)}function d(h){let y={};for(let[w,T]of h)y[w]=T;return y}function f(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return}function m(h,y){let w=0;for(let T of h)if(y(T,w++)===!1)return!1;return!0}function g(h,y){let w=0;for(let T of h)if(y(T,w++))return!0;return!1}function*b(h,y){let w=0;for(let T of h)yield y(T,w++)}function*v(h,y,w){y===void 0?(y=h,h=0,w=1):w===void 0&&(w=1);let T=k.rangeLength(h,y,w);for(let H=0;H<T;H++)yield h+w*H}var k;(function(h){function y(w,T,H){return H===0?1/0:w>T&&H>0||w<T&&H<0?0:Math.ceil((T-w)/H)}h.rangeLength=y})(k||(k={}));function R(h,y,w){let T=h[Symbol.iterator](),H=0,Y=T.next();if(Y.done&&w===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return w;let Z=T.next();if(Z.done&&w===void 0)return Y.value;if(Z.done)return y(w,Y.value,H++);let ie;w===void 0?ie=y(Y.value,Z.value,H++):ie=y(y(w,Y.value,H++),Z.value,H++);let le;for(;!(le=T.next()).done;)ie=y(ie,le.value,H++);return ie}function*P(h,y){for(;0<y--;)yield h}function*D(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let y=h.length-1;y>-1;y--)yield h[y]}function L(h){let y=[],w=new Set,T=new Map;for(let Z of h)H(Z);for(let[Z]of T)Y(Z);return y;function H(Z){let[ie,le]=Z,be=T.get(le);be?be.push(ie):T.set(le,[ie])}function Y(Z){if(w.has(Z))return;w.add(Z);let ie=T.get(Z);if(ie)for(let le of ie)Y(le);y.push(Z)}}function*B(h,y){let w=0;for(let T of h)w++%y===0&&(yield T)}r.StringExt=void 0,function(h){function y(Z,ie,le=0){let be=new Array(ie.length);for(let q=0,$=le,ue=ie.length;q<ue;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=y;function w(Z,ie,le=0){let be=y(Z,ie,le);if(!be)return null;let q=0;for(let $=0,ue=be.length;$<ue;++$){let pe=be[$]-le;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=w;function T(Z,ie,le=0){let be=y(Z,ie,le);if(!be)return null;let q=0,$=le-1;for(let ue=0,pe=be.length;ue<pe;++ue){let ye=be[ue];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=T;function H(Z,ie,le){let be=[],q=0,$=0,ue=ie.length;for(;q<ue;){let pe=ie[q],ye=ie[q];for(;++q<ue&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(le(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,y){if(y<1)return;let w=h[Symbol.iterator](),T;for(;0<y--&&!(T=w.next()).done;)yield T.value}function*O(...h){let y=h.map(T=>T[Symbol.iterator]()),w=y.map(T=>T.next());for(;m(w,T=>!T.done);w=y.map(T=>T.next()))yield w.map(T=>T.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=D,r.range=v,r.reduce=R,r.repeat=P,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var Q1=re((z1,EZ)=>{p();(function(r,e){typeof z1=="object"&&typeof EZ!="undefined"?e(z1,FV()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(z1,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(P){return P===null||typeof P=="boolean"||typeof P=="number"||typeof P=="string"}u.isPrimitive=c;function d(P){return Array.isArray(P)}u.isArray=d;function f(P){return!c(P)&&!d(P)}u.isObject=f;function m(P,D){if(P===D)return!0;if(c(P)||c(D))return!1;let K=d(P),L=d(D);return K!==L?!1:K&&L?b(P,D):v(P,D)}u.deepEqual=m;function g(P){return c(P)?P:d(P)?k(P):R(P)}u.deepCopy=g;function b(P,D){if(P===D)return!0;if(P.length!==D.length)return!1;for(let K=0,L=P.length;K<L;++K)if(!m(P[K],D[K]))return!1;return!0}function v(P,D){if(P===D)return!0;for(let K in P)if(P[K]!==void 0&&!(K in D))return!1;for(let K in D)if(D[K]!==void 0&&!(K in P))return!1;for(let K in P){let L=P[K],B=D[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function k(P){let D=new Array(P.length);for(let K=0,L=P.length;K<L;++K)D[K]=g(P[K]);return D}function R(P){let D={};for(let K in P){let L=P[K];L!==void 0&&(D[K]=g(L))}return D}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(v=>{let k=this._services.get(v);return k?this._plugins.get(k).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(v){var k,R,P,D;this._activated=!1,this._promise=null,this._service=null,this.id=v.id,this.description=(k=v.description)!==null&&k!==void 0?k:"",this.activate=v.activate,this.deactivate=(R=v.deactivate)!==null&&R!==void 0?R:null,this.provides=(P=v.provides)!==null&&P!==void 0?P:null,this.autoStart=(D=v.autoStart)!==null&&D!==void 0?D:!1,this.requires=v.requires?v.requires.slice():[],this.optional=v.optional?v.optional.slice():[]}get activated(){return this._activated}set activated(v){this._activated=v}get service(){return this._service}set service(v){this._service=v}get promise(){return this._promise}set promise(v){this._promise=v}}function d(b){return new c(b)}u.createPluginData=d;function f(b,v,k){let R=[...b.requires,...b.optional],P=K=>{if(K===b.provides)return!0;let L=k.get(K);if(!L)return!1;let B=v.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(D.push(L),N.some(P)?!0:(D.pop(),!1))};if(!b.provides||R.length===0)return;let D=[b.id];if(R.some(P))throw new ReferenceError(`Cycle detected: ${D.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,v,k){let R=new Array,P=N=>{let O=v.get(N),h=[...O.requires,...O.optional];R.push(...h.reduce((y,w)=>{let T=k.get(w);return T&&y.push([N,T]),y},[]))};for(let N of v.keys())P(N);let D=R.filter(N=>N[1]===b),K=0;for(;D.length>K;){let N=D.length,O=new Set(D.map(h=>h[0]));for(let h of O)R.filter(y=>y[1]===h).forEach(y=>{D.includes(y)||D.push(y)});K=N}let L=e.topologicSort(D),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,v){let k=new Set;for(let R of b.keys())b.get(R).autoStart===!0&&k.add(R);if(v.startPlugins)for(let R of v.startPlugins)k.add(R);if(v.ignorePlugins)for(let R of v.ignorePlugins)k.delete(R);return Array.from(k)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var wZ=re((X1,CZ)=>{p();(function(r,e){typeof X1=="object"&&typeof CZ!="undefined"?e(X1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_properties={}))})(X1,function(r){"use strict";class e{constructor(i){this._pid=t.nextPID(),this.name=i.name,this._create=i.create,this._coerce=i.coerce||null,this._compare=i.compare||null,this._changed=i.changed||null}get(i){let o,s=t.ensureMap(i);return this._pid in s?o=s[this._pid]:o=s[this._pid]=this._createValue(i),o}set(i,o){let s,a=t.ensureMap(i);this._pid in a?s=a[this._pid]:s=a[this._pid]=this._createValue(i);let l=this._coerceValue(i,o);this._maybeNotify(i,s,a[this._pid]=l)}coerce(i){let o,s=t.ensureMap(i);this._pid in s?o=s[this._pid]:o=s[this._pid]=this._createValue(i);let a=this._coerceValue(i,o);this._maybeNotify(i,o,s[this._pid]=a)}_createValue(i){let o=this._create;return o(i)}_coerceValue(i,o){let s=this._coerce;return s?s(i,o):o}_compareValue(i,o){let s=this._compare;return s?s(i,o):i===o}_maybeNotify(i,o,s){let a=this._changed;a&&!this._compareValue(o,s)&&a(i,o,s)}}(function(n){function i(o){t.ownerData.delete(o)}n.clearData=i})(e||(e={}));var t;(function(n){n.ownerData=new WeakMap,n.nextPID=(()=>{let o=0;return()=>`pid-${`${Math.random()}`.slice(2)}-${o++}`})();function i(o){let s=n.ownerData.get(o);return s||(s=Object.create(null),n.ownerData.set(o,s),s)}n.ensureMap=i})(t||(t={})),r.AttachedProperty=e})});var UV=re((Z1,xZ)=>{p();(function(r,e){typeof Z1=="object"&&typeof xZ!="undefined"?e(Z1,FV(),Q1()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(Z1,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let y=g.get(N.sender);if(y||(y=[],g.set(N.sender,y)),R(y,N,O,h))return!1;let w=h||O,T=b.get(w);T||(T=[],b.set(w,T));let H={signal:N,slot:O,thisArg:h};return y.push(H),T.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let y=g.get(N.sender);if(!y||y.length===0)return!1;let w=R(y,N,O,h);if(!w)return!1;let T=h||O,H=b.get(T);return w.signal=null,D(y),D(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let y=b.get(O);if(!(!y||y.length===0)){for(let w of y)w.signal&&w.signal.sender===N&&(w.signal=null);D(h),D(y)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.thisArg||h.slot;h.signal=null,D(b.get(y))}D(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let y=h.signal.sender;h.signal=null,D(g.get(y))}D(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let y=0,w=h.length;y<w;++y){let T=h[y];T.signal===N&&P(T,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,v=new Set,k=typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate;function R(N,O,h,y){return e.find(N,w=>w.signal===O&&w.slot===h&&w.thisArg===y)}function P(N,O){let{signal:h,slot:y,thisArg:w}=N;try{y.call(w,h.sender,O)}catch(T){s.exceptionHandler(T)}}function D(N){v.size===0&&k(K),v.add(N)}function K(){v.forEach(L),v.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var DZ=re(tR=>{"use strict";p();Object.defineProperty(tR,"__esModule",{value:!0});tR.RestorablePool=void 0;var $be=Q1(),PZ=wZ(),eR=UV(),WV=class{constructor(e){this._added=new eR.Signal(this),this._current=null,this._currentChanged=new eR.Signal(this),this._hasRestored=!1,this._isDisposed=!1,this._objects=new Set,this._restore=null,this._restored=new $be.PromiseDelegate,this._updated=new eR.Signal(this),this.namespace=e.namespace}get added(){return this._added}get current(){return this._current}set current(e){this._current!==e&&e!==null&&this._objects.has(e)&&(this._current=e,this._currentChanged.emit(this._current))}get currentChanged(){return this._currentChanged}get isDisposed(){return this._isDisposed}get restored(){return this._restored.promise}get size(){return this._objects.size}get updated(){return this._updated}async add(e){var t,n;if(e.isDisposed){let i="A disposed object cannot be added.";throw console.warn(i,e),new Error(i)}if(this._objects.has(e)){let i="This object already exists in the pool.";throw console.warn(i,e),new Error(i)}if(this._objects.add(e),e.disposed.connect(this._onInstanceDisposed,this),!eu.injectedProperty.get(e)){if(this._restore){let{connector:i}=this._restore,o=this._restore.name(e);if(o){let s=`${this.namespace}:${o}`,a=(n=(t=this._restore).args)===null||n===void 0?void 0:n.call(t,e);eu.nameProperty.set(e,s),await i.save(s,{data:a})}}this._added.emit(e)}}dispose(){this.isDisposed||(this._current=null,this._isDisposed=!0,this._objects.clear(),eR.Signal.clearData(this))}find(e){let t=this._objects.values();for(let n of t)if(e(n))return n}forEach(e){this._objects.forEach(e)}filter(e){let t=[];return this.forEach(n=>{e(n)&&t.push(n)}),t}inject(e){return eu.injectedProperty.set(e,!0),this.add(e)}has(e){return this._objects.has(e)}async restore(e){if(this._hasRestored)throw new Error("This pool has already been restored.");this._hasRestored=!0;let{command:t,connector:n,registry:i,when:o}=e,s=this.namespace,a=o?[n.list(s)].concat(o):[n.list(s)];this._restore=e;let[l]=await Promise.all(a),u=await Promise.all(l.ids.map(async(c,d)=>{let f=l.values[d],m=f&&f.data;return m===void 0?n.remove(c):i.execute(t,m).catch(()=>n.remove(c))}));return this._restored.resolve(),u}async save(e){var t,n;let i=eu.injectedProperty.get(e);if(!this._restore||!this.has(e)||i)return;let{connector:o}=this._restore,s=this._restore.name(e),a=eu.nameProperty.get(e),l=s?`${this.namespace}:${s}`:"";if(a&&a!==l&&await o.remove(a),eu.nameProperty.set(e,l),l){let u=(n=(t=this._restore).args)===null||n===void 0?void 0:n.call(t,e);await o.save(l,{data:u})}a!==l&&this._updated.emit(e)}_onInstanceDisposed(e){if(this._objects.delete(e),e===this._current&&(this._current=null,this._currentChanged.emit(this._current)),eu.injectedProperty.get(e)||!this._restore)return;let{connector:t}=this._restore,n=eu.nameProperty.get(e);n&&t.remove(n)}};tR.RestorablePool=WV;var eu;(function(r){r.injectedProperty=new PZ.AttachedProperty({name:"injected",create:()=>!1}),r.nameProperty=new PZ.AttachedProperty({name:"name",create:()=>""})})(eu||(eu={}))});var TZ=re(Mx=>{"use strict";p();Object.defineProperty(Mx,"__esModule",{value:!0});Mx.StateDB=void 0;var zbe=UV(),Ax=class r{constructor(e={}){this._changed=new zbe.Signal(this);let{connector:t,transform:n}=e;this._connector=t||new r.Connector,n?this._ready=n.then(i=>{let{contents:o,type:s}=i;switch(s){case"cancel":return;case"clear":return this._clear();case"merge":return this._merge(o||{});case"overwrite":return this._overwrite(o||{});default:return}}):this._ready=Promise.resolve(void 0)}get changed(){return this._changed}async clear(){await this._ready,await this._clear()}async fetch(e){return await this._ready,this._fetch(e)}async list(e){return await this._ready,this._list(e)}async remove(e){await this._ready,await this._remove(e),this._changed.emit({id:e,type:"remove"})}async save(e,t){await this._ready,await this._save(e,t),this._changed.emit({id:e,type:"save"})}async toJSON(){await this._ready;let{ids:e,values:t}=await this._list();return t.reduce((n,i,o)=>(n[e[o]]=i,n),{})}async _clear(){await Promise.all((await this._list()).ids.map(e=>this._remove(e)))}async _fetch(e){let t=await this._connector.fetch(e);if(t)return JSON.parse(t).v}async _list(e=""){let{ids:t,values:n}=await this._connector.list(e);return{ids:t,values:n.map(i=>JSON.parse(i).v)}}async _merge(e){await Promise.all(Object.keys(e).map(t=>e[t]&&this._save(t,e[t])))}async _overwrite(e){await this._clear(),await this._merge(e)}async _remove(e){return this._connector.remove(e)}async _save(e,t){return this._connector.save(e,JSON.stringify({v:t}))}};Mx.StateDB=Ax;(function(r){class e{constructor(){this._storage={}}async fetch(n){return this._storage[n]}async list(n=""){return Object.keys(this._storage).reduce((i,o)=>((n===""||n===o.split(":")[0])&&(i.ids.push(o),i.values.push(this._storage[o])),i),{ids:[],values:[]})}async remove(n){delete this._storage[n]}async save(n,i){this._storage[n]=i}}r.Connector=e})(Ax||(Mx.StateDB=Ax={}))});var kZ=re(rR=>{"use strict";p();Object.defineProperty(rR,"__esModule",{value:!0});rR.IStateDB=void 0;var Qbe=Q1();rR.IStateDB=new Qbe.Token("@jupyterlab/coreutils:IStateDB",`A service for the JupyterLab state database.
  Use this if you want to store data that will persist across page loads.
  See "state database" for more information.`)});var VV=re(Ml=>{"use strict";p();var Xbe=Ml&&Ml.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Ox=Ml&&Ml.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Xbe(e,r,t)};Object.defineProperty(Ml,"__esModule",{value:!0});Ox(bZ(),Ml);Ox(SZ(),Ml);Ox(DZ(),Ml);Ox(TZ(),Ml);Ox(kZ(),Ml)});var HV=re(iR=>{"use strict";p();Object.defineProperty(iR,"__esModule",{value:!0});iR.SettingManager=void 0;var jV=io(),Zbe=VV(),nR=ko(),eIe="api/settings",BV=class extends Zbe.DataConnector{constructor(e={}){var t;super(),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:nR.ServerConnection.makeSettings()}async fetch(e){if(!e)throw new Error("Plugin `id` parameter is required for settings fetch.");let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=nR.ServerConnection,a=n+i,l=Lx.url(a,e),u=await o(l,{},t);if(u.status!==200)throw await s.create(u);return u.json()}async list(e){var t,n,i,o;let{serverSettings:s}=this,{baseUrl:a,appUrl:l}=s,{makeRequest:u,ResponseError:c}=nR.ServerConnection,d=a+l,f=Lx.url(d,"",e==="ids"),m=await u(f,{},s);if(m.status!==200)throw new c(m);let g=await m.json(),b=(n=(t=g==null?void 0:g.settings)===null||t===void 0?void 0:t.map(k=>k.id))!==null&&n!==void 0?n:[],v=[];return e||(v=(o=(i=g==null?void 0:g.settings)===null||i===void 0?void 0:i.map(k=>(k.data={composite:{},user:{}},k)))!==null&&o!==void 0?o:[]),{ids:b,values:v}}async save(e,t){let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=nR.ServerConnection,l=i+o,u=Lx.url(l,e),c={body:JSON.stringify({raw:t}),method:"PUT"},d=await s(u,c,n);if(d.status!==204)throw new a(d)}};iR.SettingManager=BV;var Lx;(function(r){function e(t,n,i){let o=i?jV.URLExt.objectToQueryString({ids_only:!0}):"",s=jV.URLExt.join(t,eIe),a=jV.URLExt.join(s,n);if(!a.startsWith(s))throw new Error("Can only be used for workspaces requests");return`${a}${o}`}r.url=e})(Lx||(Lx={}))});var Ux=re(Ao=>{"use strict";p();Object.defineProperty(Ao,"__esModule",{value:!0});Ao.shutdownTerminal=Ao.listRunning=Ao.startNew=Ao.isAvailable=Ao.TERMINAL_SERVICE_URL=void 0;var Kx=io(),Ad=ko();Ao.TERMINAL_SERVICE_URL="api/terminals";function NZ(){return String(Kx.PageConfig.getOption("terminalsAvailable")).toLowerCase()==="true"}Ao.isAvailable=NZ;async function tIe(r=Ad.ServerConnection.makeSettings(),e,t){Fx.errorIfNotAvailable();let n=Kx.URLExt.join(r.baseUrl,Ao.TERMINAL_SERVICE_URL),i={method:"POST",body:JSON.stringify({name:e,cwd:t})},o=await Ad.ServerConnection.makeRequest(n,i,r);if(o.status!==200)throw await Ad.ServerConnection.ResponseError.create(o);return await o.json()}Ao.startNew=tIe;async function rIe(r=Ad.ServerConnection.makeSettings()){Fx.errorIfNotAvailable();let e=Kx.URLExt.join(r.baseUrl,Ao.TERMINAL_SERVICE_URL),t=await Ad.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await Ad.ServerConnection.ResponseError.create(t);let n=await t.json();if(!Array.isArray(n))throw new Error("Invalid terminal list");return n}Ao.listRunning=rIe;async function nIe(r,e=Ad.ServerConnection.makeSettings()){var t;Fx.errorIfNotAvailable();let n=Kx.URLExt.join(e.baseUrl,Ao.TERMINAL_SERVICE_URL),i=Kx.URLExt.join(n,r);if(!i.startsWith(n))throw new Error("Can only be used for terminal requests");let o={method:"DELETE"},s=await Ad.ServerConnection.makeRequest(i,o,e);if(s.status===404){let l=(t=(await s.json()).message)!==null&&t!==void 0?t:`The terminal session "${r}"" does not exist on the server`;console.warn(l)}else if(s.status!==204)throw await Ad.ServerConnection.ResponseError.create(s)}Ao.shutdownTerminal=nIe;var Fx;(function(r){function e(){if(!NZ())throw new Error("Terminals Unavailable")}r.errorIfNotAvailable=e})(Fx||(Fx={}))});var RZ=re(oR=>{"use strict";p();Object.defineProperty(oR,"__esModule",{value:!0});oR.isAvailable=void 0;var iIe=Ux();Object.defineProperty(oR,"isAvailable",{enumerable:!0,get:function(){return iIe.isAvailable}})});var OZ=re(aR=>{"use strict";p();Object.defineProperty(aR,"__esModule",{value:!0});aR.TerminalConnection=void 0;var AZ=io(),oIe=Hc(),sR=Ms(),sIe=Bn(),MZ=Ux(),qV=class r{constructor(e){var t;this._createSocket=()=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");let n=this._name,i=this.serverSettings,o=AZ.URLExt.join(i.wsUrl,"terminals","websocket",encodeURIComponent(n)),s=i.token;i.appendToken&&s!==""&&(o=o+`?token=${encodeURIComponent(s)}`),this._ws=new i.WebSocket(o),this._ws.onmessage=this._onWSMessage,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose},this._onWSMessage=n=>{if(this._isDisposed)return;let i=JSON.parse(n.data);if(i[0]==="disconnect"&&this.dispose(),this._connectionStatus==="connecting"){i[0]==="setup"&&this._updateConnectionStatus("connected");return}this._messageReceived.emit({type:i[0],content:i.slice(1)})},this._onWSClose=n=>{console.warn(`Terminal websocket closed: ${n.code}`),this.isDisposed||this._reconnect()},this._connectionStatus="connecting",this._connectionStatusChanged=new sR.Signal(this),this._isDisposed=!1,this._disposed=new sR.Signal(this),this._messageReceived=new sR.Signal(this),this._reconnectTimeout=null,this._ws=null,this._noOp=()=>{},this._reconnectLimit=7,this._reconnectAttempt=0,this._pendingMessages=[],this._name=e.model.name,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:sIe.ServerConnection.makeSettings(),this._createSocket()}get disposed(){return this._disposed}get messageReceived(){return this._messageReceived}get name(){return this._name}get model(){return{name:this._name}}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearSocket(),sR.Signal.clearData(this))}send(e){this._sendMessage(e)}_sendMessage(e,t=!0){if(!(this._isDisposed||!e.content))if(this.connectionStatus==="connected"&&this._ws){let n=[e.type,...e.content];this._ws.send(JSON.stringify(n))}else if(t)this._pendingMessages.push(e);else throw new Error(`Could not send message: ${JSON.stringify(e)}`)}_sendPending(){for(;this.connectionStatus==="connected"&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}reconnect(){this._errorIfDisposed();let e=new oIe.PromiseDelegate,t=(n,i)=>{i==="connected"?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):i==="disconnected"&&(e.reject(new Error("Terminal connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");let e=JV.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.error(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`),this._reconnectTimeout=setTimeout(this._createSocket,e),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_clearSocket(){this._ws!==null&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}async shutdown(){await(0,MZ.shutdownTerminal)(this.name,this.serverSettings),this.dispose()}clone(){return new r(this)}_updateConnectionStatus(e){this._connectionStatus!==e&&(this._connectionStatus=e,e!=="connecting"&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),e==="connected"&&this._sendPending(),this._connectionStatusChanged.emit(e))}_errorIfDisposed(){if(this.isDisposed)throw new Error("Terminal connection is disposed")}get connectionStatusChanged(){return this._connectionStatusChanged}get connectionStatus(){return this._connectionStatus}};aR.TerminalConnection=qV;var JV;(function(r){function e(n,i){return AZ.URLExt.join(n,MZ.TERMINAL_SERVICE_URL,encodeURIComponent(i))}r.getTermUrl=e;function t(n,i){return n=Math.ceil(n),i=Math.floor(i),Math.floor(Math.random()*(i-n+1))+n}r.getRandomIntInclusive=t})(JV||(JV={}))});var KZ=re(jx=>{"use strict";p();Object.defineProperty(jx,"__esModule",{value:!0});jx.TerminalManager=void 0;var aIe=Ug(),LZ=Ms(),lIe=Bn(),cIe=Fg(),Wx=Ux(),uIe=OZ(),Vx=class extends cIe.BaseManager{constructor(e={}){var t;if(super(e),this._isReady=!1,this._names=[],this._terminalConnections=new Set,this._runningChanged=new LZ.Signal(this),this._connectionFailure=new LZ.Signal(this),!this.isAvailable()){this._ready=Promise.reject("Terminals unavailable"),this._ready.catch(n=>{});return}this._pollModels=new aIe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:TerminalManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._names.length=0,this._terminalConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}isAvailable(){return(0,Wx.isAvailable)()}connectTo(e){let t=new uIe.TerminalConnection({...e,serverSettings:this.serverSettings});return this._onStarted(t),this._names.includes(e.model.name)||this.refreshRunning().catch(()=>{}),t}running(){return this._models[Symbol.iterator]()}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e){let t=await(0,Wx.startNew)(this.serverSettings,e==null?void 0:e.name,e==null?void 0:e.cwd);return await this.refreshRunning(),this.connectTo({model:t})}async shutdown(e){await(0,Wx.shutdownTerminal)(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all(this._names.map(e=>(0,Wx.shutdownTerminal)(e,this.serverSettings))),await this.refreshRunning()}async requestRunning(){var e,t;let n;try{n=await(0,Wx.listRunning)(this.serverSettings)}catch(o){throw(o instanceof lIe.ServerConnection.NetworkError||((e=o.response)===null||e===void 0?void 0:e.status)===503||((t=o.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(o),o}if(this.isDisposed)return;let i=n.map(({name:o})=>o).sort();i!==this._names&&(this._names=i,this._terminalConnections.forEach(o=>{i.includes(o.name)||o.dispose()}),this._runningChanged.emit(this._models))}_onStarted(e){this._terminalConnections.add(e),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._terminalConnections.delete(e),this.refreshRunning().catch(()=>{})}get _models(){return this._names.map(e=>({name:e}))}};jx.TerminalManager=Vx;(function(r){class e extends r{constructor(){super(...arguments),this._readyPromise=new Promise(()=>{})}get isActive(){return!1}get parentReady(){return super.ready}get ready(){return this.parentReady.then(()=>this._readyPromise)}async startNew(n){return Promise.reject(new Error("Not implemented in no-op Terminal Manager"))}connectTo(n){throw Error("Not implemented in no-op Terminal Manager")}async shutdown(n){return Promise.reject(new Error("Not implemented in no-op Terminal Manager"))}async requestRunning(){return Promise.resolve()}}r.NoopManager=e})(Vx||(jx.TerminalManager=Vx={}))});var GV=re(Mo=>{"use strict";p();var FZ=Mo&&Mo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),dIe=Mo&&Mo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),UZ=Mo&&Mo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&FZ(e,r,t);return dIe(e,r),e},pIe=Mo&&Mo.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&FZ(e,r,t)};Object.defineProperty(Mo,"__esModule",{value:!0});Mo.TerminalAPI=Mo.Terminal=void 0;var fIe=UZ(RZ());Mo.Terminal=fIe;var mIe=UZ(Ux());Mo.TerminalAPI=mIe;pIe(KZ(),Mo)});var QV=re(lR=>{"use strict";p();Object.defineProperty(lR,"__esModule",{value:!0});lR.UserManager=void 0;var hIe=io(),gIe=Hc(),vIe=Ug(),WZ=Ms(),yIe=ko(),bIe=Fg(),IIe="api/me",YV="@jupyterlab/services:UserManager#user",$V=class extends bIe.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._userChanged=new WZ.Signal(this),this._connectionFailure=new WZ.Signal(this),this._ready=this.requestUser().then(()=>{this.isDisposed||(this._isReady=!0)}).catch(n=>new Promise(()=>{})),this._pollSpecs=new vIe.Poll({auto:!1,factory:()=>this.requestUser(),frequency:{interval:61*1e3,backoff:!0,max:300*1e3},name:YV,standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this.ready.then(()=>{this._pollSpecs.start()})}get isReady(){return this._isReady}get ready(){return this._ready}get identity(){return this._identity}get permissions(){return this._permissions}get userChanged(){return this._userChanged}get connectionFailure(){return this._connectionFailure}dispose(){this._pollSpecs.dispose(),super.dispose()}async refreshUser(){await this._pollSpecs.refresh(),await this._pollSpecs.tick}async requestUser(){if(this.isDisposed)return;let{baseUrl:e}=this.serverSettings,{makeRequest:t,ResponseError:n}=yIe.ServerConnection,i=hIe.URLExt.join(e,IIe),o=await t(i,{},this.serverSettings);if(o.status!==200)throw await n.create(o);let s={identity:this._identity,permissions:this._permissions},a=await o.json(),l=a.identity,{localStorage:u}=window,c=u.getItem(YV);if(c&&(!l.initials||!l.color)){let d=JSON.parse(c);l.initials=l.initials||d.initials||l.name.substring(0,1),l.color=l.color||d.color||zV.getRandomColor()}gIe.JSONExt.deepEqual(a,s)||(this._identity=l,this._permissions=a.permissions,u.setItem(YV,JSON.stringify(l)),this._userChanged.emit(a))}};lR.UserManager=$V;var zV;(function(r){let e=["var(--jp-collaborator-color1)","var(--jp-collaborator-color2)","var(--jp-collaborator-color3)","var(--jp-collaborator-color4)","var(--jp-collaborator-color5)","var(--jp-collaborator-color6)","var(--jp-collaborator-color7)"];r.getRandomColor=()=>e[Math.floor(Math.random()*e.length)]})(zV||(zV={}))});var ZV=re(cR=>{"use strict";p();Object.defineProperty(cR,"__esModule",{value:!0});cR.WorkspaceManager=void 0;var VZ=io(),SIe=VV(),Bx=ko(),_Ie="api/workspaces",XV=class extends SIe.DataConnector{constructor(e={}){var t;super(),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Bx.ServerConnection.makeSettings()}async fetch(e){let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=Bx.ServerConnection,a=n+i,l=yI.url(a,e),u=await o(l,{},t);if(u.status!==200)throw await s.create(u);return u.json()}async list(){let{serverSettings:e}=this,{baseUrl:t,appUrl:n}=e,{makeRequest:i,ResponseError:o}=Bx.ServerConnection,s=t+n,a=yI.url(s,""),l=await i(a,{},e);if(l.status!==200)throw await o.create(l);return(await l.json()).workspaces}async remove(e){let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=Bx.ServerConnection,a=n+i,l=yI.url(a,e),c=await o(l,{method:"DELETE"},t);if(c.status!==204)throw await s.create(c)}async save(e,t){let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=Bx.ServerConnection,l=i+o,u=yI.url(l,e),c={body:JSON.stringify(t),method:"PUT"},d=await s(u,c,n);if(d.status!==204)throw await a.create(d)}};cR.WorkspaceManager=XV;var yI;(function(r){function e(t,n){let i=VZ.URLExt.join(t,_Ie),o=VZ.URLExt.join(i,n);if(!o.startsWith(i))throw new Error("Can only be used for workspaces requests");return o}r.url=e})(yI||(yI={}))});var BZ=re(uR=>{"use strict";p();Object.defineProperty(uR,"__esModule",{value:!0});uR.ServiceManager=void 0;var jZ=Ms(),EIe=lZ(),CIe=pV(),wIe=gV(),xIe=TV(),PIe=W1(),DIe=MV(),TIe=ko(),kIe=LV(),NIe=HV(),RIe=GV(),AIe=QV(),MIe=ZV(),ej=class{constructor(e={}){var t,n;this._isDisposed=!1,this._connectionFailure=new jZ.Signal(this),this._isReady=!1;let i=e.defaultDrive,o=(t=e.serverSettings)!==null&&t!==void 0?t:TIe.ServerConnection.makeSettings(),s=(n=e.standby)!==null&&n!==void 0?n:"when-hidden",a={defaultDrive:i,serverSettings:o,standby:s};this.serverSettings=o,this.contents=e.contents||new CIe.ContentsManager(a),this.events=e.events||new wIe.EventManager(a),this.kernels=e.kernels||new xIe.KernelManager(a),this.sessions=e.sessions||new kIe.SessionManager({...a,kernelManager:this.kernels}),this.settings=e.settings||new NIe.SettingManager(a),this.terminals=e.terminals||new RIe.TerminalManager(a),this.builder=e.builder||new EIe.BuildManager(a),this.workspaces=e.workspaces||new MIe.WorkspaceManager(a),this.nbconvert=e.nbconvert||new DIe.NbConvertManager(a),this.kernelspecs=e.kernelspecs||new PIe.KernelSpecManager(a),this.user=e.user||new AIe.UserManager(a),this.kernelspecs.connectionFailure.connect(this._onConnectionFailure,this),this.sessions.connectionFailure.connect(this._onConnectionFailure,this),this.terminals.connectionFailure.connect(this._onConnectionFailure,this);let l=[this.sessions.ready,this.kernelspecs.ready];this.terminals.isAvailable()&&l.push(this.terminals.ready),this._readyPromise=Promise.all(l).then(()=>{this._isReady=!0})}get connectionFailure(){return this._connectionFailure}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,jZ.Signal.clearData(this),this.contents.dispose(),this.events.dispose(),this.sessions.dispose(),this.terminals.dispose())}get isReady(){return this._isReady}get ready(){return this._readyPromise}_onConnectionFailure(e,t){this._connectionFailure.emit(t)}};uR.ServiceManager=ej});var Bn=re(Hn=>{"use strict";p();var OIe=Hn&&Hn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),cs=Hn&&Hn.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&OIe(e,r,t)};Object.defineProperty(Hn,"__esModule",{value:!0});cs(Fg(),Hn);cs(_X(),Hn);cs(pV(),Hn);cs(gV(),Hn);cs(TV(),Hn);cs(W1(),Hn);cs(BZ(),Hn);cs(ko(),Hn);cs(LV(),Hn);cs(HV(),Hn);cs(GV(),Hn);cs(QV(),Hn);cs(ZV(),Hn);cs(MV(),Hn)});var nj=re((LGe,zZ)=>{"use strict";p();var YZ=Array.isArray,$Z=Object.keys,FIe=Object.prototype.hasOwnProperty;zZ.exports=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=YZ(e),i=YZ(t),o,s,a;if(n&&i){if(s=e.length,s!=t.length)return!1;for(o=s;o--!==0;)if(!r(e[o],t[o]))return!1;return!0}if(n!=i)return!1;var l=e instanceof Date,u=t instanceof Date;if(l!=u)return!1;if(l&&u)return e.getTime()==t.getTime();var c=e instanceof RegExp,d=t instanceof RegExp;if(c!=d)return!1;if(c&&d)return e.toString()==t.toString();var f=$Z(e);if(s=f.length,s!==$Z(t).length)return!1;for(o=s;o--!==0;)if(!FIe.call(t,f[o]))return!1;for(o=s;o--!==0;)if(a=f[o],!r(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}});var Sj=re(zf=>{"use strict";p();Object.defineProperty(zf,"__esModule",{value:!0});zf.TargetPopulation=zf.Filters=zf.VSCodeFilterProvider=void 0;var JR=require("vscode"),Ij=class r{constructor(e,t,n){this.extensionName=e,this.extensionVersion=t,this.targetPopulation=n}static trimVersionSuffix(e){let t=/\-[a-zA-Z0-9]+$/;return e.split(t)[0]}getFilterValue(e){switch(e){case cu.ApplicationVersion:return r.trimVersionSuffix(JR.version);case cu.Build:return JR.env.appName;case cu.ClientId:return JR.env.machineId;case cu.ExtensionName:return this.extensionName;case cu.ExtensionVersion:return r.trimVersionSuffix(this.extensionVersion);case cu.Language:return JR.env.language;case cu.TargetPopulation:return this.targetPopulation;default:return""}}getFilters(){let e=new Map,t=Object.values(cu);for(let n of t)e.set(n,this.getFilterValue(n));return e}};zf.VSCodeFilterProvider=Ij;var cu;(function(r){r.Market="X-MSEdge-Market",r.CorpNet="X-FD-Corpnet",r.ApplicationVersion="X-VSCode-AppVersion",r.Build="X-VSCode-Build",r.ClientId="X-MSEdge-ClientId",r.ExtensionName="X-VSCode-ExtensionName",r.ExtensionVersion="X-VSCode-ExtensionVersion",r.Language="X-VSCode-Language",r.TargetPopulation="X-VSCode-TargetPopulation"})(cu||(zf.Filters=cu={}));var Qee;(function(r){r.Team="team",r.Internal="internal",r.Insiders="insider",r.Public="public"})(Qee||(zf.TargetPopulation=Qee={}))});var Xee=re(GR=>{"use strict";p();Object.defineProperty(GR,"__esModule",{value:!0});GR.BaseFeatureProvider=void 0;var _j=class{constructor(e){this.telemetry=e,this.isFetching=!1}async getFeatures(){if(this.isFetching&&this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetch();let e=await this.fetchPromise;return this.isFetching=!1,this.fetchPromise=void 0,e}};GR.BaseFeatureProvider=_j});var Zee=re(YR=>{"use strict";p();Object.defineProperty(YR,"__esModule",{value:!0});YR.FilteredFeatureProvider=void 0;var fSe=Xee(),Ej=class extends fSe.BaseFeatureProvider{constructor(e,t){super(e),this.telemetry=e,this.filterProviders=t,this.cachedTelemetryEvents=[]}getFilters(){let e=new Map;for(let t of this.filterProviders){let n=t.getFilters();for(let i of n.keys()){let o=n.get(i);e.set(i,o)}}return e}PostEventToTelemetry(e){if(this.cachedTelemetryEvents.includes(e))return;let t=JSON.stringify(e);this.telemetry.postEvent("report-headers",new Map([["ABExp.headers",t]])),this.cachedTelemetryEvents.push(e)}};YR.FilteredFeatureProvider=Ej});var ete=re(Qf=>{"use strict";p();Object.defineProperty(Qf,"__esModule",{value:!0});Qf.TasApiFeatureProvider=Qf.TASAPI_FETCHERROR_EVENTNAME=void 0;var mSe=Zee();Qf.TASAPI_FETCHERROR_EVENTNAME="call-tas-error";var Cj="ErrorType",wj=class extends mSe.FilteredFeatureProvider{constructor(e,t,n){super(t,n),this.httpClient=e,this.telemetry=t,this.filterProviders=n}async fetch(){let e=this.getFilters(),t={};for(let a of e.keys()){let l=e.get(a);t[a]=l}let n;try{n=await this.httpClient.get({headers:t})}catch(a){let l=a,u=new Map;l.responseReceived&&!l.responseOk?u.set(Cj,"ServerError"):l.responseReceived===!1?u.set(Cj,"NoResponse"):u.set(Cj,"GenericError"),this.telemetry.postEvent(Qf.TASAPI_FETCHERROR_EVENTNAME,u)}if(!n)throw Error(Qf.TASAPI_FETCHERROR_EVENTNAME);e.keys.length>0&&this.PostEventToTelemetry(t);let i=n.data,o=i.Configs,s=[];for(let a of o)if(a.Parameters)for(let l of Object.keys(a.Parameters)){let u=l+(a.Parameters[l]?"":"cf");s.includes(u)||s.push(u)}return{features:s,assignmentContext:i.AssignmentContext,configs:o}}};Qf.TasApiFeatureProvider=wj});var tte=re(FI=>{"use strict";p();Object.defineProperty(FI,"__esModule",{value:!0});FI.HttpClient=FI.FetchError=void 0;var KI=class extends Error{constructor(e,t,n){super(e),this.responseReceived=t,this.responseOk=n}};FI.FetchError=KI;var xj=class{constructor(e){this.endpoint=e}async get(e){let t=await fetch(this.endpoint,{method:"GET",headers:e==null?void 0:e.headers});if(!t)throw new KI("No response received",!1);if(!t.ok)throw new KI("Response not ok",!0,!1);let n=await t.json();if(!n)throw new KI("No data received",!1);return{data:n}}};FI.HttpClient=xj});var rte=re($R=>{"use strict";p();Object.defineProperty($R,"__esModule",{value:!0});$R.MemoryKeyValueStorage=void 0;var Pj=class{constructor(){this.storage=new Map}async getValue(e,t){return this.storage.has(e)?await Promise.resolve(this.storage.get(e)):await Promise.resolve(t||void 0)}setValue(e,t){this.storage.set(e,t)}};$R.MemoryKeyValueStorage=Pj});var nte=re(zR=>{"use strict";p();Object.defineProperty(zR,"__esModule",{value:!0});zR.ExperimentationServiceBase=void 0;var hSe=rte(),Dj=class{get features(){return this._features}set features(e){this._features=e,this.telemetry&&this.telemetry.setSharedProperty(this.assignmentContextTelemetryPropertyName,this.features.assignmentContext)}constructor(e,t,n,i,o){this.telemetry=e,this.assignmentContextTelemetryPropertyName=t,this.telemetryEventName=n,this.storageKey=i,this.storage=o,this.featuresConsumed=!1,this.cachedTelemetryEvents=[],this._features={features:[],assignmentContext:"",configs:[]},this.storageKey||(this.storageKey="ABExp.Features"),this.storage||(o=new hSe.MemoryKeyValueStorage),this.loadCachePromise=this.loadCachedFeatureData(),this.initializePromise=this.loadCachePromise,this.initialFetch=new Promise((s,a)=>{this.resolveInitialFetchPromise=s})}async getFeaturesAsync(e=!1){if(this.fetchPromise!=null){try{await this.fetchPromise}catch(t){}return this.features}if(!this.featureProviders||this.featureProviders.length===0)return Promise.resolve({features:[],assignmentContext:"",configs:[]});try{this.fetchPromise=Promise.all(this.featureProviders.map(async n=>await n.getFeatures()));let t=await this.fetchPromise;this.updateFeatures(t,e)}catch(t){}return this.fetchPromise=void 0,this.resolveInitialFetchPromise&&(this.resolveInitialFetchPromise(),this.resolveInitialFetchPromise=void 0),this.features}updateFeatures(e,t=!1){let n={features:[],assignmentContext:"",configs:[]};for(let i of e){for(let o of i.features)n.features.includes(o)||n.features.push(o);for(let o of i.configs){let s=n.configs.find(a=>a.Id===o.Id);s?s.Parameters=Object.assign(Object.assign({},s.Parameters),o.Parameters):n.configs.push(o)}n.assignmentContext+=i.assignmentContext}(t||!this.featuresConsumed)&&(this.features=n),this.storage&&this.storage.setValue(this.storageKey,n)}async loadCachedFeatureData(){let e;this.storage&&(e=await this.storage.getValue(this.storageKey),e!==void 0&&e.configs===void 0&&(e.configs=[])),this.features.features.length===0&&(this.features=e||{features:[],assignmentContext:"",configs:[]})}isFlightEnabled(e){return this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isCachedFlightEnabled(e){return await this.loadCachePromise,this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isFlightEnabledAsync(e){let t=await this.getFeaturesAsync(!0);return this.featuresConsumed=!0,this.PostEventToTelemetry(e),t.features.includes(e)}getTreatmentVariable(e,t){this.featuresConsumed=!0,this.PostEventToTelemetry(`${e}.${t}`);let n=this.features.configs.find(i=>i.Id===e);return n==null?void 0:n.Parameters[t]}async getTreatmentVariableAsync(e,t,n){if(n){let i=this.featuresConsumed,o=this.getTreatmentVariable(e,t);if(o===void 0)this.featuresConsumed=i;else return o}return await this.getFeaturesAsync(!0),this.getTreatmentVariable(e,t)}PostEventToTelemetry(e){this.cachedTelemetryEvents.includes(e)||(this.telemetry.postEvent(this.telemetryEventName,new Map([["ABExp.queriedFeature",e]])),this.cachedTelemetryEvents.push(e))}invokeInit(){this.init()}addFeatureProvider(...e){if(!(e==null||this.featureProviders==null))for(let t of e)this.featureProviders.push(t)}};zR.ExperimentationServiceBase=Dj});var ite=re(QR=>{"use strict";p();Object.defineProperty(QR,"__esModule",{value:!0});QR.PollingService=void 0;var Tj=class{constructor(e){this.fetchInterval=e}StopPolling(){clearInterval(this.intervalHandle),this.intervalHandle=void 0}OnPollTick(e){this.onTick=e}StartPolling(e=!1){this.intervalHandle&&this.StopPolling(),this.onTick!=null&&(e&&this.onTick().then(()=>{}).catch(()=>{}),this.intervalHandle=setInterval(async()=>{await this.onTick()},this.fetchInterval),this.intervalHandle.unref&&this.intervalHandle.unref())}};QR.PollingService=Tj});var ote=re(XR=>{"use strict";p();Object.defineProperty(XR,"__esModule",{value:!0});XR.ExperimentationServiceAutoPolling=void 0;var gSe=nte(),vSe=ite(),kj=class extends gSe.ExperimentationServiceBase{constructor(e,t,n,i,o,s,a){if(super(e,i,o,s,a),this.telemetry=e,this.filterProviders=t,this.refreshRateMs=n,this.assignmentContextTelemetryPropertyName=i,this.telemetryEventName=o,this.storageKey=s,this.storage=a,n<1e3&&n!==0)throw new Error("The minimum refresh rate for polling is 1000 ms (1 second). If you wish to deactivate this auto-polling use value of 0.");n>0&&(this.pollingService=new vSe.PollingService(n),this.pollingService.OnPollTick(async()=>{await super.getFeaturesAsync()}))}init(){this.pollingService?this.pollingService.StartPolling(!0):super.getFeaturesAsync()}async getFeaturesAsync(e=!1){if(this.pollingService){this.pollingService.StopPolling();let t=await super.getFeaturesAsync(e);return this.pollingService.StartPolling(),t}else return await super.getFeaturesAsync(e)}};XR.ExperimentationServiceAutoPolling=kj});var ste=re(eA=>{"use strict";p();Object.defineProperty(eA,"__esModule",{value:!0});eA.ExperimentationService=void 0;var ySe=ete(),bSe=tte(),ISe=ote(),ZR=class extends ISe.ExperimentationServiceAutoPolling{constructor(e){super(e.telemetry,e.filterProviders||[],e.refetchInterval!=null?e.refetchInterval:0,e.assignmentContextTelemetryPropertyName,e.telemetryEventName,e.storageKey,e.keyValueStorage),this.options=e,this.invokeInit()}init(){this.featureProviders=[],this.addFeatureProvider(new ySe.TasApiFeatureProvider(new bSe.HttpClient(this.options.endpoint),this.telemetry,this.filterProviders)),super.init()}};eA.ExperimentationService=ZR;ZR.REFRESH_RATE_IN_MINUTES=30});var ate=re(tA=>{"use strict";p();Object.defineProperty(tA,"__esModule",{value:!0});tA.ExperimentationService=void 0;var SSe=ste();Object.defineProperty(tA,"ExperimentationService",{enumerable:!0,get:function(){return SSe.ExperimentationService}})});var lte=re(rA=>{"use strict";p();Object.defineProperty(rA,"__esModule",{value:!0});rA.MementoKeyValueStorage=void 0;var Nj=class{constructor(e){this.mementoGlobalStorage=e}async getValue(e,t){return await this.mementoGlobalStorage.get(e)||t}setValue(e,t){this.mementoGlobalStorage.update(e,t)}};rA.MementoKeyValueStorage=Nj});var cte=re(Aj=>{"use strict";p();Object.defineProperty(Aj,"__esModule",{value:!0});var Rj=class{constructor(){this.initializePromise=Promise.resolve(),this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,t){}getTreatmentVariableAsync(e,t){return Promise.resolve(void 0)}};Aj.default=Rj});var dte=re(UI=>{"use strict";p();Object.defineProperty(UI,"__esModule",{value:!0});UI.getExperimentationServiceAsync=UI.getExperimentationService=void 0;var _Se=Sj(),ESe=ate(),Mj=require("vscode"),CSe=lte(),wSe=cte(),xSe="https://default.exp-tas.com/vscode/ab",PSe="query-expfeature",DSe="abexp.assignmentcontext",TSe="VSCode.ABExp.FeatureData",kSe=1e3*60*30;function ute(r,e,t,n,i,...o){if(!i)throw new Error("Memento storage was not provided.");let s=Mj.workspace.getConfiguration("telemetry");if(!(Mj.env.isTelemetryEnabled===void 0?s.get("enableTelemetry",!0):Mj.env.isTelemetryEnabled))return new wSe.default;let u=[new _Se.VSCodeFilterProvider(r,e,t),...o],c=new CSe.MementoKeyValueStorage(i);return new ESe.ExperimentationService({filterProviders:u,telemetry:n,storageKey:TSe,keyValueStorage:c,featuresTelemetryPropertyName:"",assignmentContextTelemetryPropertyName:DSe,telemetryEventName:PSe,endpoint:xSe,refetchInterval:kSe})}UI.getExperimentationService=ute;async function NSe(r,e,t,n,i,...o){let s=ute(r,e,t,n,i,...o);return await s.initializePromise,s}UI.getExperimentationServiceAsync=NSe});var fte=re(Xf=>{"use strict";p();Object.defineProperty(Xf,"__esModule",{value:!0});Xf.TargetPopulation=Xf.getExperimentationServiceAsync=Xf.getExperimentationService=void 0;var pte=dte();Object.defineProperty(Xf,"getExperimentationService",{enumerable:!0,get:function(){return pte.getExperimentationService}});Object.defineProperty(Xf,"getExperimentationServiceAsync",{enumerable:!0,get:function(){return pte.getExperimentationServiceAsync}});var RSe=Sj();Object.defineProperty(Xf,"TargetPopulation",{enumerable:!0,get:function(){return RSe.TargetPopulation}})});var uA=re((Mtt,Fj)=>{"use strict";p();function LSe(r){var e=void 0;typeof r=="string"?e=[r]:e=r.raw;for(var t="",n=0;n<e.length;n++)t+=e[n].replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`"),n<(arguments.length<=1?0:arguments.length-1)&&(t+=arguments.length<=n+1?void 0:arguments[n+1]);var i=t.split(`
`),o=null;return i.forEach(function(s){var a=s.match(/^(\s+)\S+/);if(a){var l=a[1].length;o?o=Math.min(o,l):o=l}}),o!==null&&(t=i.map(function(s){return s[0]===" "?s.slice(o):s}).join(`
`)),t=t.trim(),t.replace(/\\n/g,`
`)}typeof Fj!="undefined"&&(Fj.exports=LSe)});var Ute=re((Bd,Fte)=>{p();var Kte=typeof self!="undefined"?self:Bd,gA=function(){function r(){this.fetch=!1,this.DOMException=Kte.DOMException}return r.prototype=Kte,new r}();(function(r){var e=function(t){var n={searchParams:"URLSearchParams"in r,iterable:"Symbol"in r&&"iterator"in Symbol,blob:"FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(h){return!1}}(),formData:"FormData"in r,arrayBuffer:"ArrayBuffer"in r};function i(h){return h&&DataView.prototype.isPrototypeOf(h)}if(n.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(h){return h&&o.indexOf(Object.prototype.toString.call(h))>-1};function a(h){if(typeof h!="string"&&(h=String(h)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(h))throw new TypeError("Invalid character in header field name");return h.toLowerCase()}function l(h){return typeof h!="string"&&(h=String(h)),h}function u(h){var y={next:function(){var w=h.shift();return{done:w===void 0,value:w}}};return n.iterable&&(y[Symbol.iterator]=function(){return y}),y}function c(h){this.map={},h instanceof c?h.forEach(function(y,w){this.append(w,y)},this):Array.isArray(h)?h.forEach(function(y){this.append(y[0],y[1])},this):h&&Object.getOwnPropertyNames(h).forEach(function(y){this.append(y,h[y])},this)}c.prototype.append=function(h,y){h=a(h),y=l(y);var w=this.map[h];this.map[h]=w?w+", "+y:y},c.prototype.delete=function(h){delete this.map[a(h)]},c.prototype.get=function(h){return h=a(h),this.has(h)?this.map[h]:null},c.prototype.has=function(h){return this.map.hasOwnProperty(a(h))},c.prototype.set=function(h,y){this.map[a(h)]=l(y)},c.prototype.forEach=function(h,y){for(var w in this.map)this.map.hasOwnProperty(w)&&h.call(y,this.map[w],w,this)},c.prototype.keys=function(){var h=[];return this.forEach(function(y,w){h.push(w)}),u(h)},c.prototype.values=function(){var h=[];return this.forEach(function(y){h.push(y)}),u(h)},c.prototype.entries=function(){var h=[];return this.forEach(function(y,w){h.push([w,y])}),u(h)},n.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);function d(h){if(h.bodyUsed)return Promise.reject(new TypeError("Already read"));h.bodyUsed=!0}function f(h){return new Promise(function(y,w){h.onload=function(){y(h.result)},h.onerror=function(){w(h.error)}})}function m(h){var y=new FileReader,w=f(y);return y.readAsArrayBuffer(h),w}function g(h){var y=new FileReader,w=f(y);return y.readAsText(h),w}function b(h){for(var y=new Uint8Array(h),w=new Array(y.length),T=0;T<y.length;T++)w[T]=String.fromCharCode(y[T]);return w.join("")}function v(h){if(h.slice)return h.slice(0);var y=new Uint8Array(h.byteLength);return y.set(new Uint8Array(h)),y.buffer}function k(){return this.bodyUsed=!1,this._initBody=function(h){this._bodyInit=h,h?typeof h=="string"?this._bodyText=h:n.blob&&Blob.prototype.isPrototypeOf(h)?this._bodyBlob=h:n.formData&&FormData.prototype.isPrototypeOf(h)?this._bodyFormData=h:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(h)?this._bodyText=h.toString():n.arrayBuffer&&n.blob&&i(h)?(this._bodyArrayBuffer=v(h.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(h)||s(h))?this._bodyArrayBuffer=v(h):this._bodyText=h=Object.prototype.toString.call(h):this._bodyText="",this.headers.get("content-type")||(typeof h=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(h)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var h=d(this);if(h)return h;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var h=d(this);if(h)return h;if(this._bodyBlob)return g(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(b(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(K)}),this.json=function(){return this.text().then(JSON.parse)},this}var R=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function P(h){var y=h.toUpperCase();return R.indexOf(y)>-1?y:h}function D(h,y){y=y||{};var w=y.body;if(h instanceof D){if(h.bodyUsed)throw new TypeError("Already read");this.url=h.url,this.credentials=h.credentials,y.headers||(this.headers=new c(h.headers)),this.method=h.method,this.mode=h.mode,this.signal=h.signal,!w&&h._bodyInit!=null&&(w=h._bodyInit,h.bodyUsed=!0)}else this.url=String(h);if(this.credentials=y.credentials||this.credentials||"same-origin",(y.headers||!this.headers)&&(this.headers=new c(y.headers)),this.method=P(y.method||this.method||"GET"),this.mode=y.mode||this.mode||null,this.signal=y.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&w)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(w)}D.prototype.clone=function(){return new D(this,{body:this._bodyInit})};function K(h){var y=new FormData;return h.trim().split("&").forEach(function(w){if(w){var T=w.split("="),H=T.shift().replace(/\+/g," "),Y=T.join("=").replace(/\+/g," ");y.append(decodeURIComponent(H),decodeURIComponent(Y))}}),y}function L(h){var y=new c,w=h.replace(/\r?\n[\t ]+/g," ");return w.split(/\r?\n/).forEach(function(T){var H=T.split(":"),Y=H.shift().trim();if(Y){var Z=H.join(":").trim();y.append(Y,Z)}}),y}k.call(D.prototype);function B(h,y){y||(y={}),this.type="default",this.status=y.status===void 0?200:y.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in y?y.statusText:"OK",this.headers=new c(y.headers),this.url=y.url||"",this._initBody(h)}k.call(B.prototype),B.prototype.clone=function(){return new B(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},B.error=function(){var h=new B(null,{status:0,statusText:""});return h.type="error",h};var N=[301,302,303,307,308];B.redirect=function(h,y){if(N.indexOf(y)===-1)throw new RangeError("Invalid status code");return new B(null,{status:y,headers:{location:h}})},t.DOMException=r.DOMException;try{new t.DOMException}catch(h){t.DOMException=function(y,w){this.message=y,this.name=w;var T=Error(y);this.stack=T.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function O(h,y){return new Promise(function(w,T){var H=new D(h,y);if(H.signal&&H.signal.aborted)return T(new t.DOMException("Aborted","AbortError"));var Y=new XMLHttpRequest;function Z(){Y.abort()}Y.onload=function(){var ie={status:Y.status,statusText:Y.statusText,headers:L(Y.getAllResponseHeaders()||"")};ie.url="responseURL"in Y?Y.responseURL:ie.headers.get("X-Request-URL");var le="response"in Y?Y.response:Y.responseText;w(new B(le,ie))},Y.onerror=function(){T(new TypeError("Network request failed"))},Y.ontimeout=function(){T(new TypeError("Network request failed"))},Y.onabort=function(){T(new t.DOMException("Aborted","AbortError"))},Y.open(H.method,H.url,!0),H.credentials==="include"?Y.withCredentials=!0:H.credentials==="omit"&&(Y.withCredentials=!1),"responseType"in Y&&n.blob&&(Y.responseType="blob"),H.headers.forEach(function(ie,le){Y.setRequestHeader(le,ie)}),H.signal&&(H.signal.addEventListener("abort",Z),Y.onreadystatechange=function(){Y.readyState===4&&H.signal.removeEventListener("abort",Z)}),Y.send(typeof H._bodyInit=="undefined"?null:H._bodyInit)})}return O.polyfill=!0,r.fetch||(r.fetch=O,r.Headers=c,r.Request=D,r.Response=B),t.Headers=c,t.Request=D,t.Response=B,t.fetch=O,Object.defineProperty(t,"__esModule",{value:!0}),t}({})})(gA);gA.fetch.ponyfill=!0;delete gA.fetch.polyfill;var iS=gA;Bd=iS.fetch;Bd.default=iS.fetch;Bd.fetch=iS.fetch;Bd.Headers=iS.Headers;Bd.Request=iS.Request;Bd.Response=iS.Response;Fte.exports=Bd});var ire=re((DA,nre)=>{p();var SS=null;typeof WebSocket!="undefined"?SS=WebSocket:typeof MozWebSocket!="undefined"?SS=MozWebSocket:typeof DA!="undefined"?SS=DA.WebSocket||DA.MozWebSocket:typeof window!="undefined"?SS=window.WebSocket||window.MozWebSocket:typeof self!="undefined"&&(SS=self.WebSocket||self.MozWebSocket);nre.exports=SS});var Are=re((sbt,Rre)=>{"use strict";p();Rre.exports=({onlyFirst:r=!1}={})=>{let e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,r?void 0:"g")}});var one=re((awt,ine)=>{"use strict";p();var l_e=(r,e={})=>{let t=e.safe===!0||e.keepProtected===!0,n=!1,i=(o,s)=>{let a="",l,u;for(let c of o.nodes)switch(c.type){case"block":if(e.first&&n===!0){a+=i(c,o);break}if(e.preserveNewlines===!0){l=i(c,o),u=l.split(`
`),a+=`
`.repeat(u.length-1);break}if(t===!0&&c.protected===!0){a+=i(c,o);break}n=!0;break;case"line":if(e.first&&n===!0){a+=c.value;break}t===!0&&c.protected===!0&&(a+=c.value),n=!0;break;case"open":case"close":case"text":case"newline":default:{a+=c.value||"";break}}return a};return i(r)};ine.exports=l_e});var ane=re((cwt,sne)=>{"use strict";p();var _M=class{constructor(e){this.type=e.type,e.value&&(this.value=e.value),e.match&&(this.match=e.match),this.newline=e.newline||""}get protected(){return!!this.match&&this.match[1]==="!"}},v9=class extends _M{constructor(e){super(e),this.nodes=e.nodes||[]}push(e){this.nodes.push(e)}get protected(){return this.nodes.length>0&&this.nodes[0].protected===!0}};sne.exports={Node:_M,Block:v9}});var cne=re(lne=>{"use strict";p();lne.javascript={BLOCK_OPEN_REGEX:/^\/\*\*?(!?)/,BLOCK_CLOSE_REGEX:/^\*\/(\n?)/,LINE_REGEX:/^\/\/(!?).*/}});var pne=re((fwt,dne)=>{"use strict";p();var{Node:pm,Block:une}=ane(),c_e=cne(),y9={ESCAPED_CHAR_REGEX:/^\\./,QUOTED_STRING_REGEX:/^(['"`])((?:\\.|[^\1])+?)(\1)/,NEWLINE_REGEX:/^\r*\n/},u_e=(r,e={})=>{if(typeof r!="string")throw new TypeError("Expected input to be a string");let t=new une({type:"root",nodes:[]}),n=[t],i=(e.language||"javascript").toLowerCase(),o=c_e[i];if(typeof o=="undefined")throw new Error(`Language "${i}" is not supported by strip-comments`);let{LINE_REGEX:s,BLOCK_OPEN_REGEX:a,BLOCK_CLOSE_REGEX:l}=o,u=t,c=r,d,f,m=[a,l].filter(Boolean),g=!1;m.every(P=>P.source==='^"""')&&(g=!0);let b=(P=c[0]||"")=>(c=c.slice(P.length),P),v=(P,D="text")=>{let K=P.exec(c);if(K)return b(K[0]),{type:D,value:K[0],match:K}},k=P=>{if(f&&f.type==="text"&&P.type==="text"){f.value+=P.value;return}u.push(P),P.nodes&&(n.push(P),u=P),f=P},R=()=>{if(u.type==="root")throw new SyntaxError("Unclosed block comment");n.pop(),u=n[n.length-1]};for(;c!=="";){if(d=v(y9.ESCAPED_CHAR_REGEX,"text")){k(new pm(d));continue}if(u.type!=="block"&&(!f||!/\w$/.test(f.value))&&!(g&&c.startsWith('"""'))&&(d=v(y9.QUOTED_STRING_REGEX,"text"))){k(new pm(d));continue}if(d=v(y9.NEWLINE_REGEX,"newline")){k(new pm(d));continue}if(a&&e.block&&!(g&&u.type==="block")&&(d=v(a,"open"))){k(new une({type:"block"})),k(new pm(d));continue}if(l&&u.type==="block"&&e.block&&(d=v(l,"close"))){d.newline=d.match[1]||"",k(new pm(d)),R();continue}if(s&&u.type!=="block"&&e.line&&(d=v(s,"line"))){k(new pm(d));continue}if(d=v(/^[a-zABD-Z0-9\t ]+/,"text")){k(new pm(d));continue}k(new pm({type:"text",value:b(c[0])}))}return t};dne.exports=u_e});var mne=re((hwt,fne)=>{"use strict";p();var EM=one(),DP=pne(),CM=fne.exports=(r,e)=>{let t={...e,block:!0,line:!0};return EM(DP(r,t),t)};CM.block=(r,e)=>{let t={...e,block:!0};return EM(DP(r,t),t)};CM.line=(r,e)=>{let t={...e,line:!0};return EM(DP(r,t),t)};CM.first=(r,e)=>{let t={...e,block:!0,line:!0,first:!0};return EM(DP(r,t),t)};CM.parse=DP});var Xne=re((HP,Qne)=>{p();var K_e=typeof HP=="object"&&HP&&HP.Object===Object&&HP;Qne.exports=K_e});var eie=re((kFt,Zne)=>{p();var F_e=Xne(),U_e=typeof self=="object"&&self&&self.Object===Object&&self,W_e=F_e||U_e||Function("return this")();Zne.exports=W_e});var uO=re((RFt,tie)=>{p();var V_e=eie(),j_e=V_e.Symbol;tie.exports=j_e});var nie=re((MFt,rie)=>{p();function B_e(r,e){for(var t=-1,n=r==null?0:r.length,i=Array(n);++t<n;)i[t]=e(r[t],t,r);return i}rie.exports=B_e});var oie=re((LFt,iie)=>{p();var H_e=Array.isArray;iie.exports=H_e});var cie=re((FFt,lie)=>{p();var sie=uO(),aie=Object.prototype,q_e=aie.hasOwnProperty,J_e=aie.toString,qP=sie?sie.toStringTag:void 0;function G_e(r){var e=q_e.call(r,qP),t=r[qP];try{r[qP]=void 0;var n=!0}catch(o){}var i=J_e.call(r);return n&&(e?r[qP]=t:delete r[qP]),i}lie.exports=G_e});var die=re((WFt,uie)=>{p();var Y_e=Object.prototype,$_e=Y_e.toString;function z_e(r){return $_e.call(r)}uie.exports=z_e});var hie=re((jFt,mie)=>{p();var pie=uO(),Q_e=cie(),X_e=die(),Z_e="[object Null]",eEe="[object Undefined]",fie=pie?pie.toStringTag:void 0;function tEe(r){return r==null?r===void 0?eEe:Z_e:fie&&fie in Object(r)?Q_e(r):X_e(r)}mie.exports=tEe});var vie=re((HFt,gie)=>{p();function rEe(r){return r!=null&&typeof r=="object"}gie.exports=rEe});var bie=re((JFt,yie)=>{p();var nEe=hie(),iEe=vie(),oEe="[object Symbol]";function sEe(r){return typeof r=="symbol"||iEe(r)&&nEe(r)==oEe}yie.exports=sEe});var wie=re((YFt,Cie)=>{p();var Iie=uO(),aEe=nie(),lEe=oie(),cEe=bie(),uEe=1/0,Sie=Iie?Iie.prototype:void 0,_ie=Sie?Sie.toString:void 0;function Eie(r){if(typeof r=="string")return r;if(lEe(r))return aEe(r,Eie)+"";if(cEe(r))return _ie?_ie.call(r):"";var e=r+"";return e=="0"&&1/r==-uEe?"-0":e}Cie.exports=Eie});var Pie=re((zFt,xie)=>{p();var dEe=wie();function pEe(r){return r==null?"":dEe(r)}xie.exports=pEe});var kie=re((XFt,Tie)=>{p();var fEe=Pie(),Die=/[\\^$.*+?()[\]{}|]/g,mEe=RegExp(Die.source);function hEe(r){return r=fEe(r),r&&mEe.test(r)?r.replace(Die,"\\$&"):r}Tie.exports=hEe});var ICe={};Wv(ICe,{activate:()=>gCe,deactivate:()=>vCe});module.exports=cL(ICe);p();p();Reflect.metadata===void 0&&nB();p();var hr=require("vscode");p();p();function Vv(){try{return(oB(),cL(iB)).isPreRelesVersionOfJupyterExtension===!0}catch(r){return!0}}var AE={isExiting:!1},lD="_builtin.JupyterServerSelectorForTesting",ME="_builtin.jupyterServerUrlProvider";var sB=!1;function aB(r){sB=r}function lB(){return sB}var cB=!1;function uB(r){cB=r}function zr(){return cB}var $e="python",KE="markdown",ec="vscode-notebook-cell";var uD={language:$e};var jv="vscode-interactive-input",St="jupyter-notebook",yr="interactive";var tc="GitHub.codespaces",Ge="ms-toolsai.jupyter",dD="ms-toolsai.datawrangler",pD=["donjayamanne"],fD="ms-toolsai.vscode-jupyter-powertoys",Bv="ms-toolsai.jupyter-hub",dB="0c6ae279ed8443289764825290e4f9e2-1a736e7c-1324-4338-be46-fc2a58ae4d14-7255",Hv="STANDARD_OUTPUT_CHANNEL",cD;(t=>(t.PythonInteractiveHelpLink="https://aka.ms/pyaiinstall",t.JupyterDataRateHelpLink="https://aka.ms/AA5ggm0"))(cD||(cD={}));var ai;(o=>(o.JupyterServerRemoteLaunchNameSeparator=`
`,o.JupyterServerRemoteLaunchService=Ge,o.JupyterServerUriListMax=10,o.IntellisenseTimeout=2e3,o.IntellisenseResolveTimeout=5e3))(ai||(ai={}));var li=!1;var Xoe=!1;function vn(){return Xoe||FE()}var Zoe=!1;function FE(){return Zoe}var nt;(b=>(b.GeneratedThemeName="ipython-theme",b.MatplotLibDefaultParams="_VSCode_defaultMatplotlib_Params",b.MatplotLibFigureFormats="_VSCode_matplotLib_FigureFormats",b.DefaultCodeCellMarker="# %%",b.DefaultCommTarget="jupyter.widget",b.ALL_VARIABLES="ALL_VARIABLES",b.KERNEL_VARIABLES="KERNEL_VARIABLES",b.DEBUGGER_VARIABLES="DEBUGGER_VARIABLES",b.PYTHON_VARIABLES_REQUESTER="PYTHON_VARIABLES_REQUESTER",b.MULTIPLEXING_DEBUGSERVICE="MULTIPLEXING_DEBUGSERVICE",b.RUN_BY_LINE_DEBUGSERVICE="RUN_BY_LINE_DEBUGSERVICE",b.REMOTE_URI="https://remote/",b.REMOTE_URI_ID_PARAM="id",b.REMOTE_URI_HANDLE_PARAM="uriHandle",b.REMOTE_URI_EXTENSION_ID_PARAM="extensionId"))(nt||(nt={}));var OE;(n=>(n.ImportIPython=`{0}
from IPython import get_ipython

{1}`,n.MatplotLibInit=`import matplotlib
%matplotlib inline
${nt.MatplotLibDefaultParams} = dict(matplotlib.rcParams)
`,n.DisableJedi="%config Completer.use_jedi = False"))(OE||(OE={}));var pB="JUPYTER_OUTPUT_CHANNEL",uL="Default Light+",$s="ms-python.python",fB="ms-python.vscode-python-envs",hp="ms-toolsai.jupyter-renderers",mB="ms-python.vscode-pylance",hB=["python","html","xml","javascript","markdown","latex","shellscript","bat","powershell","kusto","ruby","sql","perl","qsharp","raw"],gB=new Map([["bash","shellscript"],["c#","csharp"],["f#","fsharp"],["q#","qsharp"],["c++11","c++"],["c++12","c++"],["c++14","c++"]]),vB=["python","r","julia","c++","c#","f#","q#","powershell","java","scala","haskell","bash","cling","rust","sas","sos","ocaml"];var de;(Ne=>(Ne.RunAllCells="jupyter.runallcells",Ne.RunAllCellsAbove="jupyter.runallcellsabove",Ne.RunCellAndAllBelow="jupyter.runcellandallbelow",Ne.RunAllCellsAbovePalette="jupyter.runallcellsabove.palette",Ne.RunCellAndAllBelowPalette="jupyter.runcurrentcellandallbelow.palette",Ne.RunToLine="jupyter.runtoline",Ne.RunFromLine="jupyter.runfromline",Ne.RunCell="jupyter.runcell",Ne.RunCurrentCell="jupyter.runcurrentcell",Ne.RunCurrentCellAdvance="jupyter.runcurrentcelladvance",Ne.CreateNewInteractive="jupyter.createnewinteractive",Ne.ImportNotebookFile="jupyter.importnotebookfile",Ne.ExportFileAsNotebook="jupyter.exportfileasnotebook",Ne.InterruptKernel="jupyter.interruptkernel",Ne.RestartKernel="jupyter.restartkernel",Ne.RestartKernelAndRunAllCells="jupyter.restartkernelandrunallcells",Ne.RestartKernelAndRunUpToSelectedCell="jupyter.restartkernelandrunuptoselectedcell",Ne.NotebookEditorRemoveAllCells="jupyter.notebookeditor.removeallcells",Ne.NotebookEditorRunAllCells="jupyter.notebookeditor.runallcells",Ne.NotebookEditorRunSelectedCell="jupyter.notebookeditor.runselectedcell",Ne.NotebookEditorAddCellBelow="jupyter.notebookeditor.addcellbelow",Ne.ExpandAllCells="jupyter.expandallcells",Ne.CollapseAllCells="jupyter.collapseallcells",Ne.ExecSelectionInInteractiveWindow="jupyter.execSelectionInteractive",Ne.RunFileInInteractiveWindows="jupyter.runFileInteractive",Ne.DebugFileInInteractiveWindows="jupyter.debugFileInteractive",Ne.AddCellBelow="jupyter.addcellbelow",Ne.DebugCurrentCellPalette="jupyter.debugcurrentcell.palette",Ne.DebugCell="jupyter.debugcell",Ne.DebugStepOver="jupyter.debugstepover",Ne.DebugContinue="jupyter.debugcontinue",Ne.DebugStop="jupyter.debugstop",Ne.RunCurrentCellAndAddBelow="jupyter.runcurrentcellandaddbelow",Ne.InsertCellBelowPosition="jupyter.insertCellBelowPosition",Ne.InsertCellBelow="jupyter.insertCellBelow",Ne.InsertCellAbove="jupyter.insertCellAbove",Ne.DeleteCells="jupyter.deleteCells",Ne.SelectCell="jupyter.selectCell",Ne.SelectCellContents="jupyter.selectCellContents",Ne.ExtendSelectionByCellAbove="jupyter.extendSelectionByCellAbove",Ne.ExtendSelectionByCellBelow="jupyter.extendSelectionByCellBelow",Ne.MoveCellsUp="jupyter.moveCellsUp",Ne.MoveCellsDown="jupyter.moveCellsDown",Ne.ChangeCellToMarkdown="jupyter.changeCellToMarkdown",Ne.ChangeCellToCode="jupyter.changeCellToCode",Ne.GotoNextCellInFile="jupyter.gotoNextCellInFile",Ne.GotoPrevCellInFile="jupyter.gotoPrevCellInFile",Ne.ScrollToCell="jupyter.scrolltocell",Ne.CreateNewNotebook="jupyter.createnewnotebook",Ne.ViewJupyterOutput="jupyter.viewOutput",Ne.ExportAsPythonScript="jupyter.exportAsPythonScript",Ne.ExportToHTML="jupyter.exportToHTML",Ne.ExportToPDF="jupyter.exportToPDF",Ne.Export="jupyter.export",Ne.NativeNotebookExport="jupyter.notebookeditor.export",Ne.LatestExtension="jupyter.latestExtension",Ne.EnableLoadingWidgetsFrom3rdPartySource="jupyter.enableLoadingWidgetScriptsFromThirdPartySource",Ne.ShowDataViewer="jupyter.showDataViewer",Ne.ShowJupyterDataViewer="jupyter.showJupyterDataViewer",Ne.RefreshDataViewer="jupyter.refreshDataViewer",Ne.ClearSavedJupyterUris="jupyter.clearSavedJupyterUris",Ne.OpenVariableView="jupyter.openVariableView",Ne.OpenOutlineView="jupyter.openOutlineView",Ne.InteractiveClearAll="jupyter.interactive.clearAllCells",Ne.InteractiveGoToCode="jupyter.interactive.goToCode",Ne.InteractiveCopyCell="jupyter.interactive.copyCell",Ne.InteractiveExportAsNotebook="jupyter.interactive.exportasnotebook",Ne.InteractiveExportAs="jupyter.interactive.exportas",Ne.RunByLine="jupyter.runByLine",Ne.RunAndDebugCell="jupyter.runAndDebugCell",Ne.RunByLineNext="jupyter.runByLineNext",Ne.RunByLineStop="jupyter.runByLineStop",Ne.ReplayPylanceLog="jupyter.replayPylanceLog",Ne.ReplayPylanceLogStep="jupyter.replayPylanceLogStep",Ne.InstallPythonExtensionViaKernelPicker="jupyter.installPythonExtensionViaKernelPicker",Ne.InstallPythonViaKernelPicker="jupyter.installPythonViaKernelPicker",Ne.ContinueEditSessionInCodespace="jupyter.continueEditSessionInCodespace"))(de||(de={}));var Ou;(n=>(n.DefaultDesignLenses=[de.RunCurrentCell,de.RunAllCellsAbove,de.DebugCell],n.DefaultDebuggingLenses=[de.DebugContinue,de.DebugStop,de.DebugStepOver],n.DebuggerCommands=[de.DebugContinue,de.DebugStop,de.DebugStepOver]))(Ou||(Ou={}));var vr;(N=>(N.HasCodeCells="jupyter.hascodecells",N.IsInteractiveActive="jupyter.isinteractiveactive",N.OwnsSelection="jupyter.ownsSelection",N.HaveNativeCells="jupyter.havenativecells",N.HaveNative="jupyter.havenative",N.IsNativeActive="jupyter.isnativeactive",N.IsInteractiveOrNativeActive="jupyter.isinteractiveornativeactive",N.IsPythonOrNativeActive="jupyter.ispythonornativeactive",N.IsPythonOrInteractiveActive="jupyter.ispythonorinteractiveeactive",N.IsPythonOrInteractiveOrNativeActive="jupyter.ispythonorinteractiveornativeeactive",N.CanRestartNotebookKernel="jupyter.notebookeditor.canrestartNotebookkernel",N.CanInterruptNotebookKernel="jupyter.notebookeditor.canInterruptNotebookKernel",N.CanRestartInteractiveWindowKernel="jupyter.interactive.canRestartNotebookKernel",N.CanInterruptInteractiveWindowKernel="jupyter.interactive.canInterruptNotebookKernel",N.RunByLineCells="jupyter.notebookeditor.runByLineCells",N.RunByLineDocuments="jupyter.notebookeditor.runByLineDocuments",N.DebugDocuments="jupyter.notebookeditor.debugDocuments",N.IsPythonNotebook="jupyter.ispythonnotebook",N.IsJupyterKernelSelected="jupyter.kernel.isjupyter",N.IsDataViewerActive="jupyter.dataViewerActive",N.HasNativeNotebookOrInteractiveWindowOpen="jupyter.hasNativeNotebookOrInteractiveWindowOpen",N.ZmqAvailable="jupyter.zmqavailable",N.ReplayLogLoaded="jupyter.replayLogLoaded",N.KernelSource="jupyter.kernelSource"))(vr||(vr={}));var LE;(l=>(l.PythonCellMarker=/^(#\s*%%|#\s*\<codecell\>|#\s*In\[\d*?\]|#\s*In\[ \])/,l.PythonMarkdownCellMarker=/^(#\s*%%\s*\[markdown\]|#\s*\<markdowncell\>)/,l.UrlPatternRegEx="(?<PREFIX>https?:\\/\\/)((\\(.+\\s+or\\s+(?<IP>.+)\\))|(?<LOCAL>[^\\s]+))(?<REST>:.+)",l.HttpPattern=/https?:\/\//,l.ShapeSplitterRegEx=/.*,\s*(\d+).*/,l.SvgHeightRegex=/(\<svg.*height=\")(.*?)\"/,l.SvgWidthRegex=/(\<svg.*width=\")(.*?)\"/,l.SvgSizeTagRegex=/\<svg.*tag=\"sizeTag=\{(.*),\s*(.*)\}\"/))(LE||(LE={}));var sDe=Symbol("DataScienceStartupTime"),dL={major:4,minor:2},mo="application/vnd.jupyter.widget-view+json";var UE=7,mD="unknown";p();p();p();var ese=new Map;function yB(){return ese}p();p();p();var bB=Symbol("MicrotaskDelay");async function nc(r){return new Promise(e=>{setTimeout(()=>e(r),r)})}async function gD(r,e,t){return new Promise(n=>{let i,o=setTimeout(()=>i(!1),e),s=setInterval(()=>{r().then(a=>{a&&i(!0)}).catch(a=>i(!1))},t);i=a=>{clearTimeout(o),clearInterval(s),n(a)}})}function Ui(r,e,...t){let n=hD(e)?void 0:e;hD(e)&&t.push(e);let i,o=setTimeout(()=>i==null?void 0:i(n),r);return Promise.race([Promise.race(t).finally(()=>clearTimeout(o)),new Promise(s=>i=s)])}function Jv(r,e,...t){let n,i=setTimeout(()=>n==null?void 0:n(e),r);return Promise.race([Promise.race(t).finally(()=>clearTimeout(i)),new Promise((o,s)=>n=s)])}function Gv(r){return typeof(r==null?void 0:r.then)=="function"&&typeof(r==null?void 0:r.catch)=="function"}function hD(r){return typeof(r==null?void 0:r.then)=="function"}var pL=class{constructor(e=null){this.scope=e;this._resolved=!1;this._rejected=!1;this._promise=new Promise((t,n)=>{this._resolve=t,this._reject=n})}get value(){return this._value}resolve(e){this._value=e,this._resolve.apply(this.scope?this.scope:this,arguments),this._resolved=!0}reject(e){this._reject.apply(this.scope?this.scope:this,arguments),this._rejected=!0}get promise(){return this._promise}get resolved(){return this._resolved}get rejected(){return this._rejected}get completed(){return this._rejected||this._resolved}};function Oe(r=null){return new pL(r)}function Ka(r){let e=Oe();return r.then(e.resolve.bind(e)).catch(e.reject.bind(e)),e}var qv=class{constructor(){this.currentPromise=Promise.resolve(void 0)}async chain(e){let t=Oe(),n=this.currentPromise;return this.currentPromise=this.currentPromise.then(async()=>{try{let i=await e();t.resolve(i)}catch(i){throw t.reject(i),i}}),await n,t.promise}chainFinally(e){let t=Oe();return this.currentPromise=this.currentPromise.finally(()=>e().then(n=>t.resolve(n)).catch(n=>t.reject(n))),t.promise}};var tse=(r,e)=>{let t=!0,n=setTimeout(()=>{t=!1,e()},r);return{isTriggered:()=>t,dispose:()=>{clearTimeout(n),t=!1}}},rse=r=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,r())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},rc=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,o)=>{this.doResolve=i,this.doReject=o}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let i=this.task;return this.task=null,i()}}),this.completionPromise.catch(E));let n=()=>{var i;this.deferred=null,(i=this.doResolve)==null||i.call(this,null)};return this.deferred=t===bB?rse(n):tse(t,n),this.completionPromise}isTriggered(){var e;return!!((e=this.deferred)!=null&&e.isTriggered())}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.doReject)==null||e.call(this,new Error("Canceled")),this.completionPromise=null)}cancelTimeout(){var e;(e=this.deferred)==null||e.dispose(),this.deferred=null}dispose(){this.cancel()}};function E(){}function zs(r){try{let e=r();Gv(e)&&e.catch(E)}catch(e){}}function ci(r){if(!r)return!1;let e=r;return typeof e.path=="string"&&typeof e.scheme=="string"}function SB(r){let e=ci(r)?r:r.uri;return e.scheme.includes(ec)||e.path.endsWith(".interactive")}function ic(){return process.platform.toString()==="web"||process.browser===!0}function IB(r,e){return ci(e)?e.toString():e}function _B(r,e){return r===e?!0:r&&!e||!r&&e?!1:JSON.stringify(r,IB)===JSON.stringify(e,IB)}p();var bt=class{constructor(){this.started=Date.now()}get elapsedTime(){return Date.now()-this.started}reset(){this.started=Date.now()}};var MDe=yB();function yn(r){return function(e,t,n){let i=n.value,o=`Jupyter Extension (Error in ${r||t}, method:${t}):`;n.value=function(...s){try{let a=i.apply(this,s);if(a&&typeof a.then=="function"&&typeof a.catch=="function")return a.catch(l=>{vn()||C.error(o,l)})}catch(a){if(vn())return;C.error(o,a)}}}}function nse(r,e,t){let n=new bt;try{t&&r(void 0);let i=e();return Gv(i)?i.then(o=>(r({elapsed:n.elapsedTime,returnValue:o}),o)).catch(o=>{r({elapsed:n.elapsedTime,err:o})}):r({elapsed:n.elapsedTime,returnValue:i}),i}catch(i){throw r({elapsed:n.elapsedTime,err:i}),i}}function EB(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){let a={kind:"Class",name:t&&t.constructor?t.constructor.name:"",args:s,methodName:n,target:t},l=this;return nse(u=>r(a,u),()=>o.apply(l,s),e)},i}}function Yv(){return function(r,e,t){let n=t.value;return t.value=function(...i){if(!vn())throw new Error(`Function: ${e} can only be called from test code`);return n.apply(this,i)},t}}function fL(){return function(r,e,t){let n=t.value,i=`chainedPromiseFor_${e}`;return t.value=async function(...o){let s=this[i];s?s=s.then(()=>n.apply(this,o)):s=n.apply(this,o),this[i]=s;let a=s.then(l=>l).catch(l=>{throw this[i]=void 0,l});return a.catch(E),a},t}}p();function mL(r,e){if(Array.isArray(r))return r.map(t=>mL(t,e)).join(", ");if(r===void 0)return"undefined";if(r===null)return"null";try{return r&&r.path?`<Uri:${r.path}>`:JSON.stringify(r)}catch(t){return`<${e} cannot be serialized for logging>`}}function hL(r){if(!r)return"";try{return r.map((t,n)=>{let i=mL(t,"argument");return`Arg ${n+1}: ${i}`}).join(", ")}catch(e){return""}}function CB(r){return`Return Value: ${mL(r,"Return value")}`}function vD(){let r=new Date,e=String(r.getHours()).padStart(2,"0"),t=String(r.getMinutes()).padStart(2,"0"),n=String(r.getSeconds()).padStart(2,"0"),i=String(r.getMilliseconds()).padStart(3,"0");return`${e}:${t}:${n}.${i}`}p();function ct(r,e={removeEmptyEntries:!0,trim:!0}){r=r||"";let t=r.split(/\r?\n/g);return e&&e.trim&&(t=t.map(n=>n.trim())),e&&e.removeEmptyEntries&&(t=t.filter(n=>n.length>0)),t}function ise(r){return r&&(r.indexOf(" ")>=0&&!r.startsWith('"')&&!r.endsWith('"')?`"${r}"`:r.toString())}function gL(r){return r&&ise(r).replace(/\\/g,"/")}function WE(r){return r&&r.replace(/(^['"])|(['"]$)/g,"")}function $v(r){return r?r.replace(/\$\([a-z0-9\-]+?\)/gi,"").trim():r||""}function zv(r){let e=r.split(`
`),t=e.find(n=>n.trim().length>0&&!n.trim().startsWith("#"));if(t){let n=t.match(/^\s*/)[0];return e.map(i=>i.startsWith(n)?i.replace(n,""):i).join(`
`)}return r}p();var wL=require("vscode");p();p();p();var bD="en",SD=!1,_D=!1,VE=!1,ose=!1,sse=!1,yL=!1,ase=!1,lse=!1,cse=!1,yD,ID=bD,use,vp,Qs=typeof self=="object"?self:{},_i,xB,PB;typeof Qs.vscode!="undefined"&&typeof Qs.vscode.process!="undefined"?_i=Qs.vscode.process:typeof process!="undefined"&&typeof((PB=(xB=process)==null?void 0:xB.versions)==null?void 0:PB.node)=="string"&&(_i=process);var DB,TB=typeof((DB=_i==null?void 0:_i.versions)==null?void 0:DB.electron)=="string",dse=TB&&(_i==null?void 0:_i.type)==="renderer";if(typeof _i=="object"){SD=_i.platform==="win32",_D=_i.platform==="darwin",VE=_i.platform==="linux",ose=VE&&!!_i.env.SNAP&&!!_i.env.SNAP_REVISION,ase=TB,cse=!!_i.env.CI||!!_i.env.BUILD_ARTIFACTSTAGINGDIRECTORY,yD=bD,ID=bD;let r=_i.env.VSCODE_NLS_CONFIG;if(r)try{let e=JSON.parse(r),t=e.availableLanguages["*"];yD=e.locale,ID=t||bD,use=e._translationsConfigFile}catch(e){}sse=!0}else typeof navigator=="object"&&!dse?(vp=navigator.userAgent,SD=vp.indexOf("Windows")>=0,_D=vp.indexOf("Macintosh")>=0,lse=(vp.indexOf("Macintosh")>=0||vp.indexOf("iPad")>=0||vp.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,VE=vp.indexOf("Linux")>=0,yL=!0,yD=navigator.language,ID=yD):console.error("Unable to resolve platform.");var vL=0;_D?vL=1:SD?vL=3:VE&&(vL=2);var jE=SD,kB=_D,NB=VE;var ED=yL,VDe=yL&&typeof Qs.importScripts=="function";var oc=vp,gp=ID,wB;(n=>{function r(){return gp}n.value=r;function e(){return gp.length===2?gp==="en":gp.length>=3?gp[0]==="e"&&gp[1]==="n"&&gp[2]==="-":!1}n.isDefaultVariant=e;function t(){return gp==="en"}n.isDefault=t})(wB||(wB={}));var jDe=(()=>{if(typeof Qs.postMessage=="function"&&!Qs.importScripts){let r=[];Qs.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,i=r.length;n<i;n++){let o=r[n];if(o.id===t.data.vscodeScheduleAsyncWork){r.splice(n,1),o.callback();return}}});let e=0;return t=>{let n=++e;r.push({id:n,callback:t}),Qs.postMessage({vscodeScheduleAsyncWork:n},"*")}}return r=>setTimeout(r)})();var pse=!!(oc&&oc.indexOf("Chrome")>=0),BDe=!!(oc&&oc.indexOf("Firefox")>=0),HDe=!!(!pse&&oc&&oc.indexOf("Safari")>=0),qDe=!!(oc&&oc.indexOf("Edg/")>=0),JDe=!!(oc&&oc.indexOf("Android")>=0);var Rm;if(typeof Qs.vscode!="undefined"&&typeof Qs.vscode.process!="undefined"){let r=Qs.vscode.process;Rm={get platform(){return r.platform},get arch(){return r.arch},get env(){return r.env},cwd(){return r.cwd()}}}else typeof process!="undefined"?Rm={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Rm={get platform(){return jE?"win32":kB?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var CD=Rm.cwd,RB=Rm.env,Uo=Rm.platform,QDe=Rm.arch;var mse=65,hse=97,gse=90,vse=122,Ip=46,ui=47,Wo=92,yp=58,yse=63,wD=class extends Error{constructor(e,t,n){let i;typeof t=="string"&&t.indexOf("not ")===0?(i="must not be",t=t.replace(/^not /,"")):i="must be";let o=e.indexOf(".")!==-1?"property":"argument",s=`The "${e}" ${o} ${i} of type ${t}`;s+=`. Received type ${typeof n}`,super(s),this.code="ERR_INVALID_ARG_TYPE"}};function bn(r,e){if(typeof r!="string")throw new wD(e,"string",r)}function Dt(r){return r===ui||r===Wo}function bL(r){return r===ui}function bp(r){return r>=mse&&r<=gse||r>=hse&&r<=vse}function xD(r,e,t,n){let i="",o=0,s=-1,a=0,l=0;for(let u=0;u<=r.length;++u){if(u<r.length)l=r.charCodeAt(u);else{if(n(l))break;l=ui}if(n(l)){if(!(s===u-1||a===1))if(a===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==Ip||i.charCodeAt(i.length-2)!==Ip){if(i.length>2){let c=i.lastIndexOf(t);c===-1?(i="",o=0):(i=i.slice(0,c),o=i.length-1-i.lastIndexOf(t)),s=u,a=0;continue}else if(i.length!==0){i="",o=0,s=u,a=0;continue}}e&&(i+=i.length>0?`${t}..`:"..",o=2)}else i.length>0?i+=`${t}${r.slice(s+1,u)}`:i=r.slice(s+1,u),o=u-s-1;s=u,a=0}else l===Ip&&a!==-1?++a:a=-1}return i}function AB(r,e){if(e===null||typeof e!="object")throw new wD("pathObject","Object",e);let t=e.dir||e.root,n=e.base||`${e.name||""}${e.ext||""}`;return t?t===e.root?`${t}${n}`:`${t}${r}${n}`:n}var kn={resolve(...r){let e="",t="",n=!1;for(let i=r.length-1;i>=-1;i--){let o;if(i>=0){if(o=r[i],bn(o,"path"),o.length===0)continue}else e.length===0?o=CD():(o=RB[`=${e}`]||CD(),(o===void 0||o.slice(0,2).toLowerCase()!==e.toLowerCase()&&o.charCodeAt(2)===Wo)&&(o=`${e}\\`));let s=o.length,a=0,l="",u=!1,c=o.charCodeAt(0);if(s===1)Dt(c)&&(a=1,u=!0);else if(Dt(c))if(u=!0,Dt(o.charCodeAt(1))){let d=2,f=d;for(;d<s&&!Dt(o.charCodeAt(d));)d++;if(d<s&&d!==f){let m=o.slice(f,d);for(f=d;d<s&&Dt(o.charCodeAt(d));)d++;if(d<s&&d!==f){for(f=d;d<s&&!Dt(o.charCodeAt(d));)d++;(d===s||d!==f)&&(l=`\\\\${m}\\${o.slice(f,d)}`,a=d)}}}else a=1;else bp(c)&&o.charCodeAt(1)===yp&&(l=o.slice(0,2),a=2,s>2&&Dt(o.charCodeAt(2))&&(u=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(t=`${o.slice(a)}\\${t}`,n=u,u&&e.length>0)break}return t=xD(t,!n,"\\",Dt),n?`${e}\\${t}`:`${e}${t}`||"."},normalize(r){bn(r,"path");let e=r.length;if(e===0)return".";let t=0,n,i=!1,o=r.charCodeAt(0);if(e===1)return bL(o)?"\\":r;if(Dt(o))if(i=!0,Dt(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){let u=r.slice(l,a);for(l=a;a<e&&Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Dt(r.charCodeAt(a));)a++;if(a===e)return`\\\\${u}\\${r.slice(l)}\\`;a!==l&&(n=`\\\\${u}\\${r.slice(l,a)}`,t=a)}}}else t=1;else bp(o)&&r.charCodeAt(1)===yp&&(n=r.slice(0,2),t=2,e>2&&Dt(r.charCodeAt(2))&&(i=!0,t=3));let s=t<e?xD(r.slice(t),!i,"\\",Dt):"";return s.length===0&&!i&&(s="."),s.length>0&&Dt(r.charCodeAt(e-1))&&(s+="\\"),n===void 0?i?`\\${s}`:s:i?`${n}\\${s}`:`${n}${s}`},isAbsolute(r){bn(r,"path");let e=r.length;if(e===0)return!1;let t=r.charCodeAt(0);return Dt(t)||e>2&&bp(t)&&r.charCodeAt(1)===yp&&Dt(r.charCodeAt(2))},join(...r){if(r.length===0)return".";let e,t;for(let o=0;o<r.length;++o){let s=r[o];bn(s,"path"),s.length>0&&(e===void 0?e=t=s:e+=`\\${s}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof t=="string"&&Dt(t.charCodeAt(0))){++i;let o=t.length;o>1&&Dt(t.charCodeAt(1))&&(++i,o>2&&(Dt(t.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&Dt(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return kn.normalize(e)},relative(r,e){if(bn(r,"from"),bn(e,"to"),r===e)return"";let t=kn.resolve(r),n=kn.resolve(e);if(t===n||(r=t.toLowerCase(),e=n.toLowerCase(),r===e))return"";let i=0;for(;i<r.length&&r.charCodeAt(i)===Wo;)i++;let o=r.length;for(;o-1>i&&r.charCodeAt(o-1)===Wo;)o--;let s=o-i,a=0;for(;a<e.length&&e.charCodeAt(a)===Wo;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===Wo;)l--;let u=l-a,c=s<u?s:u,d=-1,f=0;for(;f<c;f++){let g=r.charCodeAt(i+f);if(g!==e.charCodeAt(a+f))break;g===Wo&&(d=f)}if(f!==c){if(d===-1)return n}else{if(u>c){if(e.charCodeAt(a+f)===Wo)return n.slice(a+f+1);if(f===2)return n.slice(a+f)}s>c&&(r.charCodeAt(i+f)===Wo?d=f:f===2&&(d=3)),d===-1&&(d=0)}let m="";for(f=i+d+1;f<=o;++f)(f===o||r.charCodeAt(f)===Wo)&&(m+=m.length===0?"..":"\\..");return a+=d,m.length>0?`${m}${n.slice(a,l)}`:(n.charCodeAt(a)===Wo&&++a,n.slice(a,l))},toNamespacedPath(r){if(typeof r!="string")return r;if(r.length===0)return"";let e=kn.resolve(r);if(e.length<=2)return r;if(e.charCodeAt(0)===Wo){if(e.charCodeAt(1)===Wo){let t=e.charCodeAt(2);if(t!==yse&&t!==Ip)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(bp(e.charCodeAt(0))&&e.charCodeAt(1)===yp&&e.charCodeAt(2)===Wo)return`\\\\?\\${e}`;return r},dirname(r){bn(r,"path");let e=r.length;if(e===0)return".";let t=-1,n=0,i=r.charCodeAt(0);if(e===1)return Dt(i)?r:".";if(Dt(i)){if(t=n=1,Dt(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Dt(r.charCodeAt(a));)a++;if(a===e)return r;a!==l&&(t=n=a+1)}}}}else bp(i)&&r.charCodeAt(1)===yp&&(t=e>2&&Dt(r.charCodeAt(2))?3:2,n=t);let o=-1,s=!0;for(let a=e-1;a>=n;--a)if(Dt(r.charCodeAt(a))){if(!s){o=a;break}}else s=!1;if(o===-1){if(t===-1)return".";o=t}return r.slice(0,o)},basename(r,e){e!==void 0&&bn(e,"ext"),bn(r,"path");let t=0,n=-1,i=!0,o;if(r.length>=2&&bp(r.charCodeAt(0))&&r.charCodeAt(1)===yp&&(t=2),e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=t;--o){let l=r.charCodeAt(o);if(Dt(l)){if(!i){t=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=o):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(o=r.length-1;o>=t;--o)if(Dt(r.charCodeAt(o))){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(t,n)},extname(r){bn(r,"path");let e=0,t=-1,n=0,i=-1,o=!0,s=0;r.length>=2&&r.charCodeAt(1)===yp&&bp(r.charCodeAt(0))&&(e=n=2);for(let a=r.length-1;a>=e;--a){let l=r.charCodeAt(a);if(Dt(l)){if(!o){n=a+1;break}continue}i===-1&&(o=!1,i=a+1),l===Ip?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":r.slice(t,i)},format:AB.bind(null,"\\"),parse(r){bn(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.length,n=0,i=r.charCodeAt(0);if(t===1)return Dt(i)?(e.root=e.dir=r,e):(e.base=e.name=r,e);if(Dt(i)){if(n=1,Dt(r.charCodeAt(1))){let d=2,f=d;for(;d<t&&!Dt(r.charCodeAt(d));)d++;if(d<t&&d!==f){for(f=d;d<t&&Dt(r.charCodeAt(d));)d++;if(d<t&&d!==f){for(f=d;d<t&&!Dt(r.charCodeAt(d));)d++;d===t?n=d:d!==f&&(n=d+1)}}}}else if(bp(i)&&r.charCodeAt(1)===yp){if(t<=2)return e.root=e.dir=r,e;if(n=2,Dt(r.charCodeAt(2))){if(t===3)return e.root=e.dir=r,e;n=3}}n>0&&(e.root=r.slice(0,n));let o=-1,s=n,a=-1,l=!0,u=r.length-1,c=0;for(;u>=n;--u){if(i=r.charCodeAt(u),Dt(i)){if(!l){s=u+1;break}continue}a===-1&&(l=!1,a=u+1),i===Ip?o===-1?o=u:c!==1&&(c=1):o!==-1&&(c=-1)}return a!==-1&&(o===-1||c===0||c===1&&o===a-1&&o===s+1?e.base=e.name=r.slice(s,a):(e.name=r.slice(s,o),e.base=r.slice(s,a),e.ext=r.slice(o,a))),s>0&&s!==n?e.dir=r.slice(0,s-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},_r={resolve(...r){let e="",t=!1;for(let n=r.length-1;n>=-1&&!t;n--){let i=n>=0?r[n]:CD();bn(i,"path"),i.length!==0&&(e=`${i}/${e}`,t=i.charCodeAt(0)===ui)}return e=xD(e,!t,"/",bL),t?`/${e}`:e.length>0?e:"."},normalize(r){if(bn(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===ui,t=r.charCodeAt(r.length-1)===ui;return r=xD(r,!e,"/",bL),r.length===0?e?"/":t?"./":".":(t&&(r+="/"),e?`/${r}`:r)},isAbsolute(r){return bn(r,"path"),r.length>0&&r.charCodeAt(0)===ui},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){let n=r[t];bn(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":_r.normalize(e)},relative(r,e){if(bn(r,"from"),bn(e,"to"),r===e||(r=_r.resolve(r),e=_r.resolve(e),r===e))return"";let t=1,n=r.length,i=n-t,o=1,s=e.length-o,a=i<s?i:s,l=-1,u=0;for(;u<a;u++){let d=r.charCodeAt(t+u);if(d!==e.charCodeAt(o+u))break;d===ui&&(l=u)}if(u===a)if(s>a){if(e.charCodeAt(o+u)===ui)return e.slice(o+u+1);if(u===0)return e.slice(o+u)}else i>a&&(r.charCodeAt(t+u)===ui?l=u:u===0&&(l=0));let c="";for(u=t+l+1;u<=n;++u)(u===n||r.charCodeAt(u)===ui)&&(c+=c.length===0?"..":"/..");return`${c}${e.slice(o+l)}`},toNamespacedPath(r){return r},dirname(r){if(bn(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===ui,t=-1,n=!0;for(let i=r.length-1;i>=1;--i)if(r.charCodeAt(i)===ui){if(!n){t=i;break}}else n=!1;return t===-1?e?"/":".":e&&t===1?"//":r.slice(0,t)},basename(r,e){e!==void 0&&bn(e,"ext"),bn(r,"path");let t=0,n=-1,i=!0,o;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=0;--o){let l=r.charCodeAt(o);if(l===ui){if(!i){t=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=o):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(o=r.length-1;o>=0;--o)if(r.charCodeAt(o)===ui){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(t,n)},extname(r){bn(r,"path");let e=-1,t=0,n=-1,i=!0,o=0;for(let s=r.length-1;s>=0;--s){let a=r.charCodeAt(s);if(a===ui){if(!i){t=s+1;break}continue}n===-1&&(i=!1,n=s+1),a===Ip?e===-1?e=s:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||n===-1||o===0||o===1&&e===n-1&&e===t+1?"":r.slice(e,n)},format:AB.bind(null,"/"),parse(r){bn(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.charCodeAt(0)===ui,n;t?(e.root="/",n=1):n=0;let i=-1,o=0,s=-1,a=!0,l=r.length-1,u=0;for(;l>=n;--l){let c=r.charCodeAt(l);if(c===ui){if(!a){o=l+1;break}continue}s===-1&&(a=!1,s=l+1),c===Ip?i===-1?i=l:u!==1&&(u=1):i!==-1&&(u=-1)}if(s!==-1){let c=o===0&&t?1:o;i===-1||u===0||u===1&&i===s-1&&i===o+1?e.base=e.name=r.slice(c,s):(e.name=r.slice(c,i),e.base=r.slice(c,s),e.ext=r.slice(i,s))}return o>0?e.dir=r.slice(0,o-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};_r.win32=kn.win32=kn;_r.posix=kn.posix=_r;var Ss=Uo==="win32"?kn.normalize:_r.normalize,ZDe=Uo==="win32"?kn.isAbsolute:_r.isAbsolute,BE=Uo==="win32"?kn.join:_r.join,MB=Uo==="win32"?kn.resolve:_r.resolve,OB=Uo==="win32"?kn.relative:_r.relative,Ei=Uo==="win32"?kn.dirname:_r.dirname,Ht=Uo==="win32"?kn.basename:_r.basename,Sp=Uo==="win32"?kn.extname:_r.extname,eTe=Uo==="win32"?kn.format:_r.format,tTe=Uo==="win32"?kn.parse:_r.parse,rTe=Uo==="win32"?kn.toNamespacedPath:_r.toNamespacedPath,Wi=Uo==="win32"?kn.sep:_r.sep,nTe=Uo==="win32"?kn.delimiter:_r.delimiter;p();var qE=require("vscode");p();p();p();p();var bse=require("vscode");var PD=class{constructor(e){this.computeFn=e;this.lastCache=void 0;this.lastArgKey=void 0}get(e){let t=JSON.stringify(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this.computeFn(e)),this.lastCache}};p();var HE=class r{constructor(e){this.executor=e;this._didRun=!1}hasValue(){return this._didRun}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}map(e){return new r(()=>e(this.getValue()))}};function WB(r,e){return r<e?-1:r>e?1:0}function Ise(r,e,t=0,n=r.length,i=0,o=e.length){for(;t<n&&i<o;t++,i++){let l=r.charCodeAt(t),u=e.charCodeAt(i);if(l<u)return-1;if(l>u)return 1}let s=n-t,a=o-i;return s<a?-1:s>a?1:0}function VB(r,e,t=0,n=r.length,i=0,o=e.length){for(;t<n&&i<o;t++,i++){let l=r.charCodeAt(t),u=e.charCodeAt(i);if(l===u)continue;if(l>=128||u>=128)return Ise(r.toLowerCase(),e.toLowerCase(),t,n,i,o);LB(l)&&(l-=32),LB(u)&&(u-=32);let c=l-u;if(c!==0)return c}let s=n-t,a=o-i;return s<a?-1:s>a?1:0}function LB(r){return r>=97&&r<=122}function jB(r,e){return r.length===e.length&&VB(r,e)===0}function BB(r,e){let t=e.length;return e.length>r.length?!1:VB(r,e,0,t)===0}var sc=class sc{constructor(e){this.confusableDictionary=e}static getInstance(e){return sc.cache.get(Array.from(e))}static getLocales(){return sc._locales.getValue()}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};sc.ambiguousCharacterData=new HE(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}')),sc.cache=new PD(e=>{function t(c){let d=new Map;for(let f=0;f<c.length;f+=2)d.set(c[f],c[f+1]);return d}function n(c,d){let f=new Map(c);for(let[m,g]of d)f.set(m,g);return f}function i(c,d){if(!c)return d;let f=new Map;for(let[m,g]of c)d.has(m)&&f.set(m,g);return f}let o=sc.ambiguousCharacterData.getValue(),s=e.filter(c=>!c.startsWith("_")&&c in o);s.length===0&&(s=["_default"]);let a;for(let c of s){let d=t(o[c]);a=i(a,d)}let l=t(o._common),u=n(l,a);return new sc(u)}),sc._locales=new HE(()=>Object.keys(sc.ambiguousCharacterData.getValue()).filter(e=>!e.startsWith("_")));var KB=sc,Qv=class Qv{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set(Qv.getRawData())),this._data}static isInvisibleCharacter(e){return Qv.getData().has(e)}static get codePoints(){return Qv.getData()}};Qv._data=void 0;var FB=Qv;function _p(r){return r===47||r===92}function IL(r){return r.replace(/[\\/]/g,_r.sep)}function HB(r){return r.indexOf("/")===-1&&(r=IL(r)),/^[a-zA-Z]:(\/|$)/.test(r)&&(r="/"+r),r}function SL(r,e=_r.sep){if(!r)return"";let t=r.length,n=r.charCodeAt(0);if(_p(n)){if(_p(r.charCodeAt(1))&&!_p(r.charCodeAt(2))){let o=3,s=o;for(;o<t&&!_p(r.charCodeAt(o));o++);if(s!==o&&!_p(r.charCodeAt(o+1))){for(o+=1;o<t;o++)if(_p(r.charCodeAt(o)))return r.slice(0,o+1).replace(/[\\/]/g,e)}}return e}else if(Sse(n)&&r.charCodeAt(1)===58)return _p(r.charCodeAt(2))?r.slice(0,2)+e:r.slice(0,2);let i=r.indexOf("://");if(i!==-1){for(i+=3;i<t;i++)if(_p(r.charCodeAt(i)))return r.slice(0,i+1)}return""}function _L(r,e,t,n=Wi){if(r===e)return!0;if(!r||!e||e.length>r.length)return!1;if(t){if(!BB(r,e))return!1;if(e.length===r.length)return!0;let o=e.length;return e.charAt(e.length-1)===n&&o--,r.charAt(o)===n}return e.charAt(e.length-1)!==n&&(e+=n),r.indexOf(e)===0}function Sse(r){return r>=65&&r<=90||r>=97&&r<=122}p();var Fa;(Y=>(Y.inMemory="inmemory",Y.vscode="vscode",Y.internal="private",Y.walkThrough="walkThrough",Y.walkThroughSnippet="walkThroughSnippet",Y.http="http",Y.https="https",Y.file="file",Y.mailto="mailto",Y.untitled="untitled",Y.data="data",Y.command="command",Y.vscodeRemote="vscode-remote",Y.vscodeRemoteResource="vscode-remote-resource",Y.vscodeUserData="vscode-userdata",Y.vscodeCustomEditor="vscode-custom-editor",Y.vscodeNotebook="vscode-notebook",Y.vscodeNotebookCell="vscode-notebook-cell",Y.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",Y.vscodeNotebookCellOutput="vscode-notebook-cell-output",Y.vscodeInteractive="vscode-interactive",Y.vscodeInteractiveInput="vscode-interactive-input",Y.vscodeSettings="vscode-settings",Y.vscodeWorkspaceTrust="vscode-workspace-trust",Y.vscodeTerminal="vscode-terminal",Y.webviewPanel="webview-panel",Y.vscodeWebview="vscode-webview",Y.extension="extension",Y.vscodeFileResource="vscode-file",Y.tmp="tmp",Y.vsls="vsls"))(Fa||(Fa={}));function Ua(r){return ED?(r==null?void 0:r.path)||"":(r==null?void 0:r.fsPath)||""}var JE=class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:WB(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1,i=jE?"\\":"/"){if(e.scheme===t.scheme){if(e.scheme===Fa.file)return _L(Ua(e),Ua(t),this._ignorePathCasing(e),i)&&e.query===t.query&&(n||e.fragment===t.fragment);if(qB(e.authority,t.authority))return _L(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return qE.Uri.joinPath(e,...t)}basenameOrAuthority(e){return di(e)||e.authority}basename(e,t){return _r.basename(e.path,t)}extname(e){return _r.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===Fa.file?t=qE.Uri.file(Ei(Ua(e))).path:(t=_r.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===Fa.file?t=qE.Uri.file(Ss(Ua(e))).path:t=_r.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!qB(e.authority,t.authority))return;if(e.scheme===Fa.file){let o=OB(Ua(e),Ua(t));return jE?IL(o):o}let n=e.path||"/",i=t.path||"/";if(this._ignorePathCasing(e)){let o=0;for(let s=Math.min(n.length,i.length);o<s&&!(n.charCodeAt(o)!==i.charCodeAt(o)&&n.charAt(o).toLowerCase()!==i.charAt(o).toLowerCase());o++);n=i.substr(0,o)+n.substr(o)}return _r.relative(n,i)}resolvePath(e,t){if(e.scheme===Fa.file){let n=qE.Uri.file(MB(Ua(e),t));return e.with({authority:n.authority,path:n.path})}return t=HB(t),e.with({path:_r.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&jB(e,t)}hasTrailingPathSeparator(e,t=Wi){if(e.scheme===Fa.file){let n=Ua(e);return n.length>SL(n).length&&n[n.length-1]===t}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Wi){return JB(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Wi){let n=!1;if(e.scheme===Fa.file){let i=Ua(e);n=i!==void 0&&i.length===SL(i).length&&i[i.length-1]===t}else{t="/";let i=e.path;n=i.length===1&&i.charCodeAt(i.length-1)===47}return!n&&!JB(e,t)?e.with({path:e.path+"/"}):e}},lr=new JE(()=>!1),DTe=new JE(r=>r.scheme===Fa.file?!NB:!0),TTe=new JE(r=>!0),Xs=lr.isEqual.bind(lr),DD=lr.isEqualOrParent.bind(lr),Wa=lr.getComparisonKey.bind(lr),kTe=lr.basenameOrAuthority.bind(lr),di=lr.basename.bind(lr),Xv=lr.extname.bind(lr),Am=lr.dirname.bind(lr),Vi=lr.joinPath.bind(lr),NTe=lr.normalizePath.bind(lr),EL=lr.relativePath.bind(lr),RTe=lr.resolvePath.bind(lr),ATe=lr.isAbsolutePath.bind(lr),qB=lr.isEqualAuthority.bind(lr),JB=lr.hasTrailingPathSeparator.bind(lr),MTe=lr.removeTrailingPathSeparator.bind(lr),OTe=lr.addTrailingPathSeparator.bind(lr),GB;(o=>{o.META_DATA_LABEL="label",o.META_DATA_DESCRIPTION="description",o.META_DATA_SIZE="size",o.META_DATA_MIME="mime";function i(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(c=>{let[d,f]=c.split(":");d&&f&&a.set(d,f)});let u=s.path.substring(0,s.path.indexOf(";"));return u&&a.set(o.META_DATA_MIME,u),a}o.parseMetaData=i})(GB||(GB={}));p();function wi(r=process.platform){return/^win/.test(r)?"Windows":/^darwin/.test(r)?"OSX":/^linux/.test(r)?"Linux":"Unknown"}function TD(r,e){return r.replace(/^~(?=$|\/|\\)/,e)}function Ese(){if(!ic())return wL.Uri.file(require("os").homedir())}function ut(r){let e=wi()==="Windows";if(r){let t=Ua(r);return t&&t.startsWith(Wi)&&t.length>1&&t[1]!==Wi&&e?t.slice(1):t||""}return""}function Ee(r,e=[],t){t=t||Ese();let n;typeof r=="string"&&(n=wL.Uri.file(r)),typeof r!="string"&&(n=r);let i=CL(n,void 0,t),o=e.find(l=>n&&DD(n,l.uri,!0));if(e.length>1&&o)return`${o.name}${Wi}${CL(n,o.uri,t)}`;let s=o?[CL(n,o.uri,t)]:[],a=i;return[i,...s].forEach(l=>{l.length<a.length&&(a=l)}),a}function CL(r,e,t){let n=wi()==="Windows";if(r&&e&&DD(r,e,!0)){let i=EL(e,r);if(i)return n?i.replace(/\//g,"\\"):i}if(r&&t&&DD(r,t,!0)){let i=EL(t,r);if(i)return i=n?i.replace(/\//g,"\\"):i,`~${Wi}${i}`}return ut(r)}p();p();var kD=class{constructor(){this.event=(e,t,n)=>{let i=this.add(t?e.bind(t):e);return n==null||n.push(i),i}}get size(){return this.listeners?typeof this.listeners=="function"?1:this.listeners.length:0}fire(e){if(this.listeners)if(typeof this.listeners=="function")this.listeners(e);else for(let t of this.listeners)t(e)}dispose(){this.listeners=void 0}add(e){return this.listeners?typeof this.listeners=="function"?this.listeners=[this.listeners,e]:this.listeners.push(e):this.listeners=e,{dispose:()=>this.rm(e)}}rm(e){if(!this.listeners)return;if(typeof this.listeners=="function"){this.listeners===e&&(this.listeners=void 0);return}let t=this.listeners.indexOf(e);t!==-1&&(this.listeners.length===2?this.listeners=t===0?this.listeners[1]:this.listeners[0]:this.listeners=this.listeners.slice(0,t).concat(this.listeners.slice(t+1)))}};p();function cr(r){let e=this,t=!1,n;return function(){return t||(t=!0,n=r.apply(e,arguments)),n}}p();var ND;(v=>{function r(k){return k&&typeof k=="object"&&typeof k[Symbol.iterator]=="function"}v.is=r;let e=Object.freeze([]);function t(){return e}v.empty=t;function*n(k){yield k}v.single=n;function i(k){return r(k)?k:n(k)}v.wrap=i;function o(k){return k||e}v.from=o;function s(k){return!k||k[Symbol.iterator]().next().done===!0}v.isEmpty=s;function a(k){return k[Symbol.iterator]().next().value}v.first=a;function l(k,R){for(let P of k)if(R(P))return!0;return!1}v.some=l;function u(k,R){for(let P of k)if(R(P))return P}v.find=u;function*c(k,R){for(let P of k)R(P)&&(yield P)}v.filter=c;function*d(k,R){let P=0;for(let D of k)yield R(D,P++)}v.map=d;function*f(...k){for(let R of k)for(let P of R)yield P}v.concat=f;function m(k,R,P){let D=P;for(let K of k)D=R(D,K);return D}v.reduce=m;function*g(k,R,P=k.length){for(R<0&&(R+=k.length),P<0?P+=k.length:P>k.length&&(P=k.length);R<P;R++)yield k[R]}v.slice=g;function b(k,R=Number.POSITIVE_INFINITY){let P=[];if(R===0)return[P,k];let D=k[Symbol.iterator]();for(let K=0;K<R;K++){let L=D.next();if(L.done)return[P,v.empty()];P.push(L.value)}return[P,{[Symbol.iterator](){return D}}]}v.consume=b})(ND||(ND={}));var RD;function YB(r){RD=r}function Lu(r){return RD==null||RD.push(r),r}function Ce(r){if(ND.is(r)){for(let e of r)if(e)try{e.dispose()}catch(t){console.warn(`dispose() failed for ${e}`,t)}return Array.isArray(r)?[]:r}else if(r)return r.dispose(),r}var OD=class OD{constructor(...e){this._toDispose=new Set;this._isDisposed=!1;e.forEach(t=>this.add(t)),Lu(this)}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Ce(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?OD.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}};OD.DISABLE_DISPOSED_WARNING=!1;var ln=OD,Pr=class{constructor(...e){this._store=new ln;this._isDisposed=!1;e.forEach(t=>this._store.add(t)),Lu(this)}get isDisposed(){return this._isDisposed}dispose(){this._store.dispose(),this._isDisposed=!0}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},ac=class extends Pr{constructor(){super(),this._onDidDispose=new kD,this.onDidDispose=this._onDidDispose.event}dispose(){super.dispose(),this._onDidDispose.fire(),this._onDidDispose.dispose()}};var AD=class{constructor(){this._store=new Map;this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Ce(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get(e){return this._store.get(e)}set(e,t,n=!1){var i;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||(i=this._store.get(e))==null||i.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))==null||t.dispose(),this._store.delete(e)}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var MD=class{constructor(){this.references=new Map}acquire(e,...t){let n=this.references.get(e);n||(n={counter:0,object:this.createReferencedObject(e,...t)},this.references.set(e,n));let{object:i}=n,o=cr(()=>{n&&--n.counter===0&&(this.destroyReferencedObject(e,n.object),this.references.delete(e))});return n.counter++,{object:i,dispose:o}}};p();var V=require("vscode");p();var Ze=require("vscode"),xL=60,PL=xL*60,GE=PL*24,$B=GE*7,zB=GE*30,QB=GE*365;function Zv(r,e,t,n){typeof r!="number"&&(r=r.getTime());let i=Math.round((new Date().getTime()-r)/1e3);if(i<-30)return Ze.l10n.t("in {0}",Zv(new Date().getTime()+i*1e3,!1));if(!n&&i<30)return Ze.l10n.t("now");let o;return i<xL?(o=i,e?o===1?t?Ze.l10n.t("{0} second ago",o):Ze.l10n.t("{0} sec ago",o):t?Ze.l10n.t("{0} seconds ago",o):Ze.l10n.t("{0} secs ago",o):o===1?t?Ze.l10n.t("{0} second",o):Ze.l10n.t("{0} sec",o):t?Ze.l10n.t("{0} seconds",o):Ze.l10n.t("{0} secs",o)):i<PL?(o=Math.floor(i/xL),e?o===1?t?Ze.l10n.t("{0} minute ago",o):Ze.l10n.t("{0} min ago",o):t?Ze.l10n.t("{0} minutes ago",o):Ze.l10n.t("{0} mins ago",o):o===1?t?Ze.l10n.t("{0} minute",o):Ze.l10n.t("{0} min",o):t?Ze.l10n.t("{0} minutes",o):Ze.l10n.t("{0} mins",o)):i<GE?(o=Math.floor(i/PL),e?o===1?t?Ze.l10n.t("{0} hour ago",o):Ze.l10n.t("{0} hr ago",o):t?Ze.l10n.t("{0} hours ago",o):Ze.l10n.t("{0} hrs ago",o):o===1?t?Ze.l10n.t("{0} hour",o):Ze.l10n.t("{0} hr",o):t?Ze.l10n.t("{0} hours",o):Ze.l10n.t("{0} hrs",o)):i<$B?(o=Math.floor(i/GE),e?o===1?Ze.l10n.t("{0} day ago",o):Ze.l10n.t("{0} days ago",o):o===1?Ze.l10n.t("{0} day",o):Ze.l10n.t("{0} days",o)):i<zB?(o=Math.floor(i/$B),e?o===1?t?Ze.l10n.t("{0} week ago",o):Ze.l10n.t("{0} wk ago",o):t?Ze.l10n.t("{0} weeks ago",o):Ze.l10n.t("{0} wks ago",o):o===1?t?Ze.l10n.t("{0} week",o):Ze.l10n.t("{0} wk",o):t?Ze.l10n.t("{0} weeks",o):Ze.l10n.t("{0} wks",o)):i<QB?(o=Math.floor(i/zB),e?o===1?t?Ze.l10n.t("{0} month ago",o):Ze.l10n.t("{0} mo ago",o):t?Ze.l10n.t("{0} months ago",o):Ze.l10n.t("{0} mos ago",o):o===1?t?Ze.l10n.t("{0} month",o):Ze.l10n.t("{0} mo",o):t?Ze.l10n.t("{0} months",o):Ze.l10n.t("{0} mos",o)):(o=Math.floor(i/QB),e?o===1?t?Ze.l10n.t("{0} year ago",o):Ze.l10n.t("{0} yr ago",o):t?Ze.l10n.t("{0} years ago",o):Ze.l10n.t("{0} yrs ago",o):o===1?t?Ze.l10n.t("{0} year",o):Ze.l10n.t("{0} yr",o):t?Ze.l10n.t("{0} years",o):Ze.l10n.t("{0} yrs",o))}p();p();p();p();var C7=ae(he());var ay=class{async createHash(e,t="SHA-256"){return Ha(e,t)}};ay=U([(0,C7.injectable)()],ay);var fT={},E7=!1,mT;typeof window=="object"?mT=window.crypto:typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope?mT=self.crypto:mT=require("node:crypto").webcrypto;async function Ha(r,e){let t=r.includes("/")||r.includes("\\")||r.endsWith(".interactive");if(t&&fT[r])return fT[r];let n=await cde(r,e);return t&&!E7&&(Object.keys(fT).length>1e4&&(E7=!0),fT[r]=n),n}async function cde(r,e){let t=new TextEncoder().encode(r),n=await mT.subtle.digest({name:e},t);return Array.from(new Uint8Array(n)).map(o=>o.toString(16).padStart(2,"0")).join("")}function Km(r){if(typeof r=="string")try{let[e,t,n]=`${r.trim()}...`.split(".").map(i=>parseInt(i,10));return isNaN(e)?"":isNaN(t)?e.toString():isNaN(n)?`${e}.${t}`:`${e}.${t}.${n}`}catch(e){return C.error(`Failed to parse version ${r}`,e),""}return r?`${r.major}.${r.minor}.${r.micro}`:""}async function Rt(r){return Ha(r,"SHA-256")}var lK=ae(sK());var ZE=require("vscode");p();var ot=class extends Error{constructor(t,n){super(n);this.category=t;this.isJupyterError=!0}},Ur=class r extends ot{constructor(t,n,i){super(i||aK(n),t);this.originalException=n;n&&(this.stack=`${new Error("").stack}

${n.stack}`)}static from(t,n){return n instanceof ot?n:new r(t,n)}static unwrap(t){return t&&(t instanceof r&&t.originalException&&t.originalException instanceof ot&&(t=t.originalException),t)}};function aK(r){return r&&r instanceof ot?r.category:"unknown"}function Uu(r){var l,u,c;let e=Ji(r);if(li&&C.ci(`Python Env Info for ${JSON.stringify(r)} is ${JSON.stringify(e)}`),e){let d=[];typeof((l=e.version)==null?void 0:l.major)=="number"&&(d.push(e.version.major.toString()),typeof e.version.minor=="number"&&(d.push(e.version.minor.toString()),typeof e.version.micro=="number"&&d.push(e.version.micro.toString())));let f=d.length?d.join("."):"",m=((u=e.environment)==null?void 0:u.name)||(e.environment?di((c=e.environment)==null?void 0:c.folderUri):""),g=f?`Python ${f}`:"Python";return Pp(r)&&m?m:m?`${m} (${g})`:g}if(Object.keys(r).length===1&&r.id)return r.id;let t=Km(Cc(r)||"").trim(),n=Pp(r),i=t?`Python ${t}`:"Python",o=_s(r);if(n&&o)return o;let s=[];o&&s.push(o);let a=br(r);return a&&a!=="Unknown"&&s.push(a),[i,s.length?`(${s.join(": ")})`:""].join(" ").trim()}function _s(r){var n,i,o;let e=Ji(r),t=(n=e==null?void 0:e.environment)==null?void 0:n.name;return!t&&((i=e==null?void 0:e.environment)!=null&&i.folderUri)&&br(r)==="Conda"&&(t=di((o=e==null?void 0:e.environment)==null?void 0:o.folderUri)),t}var pde=["Unknown","Conda","PipEnv","Poetry","Pyenv","Venv","VirtualEnv","VirtualEnvWrapper"];function br(r){let e=Ji(r);return e?fde(e):"Unknown"}function fde(r){var t,n;if(((t=r.environment)==null?void 0:t.type)==="Conda")return"Conda";let e=[["Conda","Conda"],["Pyenv","Pyenv"],["Pipenv","PipEnv"],["Poetry","Poetry"],["VirtualEnvWrapper","VirtualEnvWrapper"],["VirtualEnv","VirtualEnv"],["Venv","Venv"]];for(let[i,o]of e)if(r.tools.includes(i))return o;if(((n=r.environment)==null?void 0:n.type)==="VirtualEnvironment")return"VirtualEnv";for(let i of pde)if(r.tools.some(o=>o.toLowerCase()===i.toLowerCase()))return i;return"Unknown"}var vo;function w7(r){vo=r}function Pp(r){if(!r||!vo)return!1;let e=Ji(r);return e&&br(e)==="Conda"&&!e.executable.uri}function Ji(r){if(r){if(!vo)throw new Ur("Python API not initialized",void 0,"pythonAPINotInitialized");return typeof r=="string"?vo.environments.known.find(e=>{var t;return e.id===r||e.path===r||((t=e.executable.uri)==null?void 0:t.fsPath)===r}):vo.environments.known.find(e=>e.id===r.id)}}async function cK(r){var n;if(!(r!=null&&r.id))return;if(vo){let i=vo.environments.known.find(o=>o.id===r.id);if((n=i==null?void 0:i.executable)!=null&&n.sysPrefix)return i.executable.sysPrefix}let t=await(await lK.PythonExtension.api()).environments.resolveEnvironment(r.id).then(i=>{var o;return(o=i==null?void 0:i.executable)==null?void 0:o.sysPrefix});return t||C.warn(`Unable to find sysPrefix for interpreter ${Ee(r.id)}`),t}function x7(r){var t;if(!(r!=null&&r.id))return;if(!vo)throw new Ur("Python API not initialized",void 0,"pythonAPINotInitialized");let e=vo.environments.known.find(n=>n.id===r.id);return(t=e==null?void 0:e.executable)==null?void 0:t.sysPrefix}async function Dp(r,e=!1){if(!(r!=null&&r.id))return;if(vo&&!e){let i=vo.environments.known.find(o=>o.id===r.id);if(i!=null&&i.version)return i.version}let n=await(await lK.PythonExtension.api()).environments.resolveEnvironment(r.id);return n!=null&&n.version||C.warn(`Unable to find Version for interpreter ${Ee(r.id)}`),n==null?void 0:n.version}function Cc(r){if(!(r!=null&&r.id))return;if(!vo)throw new Ur("Python API not initialized",void 0,"pythonAPINotInitialized");let e=vo.environments.known.find(t=>t.id===r.id);return e==null?void 0:e.version}function P7(){return vo?vo.environments.known:[]}function hT(r){var n,i;if(!r)return;let e,t=r.id;if(r.executable.uri)e=r.executable.uri;else if(br(r)==="Conda")e=wi()==="Windows"?ZE.Uri.joinPath(((n=r.environment)==null?void 0:n.folderUri)||ZE.Uri.file(r.path),"python.exe"):ZE.Uri.joinPath(((i=r.environment)==null?void 0:i.folderUri)||ZE.Uri.file(r.path),"bin","python");else{C.warn(`Python environment ${Ee(r.id)} excluded as Uri is undefined`);return}return{id:t,uri:e}}function mde(r){return Uu(r)}var Ue;(R=>(R.bannerLabelYes=V.l10n.t("Yes"),R.bannerLabelNo=V.l10n.t("No"),R.canceled=V.l10n.t("Canceled"),R.cancel=V.l10n.t("Cancel"),R.ok=V.l10n.t("Ok"),R.refresh=V.l10n.t("Refresh"),R.refreshing=V.l10n.t("Refreshing..."),R.install=V.l10n.t("Install"),R.downloadAndInstall=V.l10n.t("Download and Install"),R.loadingExtension=V.l10n.t("Jupyter Extension loading..."),R.handleExtensionActivationError=V.l10n.t("Extension activation failed, run the 'Developer: Toggle Developer Tools' command for more information."),R.doNotShowAgain=V.l10n.t("Do not show again"),R.reload=V.l10n.t("Reload"),R.moreInfo=V.l10n.t("More Info"),R.learnMore=V.l10n.t("Learn more"),R.and=V.l10n.t("and"),R.reportThisIssue=V.l10n.t("Report this issue"),R.clickHereForMoreInfoWithHtml=P=>V.l10n.t("Click <a href='{0}'>here</a> for more info.",P)))(Ue||(Ue={}));var Tp;(t=>(t.notInGroup=n=>V.l10n.t("User does not belong to experiment group '{0}'",n),t.inGroup=n=>V.l10n.t("User belongs to experiment group '{0}'",n)))(Tp||(Tp={}));var gT;(e=>e.jupyter=V.l10n.t("Jupyter"))(gT||(gT={}));var D7;(e=>e.currentWorkingDirectory="cwd:")(D7||(D7={}));var T7;(e=>e.bannerMessage=V.l10n.t("Would you like shift-enter to send code to the new Interactive Window experience?"))(T7||(T7={}));var k7;(e=>e.bannerMessage=V.l10n.t("Can you please take a minute to tell us about your notebooks experience in VS Code?"))(k7||(k7={}));var N7;(t=>(t.bannerLabelYes=V.l10n.t("Yes, take survey now"),t.bannerLabelNo=V.l10n.t("No, thanks")))(N7||(N7={}));var W;(J=>(J.warnWhenSelectingKernelWithUnSupportedPythonVersion=V.l10n.t("The version of Python associated with the selected kernel is no longer supported. Please consider selecting a different kernel."),J.installingPythonExtension=V.l10n.t("Installing Python extension and locating kernels."),J.pythonExtensionRequired=V.l10n.t("The Python Extension is required to perform that task. Click Yes to open Python Extension installation page."),J.rendererExtensionRequired=V.l10n.t("The Renderer Extension is required to view IPyWidgets. Click Yes to open Jupyter Notebook Renderer Extension installation page."),J.rendererExtension1015Required=V.l10n.t("The installed version of the Renderer Extension is outdated and requires and update to view IPyWidgets. Click Yes to open Jupyter Notebook Renderer Extension installation page."),J.pythonExtensionInstalled=V.l10n.t("Python Extension is now installed. Some features might not be available until a notebook or interactive window session is restarted."),J.unknownPackage=V.l10n.t("unknown"),J.interactiveWindowTitleFormat=te=>V.l10n.t("Interactive - {0}",te),J.interactiveWindowModeBannerTitle=V.l10n.t({message:"Do you want to open a new Interactive Window for this file? [More Information](command:workbench.action.openSettings?%5B%22jupyter.interactiveWindowMode%22%5D).",args:[],comment:'The string "command:workbench.action.openSettings?%5B%22jupyter.interactiveWindowMode%22%5D" should not be translated. It is a command that opens the settings page with the "jupyter.interactiveWindowMode" setting selected.'}),J.interactiveWindowModeBannerSwitchYes=V.l10n.t("Yes"),J.interactiveWindowModeBannerSwitchNo=V.l10n.t("No"),J.dataExplorerTitle=V.l10n.t("Data Viewer"),J.badWebPanelFormatString=te=>V.l10n.t({message:"<html><body><h1>{0} is not a valid file name</h1></body></html>",args:[te],comment:["Only translate the text within the HTML tags"]}),J.installingMissingDependencies=V.l10n.t("Installing missing dependencies"),J.validatingKernelDependencies=V.l10n.t("Validating kernel dependencies"),J.performingExport=V.l10n.t("Performing Export"),J.exportNotebookToPython=V.l10n.t("Exporting Notebook to Python"),J.sessionDisposed=V.l10n.t("Cannot execute code, session has been disposed. Please try restarting the Kernel."),J.passwordFailure=V.l10n.t("Failed to connect to password protected server. Check that password is correct."),J.incorrectPassword=V.l10n.t("Incorrect Password."),J.exportDialogFilter=V.l10n.t("Jupyter Notebooks"),J.exportDialogComplete=te=>V.l10n.t("Notebook written to {0}",te),J.exportDialogFailed=te=>V.l10n.t("Failed to export notebook. {0}",te),J.exportOpenQuestion1=V.l10n.t("Open in editor"),J.runCellLensCommandTitle=V.l10n.t("Run Cell"),J.importDialogTitle=V.l10n.t("Import Jupyter Notebook"),J.importDialogFilter="Jupyter Notebooks",J.notebookCheckForImportNo=V.l10n.t("Later"),J.libraryRequiredToLaunchJupyterNotInstalled=te=>V.l10n.t("Running cells requires {0} package.",te),J.librariesRequiredToLaunchJupyterNotInstalled=te=>V.l10n.t("Running cells requires {0} package.",te),J.libraryRequiredToLaunchJupyterNotInstalledInterpreter=(te,Qe)=>V.l10n.t("Running cells with '{0}' requires the {1} package.",te,Qe),J.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreter=(te,Qe)=>V.l10n.t("Running cells with '{0}' requires the {1} package.",te,Qe),J.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreterAndRequiresUpdate=(te,Qe)=>V.l10n.t("Running cells with '{0}' requires the {1} package to be installed or requires an update.",te,Qe),J.librariesRequiredToLaunchJupyterNotInstalledInterpreter=(te,Qe)=>V.l10n.t("Running cells with '{0}' requires the {1} package.",te,Qe),J.createANewPythonEnvironment=()=>V.l10n.t("[Create a Python Environment](command:jupyter.createPythonEnvAndSelectController) with the required packages."),J.installPackageInstructions=(te,Qe)=>V.l10n.t(`Install '{0}' into the Python environment. 
Command: '{1}'`,te,Qe),J.OrInstallPackageInstructions=(te,Qe)=>V.l10n.t("Or install '{0}' using the command: '{1}'",te,Qe),J.pythonCondaKernelsWithoutPython=V.l10n.t("The Python Runtime and IPyKernel will be automatically installed upon selecting this environment."),J.selectJupyterInterpreter=V.l10n.t("Select an Interpreter to start Jupyter"),J.jupyterInstall=V.l10n.t("Install"),J.currentlySelectedJupyterInterpreterForPlaceholder=te=>V.l10n.t("Selected Environment {0}",te),J.jupyterNotSupported=te=>V.l10n.t("Jupyter cannot be started. Error attempting to locate Jupyter: {0}",te),J.jupyterNotebookNotInstalledOrNotFound=te=>{if(te){let Qe=mde(te);return V.l10n.t("Failed to start Jupyter Server as the packages 'jupyter' and 'notebook' could not be located in the Python environment '{0}'.",Qe)}else return V.l10n.t("Failed to start Jupyter Server as the packages 'jupyter' and 'notebook' could not be located in the Python environment.")},J.jupyterNotSupportedBecauseOfEnvironment=(te,Qe)=>V.l10n.t("Activating {0} to run Jupyter failed with {1}",te,Qe),J.jupyterNbConvertNotSupported=V.l10n.t("Jupyter nbconvert is not installed"),J.jupyterLaunchTimedOut=V.l10n.t("The Jupyter notebook server failed to launch in time"),J.jupyterLaunchNoURL=V.l10n.t("Failed to find the URL of the launched Jupyter notebook server"),J.jupyterSelfCertFail=te=>V.l10n.t(`The security certificate used by server {0} was not issued by a trusted certificate authority.\r
This may indicate an attempt to steal your information.\r
Do you want to enable the Allow Unauthorized Remote Connection setting for this workspace to allow you to connect?`,te),J.jupyterExpiredCertFail=te=>V.l10n.t(`The security certificate used by server {0} has expired.\r
This may indicate an attempt to steal your information.\r
Do you want to enable the Allow Unauthorized Remote Connection setting for this workspace to allow you to connect?`,te),J.jupyterSelfCertFailErrorMessageOnly=V.l10n.t(`The security certificate used by server was not issued by a trusted certificate authority.\r
This may indicate an attempt to steal your information.`),J.jupyterSelfCertExpiredErrorMessageOnly=V.l10n.t(`The security certificate used by server has expired.\r
This may indicate an attempt to steal your information.`),J.jupyterSelfCertEnable=V.l10n.t("Yes, connect anyways"),J.jupyterSelfCertClose=V.l10n.t("No, close the connection"),J.pythonInteractiveHelpLink=V.l10n.t("See <https://aka.ms/pyaiinstall> for help on installing Jupyter."),J.importingFormat=te=>V.l10n.t("Importing {0}",te),J.startingJupyter=V.l10n.t("Starting Jupyter Server"),J.connectingToKernel=te=>V.l10n.t("Connecting to kernel: {0}",te),J.connectingToJupyter=V.l10n.t("Connecting to Jupyter Server"),J.exportingFormat=te=>V.l10n.t("Exporting {0}",te),J.runAllCellsLensCommandTitle=V.l10n.t("Run All Cells"),J.runAllCellsAboveLensCommandTitle=V.l10n.t("Run Above"),J.runCellAndAllBelowLensCommandTitle=V.l10n.t("Run Below"),J.restartKernelMessage=V.l10n.t("Do you want to restart the Jupyter kernel? All variables will be lost."),J.restartKernelMessageYes=V.l10n.t("Restart"),J.restartKernelMessageDontAskAgain=V.l10n.t("Don't Ask Again"),J.automaticallyReconnectingToAKernelProgressMessage=te=>V.l10n.t("Reconnecting to the kernel {0}",te),J.restartingKernelStatus=te=>V.l10n.t("Restarting Kernel {0}",te),J.interruptingKernelFailed=V.l10n.t("Kernel interrupt failed. Jupyter Server is hung. Please reload VS Code."),J.sessionStartFailedWithKernel=te=>V.l10n.t({message:`Failed to start the Kernel '{0}'. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.failedToStartJupyter=te=>V.l10n.t({message:`Failed to start Jupyter in the environment '{0}'. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.failedToStartJupyterWithErrorInfo=(te,Qe)=>V.l10n.t({message:`Failed to start Jupyter in the environment '{0}'. 
{1} 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te,Qe],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.failedToStartJupyterDueToOutdatedTraitlets=(te,Qe)=>V.l10n.t({message:`Failed to start Jupyter in the environment '{0}' possibly due to an outdated version of 'traitlets'. 
{1} 
Consider updating the 'traitlets' module to '5.1.1' or later. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te,Qe],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the text 'traitlets', that is a Python module name"]}),J.failedToStartKernel=V.l10n.t("Failed to start the Kernel."),J.failedToRestartKernel=V.l10n.t("Failed to restart the Kernel."),J.failedToInterruptKernel=V.l10n.t("Failed to interrupt the Kernel."),J.rawKernelStartFailedDueToTimeout=te=>V.l10n.t({message:`Unable to start Kernel '{0}' due to a connection timeout. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.rawKernelStartFailedDueToTimeoutWaitingForPort=te=>V.l10n.t({message:`Unable to start Kernel '{0}' due to a timeout waiting for the ports to get used. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.viewJupyterLogForFurtherInfo=V.l10n.t({message:"View Jupyter [log](command:jupyter.viewOutput) for further details.",comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.kernelDied=te=>V.l10n.t({message:"The kernel died. Error: {0}... View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.kernelDiedWithoutError=te=>V.l10n.t({message:"The kernel '{0}' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),J.failedToStartAnUntrustedKernelSpec=(te,Qe)=>V.l10n.t({message:`The kernel '{0}' was not started as it is located in an insecure location '{1}'.  
Click [here](https://aka.ms/JupyterTrustedKernelPaths) for further details, optionally update the setting [jupyter.kernels.trusted](command:workbench.action.openSettings?["jupyter.kernels.trusted"]) to trust the kernel.`,args:[te,Qe],comment:['Do not translate the text "jupyter.kernels.trusted", that is a setting in VS Code','Do not translate the text command:workbench.action.openSettings?["jupyter.kernels.trusted"], that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/JupyterTrustedKernelPaths"]}),J.kernelDiedWithoutErrorAndAutoRestarting=te=>V.l10n.t({message:"The kernel '{0}' died and is being automatically restarted by Jupyter. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),J.kernelCrashedDueToCodeInCurrentOrPreviousCell=V.l10n.t({message:`The Kernel crashed while executing code in the current cell or a previous cell. 
Please review the code in the cell(s) to identify a possible cause of the failure. 
Click <a href='https://aka.ms/vscodeJupyterKernelCrash'>here</a> for more info. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),J.kernelDisconnected=te=>V.l10n.t("Unable to connect to the kernel '{0}', please verify the Jupyter Server connection. View Jupyter [log](command:jupyter.viewOutput) for further details.",te),J.cannotRunCellKernelIsDead=te=>V.l10n.t("Cannot run cells, as the kernel '{0}' is dead.",te),J.showJupyterLogs=V.l10n.t("Show Jupyter Logs."),J.restartKernel=V.l10n.t("Restart Kernel"),J.reloadRequired=V.l10n.t("Please reload the window for new settings to take effect."),J.restartedKernelHeader=te=>V.l10n.t("Restarted {0}",te),J.connectedKernelHeader=te=>V.l10n.t("Connected to {0}",te),J.restartingKernelCustomHeader=te=>V.l10n.t("_Restarting {0}..._",te),J.restartingKernelHeader=V.l10n.t("_Restarting kernel..._"),J.startingNewKernelHeader=V.l10n.t("_Connecting to kernel..._"),J.startingNewKernelCustomHeader=te=>V.l10n.t("_Connecting to {0}..._",te),J.noKernelConnected=V.l10n.t("No kernel connected"),J.jupyterSelectUriCommandLabel=V.l10n.t("Enter the URL of the running Jupyter Server..."),J.jupyterSelectUriInputTitle=V.l10n.t("Enter the URL of the running Jupyter Server"),J.jupyterSelectUriInputPlaceholder=V.l10n.t("Enter the URL of the running Jupyter Server"),J.connectToToTheJupyterServer=te=>V.l10n.t("Connect to the Jupyter Server {0}",te),J.enterOrSelectRemoteJupyterPlaceholder=V.l10n.t("Enter a remote URL, or select a remote server"),J.selectRemoteJupyterPlaceholder=V.l10n.t("Select a remote server"),J.jupyterServerLastConnectionForQuickPickDescription=te=>V.l10n.t("Last connected {0}",Zv(te,!0,!1,!1)),J.jupyterServerNotUsedBeforeQuickPickSeparatorTitle=V.l10n.t("Jupyter Servers"),J.jupyterSelectURIInvalidURI=V.l10n.t("Invalid URL specified"),J.jupyterSelectURIMustBeHttpOrHttps=V.l10n.t("Invalid protocol in URL specified, only HTTP or HTTPS are supported."),J.jupyterSelectLiveRemoteKernelDescription=(te,Qe)=>te?Qe===0?V.l10n.t("Last activity {0}",Zv(te,!0,!1,!1)):Qe===1?V.l10n.t("Last activity {0}, 1 connection",Zv(te,!0,!1,!1)):V.l10n.t("Last activity {0}, {1} connections",Zv(te,!0,!1,!1),Qe.toString()):Qe===0?"":Qe===1?V.l10n.t("1 connection"):V.l10n.t("{0} connections",Qe.toString()),J.installJupyterHub=V.l10n.t("Install the JupyterHub extension to connect to JupyterHub servers."),J.useJupyterHubExtension=V.l10n.t("Select 'Existing JupyterHub Server...' from the Kernel Picker"),J.useJupyterHubExtensionDetail=V.l10n.t("Use this option when connecting to JupyterHub servers"),J.installJupyterHubDetail=V.l10n.t("Once installed, open the Kernel Picker and select 'Existing JupyterHub Server...'"),J.jupyterSelectUserAndPasswordTitle=V.l10n.t("Enter your user name and password to connect to Jupyter Hub"),J.jupyterRenameServer=V.l10n.t("Change Server Display Name (Leave Blank To Use URL)"),J.jupyterServerUriDisplayNameInputPlaceholder=V.l10n.t("Enter a display name"),J.jupyterSelectUserPrompt=V.l10n.t("Enter your user name"),J.jupyterSelectPasswordPrompt=V.l10n.t("Enter your password"),J.jupyterSelectPasswordTitle=V.l10n.t("Enter your password for the Jupyter Server"),J.pythonNotInstalled=V.l10n.t(`Python is not installed. 
Please download and install Python in order to execute cells in this notebook. 
Once installed please reload VS Code.`),J.pleaseReloadVSCodeOncePythonHasBeenInstalled=V.l10n.t("Upon installing Python please reload VS Code."),J.jupyterNotebookFailure=te=>V.l10n.t(`Jupyter notebook failed to launch. \r
{0}`,te),J.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid=te=>V.l10n.t("The remote Jupyter Server contributed by the extension '{0}' is no longer available.",te),J.remoteJupyterConnectionFailedWithServerWithError=(te,Qe)=>V.l10n.t("Failed to connect to the remote Jupyter Server '{0}'. Verify the server is running and reachable. ({1}).",te,Qe),J.remoteJupyterConnectionFailedWithServer=te=>V.l10n.t("Failed to connect to the remote Jupyter Server '{0}'. Verify the server is running and reachable.",te),J.remoteJupyterConnectionFailedWithoutServerWithError=te=>V.l10n.t("Connection failure. Verify the server is running and reachable. ({0}).",te),J.remoteJupyterConnectionFailedWithoutServerWithErrorWeb=te=>V.l10n.t(`Connection failure. Verify the server is running and reachable from a browser. ({0}). 
When connecting from vscode.dev Jupyter servers must be started with specific options to connect. 
Click [here](https://aka.ms/vscjremoteweb) for more information.`,te),J.removeRemoteJupyterConnectionButtonText=V.l10n.t("Forget Connection"),J.jupyterNotebookRemoteConnectFailedWeb=te=>V.l10n.t(`Failed to connect to remote Jupyter Server.\r
Check that the Jupyter Server URL can be reached from a browser.\r
{0}. Click [here](https://aka.ms/vscjremoteweb) for more information.`,te),J.packageNotInstalledWindowsLongPathNotEnabledError=(te,Qe)=>V.l10n.t(`Support for Windows Long Path has not been enabled, hence the package {0} could not be installed into the Python Environment '{1}'.
Please ensure that support for Windows Long Path is enabled.
See [here](https://pip.pypa.io/warnings/enable-long-paths) for more information.`,te,Qe),J.changeRemoteJupyterConnectionButtonText=V.l10n.t("Manage Connections"),J.rawConnectionBrokenError=V.l10n.t("Direct kernel connection broken"),J.jupyterServerCrashed=te=>V.l10n.t(`Jupyter Server crashed. Unable to connect. \r
Error code from Jupyter: {0}`,te.toString()),J.jupyterKernelSpecModuleNotFound=te=>V.l10n.t(`'Kernelspec' module not installed in the selected interpreter ({0}).
 Please re-install or update 'jupyter'.`,te),J.interruptKernelStatus=te=>V.l10n.t("Interrupting Kernel {0}",te),J.exportPythonQuickPickLabel=V.l10n.t("Python Script"),J.exportHTMLQuickPickLabel=V.l10n.t("HTML"),J.exportPDFQuickPickLabel=V.l10n.t("PDF"),J.restartKernelAfterInterruptMessage=te=>V.l10n.t("Interrupting the kernel '{0}' timed out. Do you want to restart the kernel instead? All variables will be lost.",te),J.documentMismatch=te=>V.l10n.t("Cannot run cells, duplicate documents for {0} found.",te),J.jupyterGetVariablesBadResults=V.l10n.t("Failed to fetch variable info from the Jupyter Server."),V.l10n.t("Failure to create an 'Interactive' window. Try reinstalling the Python Extension."),J.jupyterGetVariablesExecutionError=te=>V.l10n.t(`Failure during variable extraction: \r
{0}`,te),J.selectKernel=V.l10n.t("Change Kernel"),J.selectDifferentKernel=V.l10n.t("Select a different Kernel"),J.kernelFilterPlaceholder=V.l10n.t("Choose the kernels that are available in the kernel picker."),J.recommendedItemCategoryInQuickPick=V.l10n.t("Recommended"),J.selectedKernelCategoryInQuickPick=V.l10n.t("Selected"),J.createPythonEnvironmentInQuickPick=V.l10n.t("Create Python Environment"),J.createPythonEnvironmentInQuickPickTooltip=V.l10n.t("Create an isolated Python Environment per workspace folder"),J.selectDifferentJupyterInterpreter=V.l10n.t("Change Interpreter"),J.pandasTooOldForViewingFormat=(te,Qe)=>V.l10n.t({message:"Python package 'pandas' is version {0}. Version {1} or greater is required for viewing data.",args:[te,Qe],comment:["Do not translate 'pandas' as that is a Python module name"]}),J.pandasRequiredForViewing=te=>V.l10n.t({message:"Python package 'pandas' version {0} (or above) is required for viewing data.",args:[te],comment:["Do not translate 'pandas' as that is a Python module name"]}),J.tooManyColumnsMessage=V.l10n.t("Variables with over a 1000 columns may take a long time to display. Are you sure you wish to continue?"),J.tooManyColumnsYes=V.l10n.t("Yes"),J.tooManyColumnsNo=V.l10n.t("No"),J.tooManyColumnsDontAskAgain=V.l10n.t("Don't Ask Again"),J.plotViewerTitle=V.l10n.t("Plots"),J.exportPlotTitle=V.l10n.t("Save plot image"),J.pdfFilter="PDF",J.pngFilter="PNG",J.svgFilter="SVG",J.exportImageFailed=te=>V.l10n.t("Error exporting image: {0}",te),J.jupyterDataRateExceeded=V.l10n.t({message:"Cannot view variable because data rate exceeded. Please restart your server with a higher data rate limit. For example, --NotebookApp.iopub_data_rate_limit=10000000000.0",comment:["Do not translate the text --NotebookApp.iopub_data_rate_limit=10000000000.0 as that is a command argument."]}),J.addCellBelowCommandTitle=V.l10n.t("Add cell"),J.debugCellCommandTitle=V.l10n.t("Debug Cell"),J.debugStepOverCommandTitle=V.l10n.t("Step over"),J.debugContinueCommandTitle=V.l10n.t("Continue"),J.debugStopCommandTitle=V.l10n.t("Stop"),J.runCurrentCellAndAddBelow=V.l10n.t("Run current cell and add empty cell below"),J.jupyterDebuggerNotInstalledError=te=>V.l10n.t("Pip module {0} is required for debugging cells. You will need to install it to debug cells.",te),J.jupyterDebuggerOutputParseError=te=>V.l10n.t("Unable to parse {0} output, please log an issue with https://github.com/microsoft/vscode-jupyter",te),J.cellStopOnErrorMessage=V.l10n.t("Cell was canceled due to an error in a previous cell."),J.scrollToCellTitleFormatMessage=te=>V.l10n.t("Go to [{0}]",te.toString()),J.instructionComments=te=>V.l10n.t(`# To add a new cell, type '{0}'
# To add a new markdown cell, type '{0} [markdown]'
`,te),J.exportButtonTitle=V.l10n.t("Export"),J.exportAsQuickPickPlaceholder=V.l10n.t("Export As..."),J.openExportedFileMessage=V.l10n.t("Would you like to open the exported file?"),J.openExportFileYes=V.l10n.t("Yes"),J.openExportFileNo=V.l10n.t("No"),J.exportFailedGeneralMessage=V.l10n.t({message:"Please check the 'Jupyter' [output](command:jupyter.viewOutput) panel for further details.",comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.exportToPDFDependencyMessage=V.l10n.t(`If you have not installed xelatex (TeX), you will need to do so before you can export to PDF. For further instructions, please see https://nbconvert.readthedocs.io/en/latest/install.html#installing-tex. \r
To avoid installing xelatex (TeX), you might want to try exporting to HTML and using your browser's "Print to PDF" feature.`),J.failedExportMessage=V.l10n.t("Export failed."),J.startingJupyterLogMessage=(te,Qe)=>V.l10n.t("Starting Jupyter from {0} with arguments {1}",te,Qe),J.waitingForJupyterSessionToBeIdle=V.l10n.t("Waiting for Jupyter Session to be idle"),J.gettingListOfKernelsForRemoteConnection=V.l10n.t("Fetching Kernels"),J.gettingListOfKernelSpecs=V.l10n.t("Fetching Kernel specs"),J.startingJupyterNotebook=V.l10n.t("Starting Jupyter Notebook"),J.registeringKernel=V.l10n.t("Registering Kernel"),J.jupyterCommandLineReloadQuestion=V.l10n.t("Please reload the window when changing the Jupyter command line."),J.jupyterCommandLineReloadAnswer=V.l10n.t("Reload"),J.createdNewKernel=(te,Qe)=>V.l10n.t("{0}: Kernel started: {1}",te,Qe),J.kernelInvalid=te=>V.l10n.t("Kernel {0} is not usable. Check the Jupyter output tab for more information.",te),J.removeRemoteJupyterServerEntryInQuickPick=V.l10n.t("Remove"),J.loadClassFailedWithNoInternet=(te,Qe)=>V.l10n.t("Error loading {0}:{1}. Internet connection required for loading 3rd party widgets.",te,Qe),J.useCDNForWidgetsNoInformation=V.l10n.t("Widgets require us to download supporting files from a 3rd party website."),J.enableCDNForWidgetsSetting=(te,Qe)=>V.l10n.t("Widgets require us to download supporting files from a 3rd party website. (Error loading {0}:{1}).",te,Qe),J.enableCDNForWidgetsButton=V.l10n.t("Enable Downloads"),J.unhandledMessage=(te,Qe)=>V.l10n.t("Unhandled kernel message from a widget: {0} : {1}",te,Qe),J.cdnWidgetScriptNotAccessibleWarningMessage=(te,Qe)=>V.l10n.t("Unable to download widget '{0}' from 3rd party website {1}, due to network access. Expected behavior may be affected. Click [here](https://aka.ms/PVSCIPyWidgets) for more information.",te,Qe),J.widgetScriptNotFoundOnCDNWidgetMightNotWork=(te,Qe,Joe)=>V.l10n.t("Unable to find widget '{0}' version '{1}' from configured widget sources {2}. Expected behavior may be affected. Click [here](https://aka.ms/PVSCIPyWidgets) for more information.",te,Qe,Joe),J.insecureSessionMessage=V.l10n.t("Connecting over HTTP without a token may be an insecure connection. Do you want to connect to a possibly insecure server?"),J.insecureSessionDenied=V.l10n.t("Denied connection to insecure server."),J.selectKernelForEditor=V.l10n.t("[Select a kernel](command:_notebook.selectKernel) to run cells."),J.needIpykernel6=V.l10n.t("Ipykernel setup required for this feature"),J.setup=V.l10n.t("Setup"),J.showDataViewerFail=V.l10n.t("Failed to create the Data Viewer. Check the Jupyter tab of the Output window for more info."),J.defaultNotebookName=V.l10n.t("default"),J.recommendExtensionForNotebookLanguage=(te,Qe)=>V.l10n.t("The {0} extension is recommended for notebooks targeting the language '{1}'",te,Qe),J.kernelWasNotStarted=V.l10n.t("Kernel was not started. A kernel session is needed to start debugging."),J.noNotebookToDebug=V.l10n.t("No active notebook document to debug."),J.cantStartDebugging=V.l10n.t("Can't start debugging."),J.restartNotSupported=V.l10n.t("Restarting is not supported in the interactive window."),J.importingIpynb=V.l10n.t("Importing notebook file"),J.exportingToFormat=te=>V.l10n.t("Exporting to {0}",te),J.kernelCategoryForJupyterSession=V.l10n.t("Jupyter Session"),J.kernelDefaultRemoteDisplayName=V.l10n.t("Remote"),J.kernelCategoryForJupyterKernel=V.l10n.t("Jupyter Kernel"),J.kernelCategoryForRemoteJupyterKernel=V.l10n.t("Jupyter Kernel"),J.kernelCategoryForConda=V.l10n.t("Conda Env"),J.kernelCategoryForCondaWithoutPython=V.l10n.t("Conda Env Without Python"),J.kernelCategoryForPoetry=V.l10n.t("Poetry Env"),J.kernelCategoryForPipEnv=V.l10n.t("Pipenv Env"),J.kernelCategoryForPyEnv=V.l10n.t("PyEnv Env"),J.kernelCategoryForGlobal=V.l10n.t("Global Env"),J.kernelCategoryForVirtual=V.l10n.t("Virtual Env"),J.fileSeemsToBeInterferingWithKernelStartup=te=>V.l10n.t("The file '{0}' seems to be overriding built in modules and interfering with the startup of the kernel. Consider renaming the file and starting the kernel again.",te),J.moduleSeemsToBeInterferingWithKernelStartup=te=>V.l10n.t("The module '{0}' seems to be overriding built in modules and interfering with the startup of the kernel. Consider renaming the folder and starting the kernel again.",te),J.pipCondaInstallHoverWarning=(te,Qe)=>V.l10n.t("'!{0} install' could install packages into the wrong environment. [More info]({1})",te,Qe),J.percentPipCondaInstallInsteadOfBang=te=>V.l10n.t({message:"Use '%{0} install' instead of '!{0} install'",args:[te],comment:['Do not translate the string within quotes, such as "%{0} install" and "!{0} install" as that is a Jupyter Shell Magic command']}),J.replacePipCondaInstallCodeAction=te=>V.l10n.t("Replace with '%{0} install'",te),J.failedToStartKernelDueToMissingModule=te=>V.l10n.t("The kernel failed to start due to the missing module '{0}'. Consider installing this module.",te),J.failedToStartKernelDueToImportFailure=te=>V.l10n.t("The kernel failed to start as the module '{0}' could not be imported.",te),J.failedToStartKernelDueToImportFailureFromFile=(te,Qe)=>V.l10n.t("The kernel failed to start as '{0}' could not be imported from '{1}'.",te,Qe),J.failedToStartKernelDueToUnknownDllLoadFailure=V.l10n.t("The kernel failed to start as a dll could not be loaded."),J.failedToStartKernelDueToDllLoadFailure=te=>V.l10n.t("The kernel failed to start as the dll '{0}' could not be loaded.",te),J.failedToStartKernelDueToWin32APIFailure=V.l10n.t("The kernel failed to start due to an error with the Win32api module. Consider (re) installing this module."),J.failedToStartKernelDueToPyZmqFailure=V.l10n.t({message:"The kernel failed to start due to an error with the 'pyzmq' module. Consider re-installing this module.",comment:['Do not translate the string "pyzmq" as that is a Python module.']}),J.failedToStartKernelDueToOldIPython=V.l10n.t("The kernel failed to start due to an outdated version of IPython. Consider updating this module to the latest version."),J.failedToStartKernelDueToOldIPyKernel=V.l10n.t("The kernel failed to start due to an outdated version of IPyKernel. Consider updating this module to the latest version."),J.failedToStartKernelDueToMissingPythonEnv=te=>V.l10n.t("The kernel failed to start as the Python Environment '{0}' is no longer available. Consider selecting another kernel or refreshing the list of Python Environments.",te),J.matplotlibWidgetInsteadOfOther=V.l10n.t("'%matplotlib' widget works best inside of VS Code"),J.matplotlibWidgetCodeActionTitle=V.l10n.t("More info"),J.allowExtensionToUseJupyterKernelApi=(te,Qe)=>V.l10n.t("Do you want to give the extension '{0}' access to the Jupyter Kernels? Clicking '{1}' would allow this extension to execute code against the Jupyter Kernels.",te,Qe),J.thanksForUsingJupyterKernelApiPleaseRegisterWithUs=te=>V.l10n.t("Thank you for trying the Jupyter API. Please file an issue on our repo to allow the extension {0} to use this API in production. This would prevent us from breaking your extension when updating the API (as it is still a work in progress).",te),J.activatingPythonEnvironment=te=>V.l10n.t("Activating Python Environment '{0}'",te),J.runningKernelStartupHooksFor=te=>V.l10n.t("Running Kernel startup hooks in '{0}'",te),J.cellAtFormat=(te,Qe)=>V.l10n.t("{0} Cell {1}",te,Qe),J.jupyterServerConsoleOutputChannel=V.l10n.t("Jupyter Server Console"),J.kernelConsoleOutputChannel=te=>V.l10n.t("{0} Kernel Console Output",te),J.webNotSupported=V.l10n.t("Operation not supported in web version of Jupyter Extension."),J.failedToInstallPythonExtension=V.l10n.t("Failed to install the Python Extension."),J.filesPossiblyOverridingPythonModulesMayHavePreventedKernelFromStarting=te=>V.l10n.t("Some of the following files found in the working directory may have prevented the Kernel from starting. Consider renaming them.",te),J.listOfFilesWithLinksThatMightNeedToBeRenamed=te=>V.l10n.t("File(s): {0} might need to be renamed.",te),J.failedToGetVersionOfPandas=V.l10n.t("Failed to get version of Pandas to use the Data Viewer."),J.failedToInstallPandas=V.l10n.t("Failed to install Pandas to use the Data Viewer."),J.localKernelSpecs=V.l10n.t("Jupyter Kernel..."),J.localPythonEnvironments=V.l10n.t("Python Environments..."),J.quickPickTitleForSelectionOfJupyterServer=V.l10n.t("Select a Jupyter Server"),J.UserJupyterServerUrlProviderDisplayName=V.l10n.t("Existing Jupyter Server..."),J.UserJupyterServerUrlProviderDetail=V.l10n.t("Connect to an existing Jupyter Server"),J.kernelPickerSelectKernelTitle=V.l10n.t("Select Kernel"),J.kernelPickerSelectLocalKernelSpecTitle=V.l10n.t("Select a Jupyter Kernel"),J.quickPickSelectPythonEnvironmentTitle=V.l10n.t("Select a Python Environment"),J.kernelPickerSelectKernelFromRemoteTitle=te=>V.l10n.t("Select a Kernel from {0}",te),J.kernelPickerSelectKernelFromRemoteTitleWithoutName=V.l10n.t("Select a Jupyter Kernel"),J.installPythonExtensionViaKernelPickerTitle=V.l10n.t("Install Python Extension"),J.installPythonExtensionViaKernelPickerToolTip=V.l10n.t("Python Extension is required to detect and use Python environments for the execution of code cells."),J.installPythonQuickPickTitle=V.l10n.t("Install Python"),J.installPythonQuickPickToolTip=V.l10n.t("Python Environments not detected. Upon installation reload VS Code or refresh the list of Kernels."),J.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickLabel=V.l10n.t({message:"$(error) Unable to connect to the remote server",comment:"Do not translate the string $(error) as that is a VS Code icon."}),J.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickDetail=V.l10n.t("Ensure the server is running and reachable."),J.dataViewerDeprecationMessage=V.l10n.t("The built-in data viewer will be deprecated soon. Please install other data viewing extensions to keep the ability to inspect data."),J.dataViewerDeprecationRecommendationActionMessage=V.l10n.t("See Recommended Extensions"),J.dataViewerExtensionRequired=V.l10n.t("A Data Viewer Extension is required to view data frames. Click Yes to see recommended extensions."),J.selectExternalDataViewer=V.l10n.t("Select DataFrame Viewer")))(W||(W={}));var Ft;(le=>(le.collapseSingle=V.l10n.t("Collapse"),le.expandSingle=V.l10n.t("Expand"),le.noRowsInDataViewer=V.l10n.t("No rows match current filter"),le.sliceIndexError=V.l10n.t({message:"Index {0} out of range for axis {1} with {2} elements",comment:["Do not translate the strings {0}, {1} and {2} as they are variable names and will be replaced later"]}),le.sliceMismatchedAxesError=V.l10n.t({message:"Expected {0} axes, got {1} in slice expression",comment:["Do not translate the strings {0} and {2} as they are variable names and will be replaced later"]}),le.fetchingDataViewer=V.l10n.t("Fetching data ..."),le.dataViewerHideFilters=V.l10n.t("Hide filters"),le.dataViewerShowFilters=V.l10n.t("Show filters"),le.refreshDataViewer=V.l10n.t("Refresh data viewer"),le.sliceSummaryTitle=V.l10n.t("SLICING"),le.sliceData=V.l10n.t("Slice Data"),le.sliceSubmitButton=V.l10n.t("Apply"),le.sliceDropdownAxisLabel=V.l10n.t("Axis"),le.sliceDropdownIndexLabel=V.l10n.t("Index"),le.variableExplorerNameColumn=V.l10n.t("Name"),le.variableExplorerTypeColumn=V.l10n.t("Type"),le.variableExplorerCountColumn=V.l10n.t("Size"),le.variableExplorerValueColumn=V.l10n.t("Value"),le.collapseVariableExplorerLabel=V.l10n.t("Variables"),le.variableLoadingValue=V.l10n.t("Loading..."),le.showDataExplorerTooltip=V.l10n.t("Show variable snapshot in data viewer"),le.noRowsInVariableExplorer=V.l10n.t("No variables defined"),le.loadingRowsInVariableExplorer=V.l10n.t("Loading variables"),le.previousPlot=V.l10n.t("Previous"),le.nextPlot=V.l10n.t("Next"),le.panPlot=V.l10n.t("Pan"),le.zoomInPlot=V.l10n.t("Zoom in"),le.zoomOutPlot=V.l10n.t("Zoom out"),le.exportPlot=V.l10n.t("Export to different formats"),le.deletePlot=V.l10n.t("Remove"),le.selectedImageListLabel=V.l10n.t("Selected Image"),le.selectedImageLabel=V.l10n.t("Image"),le.errorOutputExceedsLinkToOpenFormatString=V.l10n.t({message:"Output exceeds the <a href={0}>size limit</a>. Open the full output data <a href={1}>in a text editor</a>",comment:['Do not translate the the Hyperlink text "<a href={0}>size limit</a>" and "<a href={1}>in a text editor</a>". However the text inside those tags can be translated']}),le.dvDeprecationWarning=V.l10n.t('The built-in data viewer will be deprecated and no longer usable starting with Visual Studio Code 1.92. Please <a href="command:workbench.extensions.search?%22@tag:jupyterVariableViewers%22">install other data viewing extensions</a> to continue inspecting data')))(Ft||(Ft={}));var ly;(n=>(n.SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE=V.l10n.t({message:"The setting 'python.formatting.formatOnSave' is deprecated, please use 'editor.formatOnSave'.",comment:['Do not translate the string "python.formatting.formatOnSave" as that is a setting in VS Code','Do not translate the string "editor.formatOnSave" as that is a setting in VS Code']}),n.SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE=V.l10n.t({message:"The setting 'python.linting.lintOnTextChange' is deprecated, please enable 'python.linting.lintOnSave' and 'files.autoSave'.",comment:['Do not translate the string "python.linting.lintOnTextChange" as that is a setting in VS Code','Do not translate the string "python.linting.lintOnSave" as that is a setting in VS Code']}),n.SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES=V.l10n.t({message:"The setting 'python.autoComplete.preloadModules' is deprecated, please consider using Pylance Language Server ('python.languageServer' setting).",comment:['Do not translate the string "python.autoComplete.preloadModules" as that is a setting in VS Code','Do not translate the string "python.languageServer" as that is a setting in VS Code']})))(ly||(ly={}));var R7;(n=>(n.noCondaOrPipInstaller=V.l10n.t("There is no Conda or Pip installer available in the selected environment."),n.noPipInstaller=V.l10n.t("There is no Pip installer available in the selected environment."),n.searchForHelp=V.l10n.t("Search for help")))(R7||(R7={}));var A7;(e=>e.installingModule=t=>V.l10n.t("Installing {0}",t))(A7||(A7={}));p();var O7=uK(),vT=class{constructor(e,t,n){this.channel=e;this.homeReplaceRegEx=t,this.userNameReplaceRegEx=n}format(e,t,...n){let i=e?`${vD()} [${e}] ${O7(t,...n)}`:O7(t,...n);return this.homeReplaceRegEx&&(i=i.replace(this.homeReplaceRegEx,"~")),this.userNameReplaceRegEx&&(i=i.replace(this.userNameReplaceRegEx,"<username>")),i}error(e,...t){this.channel.appendLine(this.format("error",e,...t))}warn(e,...t){this.channel.appendLine(this.format("warn",e,...t))}info(e,...t){this.channel.appendLine(this.format("info",e,...t))}debug(e,...t){this.channel.appendLine(this.format("debug",e,...t))}trace(e,...t){this.channel.appendLine(this.format("trace",e,...t))}ci(e,...t){}};p();var L7=uK();function eC(r,e,...t){let i=[...t].length===0?L7(e):L7(e,...t);return r?`${r} ${vD()}: ${i}`:i}var yT=class{constructor(e){this.prefix=e}error(e,...t){console.error(eC("error",`${this.prefix||""} ${e}`,...t))}warn(e,...t){console.warn(eC("warn",`${this.prefix||""} ${e}`,...t))}info(e,...t){console.info(eC("info",`${this.prefix||""} ${e}`,...t))}debug(e,...t){console.log(eC("debug",`${this.prefix||""} ${e}`,...t))}trace(e,...t){console.trace(eC("trace",`${this.prefix||""} ${e}`,...t))}ci(e,...t){}};var dK="",vde=3,kp=[],Np=hr.LogLevel.Info,C={error:(r,...e)=>yde(r,...e),warn:(r,...e)=>j7(r,...e),info:(r,...e)=>bde(r,...e),debug:(r,...e)=>Ide(r,...e),trace:(r,...e)=>Sde(r,...e),ci:(r,...e)=>{e&&Array.isArray(e)?U7(r,...e):U7(r)}};function W7(r){Np=F7(),Lu(hr.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("jupyter.logging")&&(Np=F7())}));let e=hr.window.createOutputChannel(gT.jupyter,"log");return K7(new vT(e,r==null?void 0:r.homePathRegEx,r==null?void 0:r.userNameRegEx)),r.addConsoleLogger&&K7(new yT(li?void 0:"Jupyter Extension:")),e}function K7(r){return kp.push(r),{dispose:()=>{kp=kp.filter(e=>e!==r)}}}function F7(){try{let{level:r}=hr.workspace.getConfiguration("jupyter").get("logging",{level:"Info"});switch(r){case"debug":case"Debug":return hr.LogLevel.Debug;case"warn":case"Warn":case"warning":case"Warning":return hr.LogLevel.Warning;case"Off":case"off":return hr.LogLevel.Off;case"Error":case"error":return hr.LogLevel.Error;case"Trace":case"trace":return hr.LogLevel.Trace;default:return hr.LogLevel.Info}}catch(r){return console.error("Failed to get logging level from configuration",r),hr.LogLevel.Info}}function V7(...r){return Np<=hr.LogLevel.Debug?r:r.map(t=>{if(!(t instanceof Error)||!("isJupyterError"in t))return t;let n=[`${t.name}: ${t.message}`.trim()];if("kernelConnectionMetadata"in t&&t.kernelConnectionMetadata&&typeof t.kernelConnectionMetadata=="object"&&"id"in t.kernelConnectionMetadata&&(n.push(`Kernel Id = ${t.kernelConnectionMetadata.id}`),"interpreter"in t.kernelConnectionMetadata&&t.kernelConnectionMetadata.interpreter&&typeof t.kernelConnectionMetadata.interpreter=="object"&&"id"in t.kernelConnectionMetadata.interpreter&&typeof t.kernelConnectionMetadata.interpreter.id=="string"&&n.push(`Interpreter Id = ${Ee(t.kernelConnectionMetadata.interpreter.id)}`)),t.stack){let o=ct(t.stack),s=o.find(a=>a.indexOf("at ")===0);o.length===1||(o.length===1?n.push(o[0]):o.length>1&&(s!=null&&s.length)?n.push(s):n.push(o[0]))}let i=["stack","message","name","kernelConnectionMetadata","category","exitCode","isJupyterError"];return Object.keys(t).filter(o=>i.indexOf(o)===-1).forEach(o=>n.push(`${o} = ${String(t[o]).trim()}`)),n.filter(o=>o.trim().length).map((o,s)=>s===0?o:`    > ${o}`).join(`
`)})}function yde(r,...e){Np<=hr.LogLevel.Error&&(e=V7(...e),kp.forEach(t=>t.error(r,...e)))}function j7(r,...e){Np<=hr.LogLevel.Warning&&(e=V7(...e),kp.forEach(t=>t.warn(r,...e)))}function bde(r,...e){Np<=hr.LogLevel.Info&&kp.forEach(t=>t.info(r,...e))}function Ide(r,...e){Np<=hr.LogLevel.Debug&&kp.forEach(t=>t.debug(r,...e))}function Sde(r,...e){Np<=hr.LogLevel.Trace&&kp.forEach(t=>t.trace(r,...e))}function U7(r,...e){if(li)if(typeof r=="function"){let n=r(),i="",o=[];typeof n=="string"?i=n:(i=n.shift(),o=n),C.info(i,...o)}else C.info(r,...e)}function B7(r,e=vde){return _de({message:r,opts:e,level:hr.LogLevel.Debug})}var Wu=new WeakMap;function fK(r){return(e,t,n)=>{Wu.has(e)||Wu.set(e,new Map);let i=Wu.get(e);i||Wu.set(e,i=new Map),i.has(t)||i.set(t,[]),i.get(t).push({parameterIndex:n,propertyOfParameterToLog:r})}}function H7(){return(r,e,t)=>{Wu.has(r)||Wu.set(r,new Map);let n=Wu.get(r);n||Wu.set(r,n=new Map),n.has(e)||n.set(e,[]),n.get(e).push({parameterIndex:t,ignore:!0})}}function _de(r){return EB((e,t)=>Pde(r,t,e),(r.opts&4)>0)}function Ede(r){let{kind:e,name:t,args:n}=r;return(!e||e==="")&&(e="Function"),(!t||t==="")&&(t="<anon>"),n||(n=[]),{kind:e,name:t,args:n,methodName:r.methodName||"",target:r.target||void 0}}function Cde(r){if(!r)return!1;let e=r;return typeof e.path=="string"&&typeof e.scheme=="string"}function pK(r){let e=dK?r.toLowerCase().indexOf(dK):-1;return e===-1?r:`~${r.substring(e+dK.length)}`}function wde(r,e,t,n){var a;if(Cde(t))return pK(t.path);if(!t)return t;let i=(a=Wu.get(r))==null?void 0:a.get(e),o=i==null?void 0:i.find(l=>l.parameterIndex===n);if(!o)return typeof t=="string"?pK(t):t;if("ignore"in o&&o.ignore)return"";let s=t;return"propertyOfParameterToLog"in o&&o.propertyOfParameterToLog&&(s=t[o.propertyOfParameterToLog]),typeof s=="string"?pK(s):s}function xde(r,e,t){t=Ede(t);let n=[r.message];return n.push(`${t.kind} name = ${t.name}`.trim()),e?(n.push(`completed in ${e.elapsed}ms`),n.push(`has a ${e.returnValue?"truthy":"falsy"} return value`)):n[n.length-1]=`${n[n.length-1]} (started execution)`,(r.opts&1)===1&&(r.level===hr.LogLevel.Debug?n.push(hL(t.args.map((i,o)=>t?wde(t.target,t.methodName,i,o):i))):n.push(hL(t.args))),e&&(r.opts&2)===2&&n.push(CB(e.returnValue)),n.join(", ")}function Pde(r,e,t){let n=xde(r,e,t);e?e.err===void 0?r.level&&r.level===hr.LogLevel.Error||(r.level?bT(r.level,n):bT(hr.LogLevel.Info,n)):bT(hr.LogLevel.Error,n,e.err):r.level&&r.level!==hr.LogLevel.Error&&bT(r.level,n)}function bT(r,e,...t){switch(r){case hr.LogLevel.Error:C.error(e,...t);break;case hr.LogLevel.Warning:j7(e,...t);break;case hr.LogLevel.Info:C.info(e,...t);break;case hr.LogLevel.Debug:case hr.LogLevel.Trace:C.debug(e,...t);break;default:break}}var Zl=require("vscode");p();var gj=require("vscode");p();var q7=Symbol("IsDevMode"),Um=Symbol("IOutputChannel"),J7=Symbol("IS_WINDOWS"),ve=Symbol("IDisposableRegistry"),Et=Symbol("IGlobalMemento"),rr=Symbol("IGlobalMemento"),Es=Symbol("IWorkspaceMemento");var IT=Symbol("IPersistentStateFactory"),i1e=Symbol("IRandom"),Ke=Symbol("IConfigurationService"),st=Symbol("ExtensionContext"),qa=Symbol("IExtensions"),o1e=Symbol("IJupyterExtensionBanner"),ST=Symbol("IFeaturesManager"),cy=Symbol("ICryptoUtils"),Vu=Symbol("IAsyncDisposableRegistry");var uy=Symbol("IExperimentService"),_T=Symbol("IDataScienceCommandListener"),dy=Symbol("IVariableScriptGenerator"),py=Symbol("IDataFrameScriptGenerator");p();var NR=require("vscode");p();var i8=ae(n8()),tC=ae(he());try{(0,tC.decorate)((0,tC.injectable)(),i8.EventEmitter)}catch(r){C.warn("Failed to decorate EventEmitter for DI (possibly already decorated by another Extension)",r)}var et=class{constructor(e){this.container=e;et._instance=this}static get instance(){return et._instance}get(e,t){return t?this.container.getNamed(e,t):this.container.get(e)}getAll(e,t){return t?this.container.getAllNamed(e,t):this.container.getAll(e)}tryGet(e,t){try{return t?this.container.getNamed(e,t):this.container.get(e)}catch(n){}}};et=U([(0,tC.injectable)()],et);p();p();var dt=require("vscode");p();var my=Symbol("IPythonApi"),bo=Symbol("IPythonExtensionChecker");var Ca=ae(he());p();p();p();var hK="Python Kernel Debug Adapter",gK="Python Interactive Window Debug Adapter";p();p();var wT=ae(s8()),iC=ae(a8());p();p();var gy=require("vscode");p();var Rp=class extends ot{constructor(t,n,i){super("jupyterconnection",t+(n?`
${n}`:""));this.interpreter=i}};p();var Qr=class extends ot{constructor(){super("sessionDisposed",W.sessionDisposed)}};function c8(r=""){let e=u8(r);return e?e[1]:void 0}function u8(r=""){if(!r)return;let e=r.trim().split(`
`).map(t=>t.trim()).filter(t=>t.trim().length).reverse();if(e.length!==0&&e[0].includes("Error"))return[e.length>1?e[1]:"",e[0]]}function d8(r){if(!r)return;let t=(Array.isArray(r)?r[0]:r).split(`
`).map(l=>l.trim().toLowerCase()).filter(l=>l.length).reverse().find(l=>l.startsWith("file ")&&l.includes(", line ")&&l.includes(".py")&&l.includes(".py"));if(!t)return;let i=(t.substring(0,t.lastIndexOf(".py"))+".py").replace(/\\/g,"/").split("/"),o=i.indexOf("site-packages"),s=o>=0&&i.length>o+1?i[o+1]:"",a=i.reverse();if(!(a.length<2))return{fileName:a[0],folderName:a[1],packageName:s}}function Wm(r,e,t,n="",i=[]){let o=e instanceof ot?e.stdErr||e.stack||"":e.toString(),s=u8(o),a=o.toLowerCase();if(e instanceof Qr)return{reason:"sessionDisposed",message:W.sessionDisposed,moreInfoLink:"https://aka.ms/kernelDisposedCannotRunCell",telemetrySafeTags:["deadSession"]};if(a.includes("ImportError: No module named 'win32api'".toLowerCase()))return{reason:"importWin32apiFailure",message:W.failedToStartKernelDueToWin32APIFailure,moreInfoLink:"https://aka.ms/kernelFailuresWin32Api",telemetrySafeTags:["win32api"]};if(a.includes("ImportError: DLL load failed".toLowerCase())&&a.includes("win32api"))return{reason:"importWin32apiFailure",message:W.failedToStartKernelDueToWin32APIFailure,moreInfoLink:"https://aka.ms/kernelFailuresWin32Api",telemetrySafeTags:["dll.load.failed","win32api"]};if(a.includes("ImportError: DLL load failed".toLowerCase())){let c=s&&s[0].toLowerCase().startsWith("import")?s[0].substring(6).trim():void 0;return{reason:"dllLoadFailure",moduleName:c,message:c?W.failedToStartKernelDueToDllLoadFailure(c):W.failedToStartKernelDueToUnknownDllLoadFailure,moreInfoLink:"https://aka.ms/kernelFailuresDllLoad",telemetrySafeTags:["dll.load.failed"]}}if(a.includes("AssertionError: Couldn't find Class NSProcessInfo".toLowerCase()))return{reason:"oldIPythonFailure",message:W.failedToStartKernelDueToOldIPython,moreInfoLink:"https://aka.ms/kernelFailuresOldIPython",telemetrySafeTags:["oldipython"]};if(a.includes("NotImplementedError".toLowerCase())&&a.includes("asyncio".toLowerCase())&&a.includes("events.py".toLowerCase()))return{reason:"oldIPyKernelFailure",message:W.failedToStartKernelDueToOldIPyKernel,moreInfoLink:"https://aka.ms/kernelFailuresOldIPyKernel",telemetrySafeTags:["oldipykernel"]};{let c=[];if(a.includes("ImportError: cannot import name".toLowerCase())&&a.includes("from partially initialized module".toLowerCase())&&a.includes("zmq.backend.cython".toLowerCase())&&c.push("zmq.backend.cython"),a.includes("zmq".toLowerCase())&&a.includes("cython".toLowerCase())&&a.includes("__init__.py".toLowerCase())&&c.push("zmq.cython"),a.includes("zmq.error.ZMQError")&&c.push("zmq.error"),c.length)return{reason:"zmqModuleFailure",message:W.failedToStartKernelDueToPyZmqFailure,moreInfoLink:"https://aka.ms/kernelFailuresPyzmq",telemetrySafeTags:c}}if(s&&s[1].toLowerCase().startsWith("importerror")){let c=l8(s[1]);if(c&&n){let d=Kde(c.moduleName,c.fileName,r,n);return d||{reason:"importFailure",moduleName:c.moduleName,fileName:c.fileName,message:c.fileName?W.failedToStartKernelDueToImportFailureFromFile(c.moduleName,c.fileName):W.failedToStartKernelDueToImportFailure(c.moduleName),moreInfoLink:c.fileName?"https://aka.ms/kernelFailuresModuleImportErrFromFile":"https://aka.ms/kernelFailuresModuleImportErr",telemetrySafeTags:["import.error"]}}}let l="No module named".toLowerCase(),u="is not a package".toLowerCase();if(a.includes(l)&&!u){let c=ct(o).map(f=>f.trim()).filter(f=>f.length).find(f=>f.toLowerCase().includes(l)),d=c?c.substring(c.toLowerCase().indexOf(l)+l.length).trim():"";if(c)return{reason:"moduleNotFound",moduleName:d,message:W.failedToStartKernelDueToMissingModule(d),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}else if(a.includes(l)&&u){let c=ct(o).map(b=>b.trim()).filter(b=>b.length).find(b=>b.toLowerCase().includes(l)),d=c?c.substring(c.toLowerCase().indexOf(l)+l.length).trim():"",f="",m="";d.split("'").length>2&&(f=d.split("'").slice(-2)[0]||"",f=f?`${f}.py`:"",m=f||"",d=d.split("'")[1]||d);let g=i.filter(b=>di(b).toLowerCase()==="__init__.py").map(b=>di(Am(b)));return d&&f&&d!==f&&i.some(b=>di(b).toLowerCase()===f.toLowerCase())?{reason:"overridingBuiltinModules",fileName:f,moduleName:d,message:W.fileSeemsToBeInterferingWithKernelStartup(f),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}:d&&g&&d!==m&&g.some(b=>b.toLowerCase()===m.toLowerCase())?{reason:"overridingBuiltinModules",folderName:m,moduleName:d,message:W.moduleSeemsToBeInterferingWithKernelStartup(m),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}:{reason:"moduleNotFound",moduleName:d,message:W.failedToStartKernelDueToMissingModule(d),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}else if(e instanceof ot&&e.category==="invalidkernel"&&i.length){let c=di(i[0]);return{reason:"overridingBuiltinModules",fileName:c,moduleName:di(i[0],".py"),message:W.fileSeemsToBeInterferingWithKernelStartup(c),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}}else if(s&&s[1].toLowerCase().startsWith("ModuleNotFoundError".toLowerCase())){let c=l8(s[1]);if(c)return{reason:"moduleNotFound",moduleName:c.moduleName,message:W.failedToStartKernelDueToMissingModule(c.moduleName),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}if(e instanceof Rp){let c=ct(o).map(v=>v.trim()).reverse().find(v=>v.toLowerCase().includes("error: ")),d="AttributeError: 'Namespace' object has no attribute '_flags'",f=["jupyter.startup.failure"],m,g="jupyterStartFailure",b=ct(e.message,{removeEmptyEntries:!0,trim:!0}).reverse().find(v=>v.toLowerCase().includes("error: "));if(b=b||ct(e.stdErr||"",{removeEmptyEntries:!0,trim:!0}).reverse().find(v=>v.toLowerCase().includes("error: ")),a.includes(d.toLowerCase())?(g="jupyterStartFailureOutdatedTraitlets",c=W.failedToStartJupyterDueToOutdatedTraitlets(t||"",b||""),f.push("outdated.traitlets"),m="https://aka.ms/kernelFailuresJupyterTrailtletsOutdated"):(c=b?W.failedToStartJupyterWithErrorInfo(t||"",b):W.failedToStartJupyter(t||""),m=void 0),c)return{reason:g,message:c,pythonError:b,moreInfoLink:m,telemetrySafeTags:f}}}function l8(r){r=r.replace(/"/g,"'");let e=r.match(/'[^\\']*(\\'[^\\']*)*'/g),t=r.match(/\((.*?)\)/g),n,i;return e&&e[0].length>2&&(n=e[0],n=n.substring(1,n.length-1)),t&&t[0].length>2&&(i=t[0],i=i.substring(1,i.length-1)),n?{moduleName:n,fileName:i}:void 0}function Kde(r,e,t,n){if(n&&t.length!==0&&e&&!e.toLowerCase().startsWith(n)&&t.some(i=>e.toLowerCase().startsWith(i.uri.fsPath.toLowerCase())))return{reason:"overridingBuiltinModules",fileName:e,moduleName:r,message:W.fileSeemsToBeInterferingWithKernelStartup(Ee(gy.Uri.file(e),t||[])),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}}function vy(r){if(!r)return;let e=/\[([^\[\]]*)\]\((.*?)\)/gm,t;for(;(t=e.exec(r))!==null;)t.length===3&&(r=r.replace(t[0],`<a href='${t[2]}'>${t[1]}</a>`));let n=ct(r,{removeEmptyEntries:!1,trim:!1}).map(i=>`\x1B[1;31m${i}`).join(`
`);return new gy.NotebookCellOutput([gy.NotebookCellOutputItem.error({message:"",name:"",stack:n})])}var Fde=[Ude,Wde];function p8(r){let e=[],t=Array.isArray(r)?r[0].toLowerCase():r.toLowerCase();Fde.forEach(i=>i(t,e));let n=Wm([],t,void 0);return n!=null&&n.telemetrySafeTags.length&&e.push(...n.telemetrySafeTags),Array.from(new Set(e)).join(",")}function Ude(r,e=[]){r.includes("ChildProcess.exithandler".toLowerCase())&&e.push("childproc.exit")}function Wde(r,e=[]){r.includes("KernelRestarter: restart failed".toLowerCase())&&e.push("KernelRestarter.failed")}function f8(){return(new Error().stack||"").split(`
`).filter(r=>r.includes(Ge))}async function m8(r,e){r.failed=!0,r.failureCategory=r.failureCategory||aK(e);let t=!wT.FetchError&&(e==null?void 0:e.name)==="TypeError"&&(e==null?void 0:e.message)==="Failed to fetch",i=(t||wT.FetchError!==void 0)&&Bde(e,t?TypeError:wT.FetchError);r.failureCategory==="unknown"&&i&&(r.failureCategory="fetcherror"),r.stackTrace=Vde(e),typeof e=="string"&&(r.failureSubCategory="errorisstring");let o=e.stdErr?e.stdErr:e.stack||"";if(!o)return;r.failureSubCategory=r.failureSubCategory||p8(o);let s=d8(o);s&&([r.pythonErrorFile,r.pythonErrorFolder,r.pythonErrorPackage]=await Promise.all([Promise.resolve(r.pythonErrorFile||Rt(s.fileName)),Promise.resolve(r.pythonErrorFolder||Rt(s.folderName)),Promise.resolve(r.pythonErrorPackage||Rt(s.packageName))]))}function vK(r){if(r.stack&&Array.isArray(r.stack)){let e={...r,stack:r.stack.join(`
`)};return iC.parse.call(iC,e)}return iC.parse.call(iC,r)}function Vde(r){let e="";for(let t of vK(r)){let n=t.getFileName();if(n){let i=t.getLineNumber(),o=t.getColumnNumber();e+=`
	at ${jde(t)} ${n}:${i}:${o}`}else e+=`
	at <anonymous>`}return e.trim().replace(/\\/g,"/")}function jde(r){let e=[];return typeof r.getTypeName()=="string"&&r.getTypeName().length>0&&e.push(r.getTypeName()),typeof r.getMethodName()=="string"&&r.getMethodName().length>0&&e.push(r.getMethodName()),typeof r.getFunctionName()=="string"&&r.getFunctionName().length>0&&(e.length!==2||e.join(".")!==r.getFunctionName())&&e.push(r.getFunctionName()),e.join(".")}function Bde(r,e){return e?r instanceof e||r instanceof Ur&&r.originalException instanceof e:(console.error("Error type is not defined",r),!1)}var RN=require("vscode");function Pge(){try{return require("vscode")===void 0?!1:FG()!==void 0}catch(r){return!1}}function MN(){return RN.workspace.getConfiguration("telemetry").inspect("enableTelemetry").globalValue===!1}function ON(r){return RN.workspace.onDidChangeConfiguration(e=>{if(!e.affectsConfiguration("telemetry"))return;let n=RN.workspace.getConfiguration("telemetry").inspect("enableTelemetry").globalValue===!1;r(n)})}var AN={};function Gb(r,e){let t=r;FE()&&t.startsWith("ds_")||(e===void 0?delete AN[t]:AN[t]=e)}var S2;function FG(){if(S2)return S2;let r=(OG(),cL(MG)).default;return S2=new r(dB)}function LG(r,e){let t={};return Object.getOwnPropertyNames(e).forEach(n=>{if(!(e[n]===void 0||e[n]===null))try{t[n]=typeof e[n]=="string"?e[n]:typeof e[n]=="object"?"object":e[n].toString()}catch(i){C.error(`Failed to serialize ${n} for ${r}`,i)}}),t}function ne(r,e,t,n){!UG(r.toString())&&(vn()||!Pge())||Dge(r,e,t,n)}function UG(r){return r==="DATASCIENCE.JUPYTER_NOTEBOOK_EDIT_PERFORMANCE"||r==="DATASCIENCE.JUPYTER_JUPYTER_NOTEBOOK_EXEC_PERFORMANCE"||r==="DATASCIENCE.JUPYTER_NOTEBOOK_EXEC_PERFORMANCE"}function Dge(r,e,t,n){let i=FG(),o={},s=r;n?(o={},Object.assign(o,AN),Object.assign(o,t||{}),m8(o,n).then(()=>{o=LG(s,o),i.sendTelemetryEvent(s,o,e)}).catch(E)):(t&&(o=LG(s,t)),Object.assign(o,AN),UG(s)?i.sendDangerousTelemetryEvent(s,o,e):i.sendTelemetryEvent(s,o,e))}var KG=new Set;function Nr(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){let a=e||{},l=new bt,u=`${r.toString()}${JSON.stringify(a)}`,c=!KG.has(u);KG.add(u);let d=o.apply(this,s);return d&&typeof d.then=="function"&&typeof d.catch=="function"?d.then(f=>{let m={...a};return c&&(m.firstTime=c),ne(r,l?{duration:l==null?void 0:l.elapsedTime}:void 0,m),f}).catch(f=>{let m={...a};m.failed=!0,ne(r,l?{duration:l==null?void 0:l.elapsedTime}:{},m,f)}):ne(r,l?{duration:l==null?void 0:l.elapsedTime}:void 0,a),d},i}}function Vn(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){return ne(r,void 0,e),o.apply(this,s)},i}}function Tge(){return{isInsiderExtension:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether this is the Insider version of the Jupyter extension or not. Common to all events."},isPythonExtensionInstalled:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether Python extension is installed or not. Common to all events."},rawKernelSupported:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether the raw kernel is supported or not. Common to all events."}}}function at(){return{duration:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth",isMeasurement:!0}}}function os(){return{resourceType:{classification:"PublicNonPersonalData",comment:"",purpose:"FeatureInsight"}}}function kd(){return{failed:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},failureCategory:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},failureSubCategory:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorFile:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorFolder:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorPackage:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},stackTrace:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"}}}function ro(){return{properties:{actionSource:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},disableUI:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},userExecutedCell:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},resourceHash:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},pythonEnvironmentVersion:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentType:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentPath:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentPackages:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelSessionId:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelLanguage:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelConnectionType:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},isUsingActiveInterpreter:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},capturedEnvVars:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},newKernelPicker:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},...os()}}}var w5e={...at(),...kd(),...Tge()};var VG,jG,BG,HG,qG,JG,GG,YG,$G,zG,QG,XG,ZG,eY,tY,rY,nY,iY,oY,sY,aY,lY,cY,uY,dY,pY,fY,mY,hY,gY,vY,yY,bY,IY,SY,_Y,EY,CY,wY,xY,PY,DY,TY,kY,NY,RY,AY,MY,OY,LY,KY,FY,UY,WY,VY,jY,BY,HY,qY,JY,GY,YY,$Y,zY,QY,XY,ZY,e$,t$,r$,n$,i$,o$,s$,a$,l$,c$,u$,d$,p$,f$,m$,h$,g$,v$,y$,b$,I$,S$,_$,E$,C$,w$,x$,P$,D$,T$,k$,N$,R$,A$,M$,O$,L$,K$,F$,U$,W$,V$,j$,B$,H$,q$,J$,G$,Y$,$$,z$,Q$,X$,Z$,ez,tz,rz,nz,iz,oz,sz,az,lz,cz,uz,dz,pz,fz,mz,hz,gz,vz,yz,bz,Iz,Sz,_z,Ez,Cz,wz,xz,Pz,Dz,Tz,kz,Nz,Rz,Az,Mz,Oz,Lz,Kz,Fz,Uz,Wz,Vz,jz,Bz,Hz;Hz="EXTENSION.LOAD",Bz="DS_INTERNAL.EXPERIMENT_LOAD",jz="ENVFILE_VARIABLE_SUBSTITUTION",Vz="ENVFILE_WORKSPACE",Wz="HASHED_PACKAGE_NAME",Uz="DS_INTERNAL.ACTIVE_INTERPRETER_LISTING_PERF",Fz="DS_INTERNAL.CELL_OUTPUT_MIME_TYPE",Kz="DS_INTERNAL.GET_ACTIVATED_ENV_VARIABLES",Lz="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_REQUEST_EX",Oz="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_ERROR_EX",Mz="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_SUCCESS_EX",Az="DATASCIENCE.ADD_CELL_BELOW",Rz="DS_INTERNAL.CODE_LENS_ACQ_TIME",Nz="DS_INTERNAL.DOCUMENT_WITH_CODE_CELLS",kz="DATASCIENCE.DEBUG_CONTINUE",Tz="DATASCIENCE.DEBUG_CURRENT_CELL",Dz="DATASCIENCE.DEBUG_STEP_OVER",Pz="DATASCIENCE.DEBUG_STOP",xz="DATASCIENCE.DEBUG_FILE_INTERACTIVE",wz="DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",Cz="DS_INTERNAL.JUPYTER_KERNEL_SPEC",Ez="DATASCIENCE.ENTER_REMOTE_JUPYTER_URL",_z="DATASCIENCE.DISABLE_INTERACTIVE_SHIFT_ENTER",Sz="DATASCIENCE.ENABLE_INTERACTIVE_SHIFT_ENTER",Iz="DS_INTERNAL.PERCEIVED_JUPYTER_STARTUP_NOTEBOOK",bz="DATASCIENCE.EXPORT_PYTHON_FILE",yz="DATASCIENCE.EXPORT_PYTHON_FILE_AND_OUTPUT",vz="DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",gz="DATASCIENCE.EXPORT_NOTEBOOK_AS",hz="DATASCIENCE.IMPORT_NOTEBOOK",mz="DATASCIENCE.EXPORT_NOTEBOOK_AS_COMMAND",fz="DATASCIENCE.EXPORT_NOTEBOOK_AS_FAILED",pz="DS_INTERNAL.GET_PASSWORD_FAILURE",dz="DS_INTERNAL.GET_PASSWORD_SUCCESS",uz="DS_INTERNAL.JUPYTER_HUB_PASSWORD",cz="DS_INTERNAL.SHOW_DATA_NO_PANDAS",lz="DS_INTERNAL.SHOW_DATA_PANDAS_TOO_OLD",az="DS_INTERNAL.SHOW_DATA_PANDAS_OK",sz="DS_INTERNAL.SHOW_DATA_PANDAS_INSTALL_CANCELED",oz="DATASCIENCE.NATIVE.OPEN_NOTEBOOK_ALL",iz="DATASCIENCE.OPEN_PLOT_VIEWER",nz="DATASCIENCE.RUN_ALL_CELLS",rz="DATASCIENCE.RUN_SELECTION_OR_LINE",tz="DATASCIENCE.RUN_CURRENT_CELL",ez="DATASCIENCE.RUN_ALL_CELLS_ABOVE",Z$="DATASCIENCE.RUN_CELL_AND_ALL_BELOW",X$="DATASCIENCE.RUN_CURRENT_CELL_AND_ADVANCE",Q$="DATASCIENCE.RUN_FILE_INTERACTIVE",z$="DATASCIENCE.RUN_TO_LINE",$$="DATASCIENCE.RUN_FROM_LINE",Y$="DATASCIENCE.RUN_INSERT_CELL_BELOW_POSITION",G$="DATASCIENCE.RUN_INSERT_CELL_BELOW",J$="DATASCIENCE.RUN_INSERT_CELL_ABOVE",q$="DATASCIENCE.RUN_DELETE_CELLS",H$="DATASCIENCE.RUN_SELECT_CELL",B$="DATASCIENCE.RUN_SELECT_CELL_CONTENTS",j$="DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_ABOVE",V$="DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_BELOW",W$="DATASCIENCE.RUN_MOVE_CELLS_UP",U$="DATASCIENCE.RUN_MOVE_CELLS_DOWN",F$="DATASCIENCE.RUN_CHANGE_CELL_TO_MARKDOWN",K$="DATASCIENCE.RUN_CHANGE_CELL_TO_CODE",L$="DATASCIENCE.GOTO_NEXT_CELL_IN_FILE",O$="DATASCIENCE.GOTO_PREV_CELL_IN_FILE",M$="DATASCIENCE.RUN_CURRENT_CELL_AND_ADD_BELOW",A$="DATASCIENCE.SELFCERTSMESSAGECLOSE",R$="DATASCIENCE.SELFCERTSMESSAGEENABLED",N$="DATASCIENCE.USER_INSTALLED_JUPYTER",k$="DATASCIENCE.USER_INSTALLED_PANDAS",T$="DATASCIENCE.USER_DID_NOT_INSTALL_JUPYTER",D$="DATASCIENCE.USER_DID_NOT_INSTALL_PANDAS",P$="DS_INTERNAL.PYTHON_NOT_INSTALLED",x$="DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",w$="DS_INTERNAL.PYTHON_EXTENSION_INSTALLED_VIA_KERNEL_PICKER",C$="DS_INTERNAL.PYTHON_MODULE_INSTALL",E$="DS_INTERNAL.SHIFTENTER_BANNER_SHOWN",_$="DATASCIENCE.START_SHOW_DATA_EXPLORER",S$="DATASCIENCE.SHOW_DATA_EXPLORER",I$="DATASCIENCE.SHOW_DATA_EXPLORER_ROWS_LOADED",b$="DATASCIENCE.FAILED_SHOW_DATA_EXPLORER",y$="DATASCIENCE.REFRESH_DATA_VIEWER",v$="DS_INTERNAL.JUPYTER_ZMQ_SUPPORT",g$="DS_INTERNAL.JUPYTER_ZMQ_SUPPORT_FAILURE",h$="DS_INTERNAL.VARIABLE_EXPLORER_FETCH_TIME",m$="DS_INTERNAL.VARIABLE_EXPLORER_VARIABLE_COUNT",f$="DATASCIENCE.KERNEL_SPEC_LANGUAGE",p$="DS_INTERNAL.KERNEL_LAUNCHER_PERF",d$="GLOBAL_PYTHON_KERNELSPEC",u$="DS_INTERNAL.NEW_FILE_USED_IN_INTERACTIVE",c$="DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",l$="DS_INTERNAL.IPYWIDGET_USED_BY_USER",a$="DS_INTERNAL.IPYWIDGET_DISCOVER_WIDGETS_NB_EXTENSIONS",s$="DS_INTERNAL.IPYWIDGET_DISCOVERY_ERRORED",o$="DS_INTERNAL.IPYWIDGET_LOAD_SUCCESS",i$="DS_INTERNAL.IPYWIDGET_LOAD_FAILURE",n$="DS_INTERNAL.IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED_LOAD_FAILURE",r$="DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN",t$="DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN_SELECTION",e$="DS_INTERNAL.IPYWIDGET_RENDER_FAILURE",ZY="DS_INTERNAL.IPYWIDGET_UNHANDLED_MESSAGE",XY="DS_INTERNAL.RAWKERNEL_INFO_RESPONSE",QY="DS_INTERNAL.RAWKERNEL_PROCESS_LAUNCH",zY="DATASCIENCE.EXECUTE_CELL",$Y="DATASCIENCE.EXECUTE_CODE",YY="DATASCIENCE.RESUME_EXECUTE_CELL",GY="DATASCIENCE.NOTEBOOK_START",JY="DS_INTERNAL.SWITCH_KERNEL",qY="DATASCIENCE.NOTEBOOK_INTERRUPT",HY="DATASCIENCE.NOTEBOOK_RESTART",BY="DS_INTERNAL.RAWKERNEL_SESSION_NO_IPYKERNEL",jY="DS_INTERNAL.RAWKERNEL_SESSION_KERNEL_PROCESS_EXITED",VY="DATASCIENCE.NOTEBOOK_FIRST_START_BREAKDOWN",WY="DATASCIENCE.NOTEBOOK_FIRST_KERNEL_AUTO_SELECTION_BREAKDOWN",UY="DS_INTERNAL.RAWKERNEL_SESSION_SHUTDOWN",FY="DS_INTERNAL.RAWKERNEL_SESSION_DISPOSED",KY="DATASCIENCE.RUN_BY_LINE_VARIABLE_HOVER",LY="DS_INTERNAL.KERNEL_COUNT",OY="DS_INTERNAL.VSCNOTEBOOK_CELL_TRANSLATION_FAILED",MY="DS_INTERNAL.INTERACTIVE_FILE_TOOLTIPS_PERF",AY="DS_INTERNAL.NATIVE_VARIABLE_VIEW_LOADED",RY="DS_INTERNAL.NATIVE_VARIABLE_VIEW_MADE_VISIBLE",NY="DATAVIEWER.WEBVIEW_LOADED",kY="PLOTVIEWER.WEBVIEW_LOADED",TY="DS_INTERNAL.COMMAND_EXECUTED",DY="DATASCIENCE.DATA_VIEWER_SLICE_ENABLEMENT_STATE_CHANGED",PY="DATASCIENCE.DATA_VIEWER_DATA_DIMENSIONALITY",xY="DATASCIENCE.DATA_VIEWER_SLICE_OPERATION",wY="DATASCIENCE.CREATE_PYTHON_ENVIRONMENT",CY="DATASCIENCE.RECOMMENT_EXTENSION",EY="DATASCIENCE.DEBUGGING.CLICKED_ON_SETUP",_Y="DATASCIENCE.DEBUGGING.CLOSED_MODAL",SY="DATASCIENCE.DEBUGGING.IPYKERNEL6_STATUS",IY="DATASCIENCE.DEBUGGING.CLICKED_RUNBYLINE",bY="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUNBYLINE",yY="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_IW_JUPYTER",vY="DATASCIENCE.DEBUGGING.CLICKED_RUN_AND_DEBUG_CELL",gY="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL",hY="DATASCIENCE.DEBUGGING.ENDED_SESSION",mY="DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",fY="DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION_CANNOT_RESOLVE",pY="DATASCIENCE.JUPYTER_KERNEL_API_USAGE",dY="DATASCIENCE.JUPYTER_URI_CAN_BE_PARSED_AS_URI",uY="DATASCIENCE.JUPYTER_NEW_KERNEL_API_USAGE",cY="DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",lY="DATASCIENCE.JUPYTER_NEW_KERNEL_API_EXEC",aY="DATASCIENCE.JUPYTER_NEW_KERNEL_API_KERNEL_STARTUP_WAIT_UNTIL",sY="DATASCIENCE.JUPYTER_API_USAGE",oY="DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",iY="DATASCIENCE.JUPYTER_KERNEL_STARTUP_HOOK",nY="DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE",rY="DATASCIENCE.INTERACTIVE_WINDOW_DEBUG_SETUP_CODE_FAILURE",tY="DATASCIENCE.KERNEL_CRASH",eY="DATASCIENCE.JUPYTER_KERNEL_HIDDEN_VIA_FILTER",ZG="DATASCIENCE.JUPYTER_KERNEL_FILTER_USED",XG="DS_INTERNAL.RUNTEST",QG="DS_INTERNAL.PREFERRED_KERNEL_EXACT_MATCH",zG="DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",$G="DS_INTERNAL.IPYWIDGET_TIME_TO_COPY_NBEXTENSIONS_DIR",YG="DATASCIENCE.NO_ACTIVE_KERNEL_SESSION",GG="DATAVIEWER.USING_INTERPRETER",JG="DATAVIEWER.USING_KERNEL",qG="DATASCIENCE.JUPYTER_NOTEBOOK_EXEC_PERFORMANCE",HG="DATASCIENCE.JUPYTER_JUPYTER_NOTEBOOK_EXEC_PERFORMANCE",BG="DATASCIENCE.JUPYTER_NOTEBOOK_EDIT_PERFORMANCE",jG="InvokeTool",VG="DATASCIENCE.JUPYTER_CONFIGURE_NOTEBOOK_TOOL_CALL";var WG=class{constructor(){this[Hz]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{totalActivateTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},codeLoadingTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},workspaceFolderCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[Bz]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:at()};this[jz]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Vz]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Wz]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{hashedNamev2:{classification:"SystemMetaData",purpose:"FeatureInsight"},when:{classification:"SystemMetaData",purpose:"FeatureInsight"},...os()}};this[Uz]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{firstTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:at()};this[Fz]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{mimeType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},when:{classification:"SystemMetaData",purpose:"FeatureInsight"},...os()}};this[Kz]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{envType:{classification:"SystemMetaData",purpose:"FeatureInsight"},failed:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},source:{classification:"SystemMetaData",purpose:"FeatureInsight"}},measures:at()};this[Lz]={owner:"IanMatthewHuff",source:"User Action",feature:["DataFrameViewer","VariableViewer"]};this[Oz]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer","VariableViewer"]};this[Mz]={owner:"IanMatthewHuff",source:"User Action",feature:["DataFrameViewer","VariableViewer"]};this[Az]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action",measures:at()};this[Rz]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action",measures:at()};this[Nz]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:{codeLensUpdateTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},maxCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[kz]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Tz]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Dz]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Pz]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[xz]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[wz]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{...kd(),failed:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Reason for failure to fetch kernel specs"},sessionManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},specsManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasSessionManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasSpecsManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:at()};this[Cz]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},serverIdHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},providerExtensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"},baseUrlHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelId:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelConnectionType:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelLanguage:{classification:"SystemMetaData",purpose:"FeatureInsight"},envType:{classification:"SystemMetaData",purpose:"FeatureInsight"},isArgv0SameAsInterpreter:{classification:"SystemMetaData",purpose:"FeatureInsight"},argv0:{classification:"SystemMetaData",purpose:"FeatureInsight"},argv:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Ez]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{serverIdHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},baseUrlHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},failed:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},isLocalHost:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},isJupyterHub:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},reason:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[_z]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Sz]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Iz]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:ro().properties,measures:{...at()}};this[bz]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action"};this[yz]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action"};this[vz]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[gz]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"N/A",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"},cancelled:{classification:"SystemMetaData",purpose:"FeatureInsight"},successful:{classification:"SystemMetaData",purpose:"FeatureInsight"},opened:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[hz]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"User Action",properties:{scope:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[mz]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"User Action",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[fz]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"N/A",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[pz]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[dz]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[uz]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},info:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[cz]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[lz]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[az]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[sz]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[oz]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{nbformat:{classification:"PublicNonPersonalData",isMeasurement:!0,purpose:"FeatureInsight"},nbformat_minor:{classification:"PublicNonPersonalData",isMeasurement:!0,purpose:"FeatureInsight"}}};this[iz]={owner:"IanMatthewHuff",feature:["PlotViewer"],source:"User Action"};this[nz]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[rz]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[tz]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[ez]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Z$]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[X$]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Q$]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[z$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[$$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[Y$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[G$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[J$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[q$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[H$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[B$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[j$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[V$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[W$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[U$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[F$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[K$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[L$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[O$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[M$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:at()};this[A$]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[R$]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[N$]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"]};this[k$]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[T$]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"]};this[D$]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[P$]={owner:"IanMatthewHuff",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[x$]={owner:"donjayamanne",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[w$]={owner:"donjayamanne",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[C$]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"},isModulePresent:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},moduleName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pythonEnvType:{classification:"SystemMetaData",purpose:"FeatureInsight"},resourceHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},...os()},measures:at()};this[E$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[_$]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",measures:at()};this[S$]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer"],measures:{rows:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0},columns:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0}}};this[I$]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer"],measures:{rowsTimer:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[b$]={owner:"amunger",feature:["DataFrameViewer","VariableViewer"],source:"N/A",properties:{reason:{classification:"SystemMetaData",purpose:"FeatureInsight"},fromVariableView:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[y$]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action"};this[v$]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},fallbackTried:{classification:"SystemMetaData",purpose:"FeatureInsight"},alpine:{classification:"SystemMetaData",purpose:"FeatureInsight"},zmqarch:{classification:"SystemMetaData",purpose:"FeatureInsight"},libc:{classification:"SystemMetaData",purpose:"FeatureInsight"},armv:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_version_id:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[g$]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},fallbackTried:{classification:"SystemMetaData",purpose:"FeatureInsight"},alpine:{classification:"SystemMetaData",purpose:"FeatureInsight"},zmqarch:{classification:"SystemMetaData",purpose:"FeatureInsight"},libc:{classification:"SystemMetaData",purpose:"FeatureInsight"},armv:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_version_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},errorMessage:{classification:"CallstackOrException",purpose:"FeatureInsight"},fallbackErrorMessage:{classification:"CallstackOrException",purpose:"FeatureInsight"},zmqBinaries:{classification:"CallstackOrException",purpose:"FeatureInsight"}}};this[h$]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:at()};this[m$]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:{variableCount:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0}}};this[f$]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{kind:{classification:"SystemMetaData",purpose:"FeatureInsight"},language:{classification:"SystemMetaData",purpose:"FeatureInsight"},usesShell:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[p$]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{...kd(),...os()},measures:{...at()}};this[d$]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelConnectionType:{classification:"SystemMetaData",purpose:"FeatureInsight"},pythonPathDefined:{classification:"SystemMetaData",purpose:"FeatureInsight"},pythonEnvFound:{classification:"SystemMetaData",purpose:"FeatureInsight"},language:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},argv0:{classification:"SystemMetaData",purpose:"FeatureInsight"},isCreatedByUs:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[u$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[c$]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",properties:{hasKernel:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"If the kernel was known at the time of creation"},hasOwner:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"If the window was created for a text file"},mode:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Creation mode: multiple, perfile or single"},restored:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Was the window restored from a previous session"}},measures:{windowCount:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Number of active interactive windows the user has open",isMeasurement:!0}}};this[l$]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{cdnSearched:{classification:"SystemMetaData",purpose:"FeatureInsight"},hashedName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},source:{classification:"SystemMetaData",purpose:"FeatureInsight"},moduleName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},modelName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[a$]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{type:{classification:"SystemMetaData",purpose:"FeatureInsight"}},measures:at()};this[s$]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[o$]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[i$]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{timedout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},isOnline:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[n$]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[r$]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[t$]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{selection:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[e$]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[ZY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{msg_type:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[XY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],measures:{...at(),attempts:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}},properties:{...ro().properties,timedout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[QY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],measures:at()};this[zY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Cell Execution"],measures:{...at()},properties:{...ro().properties,...kd()}};this[$Y]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Code Execution"],measures:at(),properties:{...ro().properties,...kd(),extensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[YY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Cell Execution"],properties:{...ro().properties,...kd()}};this[GY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],properties:{...ro().properties,...kd()}};this[JY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:ro().properties};this[qY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",properties:{result:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},...os(),...kd(),...ro().properties},measures:{...at()}};this[HY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",properties:{...os(),...kd(),...ro().properties},measures:at()};this[BY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{...os(),...ro().properties},measures:{reason:{classification:"SystemMetaData",isMeasurement:!0,purpose:"PerformanceAndHealth"}}};this[jY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{exitReason:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...os(),...ro().properties},measures:{exitCode:{classification:"CallstackOrException",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[VY]={owner:"donjayamanne",feature:["Notebook"],source:"N/A",properties:{...os(),...ro().properties,manuallySelectedKernel:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasAlreadyOpen:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:{...at(),computeCwd:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},duration:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},envVars:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},executeCell:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},getConnection:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},interruptHandle:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelIdle:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelInfo:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelReady:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},portUsage:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},postKernelStart:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},preExecuteCellTelemetry:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},pythonEnvVars:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},sessionTelemetry:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},spawn:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},startKernel:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},startupCode:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},updateConnection:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},codeCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},mdCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},codeCellCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},mdCellCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},outputCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},outputsByteSize:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},attachmentCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},attachmentCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[WY]={owner:"donjayamanne",feature:["Notebook"],source:"N/A",properties:{...os(),...ro().properties,wasAlreadyOpen:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:{...at(),callPythonApi:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},activatePython:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},discoverEnv:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},createController:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},selectController:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[UY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{isRequestToShutdownRestartSession:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},stacktrace:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...os(),...ro().properties}};this[FY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{stacktrace:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...os(),...ro().properties}};this[KY]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[LY]={owner:"donjayamanne",feature:["KernelPicker"],source:"N/A",measures:{kernelSpecCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelInterpreterCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelLiveCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},localKernelSpecCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},remoteKernelSpecCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[OY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{outputType:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[MY]={owner:"IanMatthewHuff",feature:["InteractiveWindow"],tags:["IntelliSense"],source:"N/A",measures:at(),properties:{isResultNull:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[AY]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:at()};this[RY]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A"};this[NY]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A",measures:at()};this[kY]={owner:"IanMatthewHuff",feature:["PlotViewer"],source:"N/A",measures:at()};this[TY]={owner:"amunger",feature:"N/A",source:"N/A",properties:{command:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[DY]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",properties:{newState:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[PY]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A",measures:{numberOfDimensions:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[xY]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",properties:{source:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[wY]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},dependenciesInstalled:{classification:"SystemMetaData",purpose:"FeatureInsight"},envType:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[CY]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"},action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[EY]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[_Y]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[SY]={owner:"roblourens",feature:["Debugger"],properties:{status:{classification:"SystemMetaData",purpose:"FeatureInsight"}},source:"N/A"};this[IY]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[bY]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[yY]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[vY]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[gY]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[hY]={owner:"roblourens",feature:["Debugger"],source:"N/A",properties:{reason:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[mY]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{...at(),requestDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},timesExceededTimeout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},completionItems:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}},properties:{kernelConnectionType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},monacoLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelled:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},completed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelStatusAfterRequest:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelStatusBeforeRequest:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[fY]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelConnectionType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[pY]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[dY]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failureReason:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[uY]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{executionCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"}},properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[cY]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{accessAllowed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[lY]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{executionCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},cancelledAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},requestAcknowledgedAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},requestSentAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},...at()},properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelled:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestAcknowledged:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelledBeforeRequestAcknowledged:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelledBeforeRequestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},mimeTypes:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},failed:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"}}};this[aY]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:at(),properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[sY]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{clientExtId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[oY]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},allowed:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[iY]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},providerId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}},measures:at()};this[nY]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A"};this[rY]={owner:"roblourens",feature:["InteractiveWindow","Debugger"],source:"N/A"};this[tY]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{...ro().properties,...os()}};this[eY]={owner:"donjayamanne",source:"N/A",feature:["KernelPicker"]};this[ZG]={owner:"donjayamanne",source:"User Action",feature:["KernelPicker"]};this[XG]={owner:"amunger",feature:"N/A",source:"N/A",properties:{testName:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},testResult:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},perfWarmup:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},commitHash:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},timedCheckpoints:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[QG]={owner:"donjayamanne",feature:["KernelPicker"],source:"N/A",measures:{matchedReason:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[zG]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{requireEntryPointCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"PerformanceAndHealth"}},properties:{failed:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},failure:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},patternUsedToRegisterRequireConfig:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},widgetFolderNameHash:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[$G]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:at()};this[YG]={owner:"donjayamanne",feature:["DataFrameViewer"],source:"N/A"};this[GG]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[JG]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[qG]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...at(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0},preExecuteDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent in VS Code before starting execution.",isMeasurement:!0},executeDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent executing cells.",isMeasurement:!0},postExecuteDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent in VS Code after executing cells.",isMeasurement:!0}},properties:{outputType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",comment:"The kind of outputs generated in the notebook, text, html or images."}}};this[HG]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...at(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0}},properties:{outputType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",comment:"The kind of outputs generated in the notebook, text, html or images."}}};this[BG]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...at(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0}}};this[jG]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{toolName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",comment:"The name of the tool that was called."},resourceHash:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},failed:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether there was a failure. Common to most of the events."},failureCategory:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"A reason that we generate (e.g. kerneldied, noipykernel, etc), more like a category of the error. Common to most of the events."}}};this[VG]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{resourceHash:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},installedPythonExtension:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},isPython:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},createdEnv:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}}}};p();var kf=require("vscode");function Yb(r){let e=Uc(r.uri);return Rt(e.path)}function E2(r=kf.Uri.file(""),e=kf.Uri.file(""),t=wi(),n=!1){let i=Uc(r,t,t=="Windows"||n),o=Uc(e,t,t=="Windows"||n);return i===o||Xs(i,o,!0)}function Uc(r=kf.Uri.file(""),e=wi(),t=!1){let n=ut(r);return t&&(n=n.toLowerCase()),n.endsWith("/bin/python")?["Linux","OSX"].includes(e)?n.endsWith("/bin/python")&&n.split("/").length>4?kf.Uri.file(n.replace("/bin/python","/python")):kf.Uri.file(n):kf.Uri.file(n):kf.Uri.file(n)}p();var qz=require("vscode");var $b=class{constructor(){this.promises=new Set;this._onStateChange=new qz.EventEmitter;this.onStateChange=this._onStateChange.event}get isComplete(){return this.promises.size===0}dispose(){this._onStateChange.dispose()}push(e){this.promises.add(e),this._onStateChange.fire(),e.finally(()=>{this.promises.delete(e),this.isComplete&&this._onStateChange.fire()}).catch(E)}};p();var LN=class extends Ur{constructor(e){super("Python Extension failed to activate",e,"pythonExtension")}};p();var KN=class extends ot{constructor(){super("pythonExtension","Python Extension API not exported")}};var PQ=ae(GN());p();var Ng=require("vscode");var YN=class{};function lQ(r,e=""){let t=r?Ng.workspace.getWorkspaceFolder(r):Ng.workspace.workspaceFolders?Ng.workspace.workspaceFolders[0]:void 0;return t?Ss(wi()==="Windows"?t.uri.path.toUpperCase():t.uri.path):e}function nI(){let r=Array.isArray(Ng.workspace.workspaceFolders)&&Ng.workspace.workspaceFolders.length>0?Ng.workspace.workspaceFolders[0]:void 0;return r==null?void 0:r.uri}p();var Kg=require("vscode");p();p();p();var uQ=ae(GN());var Mg=require("vscode");p();var cQ=require("vscode");function Ag(r){return(e,t=null,n)=>{let i=!1,o;return o=r(s=>{if(!i)return o?o.dispose():i=!0,e.call(t,s)},null,n),i&&o.dispose(),o}}function bx(r,e=null,t){return new Promise(n=>Ag(r)(n,e,t))}var Rg=class{constructor(){this._listeners=new Set}get event(){return this._event||(this._event=(e,t,n)=>{this._listeners.add(t?e.bind(t):e);let i=new cQ.Disposable(()=>this._listeners.delete(e));return n==null||n.push(i),i}),this._event}async fireAsync(e,t){if(this._listeners){this._asyncDeliveryQueue||(this._asyncDeliveryQueue=[]);for(let n of this._listeners)this._asyncDeliveryQueue.push([n,e]);for(;this._asyncDeliveryQueue.length>0&&!t.isCancellationRequested;){let[n,i]=this._asyncDeliveryQueue.shift(),o=[],s={...i,token:t,waitUntil:a=>{if(Object.isFrozen(o))throw new Error("waitUntil can NOT be called asynchronous");o.push(a)}};try{n(s)}catch(a){console.error(a);continue}Object.freeze(o),await Promise.allSettled(o).then(a=>{for(let l of a)l.status==="rejected"&&console.error(l.reason)})}}}dispose(){this._listeners.clear()}};var pve={output_type:"stream",name:"stdout",text:""},fve={output_type:"error",ename:"",evalue:"",traceback:[""]},mve={output_type:"display_data",data:{},metadata:{}},hve={output_type:"execute_result",execution_count:0,data:{},metadata:{}},l3e={stream:new Set(Object.keys(pve)),error:new Set(Object.keys(fve)),display_data:new Set(Object.keys(mve)),execute_result:new Set(Object.keys(hve))};function Al(r){return r&&Xv(r).toLowerCase().endsWith("ipynb")?"notebook":"interactive"}function Vc(r){return r=r.toLowerCase(),r.length===2&&r.endsWith("#")?`${r.substring(0,1)}sharp`:gB.get(r)||r}function gr(r){return typeof r=="string"?r===St||r===yr:r.notebookType===St||r.notebookType===yr}function _a(r){let e=r.metadata;return JSON.parse(JSON.stringify((e==null?void 0:e.metadata)||{}))}async function dQ(r,e){let t=new Mg.WorkspaceEdit;t.set(r.uri,[Mg.NotebookEdit.updateNotebookMetadata(j2({...r.metadata||{},metadata:e}))]),await Mg.workspace.applyEdit(t)}function iI(r){return Mg.workspace.notebookDocuments.find(e=>gr(e)&&e.getCells().some(t=>t.document===r))}function jc(r){if(Array.isArray(r)){let e="";for(let t=0;t<r.length;t+=1){let n=r[t];t<r.length-1&&!n.endsWith(`
`)?e=e.concat(`${n}
`):e=e.concat(n)}return e}return r.toString()}function oI(r){if(Array.isArray(r))return r;let e=r.toString();if(e.length>0){let t=e.split(`
`);return t.map((n,i)=>i<t.length-1?`${n}
`:n).filter(n=>n.length>0)}return[]}function gve(r){let e=r;do r=e,e=r.replace(/[^\n]\x08/gm,"");while(e.length<r.length);return r}function vve(r){for(r=r.replace(/\r+\n/gm,`
`);r.search(/\r[^$]/g)>-1;){var e=r.match(/^(.*)\r+/m)[1],t=r.match(/\r+(.*)$/m)[1];t=t+e.slice(t.length,e.length),r=r.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,t)}return r}function pQ(r){return vve(gve(r))}var $N="'''",zN='"""';function Og(r,e,t){let n,i,o=0;for(let s of r){let a=s.trim(),l=a.startsWith($N)?$N:a.startsWith(zN)?zN:void 0,u=a.includes($N)?$N:a.includes(zN)?zN:void 0;if(i)i===u&&(i=void 0),t(s,o);else if(n)n===l&&(n=void 0),n&&e(s,o);else if(u&&!l){let c=a.indexOf(u);i=a.lastIndexOf(u)!==c?void 0:u,t(s,o)}else if(l){let c=a.indexOf(l,3);n=c>=0?void 0:l,a.length>3&&e(a.slice(3,c>=0?c:void 0),o)}else a.startsWith("#")?e(a.slice(1),o):t(s,o);o+=1}}function sI(r,e=`
`,t){return r.map((n,i)=>{let o=t?t(n):n;return i===r.length-1?`${o}`:`${o}${e}`})}function yve(r){let e=[];return Og(r,t=>e.push(t),t=>{}),e}function QN(r){return sI(yve(r.slice(r.length>1?1:0)))}function fQ(r){let e=r.length,t=-1;return r.forEach((n,i)=>{n.trim()&&(e=i,t<0&&(t=i))}),t>=0?r.slice(t,e+1):[]}function mQ(r){var t;let e=/^\s*(\d+)\.(\d+)\.(.+)\s*$/.exec(r);if(e&&e.length>2){let n=parseInt(e[1],10),i=parseInt(e[2],10),o=parseInt(e[3],10);return(t=(0,uQ.parse)(`${n}.${i}.${o}`,!0))!=null?t:void 0}}function Nf(r){let e=JSON.parse(JSON.stringify(r.metadata||{}))||{metadata:{}};return e.metadata=e.metadata||{},e}function j2(r){return bve(r)}function bve(r){return Array.isArray(r)?r.map(j2):r!=null&&typeof r=="object"&&Object.keys(r).length>0?Object.keys(r).sort().reduce((e,t)=>(e[t]=j2(r[t]),e),{}):r}async function Lg(r,e=[]){let t=bx(r.onDidDispose,void 0,e);r.dispose(),await t}var XN=new Map,H2=new Map,B2;function hQ(r){B2=r}function q2(r,e){if(!r.pythonEnvironmentPath)return;let t=Oe();Ive({interpreterHash:r.pythonEnvironmentPath}).then(n=>{r.pythonEnvironmentPackages=n||r.pythonEnvironmentPackages,e&&(e.pythonEnvironmentPackages=n||e.pythonEnvironmentPackages)}).catch(()=>{}).finally(()=>{t.resolve()})}async function Ive(r){if(!B2)return C.error("Python package provider is not initialized."),"{}";let e;if("interpreter"in r?e=r.interpreter:e=H2.get(r.interpreterHash),!e)return"{}";let t=await B2(e);return!t||t.size===0?"{}":JSON.stringify(Object.fromEntries(t))}async function gQ(r){if(!r)return{};let e=XN.get(Wa(r)),t=Al(r);if(!e&&t)return{resourceType:t,resourceHash:r?await Rt(r.toString()):void 0};if(!e)return{};let n=JSON.parse(JSON.stringify(e[0]));return q2(e[0],n),n}function Rr(r,e,t,n,i){gQ(r).then(o=>{Object.assign(o,n||{}),ne(e,t,o,i)}).catch(E)}var jn=!1,aI=new WeakMap,ZN=new Map,Ea,yQ=0;function Bc(r){var t,n;if(!r)return;if(ci(r)&&!ZN.has(r.toString())){let i=Kg.workspace.notebookDocuments.find(o=>o.uri.toString()===r.toString());i&&ZN.set(r.toString(),new WeakRef(i))}let e=ci(r)?(t=ZN.get(r.toString()))==null?void 0:t.deref():r;if(e)return(n=aI.get(e))==null?void 0:n.tracker}function bQ(r){let e=new ln;return Ea=r,yQ=r.elapsedTime,Kg.workspace.notebookDocuments.forEach(t=>aI.set(t,vQ(t,!0,r))),e.add(Kg.workspace.onDidOpenNotebookDocument(t=>{!aI.has(t)&&!jn&&aI.set(t,vQ(t,!1,r))})),e.add(Kg.workspace.onDidCloseNotebookDocument(t=>{aI.delete(t),ZN.delete(t.uri.toString())})),e}function IQ(r){var e;(e=aI.get(r))==null||e.tracker.kernelManuallySelected()}var e1={starAfter:-1,completedAfter:-1},J2=new Map,SQ=new Map,Sve=new Map,_Q=cr(()=>(e1.starAfter=Ea==null?void 0:Ea.elapsedTime,{stop:cr(()=>{e1.completedAfter=Ea.elapsedTime})}));function EQ(r,e){J2.set(r,Ea==null?void 0:Ea.elapsedTime),Sve.set(r,e||"")}function CQ(r){r.executable.uri&&SQ.set(r.id,Ea==null?void 0:Ea.elapsedTime)}function vQ(r,e,t){let n=Ea.elapsedTime,i=t.elapsedTime,o={openedAfter:i},s=u=>(u==="executeCell"&&(jn=!0),o[`${u}StartedAfter`]=t.elapsedTime,{stop:cr(()=>{o[`${u}CompletedAfter`]=t.elapsedTime})}),a={wasAlreadyOpen:e},l=()=>{};return{measures:o,info:a,tracker:{kernelSelected:cr((u,c)=>{let d=J2.get(u);typeof d=="number"&&(a.wasAlreadyOpen?o.controllerCreatedAfter=J2.get(u):o.controllerCreatedAfter=n-d),o.interpreterDiscoveredAfter=SQ.get(c||""),o.kernelSelectedAfter=t.elapsedTime,a.manuallySelectedKernel||Cve(r,{wasAlreadyOpen:a.wasAlreadyOpen},{controllerCreatedAfter:o.controllerCreatedAfter,kernelSelectedAfter:o.kernelSelectedAfter,openedAfter:i,interpreterDiscoveredAfter:o.interpreterDiscoveredAfter})}),kernelManuallySelected:cr(()=>a.manuallySelectedKernel=!0),cellExecutionCount:jn?l:cr(u=>o.executeCellCount=u),preExecuteCellTelemetry:jn?l:cr(()=>s("preExecuteCellTelemetry")),startKernel:jn?l:cr(()=>s("startKernel")),executeCell:jn?l:cr(()=>s("executeCell")),executeCellAcknowledged:jn?l:cr(()=>{o.executeCellAcknowledgedAfter=t.elapsedTime,_ve(r,a,o)}),jupyterSessionTelemetry:jn?l:cr(()=>s("sessionTelemetry")),postKernelStartup:jn?l:cr(()=>s("postKernelStart")),computeCwd:jn?l:cr(()=>s("computeCwd")),getConnection:jn?l:cr(()=>s("getConnection")),updateConnection:jn?l:cr(()=>s("updateConnection")),kernelReady:jn?l:cr(()=>s("kernelReady")),portUsage:jn?l:cr(()=>s("portUsage")),spawn:jn?l:cr(()=>s("spawn")),pythonEnvVars:jn?l:cr(()=>s("pythonEnvVars")),envVars:jn?l:cr(()=>s("envVars")),interruptHandle:jn?l:cr(()=>s("interruptHandle")),kernelInfo:jn?l:cr(()=>s("kernelInfo")),kernelIdle:jn?l:cr(()=>s("kernelIdle"))}}}var _ve=cr(function(r,e,t){if(typeof t.preExecuteCellTelemetryStartedAfter!="number"||typeof t.preExecuteCellTelemetryCompletedAfter!="number"||typeof t.executeCellAcknowledgedAfter!="number"||typeof t.startKernelStartedAfter!="number"||typeof t.startKernelCompletedAfter!="number"||typeof t.executeCellStartedAfter!="number"||typeof t.sessionTelemetryStartedAfter!="number"||typeof t.sessionTelemetryCompletedAfter!="number"||typeof t.postKernelStartStartedAfter!="number"||typeof t.postKernelStartCompletedAfter!="number"||typeof t.kernelInfoStartedAfter!="number"||typeof t.kernelInfoCompletedAfter!="number"||typeof t.kernelIdleStartedAfter!="number"||typeof t.kernelIdleCompletedAfter!="number"||typeof t.computeCwdStartedAfter!="number"||typeof t.computeCwdCompletedAfter!="number"||typeof t.kernelReadyStartedAfter!="number"||typeof t.kernelReadyCompletedAfter!="number"||typeof t.getConnectionStartedAfter!="number"||typeof t.getConnectionCompletedAfter!="number"||typeof t.updateConnectionStartedAfter!="number"||typeof t.updateConnectionCompletedAfter!="number"||typeof t.portUsageStartedAfter!="number"||typeof t.portUsageCompletedAfter!="number"||typeof t.spawnStartedAfter!="number"||typeof t.spawnCompletedAfter!="number"||typeof t.pythonEnvVarsStartedAfter!="number"||typeof t.pythonEnvVarsCompletedAfter!="number"||typeof t.envVarsStartedAfter!="number"||typeof t.envVarsCompletedAfter!="number")return;let n={duration:0,preExecuteCellTelemetry:0,startKernel:0,executeCell:0};{let u=[{name:"preExecuteCellTelemetry",start:t.preExecuteCellTelemetryStartedAfter,end:t.preExecuteCellTelemetryCompletedAfter},{name:"startKernel",start:t.startKernelStartedAfter,end:t.startKernelCompletedAfter},{name:"executeCell",start:t.executeCellStartedAfter,end:t.executeCellAcknowledgedAfter}],c=t.executeCellAcknowledgedAfter-t.preExecuteCellTelemetryStartedAfter;n.duration=c,Ix(n,u,c,t.openedAfter)}let i={sessionTelemetry:0,postKernelStart:0,computeCwd:0,getConnection:0,updateConnection:0,kernelReady:0,portUsage:0,spawn:0};{let u=[{name:"sessionTelemetry",start:t.sessionTelemetryStartedAfter,end:t.sessionTelemetryCompletedAfter},{name:"postKernelStart",start:t.postKernelStartStartedAfter,end:t.postKernelStartCompletedAfter},{name:"computeCwd",start:t.computeCwdStartedAfter,end:t.computeCwdCompletedAfter},{name:"getConnection",start:t.getConnectionStartedAfter,end:t.getConnectionCompletedAfter},{name:"updateConnection",start:t.updateConnectionStartedAfter,end:t.updateConnectionCompletedAfter},{name:"spawn",start:t.spawnStartedAfter,end:t.spawnCompletedAfter},{name:"portUsage",start:t.portUsageStartedAfter,end:t.portUsageCompletedAfter},{name:"kernelReady",start:t.kernelReadyStartedAfter,end:t.kernelReadyCompletedAfter}],c=t.startKernelCompletedAfter-t.startKernelStartedAfter;Ix(i,u,c,t.openedAfter)}let o={startupCode:0,kernelInfo:0,kernelIdle:0};{let u=[{name:"startupCode",start:t.postKernelStartStartedAfter,end:t.kernelInfoStartedAfter},{name:"kernelInfo",start:t.kernelInfoStartedAfter,end:t.kernelInfoCompletedAfter},{name:"kernelIdle",start:t.kernelIdleStartedAfter,end:t.kernelIdleCompletedAfter}],c=t.postKernelStartCompletedAfter-t.postKernelStartStartedAfter;Ix(o,u,c,t.openedAfter)}let s={pythonEnvVars:0,envVars:0,interruptHandle:0};{let u=[{name:"pythonEnvVars",start:t.pythonEnvVarsStartedAfter,end:t.pythonEnvVarsCompletedAfter},{name:"envVars",start:t.envVarsStartedAfter,end:t.envVarsCompletedAfter},{name:"interruptHandle",start:t.interruptHandleStartedAfter||0,end:t.interruptHandleCompletedAfter||0}],c=t.spawnCompletedAfter-t.spawnStartedAfter;Ix(s,u,c,t.openedAfter)}let a=Eve(r),l={...n,...i,...o,...s,...a};Rr(r.uri,"DATASCIENCE.NOTEBOOK_FIRST_START_BREAKDOWN",l,e)});function Eve(r){let e={attachmentCharLength:0,attachmentCount:0,codeCellCharLength:0,codeCellCount:0,mdCellCharLength:0,mdCellCount:0,outputCount:0,outputsByteSize:0};return r.getCells().forEach(t=>{let n=t.document.lineAt(t.document.lineCount-1).range.end,i=t.document.offsetAt(n);if(t.kind===Kg.NotebookCellKind.Markup){e.mdCellCount+=1,e.mdCellCharLength+=i;try{let s=Nf(t).attachments||{};Object.keys(s).forEach(a=>{e.attachmentCount+=1;let l=s[a];typeof l=="object"&&Object.keys(l).forEach(u=>{let c=l[u];c&&typeof c=="string"&&(e.attachmentCharLength+=c.length)})})}catch(o){C.warn("Error parsing attachments in cell metadata",o)}}else e.codeCellCount+=1,e.codeCellCharLength+=i,e.outputCount+=t.outputs.length,e.outputsByteSize+=t.outputs.reduce((o,s)=>o+s.items.reduce((a,l)=>a+l.data.byteLength,0),0)}),e}var Cve=cr(function(r,e,t){if(t.pythonExtensionActivationStartedAfter=e1.starAfter,t.pythonExtensionActivationCompletedAfter=e1.completedAfter,typeof t.controllerCreatedAfter=="undefined"||typeof t.interpreterDiscoveredAfter=="undefined"||typeof t.pythonExtensionActivationCompletedAfter=="undefined"||typeof t.pythonExtensionActivationStartedAfter=="undefined")return;let n=[{name:"callPythonApi",start:yQ,end:t.pythonExtensionActivationStartedAfter},{name:"activatePython",start:t.pythonExtensionActivationStartedAfter,end:t.pythonExtensionActivationCompletedAfter},{name:"discoverEnv",start:t.pythonExtensionActivationCompletedAfter,end:t.interpreterDiscoveredAfter},{name:"createController",start:t.interpreterDiscoveredAfter,end:t.controllerCreatedAfter},{name:"selectController",start:t.controllerCreatedAfter,end:t.kernelSelectedAfter}],i=t.kernelSelectedAfter-t.openedAfter,o={duration:i};Ix(o,n,i,t.openedAfter),Rr(r.uri,"DATASCIENCE.NOTEBOOK_FIRST_KERNEL_AUTO_SELECTION_BREAKDOWN",o,e)});function Ix(r,e,t,n){e.sort((i,o)=>i.start-o.start).forEach(i=>{typeof n=="number"&&n>=i.start&&n<=i.end?r[i.name]=(i.end-n)*100/t:typeof n=="number"&&n>i.end?r[i.name]=0:(typeof n=="number"&&n<i.start||typeof n!="number")&&(r[i.name]=(i.end-i.start)*100/t)})}p();var G2=require("vscode");p();function wQ(r){return wi()==="Windows"?Ss(r).toUpperCase():Ss(r)}function t1(r,e){return e.endsWith(Wi)||(e+=Wi),r.endsWith(Wi)||(r+=Wi),wQ(r).startsWith(wQ(e))}var wve=ae(sK());function xQ(r,e){let t=e.filter(n=>{var i,o,s;return t1(((o=(i=n.environment)==null?void 0:i.folderUri)==null?void 0:o.fsPath)||((s=n.executable.uri)==null?void 0:s.fsPath)||n.path,r.fsPath)});return t.find(n=>{var i,o;return br(n)==="Venv"&&((o=(i=n.environment)==null?void 0:i.name)==null?void 0:o.toLowerCase())===".venv"})||t.find(n=>{var i,o;return br(n)==="Conda"&&((o=(i=n.environment)==null?void 0:i.name)==null?void 0:o.toLowerCase())===".conda"})||t.find(n=>{var i,o;return["VirtualEnv","VirtualEnvWrapper"].includes(br(n))&&((o=(i=n.environment)==null?void 0:i.name)==null?void 0:o.toLowerCase())===".venv"})||t.find(n=>{var i,o,s,a;return((o=(i=n.environment)==null?void 0:i.name)==null?void 0:o.toLowerCase())===".venv"||((a=(s=n.environment)==null?void 0:s.name)==null?void 0:a.toLowerCase())===".conda"})||t.length?t[0]:void 0}function Sx(r,e){if(r){let t={...r,uri:dt.Uri.file(r.path||""),id:e||r.id};return delete t.path,t}}function _x(r){if(r){let e=Object.assign({},r,{path:ut(r.uri)});return delete e.uri,e}}var lI=class{constructor(e,t){this.disposables=e;this.extensionChecker=t;this.api=Oe();this.didActivatePython=new dt.EventEmitter;this._pythonExtensionHooked=Oe();this.extensionChecker.isPythonExtensionInstalled||dt.extensions.onDidChange(async()=>{this.extensionChecker.isPythonExtensionInstalled&&await this.registerHooks()},this,this.disposables),this.disposables.push(this.didActivatePython)}get onDidActivatePythonExtension(){return this.didActivatePython.event}get pythonExtensionHooked(){return this._pythonExtensionHooked.promise}get pythonExtensionVersion(){return this._pythonExtensionVersion}getApi(){return this.init().catch(E),this.api.promise}async getNewApi(){var t,n;await this.init();let e=dt.extensions.getExtension($s);return(t=e==null?void 0:e.packageJSON)!=null&&t.version&&(this._pythonExtensionVersion=new PQ.SemVer((n=e==null?void 0:e.packageJSON)==null?void 0:n.version)),e!=null&&e.exports&&(w7(e.exports),e.exports.environments.known.forEach(i=>{CQ(i)})),e==null?void 0:e.exports}setApi(e){this.api.resolved||!dt.workspace.isTrusted||this.api.resolve(e)}async init(){if(this.initialized)return;dt.extensions.getExtension($s)?await this.registerHooks():await this.extensionChecker.showPythonExtensionInstallRequiredPrompt(),this.initialized=!0}async registerHooks(){var n;if(this.hooksRegistered)return;let e=dt.extensions.getExtension($s);if(!e)return;let t=!1;if(!e.isActive){let i=_Q();try{let o=e.activate();o.then(()=>i.stop(),()=>i.stop()),await o,t=!0}catch(o){C.error("Failed activating the python extension: ",o),this.api.reject(new LN(o));return}}this.hooksRegistered||(this.hooksRegistered=!0,t&&this.didActivatePython.fire(),(n=e.exports)!=null&&n.jupyter?e.exports.jupyter.registerHooks():(C.error("Python extension is not exporting the jupyter API"),this.api.reject(new KN)),this._pythonExtensionHooked.resolve())}};lI=U([(0,Ca.injectable)(),x(0,(0,Ca.inject)(ve)),x(1,(0,Ca.inject)(bo))],lI);var Rf=class{constructor(e){this.disposables=e;this.pythonExtensionInstallationStatusChanged=new dt.EventEmitter;dt.extensions.onDidChange(this.extensionsChangeHandler.bind(this),this,this.disposables),this.previousInstallState=this.isPythonExtensionInstalled}get onPythonExtensionInstallationStatusChanged(){return this.pythonExtensionInstallationStatusChanged.event}get isPythonExtensionInstalled(){return dt.extensions.getExtension($s)!==void 0}get isPythonExtensionActive(){var e;return((e=dt.extensions.getExtension($s))==null?void 0:e.isActive)===!0}async directlyInstallPythonExtension(){return dt.commands.executeCommand("workbench.extensions.installExtension",$s,{context:{skipWalkthrough:!0}})}async showPythonExtensionInstallRequiredPrompt(){if(!dt.workspace.isTrusted)return;Rf.promptDisplayed=!0;let e=Ue.bannerLabelYes;ne("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"displayed"}),await dt.window.showInformationMessage(W.pythonExtensionRequired,{modal:!0},e)===e?(ne("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"download"}),await this.installPythonExtension()):ne("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"dismissed"})}async installPythonExtension(){dt.commands.executeCommand("extension.open",$s).then(E,E)}async extensionsChangeHandler(){let e=this.isPythonExtensionInstalled;e!==this.previousInstallState&&(this.pythonExtensionInstallationStatusChanged.fire(e?"installed":"uninstalled"),this.previousInstallState=e)}};Rf=U([(0,Ca.injectable)(),x(0,(0,Ca.inject)(ve))],Rf);var r1=class{constructor(e,t,n,i){this.apiProvider=e;this.extensionChecker=t;this.disposables=n;this.context=i;this.didChangeInterpreter=new dt.EventEmitter;this.didChangeInterpreters=new dt.EventEmitter;this._onDidEnvironmentVariablesChange=new dt.EventEmitter;this._onDidRemoveInterpreter=new dt.EventEmitter;this.onDidRemoveInterpreter=this._onDidRemoveInterpreter.event;this.onDidEnvironmentVariablesChange=this._onDidEnvironmentVariablesChange.event;this._status="idle";this._onDidChangeStatus=new dt.EventEmitter;this.onDidChangeStatus=this._onDidChangeStatus.event;this.refreshPromises=new $b;this.onResumeEnvDetection=new dt.EventEmitter;this.workspaceCachedActiveInterpreter=new Set;this.lastLoggedResourceAndInterpreterId="";this.pythonEnvHashes=new Map;this.loggedEnvsWithoutInterpreterPath=new Set;this.pendingInterpreterChangeEventTriggers=new Map;this.pendingInterpretersChangeEventTriggers=new Map;this.extensionChecker.isPythonExtensionInstalled&&!this.extensionChecker.isPythonExtensionActive&&this.apiProvider.onDidActivatePythonExtension(()=>{this.hookupOnDidChangeInterpreterEvent()},this,this.disposables),dt.workspace.onDidGrantWorkspaceTrust(()=>this.refreshInterpreters(!0),this,this.disposables),this.disposables.push(this._onDidChangeStatus),this.disposables.push(this.refreshPromises),this.disposables.push(this.onResumeEnvDetection),this.refreshPromises.onStateChange(()=>{this.status=this.refreshPromises.isComplete?"idle":"refreshing"})}get status(){return this._status}set status(e){this._status!==e&&(this._status=e,this._onDidChangeStatus.fire())}initialize(){this.hookupOnDidChangeInterpreterEvent()}async hasWorkspaceSpecificEnvironment(){if(!(dt.workspace.workspaceFolders||[]).length)return!1;let e=await this.getApi();return e?!!(dt.workspace.workspaceFolders||[]).some(t=>xQ(t.uri,e.environments.known)):!1}async resolveEnvironment(e){return this.getApi().then(t=>{if(!t)return;let n=typeof e=="string"?t.environments.known.find(i=>i.id===e||i.path===e):e;return t.environments.resolveEnvironment(n||e)})}get onDidChangeInterpreter(){return this.hookupOnDidChangeInterpreterEvent(),this.didChangeInterpreter.event}get onDidChangeInterpreters(){return this.hookupOnDidChangeInterpreterEvent(),this.didChangeInterpreters.event}async refreshInterpreters(e=!1){let t=(async()=>{let n=await this.getApi();if(n)try{await n.environments.refreshEnvironments({forceRefresh:e}),this.hookupOnDidChangeInterpreterEvent(),C.debug("Refreshed Environments")}catch(i){C.error("Failed to refresh the list of interpreters")}})();this.refreshPromises.push(t),this.refreshPromises.push(t.then(()=>nc(1e3))),await t}async getActiveInterpreter(e){var o,s,a;if(!dt.workspace.isTrusted)return;let t=new bt;this.hookupOnDidChangeInterpreterEvent(),!e&&((o=dt.workspace.workspaceFolders)==null?void 0:o.length)===1&&(e=dt.workspace.workspaceFolders[0].uri),(s=dt.workspace.workspaceFolders)!=null&&s.length&&(e=(e?(a=dt.workspace.getWorkspaceFolder(e))==null?void 0:a.uri:void 0)||dt.workspace.workspaceFolders[0].uri);let n=lQ(e),i=this.getApi().then(async l=>{if(!l)return;let u=l.environments.getActiveEnvironmentPath(e),c=await l.environments.resolveEnvironment(u);return this.trackResolvedEnvironment(c)});return i.then(()=>{this.workspaceCachedActiveInterpreter.has(n)||(this.workspaceCachedActiveInterpreter.add(n),ne("DS_INTERNAL.ACTIVE_INTERPRETER_LISTING_PERF",{duration:t.elapsedTime},{firstTime:!0}))}).catch(l=>{C.warn(`Failed to get active interpreter from Python for workspace ${n}`,l)}),(li||[dt.ExtensionMode.Development,dt.ExtensionMode.Test].includes(this.context.extensionMode))&&i.then(l=>{let u=`${Ee(e)}'-${Ee(l==null?void 0:l.id)}`;if(this.lastLoggedResourceAndInterpreterId===u)return;this.lastLoggedResourceAndInterpreterId=u;let c=Cc(l);C.trace(`Active Interpreter ${e?`for '${Ee(e)}' `:""}is ${Ee(l==null?void 0:l.id)} (${l&&br(l)}, '${l?_s(l):""}', ${c==null?void 0:c.major}.${c==null?void 0:c.minor}.${c==null?void 0:c.micro})`)}).catch(E),i}getInterpreterHash(e){return this.pythonEnvHashes.get(e)}async getInterpreterDetails(e,t){if(!dt.workspace.isTrusted)throw new Error("Unable to determine active Interpreter as Workspace is not trusted");this.hookupOnDidChangeInterpreterEvent();try{return await this.getApi().then(async n=>{if(!n||t!=null&&t.isCancellationRequested)return;let i=n.environments.known.find(l=>ci(e)?E2(l.executable.uri,e):typeof e=="string"?l.id===e:E2(dt.Uri.file(l.path),dt.Uri.file(e.path))),o=ci(e)?Ee(e):typeof e=="string"?e:Ee(dt.Uri.file(e.path));if(i){let l=await n.environments.resolveEnvironment(i),u=this.trackResolvedEnvironment(l);return C.ci(`Interpreter details for ${o} from Python is ${JSON.stringify(l)} and our mapping is ${JSON.stringify(u)}`),u}let s=o;if(this.loggedEnvsWithoutInterpreterPath.has(s)||(this.loggedEnvsWithoutInterpreterPath.add(s),C.warn(`No interpreter with path ${o} found in Python API, will convert Uri path to string as Id ${o}`)),t!=null&&t.isCancellationRequested)return;let a=await n.environments.resolveEnvironment(ci(e)?e.fsPath:typeof e=="string"?e:e.path);return this.trackResolvedEnvironment(a)})}catch(n){C.warn(`Failed to get Python interpreter details from Python Extension API for ${typeof e=="string"?e:Ee(ci(e)?e:dt.Uri.file(e.path))}`,n);return}}trackResolvedEnvironment(e){if(e){let t=hT(e);return t?(Yb(t).then(n=>{this.pythonEnvHashes.set(t.id,n)}).catch(E),this.triggerEventIfAllowed("interpretersChangeEvent",t),t):void 0}}triggerEventIfAllowed(e,t){e==="interpreterChangeEvent"?this.pendingInterpreterChangeEventTriggers.set((t==null?void 0:t.id)||"",t):this.pendingInterpretersChangeEventTriggers.set((t==null?void 0:t.id)||"",t),this.triggerPendingEvents()}triggerPendingEvents(){this.pendingInterpreterChangeEventTriggers.forEach(t=>this.didChangeInterpreter.fire(t)),this.pendingInterpreterChangeEventTriggers.clear();let e=Array.from(this.pendingInterpretersChangeEventTriggers.values());if(e.length){let t=e.filter(n=>!!n);t.length!==e.length&&t.length===0?this.didChangeInterpreters.fire([]):this.didChangeInterpreters.fire(t)}this.pendingInterpretersChangeEventTriggers.clear()}async getApi(){if(this.extensionChecker.isPythonExtensionInstalled)return this.apiPromise||(this.apiPromise=this.apiProvider.getNewApi()),this.apiPromise}hookupOnDidChangeInterpreterEvent(){if(this.eventHandlerAdded)return;let e=new AD;this.disposables.push(e),this.getApi().then(t=>{!this.eventHandlerAdded&&t&&(this.eventHandlerAdded=!0,t.environments.onDidEnvironmentVariablesChange(n=>{var i,o;C.debug(`Detected changes to env file ${(o=(i=n.resource)==null?void 0:i.uri)==null?void 0:o.path} in PythonApi`),this._onDidEnvironmentVariablesChange.fire()},this,this.disposables),t.environments.onDidChangeActiveEnvironmentPath(()=>{C.trace("Detected change in Active Python environment via Python API"),this.workspaceCachedActiveInterpreter.clear(),this.triggerEventIfAllowed("interpreterChangeEvent",void 0)},this,this.disposables),t.environments.onDidChangeEnvironments(async n=>{if(C.trace(`Python API env change detected, ${n.type} => '${n.env.id}'`),n.type==="remove"){let s=setTimeout(()=>{C.trace(`Python API env change detected & removed after 30000, ${n.type} => '${n.env.id}'`),e.deleteAndDispose(n.env.id),this.triggerEventIfAllowed("interpreterChangeEvent",void 0),this.triggerEventIfAllowed("interpretersChangeEvent",void 0),this._onDidRemoveInterpreter.fire({id:n.env.id})},3e4);e.set(n.env.id,new dt.Disposable(()=>clearTimeout(s)));return}e.deleteAndDispose(n.env.id);let i=hT(Ji(n.env));i&&(this.triggerEventIfAllowed("interpreterChangeEvent",i),this.triggerEventIfAllowed("interpretersChangeEvent",i))},this,this.disposables),this.didChangeInterpreters.fire(P7().map(hT).filter(n=>!!n).map(n=>n)))}).catch(E)}};r1=U([(0,Ca.injectable)(),x(0,(0,Ca.inject)(my)),x(1,(0,Ca.inject)(bo)),x(2,(0,Ca.inject)(ve)),x(3,(0,Ca.inject)(st))],r1);p();var bI=require("vscode");p();function DQ(r,e){let t=r.length>0?`?token=${r}`:"";return`${e}${t}`}async function dR(r,e){let t=W.jupyterSelfCertEnable,n=W.jupyterSelfCertClose,i=await bI.window.showErrorMessage(W.jupyterSelfCertFail(e),{modal:!0},t,n);return i===t?(ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await r.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,bI.ConfigurationTarget.Workspace),!0):(i===n&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE"),!1)}async function pR(r,e){let t=W.jupyterSelfCertEnable,n=W.jupyterSelfCertClose,i=await bI.window.showErrorMessage(W.jupyterExpiredCertFail(e),{modal:!0},t,n);return i===t?(ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await r.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,bI.ConfigurationTarget.Workspace),!0):(i===n&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE"),!1)}function tj(r,e,t,n,i,o,s){var R;let a=e.baseUrl,l=e.token,u=new URL(e.baseUrl).hostname,c=e.authorizationHeader&&Object.keys((R=e==null?void 0:e.authorizationHeader)!=null?R:{}).length>0?e.authorizationHeader:void 0;l&&r.extensionId===Ge&&r.id===ME&&(c=c||{},c.Authorization=c.Authorization||`token ${l}`);let d=c?()=>c:void 0,f={baseUrl:a,appUrl:"",wsUrl:a.replace("http","ws"),fetch:e.fetch,WebSocket:e.WebSocket},m=t.getRequestInit();(!(l===""||l==="null")||d)&&(f={...f,token:l,appendToken:!0});let b=i.getSettings(void 0).allowUnauthorizedRemoteConnection;if(a.startsWith("https")&&b&&n){let P=n.createHttpRequestAgent();m={...m,agent:P}}let{ServerConnection:v}=Bn();return f={...f,init:m,WebSocket:e.WebSocket?t.wrapWebSocketCtor(e.WebSocket):t.getWebsocketCtor(void 0,b,d),fetch:e.fetch||t.getFetchMethod(),Request:t.getRequestCtor(void 0,b,d),Headers:t.getHeadersCtor()},{baseUrl:a,providerId:r.id,serverProviderHandle:r,token:l,hostName:u,displayName:e&&e.displayName?e.displayName:DQ(l,a),dispose:()=>s==null?void 0:s.dispose(),rootDirectory:o,getAuthHeader:d,settings:v.makeSettings(f)}}async function HZ(r){let e=Vt(r);return Ha(e,"SHA-256")}var LIe=new Set([Ge,"ms-toolsai.vscode-ai","GitHub.codespaces"].map(r=>r.toLowerCase()));function Vt(r){return LIe.has(r.extensionId.toLowerCase())?`${nt.REMOTE_URI}?${nt.REMOTE_URI_ID_PARAM}=${r.id}&${nt.REMOTE_URI_HANDLE_PARAM}=${encodeURI(r.handle)}`:`${nt.REMOTE_URI}?${nt.REMOTE_URI_ID_PARAM}=${r.id}&${nt.REMOTE_URI_HANDLE_PARAM}=${encodeURI(r.handle)}&${nt.REMOTE_URI_EXTENSION_ID_PARAM}=${encodeURI(r.extensionId)}`}async function fR(r){var e;if(!ic()&&((e=r.interpreter)!=null&&e.uri)){let t=r.interpreter.uri.fsPath,n=Uc(r.interpreter.uri).fsPath,i=r.id.replace(t,n);return Rt(i)}return Rt(r.id)}var tu=class{static fromJSON(e){let t=Object.assign(e,{});switch(t.interpreter&&(t.interpreter=Sx(t.interpreter,"")),e.kind){case"startUsingLocalKernelSpec":return rj.create(t);case"connectToLiveRemoteKernel":return Hx.create(t);case"startUsingRemoteKernelSpec":return qx.create(t);case"startUsingPythonInterpreter":return Jx.create(t);default:throw new Error(`Invalid object to be deserialized into a connection, kind = ${t.kind}`)}}},Hx=class r{constructor(e){this.kind="connectToLiveRemoteKernel";this.kernelModel=e.kernelModel,this.interpreter=e.interpreter,this.baseUrl=e.baseUrl,this.id=e.id,this.serverProviderHandle=e.serverProviderHandle,mR(this)}static create(e){return new r(e)}updateModel(e){Object.assign(this.kernelModel,e)}getHashId(){return fR(this)}toJSON(){return{id:this.id,kind:this.kind,baseUrl:this.baseUrl,interpreter:_x(this.interpreter),kernelModel:this.kernelModel,serverProviderHandle:this.serverProviderHandle}}static fromJSON(e){return tu.fromJSON(e)}},rj=class r{constructor(e){this.kind="startUsingLocalKernelSpec";this.kernelSpec=e.kernelSpec,this.interpreter=e.interpreter,this.id=e.id,mR(this)}static create(e){return new r(e)}getHashId(){return fR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:_x(this.interpreter),kind:this.kind}}static fromJSON(e){return tu.fromJSON(e)}},qx=class r{constructor(e){this.kind="startUsingRemoteKernelSpec";this.interpreter=e.interpreter,this.kernelSpec=e.kernelSpec,this.baseUrl=e.baseUrl,this.id=e.id,this.serverProviderHandle=e.serverProviderHandle,mR(this)}static create(e){return new r(e)}getHashId(){return fR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:_x(this.interpreter),baseUrl:this.baseUrl,kind:this.kind,serverProviderHandle:this.serverProviderHandle}}static fromJSON(e){return tu.fromJSON(e)}},Jx=class r{constructor(e){this.kind="startUsingPythonInterpreter";this.kernelSpec=e.kernelSpec,this.interpreter=e.interpreter,this.id=e.id,mR(this)}static create(e){return new r(e)}getHashId(){return fR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:_x(this.interpreter),kind:this.kind}}updateInterpreter(e){Object.assign(this.interpreter,e)}static fromJSON(e){return tu.fromJSON(e)}};function jt(r){return r.kind==="startUsingLocalKernelSpec"||r.kind==="startUsingPythonInterpreter"}function Wt(r){return!jt(r)}var qe=Symbol("IKernelProvider"),jg=Symbol("IThirdPartyKernelProvider");var kGe=Symbol("IJupyterServerConnector"),Gx=Symbol("IKernelSessionFactory");var II=Symbol("IKernelDependencyService"),ri=Symbol("IKernelFinder"),SI=Symbol("ITracebackFormatter");var Md=Symbol("IStartupCodeProviders"),qZ=new Set;function mR(r){var m,g;if(qZ.has(r.id))return;qZ.add(r.id);let e="kernelSpec"in r?r.kernelSpec:void 0,t=(e==null?void 0:e.language)||(r.kind==="startUsingPythonInterpreter"?$e:void 0),n="",i="",o="interpreter"in r?r.interpreter:void 0,s="<#>",a;e&&Array.isArray(e.argv)&&e.argv.length>0&&(n=e.argv[0],a=n.toLowerCase()===((g=(m=o==null?void 0:o.uri)==null?void 0:m.fsPath)==null?void 0:g.toLowerCase()),Ht(n)!==n&&(n=`<P>${Ht(n)}`),i=e.argv.map(b=>b.includes("/")||b.includes("\\")?`<P>${Ht(b)}`:b).join(s));let l="kernelSpec"in r&&r.kernelSpec.specFile?Rt(r.kernelSpec.specFile):Promise.resolve(""),u=Rt(r.id),c=Wt(r)?Rt(Vt(r.serverProviderHandle)):Promise.resolve(""),d=Wt(r)?r.serverProviderHandle.extensionId:Ge,f=Wt(r)?Rt(r.baseUrl.toLowerCase()):Promise.resolve("");Promise.all([l,u,c,f]).then(([b,v,k,R])=>ne("DS_INTERNAL.JUPYTER_KERNEL_SPEC",void 0,{kernelId:v,serverIdHash:k,kernelSpecHash:b,baseUrlHash:R,providerExtensionId:d,kernelConnectionType:r.kind,kernelLanguage:t,envType:o&&br(o),isArgv0SameAsInterpreter:a,argv0:n,argv:i})).catch(E)}var NGe=Symbol("IKernelWorkingDirectory");p();var qg=require("vscode");p();var hR="application/vnd.vscode.chat_message",JZ=`
def __VSCODE_inject_module():

    def __VSCODE_call_function(function, callback, data=None):
        __VSCODE_send_chat_message__(function, data, callback=callback)

    def __VSCODE_send_chat_message__(function, data, callback):
        requests = {}
        try:
            requests = __VSCODE_send_chat_message__.__requests
        except Exception:
            __VSCODE_send_chat_message__.__requests = requests

        import uuid as __VSCODE_send_chat_message__uuid
        import IPython.display as __VSCODE_send_chat_message__ipython_display

        id = str(__VSCODE_send_chat_message__uuid.uuid4())
        requests[id] = callback
        data_is_none = data is None
        __VSCODE_send_chat_message__ipython_display.display({"${hR}": data}, metadata={"id":id, "function": function, "dataIsNone": data_is_none}, raw=True)

        del __VSCODE_send_chat_message__ipython_display
        del __VSCODE_send_chat_message__uuid

    def __VSCODE_on_chat_message(id, data):
        requests = {}
        try:
            requests = __VSCODE_send_chat_message__.__requests
        except Exception:
            __VSCODE_send_chat_message__.__requests = requests

        if id in requests:
            requests[id](data)
            del requests[id]
        else:
            raise NotImplementedError(f"Callback not found for message {id}")

    import sys as __VSCODE_send_chat_message__sys
    import IPython as __VSCODE_send_chat_message__IPython
    chat = type(__VSCODE_send_chat_message__IPython)("chat")
    chat.send_message = __VSCODE_send_chat_message__
    chat.call_function = __VSCODE_call_function
    chat.__on_message = __VSCODE_on_chat_message
    __VSCODE_send_chat_message__sys.modules["vscode"] = type(__VSCODE_send_chat_message__IPython)("vscode")
    __VSCODE_send_chat_message__sys.modules["vscode"].chat = chat
    del __VSCODE_send_chat_message__sys
    del __VSCODE_send_chat_message__IPython


__VSCODE_inject_module()
del __VSCODE_inject_module
`,KIe=[[new RegExp("\\\\","g"),"\\\\"],[new RegExp('"',"g"),'\\"'],[new RegExp("'","g"),"'"],[new RegExp("\\\b","g"),"\\b"],[new RegExp("\\f","g"),"\\f"],[new RegExp("\\n","g"),"\\n"],[new RegExp("\\r","g"),"\\r"],[new RegExp("\\t","g"),"\\t"]];function GZ(r,e){let t=Yx(e),n=typeof t=="string"?`"${t}"`:"None";return`
import vscode as __vscode
try:
    __vscode.chat.__on_message('${r}', ${n})
finally:
    del __vscode
`}function Yx(r){if(typeof r!="string")return r;for(let[e,t]of KIe)r=r.replace(e,t);return r}p();p();var ni=require("vscode"),cee=ae(nj());p();var ij=class{constructor(e,t,n,i=!1){this._impl=e;this.controllerId=t;this._endCallback=n;this.clearOutputOnStartWithTime=i;this._started=!1}get started(){return this._started}get cell(){return this._impl.cell}get token(){return this._impl.token}get executionOrder(){return this._impl.executionOrder}set executionOrder(e){var t;e&&((t=Bc(this._impl.cell.notebook))==null||t.executeCellAcknowledged()),this._impl.executionOrder=e}startIfNecessary(){this.started||(this._started=!0,this._impl.start())}start(e){this.started||(this._started=!0,this._impl.start(e),this._startTime=e,this.clearOutputOnStartWithTime?(C.trace(`Start cell ${this.cell.index} execution @ ${e} (clear output)`),this._impl.clearOutput().then(E,E)):C.trace(`Start cell ${this.cell.index} execution @ ${e}`))}end(e,t){if(this._endCallback)try{this._impl.end(e,t,this.errorInfo),C.trace(`Cell ${this.cell.index} completed in ${((t||0)-(this._startTime||0))/1e3}s (start: ${this._startTime}, end: ${t})`)}finally{this._endCallback(),this._endCallback=void 0}}clearOutput(e){return this.startIfNecessary(),this._impl.clearOutput(e)}replaceOutput(e,t){return this.startIfNecessary(),this._impl.replaceOutput(e,t)}appendOutput(e,t){return this.startIfNecessary(),this._impl.appendOutput(e,t)}replaceOutputItems(e,t){return this.startIfNecessary(),this._impl.replaceOutputItems(e,t)}appendOutputItems(e,t){return this.startIfNecessary(),this._impl.appendOutputItems(e,t)}},Vf=class Vf{static getOrCreate(e,t,n=!1){let i;if(i=this.get(e),!i)i=Vf.create(e,t,n);else if(i.controllerId!==t.id){let o=i;o.end(void 0),i=Vf.create(e,t,n),o.started&&i.start(new Date().getTime())}return i}static get(e){return Vf._map.get(e)}static create(e,t,n=!1){let i=new ij(t.createNotebookCellExecution(e),t.id,()=>{Vf._map.delete(e)},n);return Vf._map.set(e,i),i}};Vf._map=new WeakMap;var so=Vf;p();var UIe=ae(tV()),Od=require("vscode");p();var _I=class{constructor(e,t,n,i){this.specFile=t;this.interpreterPath=n;this.isRegisteredByVSC=i;this.name=e.name,this.argv=e.argv,this.language=e.language,this.executable=e.argv&&e.argv.length>0?e.argv[0]:"",this.display_name=e.display_name,this.metadata=e.metadata,this.env=e.env,this.interrupt_mode=e.interrupt_mode}};p();function $x(r){if(r.hasOwnProperty("text/html")){let e=r["text/html"];typeof e=="string"&&e.includes('<iframe id="tensorboard-frame-')&&(r["text/html"]=e.replace(/new URL\((.*), window.location\)/,'new URL("http://localhost")'))}return r}var WIe="{connection_file}";var jf="-jvsc-",VIe=/^python\d*.?\d*$/;async function Qx(r,e){return jIe(await YIe(r),r,e)}function jIe(r,e,t){var s,a;let n=e?{path:ut(e.uri)}:{},i={name:r,language:"python",display_name:(e?(a=(s=Ji(e))==null?void 0:s.environment)==null?void 0:a.name:"")||"Python 3",metadata:{interpreter:n},argv:["python","-m","ipykernel_launcher","-f",WIe],env:{},resources:{}},o=t&&i.name?Vi(t,i.name,"kernel.json"):void 0;return new _I(i,o?ut(o):void 0,ut(e==null?void 0:e.uri),"registeredByNewVersionOfExt")}function gR(r){var t,n,i;let e=r==null?void 0:r.kernelspec;return(t=r==null?void 0:r.language_info)!=null&&t.name&&r.language_info.name!==$e?!1:(n=e==null?void 0:e.name)!=null&&n.includes($e)?!0:(e==null?void 0:e.language)===$e||((i=r==null?void 0:r.language_info)==null?void 0:i.name)===$e}function BIe(r){var i,o,s,a,l;let e=((o=(i=r.metadata)==null?void 0:i.vscode)==null?void 0:o.originalSpecFile)||((s=r.metadata)==null?void 0:s.originalSpecFile),t=e?Ht(Ei(e)):r.name||"",n=((l=(a=r.metadata)==null?void 0:a.vscode)==null?void 0:l.originalDisplayName)||r.display_name||"";return!!(t.toLowerCase().match(VIe)||n.toLowerCase()==="python 3 (ipykernel)"||n.toLowerCase()==="python 3")}function HIe(r){if(r.includes(jf)){let e=/[a-f0-9]$/;if(r.substring(r.lastIndexOf(jf)+jf.length).search(e)!==-1){let t=r.substring(0,r.lastIndexOf(jf));return t.toLowerCase().endsWith(".ipynb")||t.toLowerCase().endsWith(".py")?t:`${t}.ipynb`}}return r}function vR(r){return r.kind!=="connectToLiveRemoteKernel"}function EI(r){return r.kind==="connectToLiveRemoteKernel"}function yR(r,e,t){var u,c,d;e=oj(r)?e:void 0;let n=r.name,i=Bg(r);if(i&&n.includes(zx)&&(n=n.substring(n.indexOf(zx)),i==="registeredByNewVersionOfExtForCustomKernelSpec")){let f=((c=(u=r.metadata)==null?void 0:u.vscode)==null?void 0:c.originalSpecFile)||((d=r.metadata)==null?void 0:d.originalSpecFile);f&&(n=`${n}#${Ht(Ei(f))}`)}let o="";oj(r)?o=r.argv.slice(1).filter(f=>!["-f","{connection_file}"].includes(f)).join("#").toLowerCase():o=r.argv.join("#").toLowerCase();let s=t?`${t}.`:"",a=ut(Uc(r.interpreterPath?Od.Uri.file(r.interpreterPath):Od.Uri.file(r.executable))),l=ut(Uc(e==null?void 0:e.uri))||"";return`${s}${r.id||""}.${n}.${a}.${l}.${o}`}function lt(r){var t,n,i,o;let e=JIe(r);if(!r)return e;switch(r.kind){case"connectToLiveRemoteKernel":{let a=HIe(((n=(t=r.kernelModel)==null?void 0:t.notebook)==null?void 0:n.path)||((o=(i=r.kernelModel)==null?void 0:i.model)==null?void 0:o.path)||"");return a?`${e} (${a})`:e}case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":if(r.interpreter&&br(r.interpreter)!=="Unknown"){let a=_s(r.interpreter);if(r.kernelSpec.language===$e){let l=`Python ${Km(Cc(r.interpreter))||""}`.trim();return a?`${e} (${l})`:e}else return a?`${e} (${a})`:e}else return e;case"startUsingPythonInterpreter":let s=(Km(Cc(r.interpreter))||"").trim();return r.interpreter&&br(r.interpreter)!=="Unknown"?r.kernelSpec.display_name&&Bg(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec"?r.kernelSpec.display_name:qIe(r.interpreter):`Python ${s}`.trim()}return e}function qIe(r){if(br(r)==="Unknown")return"";let e=(Km(Cc(r))||"").trim(),t=Pp(r),n=e.trim()?`Python ${e}`:"Python",i=_s(r);return t&&i?i:i?`${i} (${n})`:n}function JIe(r){var i,o;if(!r)return"";let e=r.kind==="connectToLiveRemoteKernel"?r.kernelModel.display_name:(i=r.kernelSpec)==null?void 0:i.display_name,t=r.kind==="connectToLiveRemoteKernel"?r.kernelModel.name:(o=r.kernelSpec)==null?void 0:o.name,n=r.kind==="startUsingPythonInterpreter"?Uu(r.interpreter):void 0;return[e,t,n,""].find(s=>typeof s=="string"&&s.length>0)||""}function QZ(r,e=""){var t;return r?r.kind==="connectToLiveRemoteKernel"?r.kernelModel.name:(t=r.kernelSpec)==null?void 0:t.name:e}function GIe(r){var n,i,o,s,a;if(!r)return;let e=EI(r)?r.kernelModel:void 0,t=vR(r)?r.kernelSpec:void 0;if(r.kind==="startUsingPythonInterpreter"||(r.kind==="startUsingRemoteKernelSpec"||r.kind==="startUsingLocalKernelSpec")&&r.kernelSpec.language===$e){let l=((i=(n=t==null?void 0:t.metadata)==null?void 0:n.interpreter)==null?void 0:i.path)||(t==null?void 0:t.interpreterPath)||(t==null?void 0:t.executable);if(l==="/python"||l==="python"){let u=Ji(r.interpreter);return((o=u==null?void 0:u.environment)==null?void 0:o.folderUri)||(u?Od.Uri.file(u.path):void 0)}return l?Od.Uri.file(l):void 0}else{let l=(e==null?void 0:e.executable)||(t==null?void 0:t.executable)||((a=(s=t==null?void 0:t.metadata)==null?void 0:s.interpreter)==null?void 0:a.path)||(t==null?void 0:t.interpreterPath);return l?Od.Uri.file(l):void 0}}function sj(r,e=""){if((r==null?void 0:r.kind)==="connectToLiveRemoteKernel"){let t;if(typeof r.kernelModel.lastActivityTime=="string")try{t=new Date(r.kernelModel.lastActivityTime)}catch(n){C.debug(`Error parsing date ${n}`)}else t=r.kernelModel.lastActivityTime;return W.jupyterSelectLiveRemoteKernelDescription(t,r.kernelModel.numberOfConnections)}return e}function XZ(r,e){if((r==null?void 0:r.kind)==="connectToLiveRemoteKernel")return;let t=GIe(r),n=Od.workspace.workspaceFolders?Od.workspace.workspaceFolders:[];return t?Ee(t,n,e.homeDir):""}function ZZ(r){var n,i,o;if(!r)return;if(r.interpreter)return r.interpreter;let e=EI(r)?r.kernelModel:void 0;if((n=e==null?void 0:e.metadata)!=null&&n.interpreter)return Sx((i=e==null?void 0:e.metadata)==null?void 0:i.interpreter,"");let t=vR(r)?r.kernelSpec:void 0;return Sx((o=t==null?void 0:t.metadata)==null?void 0:o.interpreter,"")}function eee(r){return r.kind==="startUsingLocalKernelSpec"||r.kind==="startUsingPythonInterpreter"&&r.kernelSpec&&Bg(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec"}function Qt(r){if(!r)return!1;if(r.kind==="startUsingPythonInterpreter")return!0;let e=EI(r)?r.kernelModel:void 0,t=vR(r)?r.kernelSpec:void 0;return(e==null?void 0:e.language)===$e||oj(t)}function oj(r){return((r==null?void 0:r.language)||"").toLowerCase()===$e}function ru(r){if(!r)return;if(r.kind==="startUsingPythonInterpreter")return $e;let e=EI(r)?r.kernelModel:void 0,t=vR(r)?r.kernelSpec:void 0;return(e==null?void 0:e.language)||ree(t)}function tee(r){var t;if(!r)return;let e=r.kernelspec;return ree(e)||((t=r.language_info)==null?void 0:t.name)}function ree(r){return r==null?void 0:r.language}var zx="jvsc74a57bd0";async function YIe(r){let t=(Km(Cc(r))||"3").replace(/\./g,""),n=r?`python${t}`:"";return r?`${n}${zx}${await Yb(r)}`:"python3"}function Bg(r){var o,s,a,l;if(r.isRegisteredByVSC)return r.isRegisteredByVSC;if(!r.name)return;let e=((s=(o=r.metadata)==null?void 0:o.vscode)==null?void 0:s.originalSpecFile)||((a=r.metadata)==null?void 0:a.originalSpecFile),t=e?Ht(Ei(e)):r.name,n=BIe({...r,name:t})?Object.keys(r.env||{}).length>0:typeof e=="string"&&!e.includes(zx);if(r.name.includes(zx))return n?"registeredByNewVersionOfExtForCustomKernelSpec":"registeredByNewVersionOfExt";let i=/[a-f0-9]{32}$/;if((l=r.metadata)!=null&&l.interpreter&&r.name.toLowerCase().search(i)!==-1)return"registeredByOldVersionOfExt"}function nee(r,e){return!r&&!e?!0:!r&&e||r&&!e?!1:(r==null?void 0:r.id)===(e==null?void 0:e.id)}async function Ai(r,e,t){C.trace(`Executing silently Code (${r.status}) = ${ct(e.substring(0,100)).join("\\n")}`);let n=Bn(),i=r.requestExecute({code:e.replace(/\r\n/g,`
`),silent:!1,stop_on_error:!1,allow_stdin:!0,store_history:!1},!0),o=[];i.onIOPub=a=>{if(n.KernelMessage.isStreamMsg(a))if(C.ci(`Got io pub message (stream), ${ct(a.content.text.substr(0,100)).join("\\n")}`),o.length>0&&o[o.length-1].output_type==="stream"&&o[o.length-1].name===a.content.name){let l=o[o.length-1];l.text+=a.content.text}else{let l={name:a.content.name,text:a.content.text,output_type:"stream"};o.push(l)}else if(n.KernelMessage.isExecuteResultMsg(a)){C.ci("Got io pub message (execresult)}");let l={data:a.content.data,execution_count:a.content.execution_count,metadata:a.content.metadata,output_type:"execute_result"};o.push(l)}else if(n.KernelMessage.isDisplayDataMsg(a)){C.ci("Got io pub message (displaydata)}");let l={data:a.content.data,metadata:a.content.metadata,output_type:"display_data"};o.push(l)}else if(n.KernelMessage.isErrorMsg(a)){if(C.ci(`Got io pub message (error), ${a.content.ename},${a.content.evalue}, ${a.content.traceback.join().substring(0,100)}}`),t!=null&&t.traceErrors){let u=`${t.traceErrorsMessage||"Failed to execute (silent) code against the kernel"}, 
Code = ${e}
Error details: `;C.error(`${u} ${a.content.ename},${a.content.evalue}, ${a.content.traceback.join()}`)}let l={ename:a.content.ename,evalue:a.content.evalue,traceback:a.content.traceback,output_type:"error"};o.push(l)}else C.ci(`Got io pub message (${a.header.msg_type})`)},await i.done;let s=ct(e.substring(0,100)).join("\\n");return t&&$Ie(o,t,s),C.trace(`Executing silently Code (completed) = ${s} with ${o.length} output(s)`),o}function iee(r,e,t,n){e=e.replace(/\r\n/g,`
`);let i=Bn(),o=r.requestExecute({code:e,silent:!1,stop_on_error:!1,allow_stdin:!1,store_history:!1},!0),s=cr(t);return o.onIOPub=a=>{s(),i.KernelMessage.isStreamMsg(a)?n(us({output_type:"stream",name:a.content.name,text:a.content.text})):i.KernelMessage.isExecuteResultMsg(a)?n(us({output_type:"execute_result",data:a.content.data,metadata:a.content.metadata,transient:a.content.transient,execution_count:a.content.execution_count})):i.KernelMessage.isDisplayDataMsg(a)?n(us({output_type:"display_data",data:$x(a.content.data),metadata:a.content.metadata,transient:a.content.transient})):i.KernelMessage.isUpdateDisplayDataMsg(a)?n(us({output_type:"display_data",data:$x(a.content.data),metadata:a.content.metadata,transient:a.content.transient})):i.KernelMessage.isErrorMsg(a)?n(us({output_type:"error",ename:a.content.ename,evalue:a.content.evalue,traceback:a.content.traceback})):i.KernelMessage.isExecuteInputMsg(a)||i.KernelMessage.isStatusMsg(a)||C.warn(`Got unexpected io pub message when executing code sillenty (${a.header.msg_type})`)},o}function $Ie(r,e,t){r.filter(n=>n.output_type==="error").forEach(n=>{let i=n,o=`${i.ename}: ${i.evalue} 
 ${i.traceback.map(a=>`    ${a}`).join(`
`)}`,s=`${e.traceErrorsMessage||""} ${t} ${o}`;e.traceErrors?C.error(s):C.warn(s),e.telemetryName&&ne(e.telemetryName)})}p();function bR(r){return typeof Buffer!="undefined"&&typeof Buffer.from=="function"?Buffer.from(r,"base64"):Uint8Array.from(atob(r),e=>e.charCodeAt(0))}var zIe=new TextDecoder;function IR(r){if(typeof Buffer!="undefined"&&typeof Buffer.from=="function")return Buffer.from(r).toString("base64");{let e=zIe.decode(r);return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(t,n){return String.fromCharCode(Number.parseInt("0x"+n))}))}}var oee=["application/vnd.*","application/vdom.*","application/geo+json","application/x-nteract-model-debug+json","text/html","application/javascript","image/gif","text/latex","text/markdown","image/png","image/svg+xml","image/jpeg","application/json","text/plain"];function see(r){if(r.mime.startsWith("application/vnd."))try{return new TextDecoder().decode(r.data).length===0}catch(e){}return!1}function QIe(r){return r.sort((e,t)=>{let n=(s,a)=>(s.endsWith(".*")&&(s=s.substr(0,s.indexOf(".*"))),a.startsWith(s)),i=oee.findIndex(s=>n(s,e.mime)),o=oee.findIndex(s=>n(s,t.mime));return see(e)&&(i=-1),see(t)&&(o=-1),i=i==-1?100:i,o=o==-1?100:o,i-o})}var Bf=class Bf{static getCellState(e){var t;return(t=Bf.cellStates.get(e))==null?void 0:t.state}static getCellStatus(e){var t;return(((t=Bf.cellStates.get(e))==null?void 0:t.stateTransition)||[]).join(", ")||""}static setCellState(e,t){var o,s;let n=((o=Bf.cellStates.get(e))==null?void 0:o.start)||new bt,i=((s=Bf.cellStates.get(e))==null?void 0:s.stateTransition)||[];i.push(`${t} ${i.length===0?"@ start":`After ${n.elapsedTime}ms`}`),Bf.cellStates.set(e,{stateTransition:i,state:t,start:n})}};Bf.cellStates=new WeakMap;var Hf=Bf;function it(r,e){let t=typeof e=="string"?()=>e:e;C.ci(()=>{var n;return`Cell Index:${r.index}, of document ${di(r.notebook.uri)} with state:${Hf.getCellStatus(r)}, exec: ${(n=r.executionSummary)==null?void 0:n.executionOrder}. ${t()}. called from ${f8()}`})}var wI=new Map;wI.set("display_data",_R);wI.set("error",tSe);wI.set("execute_result",_R);wI.set("stream",XIe);wI.set("update_display_data",_R);function us(r){let e=wI.get(r.output_type),t;return e?t=e(r):(C.warn(`Unable to translate cell from ${r.output_type} to NotebookCellData for VS Code.`),t=_R(r)),t}function aj(r){let e={outputType:r.output_type};switch(r.transient&&(e.transient=r.transient),r.output_type){case"display_data":case"execute_result":case"update_display_data":{e.executionCount=r.execution_count,e.metadata=r.metadata?JSON.parse(JSON.stringify(r.metadata)):{};break}default:break}return e}function Hg(r){return r.metadata}function _R(r){let e=aj(r);("image/svg+xml"in r.data||"image/png"in r.data)&&(e.__displayOpenPlotIcon=!0);let t=[];if(r.data)for(let n in r.data)t.push(eSe(n,r.data[n]));return new ni.NotebookCellOutput(QIe(t),e)}function XIe(r){let e=jc(r.text),t=r.name==="stderr"?ni.NotebookCellOutputItem.stderr:ni.NotebookCellOutputItem.stdout;return new ni.NotebookCellOutput([t(e)],aj(r))}function ZIe(r){if(r.items.length>0)return r.items[0].mime==="application/vnd.code.notebook.stderr"?"stderr":"stdout"}function aee(r){var i;let e=r.items[0];if(!e.data)return{output_type:"error",ename:"",evalue:"",traceback:[]};let t=(i=r.metadata)==null?void 0:i.originalError,n=JSON.parse(new TextDecoder().decode(e.data));return{output_type:"error",ename:n.name,evalue:n.message,traceback:(t==null?void 0:t.traceback)||oI(n.stack||n.message||"")}}var CI=new TextDecoder,uee=["text/plain","text/markdown","application/vnd.code.notebook.stderr","application/vnd.code.notebook.stdout"];function SR(r,e){if(!e)return"";try{if(r==="application/vnd.code.notebook.error"){let t=CI.decode(e);return JSON.parse(t)}else if(r.startsWith("text/")||uee.includes(r)){let t=CI.decode(e);return oI(t)}else{if(r.startsWith("image/")&&r!=="image/svg+xml")return IR(e);if(r.toLowerCase().startsWith("application/vnd.holoviews_load.v")&&r.toLowerCase().endsWith("+json")){let t=CI.decode(e);try{return t.length>0?JSON.parse(t):t}catch(n){return t}}else if(r.toLowerCase().includes("json")){let t=CI.decode(e);return t.length>0?JSON.parse(t):t}else return CI.decode(e)}}catch(t){return C.error(`Failed to convert ${r} output from a buffer ${typeof e}, ${e}`,t),""}}function eSe(r,e){if(!e)return ni.NotebookCellOutputItem.text("",r);try{if((r.startsWith("text/")||uee.includes(r))&&(Array.isArray(e)||typeof e=="string")){let t=Array.isArray(e)?jc(e):e;return ni.NotebookCellOutputItem.text(t,r)}else return r.startsWith("image/")&&typeof e=="string"&&r!=="image/svg+xml"?new ni.NotebookCellOutputItem(bR(e),r):typeof e=="object"&&e!==null&&!Array.isArray(e)?ni.NotebookCellOutputItem.text(JSON.stringify(e),r):(e=Array.isArray(e)?jc(e):e,ni.NotebookCellOutputItem.text(e,r))}catch(t){return C.error(`Failed to convert ${r} output to a buffer ${typeof e}, ${e}`,t),ni.NotebookCellOutputItem.text("")}}function lee(r){let e=[];r.items.filter(n=>n.mime==="application/vnd.code.notebook.stderr"||n.mime==="application/vnd.code.notebook.stdout").map(n=>CI.decode(n.data)).forEach(n=>{let i=n.split(`
`);e.length&&i.length&&i[0].length>0&&(e[e.length-1]=`${e[e.length-1]}${i.shift()}`);for(let o of i)e.push(o)});for(let n=0;n<e.length-1;n++)e[n]=`${e[n]}
`;return e.length&&e[e.length-1].length===0&&e.pop(),{output_type:"stream",name:ZIe(r)||"stdout",text:e}}function lj(r){let e=r.metadata,t;switch(e==null?void 0:e.outputType){case"error":{t=aee(r);break}case"stream":{t=lee(r);break}case"display_data":{t={output_type:"display_data",data:r.items.reduce((i,o)=>(i[o.mime]=SR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{}};break}case"execute_result":{t={output_type:"execute_result",data:r.items.reduce((i,o)=>(i[o.mime]=SR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{},execution_count:typeof(e==null?void 0:e.executionCount)=="number"?e==null?void 0:e.executionCount:null};break}case"update_display_data":{t={output_type:"update_display_data",data:r.items.reduce((i,o)=>(i[o.mime]=SR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{}};break}default:{let i=r.items.length===1&&r.items.every(l=>l.mime==="application/vnd.code.notebook.error"),o=r.items.every(l=>l.mime==="application/vnd.code.notebook.stderr"||l.mime==="application/vnd.code.notebook.stdout");if(i)return aee(r);let s=(e==null?void 0:e.outputType)||(o?"stream":"display_data");ne("DS_INTERNAL.VSCNOTEBOOK_CELL_TRANSLATION_FAILED",void 0,{outputType:s});let a;s==="stream"?a=lee(r):s==="display_data"?a={data:{},metadata:{},output_type:"display_data"}:a={output_type:s},e!=null&&e.metadata&&(a.metadata=e.metadata),r.items.length>0&&(a.data=r.items.reduce((l,u)=>(l[u.mime]=SR(u.mime,u.data),l),{})),t=a;break}}return t&&e&&e.transient&&(t.transient=e.transient),t}function tSe(r){return r=r||{output_type:"error",ename:"",evalue:"",traceback:[]},new ni.NotebookCellOutput([ni.NotebookCellOutputItem.error({name:(r==null?void 0:r.ename)||"",message:(r==null?void 0:r.evalue)||"",stack:((r==null?void 0:r.traceback)||[]).join(`
`)})],{...aj(r),originalError:r})}async function dee(r,e,t){var a,l,u,c,d,f,m,g,b,v,k,R,P,D,K,L,B;let n=!1,i;if(!r)return{changed:n,kernelId:i};(a=r==null?void 0:r.language_info)!=null&&a.name||(r.language_info=r.language_info||{name:""});let o;switch(e==null?void 0:e.kind){case"connectToLiveRemoteKernel":o=e.kernelModel.language;break;case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":o=e.kernelSpec.language;break;case"startUsingPythonInterpreter":o=$e;break;default:break}if(r.language_info.name!==o&&o&&(r.language_info.name=o,n=!0),t&&"language_info"in t&&t.language_info)(0,cee.default)(r.language_info,t.language_info)||(r.language_info=JSON.parse(JSON.stringify(t.language_info)),n=!0);else{let N=Qt(e),O=N?ZZ(e):void 0,h=await Dp(O),y=h?`${h.major}.${h.minor}.${h.micro}`:"";O&&h&&r&&r.language_info&&r.language_info.version!==y?(r.language_info.version=y,n=!0):!O&&(r!=null&&r.language_info)&&N&&(r.language_info=void 0,n=!0)}let s=e&&EI(e)?e.kernelModel:e&&"kernelSpec"in e?e.kernelSpec:void 0;if((e==null?void 0:e.kind)==="startUsingPythonInterpreter"){let N=e.kernelSpec,O=N.display_name||((u=(l=Ji(e.interpreter))==null?void 0:l.environment)==null?void 0:u.name)||"",h="";switch(Bg(N)){case"registeredByOldVersionOfExt":case"registeredByNewVersionOfExt":h="python3";break;case"registeredByNewVersionOfExtForCustomKernelSpec":{h=((d=(c=N.metadata)==null?void 0:c.vscode)!=null&&d.originalSpecFile?Ht(Ei(N.metadata.vscode.originalSpecFile)):void 0)||N.name,O=((m=(f=N.metadata)==null?void 0:f.vscode)==null?void 0:m.originalDisplayName)||O;break}default:h=N.name;break}(((g=r.kernelspec)==null?void 0:g.name)!==h||((b=r.kernelspec)==null?void 0:b.display_name)!==O)&&(n=!0,r.kernelspec={name:h,language:$e,display_name:O},"vscode"in r&&delete r.vscode,"interpreter"in r&&delete r.interpreter)}else if(s&&!r.kernelspec){let N=(k=(v=s.metadata)==null?void 0:v.vscode)!=null&&k.originalSpecFile?Ht(Ei(s.metadata.vscode.originalSpecFile)):void 0;r.kernelspec={name:N||s.name||s.display_name||"",display_name:((P=(R=s.metadata)==null?void 0:R.vscode)==null?void 0:P.originalDisplayName)||s.display_name||s.name||""},s.language&&(r.kernelspec.language=s.language),i=s.id,n=!0}else if(s&&r.kernelspec){let O=((K=(D=s.metadata)==null?void 0:D.vscode)!=null&&K.originalSpecFile?Ht(Ei(s.metadata.vscode.originalSpecFile)):void 0)||s.name||s.display_name||"",h=((B=(L=s.metadata)==null?void 0:L.vscode)==null?void 0:B.originalDisplayName)||s.display_name||s.name||"",y=s.language||s.language||"";(r.kernelspec.name!==O||r.kernelspec.language!==y||r.kernelspec.display_name!==h||i!==s.id)&&(n=!0,r.kernelspec.name=O,r.kernelspec.display_name=h,r.kernelspec.language=y,i=s.id);try{delete r.kernelspec.metadata}catch(w){}}return{changed:n,kernelId:i}}async function Ld(r,e,t,n){var a,l,u,c,d,f,m;let i=vy(t);if(!i){let g=so.get(r);n&&(g!=null&&g.started)&&g.end(n?void 0:!1,(l=(a=r.executionSummary)==null?void 0:a.timing)==null?void 0:l.endTime);return}so.get(r)||(n=!0);let o=so.getOrCreate(r,e),s=o.executionOrder;o.started||(o.start((c=(u=r.executionSummary)==null?void 0:u.timing)==null?void 0:c.startTime),o.executionOrder=((d=r.executionSummary)==null?void 0:d.executionOrder)||s),await o.appendOutput(i),o.end(n?void 0:!1,(m=(f=r.executionSummary)==null?void 0:f.timing)==null?void 0:m.endTime)}var rSe=/(?:\u001b\[|\u009b)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~]/,nSe=/(?:\u001b\]|\u009d).*?(?:\u001b\\|\u0007|\u009c)/,iSe=/\u001b(?:[ #%\(\)\*\+\-\.\/]?[a-zA-Z0-9\|}~@])/,oSe=new RegExp("(?:"+[rSe.source,nSe.source,iSe.source].join("|")+")","g");function sSe(r){return r&&(r=r.replace(oSe,"")),r.trim()}function pee(r,e){var s;let t=/Cell\s+In\s*\[(?<executionCount>\d+)\],\s*line (?<lineNumber>\d+).*/,n=/Input\s+?In\s*\[(?<executionCount>\d+)\][^<]*<cell line:\s?(?<lineNumber>\d+)>.*/,i;for(let a of r){let l=sSe(a),u=(s=t.exec(l))!=null?s:n.exec(l);if(u&&u.groups){i=parseInt(u.groups.lineNumber);break}}let o;if(i&&i>0&&i<=e.document.lineCount){let a=e.document.lineAt(i-1),l=a.text.split("#")[0].trimEnd().length;o=new ni.Range(new ni.Position(a.lineNumber,a.firstNonWhitespaceCharacterIndex),new ni.Position(a.lineNumber,l))}return o}var Xx=new WeakMap;function ER(r,e,t){var a,l;let n=Hg(t),i=(a=n==null?void 0:n.transient)==null?void 0:a.display_id;if(((l=t.metadata)==null?void 0:l.outputType)!=="display_data"||!i)return;let o=Xx.get(e)||new Map;Xx.set(e,o);let s=o.get(r)||[];o.set(r,s),s.push(i),s.length>1e3&&s.shift()}function fee(r,e){let t=Xx.get(r)||new Map;for(let n of t.values())if(n.includes(e))return!0;return!1}function mee(r,e,t){return((Xx.get(e)||new Map).get(r)||[]).includes(t)}function hee(r,e){let t=Xx.get(r)||new Map;for(let n of t.values()){let i=n.indexOf(e);i>=0&&n.splice(i,1)}}p();var Tn=require("vscode");var xI=new Map,gee=new Set,xR=new Tn.EventEmitter;Lu(xR);function vee(r){return xR.event(r)}async function yee(r){if(!Tn.workspace.isTrusted)return{accessAllowed:!1};if(r===Ge)return{accessAllowed:!0};let e=xI.get(r);return e||(e=aSe(r),xI.set(r,e),e.then(({result:t})=>{(t==="learnMore"||t==="cancelled")&&xI.get(r)===e&&(xI.delete(r),gee.add(r))})),e.then(({result:t})=>({accessAllowed:t==="allowed"}))}async function aSe(r){var s,a;let e=await cj();if(e.get(r)===!0)return{result:"allowed"};if(e.get(r)===!1)return C.warn(`Kernel API access already revoked for extension ${r}`),{result:"denied"};let t=(a=(s=Tn.extensions.getExtension(r))==null?void 0:s.packageJSON)==null?void 0:a.displayName;if(!t)return C.error(`Kernel API access revoked, as extension ${r} does not exist!`),{result:"denied"};let n=Tn.l10n.t("Allow"),i=Tn.l10n.t("Deny"),o=await Tn.window.showInformationMessage(Tn.l10n.t("Do you want to grant Kernel access to the extension {0} ({1})?",t,r),{modal:!0,detail:Tn.l10n.t("This allows the extension to execute code against Jupyter Kernels.")},n,Ue.learnMore,i);switch(o===Ue.learnMore?Tn.env.openExternal(Tn.Uri.parse("https://aka.ms/vscodeJupyterKernelApiAccess")).then(E,E):(o===n||o===i)&&await lSe(r,o===n),o){case n:return{result:"allowed"};case Ue.learnMore:return{result:"learnMore"};case i:return C.error(`Kernel API access revoked for extension ${r}`),{result:"denied"};default:return{result:"cancelled"}}}async function bee(){let r=new Set,[e]=await Promise.all([cj().then(t=>new Map(t)),...Array.from(xI.entries()).map(async([t,n])=>{(await n).result!=="allowed"&&r.add(t)})]);return r.forEach(t=>e.set(t,!1)),gee.forEach(t=>e.set(t,e.get(t)===!0)),e}var CR="API.Access",qf;async function cj(r=!1){let e=et.instance.get(st);if(e.extensionMode===Tn.ExtensionMode.Test)return new Map;if(cr(()=>{et.instance.get(ve).push(e.secrets.onDidChange(i=>{i.key===CR&&(qf=void 0)}))})(),qf&&!r)return qf;let t="";try{return t=await e.secrets.get(CR),!t||t.length===0?new Map:(qf=new Map(Object.entries(JSON.parse(t))),qf)}catch(n){return C.error(`Failed to parse API access information ${t}`,n),new Map}}var wR=Promise.resolve();async function Iee(r){return wR=wR.then(async()=>{await Promise.all(Array.from(xI.entries()).map(async([t,n])=>{let i=await n;i.result=r.includes(t)===!0?"allowed":"denied"})),qf=new Map(r.map(t=>[t,!0]));let e=et.instance.get(st);if(e.extensionMode!==Tn.ExtensionMode.Test)try{await e.secrets.store(CR,JSON.stringify(Object.fromEntries(qf))),xR.fire()}catch(t){C.error(`Failed to update API access information ${JSON.stringify(Object.fromEntries(qf))}`,t)}})}async function lSe(r,e){return wR=wR.then(async()=>{let t=et.instance.get(st);if(t.extensionMode===Tn.ExtensionMode.Test)return;let n=await cj(!0);if(e!==n.get(r)){n.set(r,e);try{await t.secrets.store(CR,JSON.stringify(Object.fromEntries(n))),xR.fire()}catch(i){C.error(`Failed to store API access information ${JSON.stringify(Object.fromEntries(n))}`,i)}}})}p();var See=" (Interactive)",Nt=Symbol("IControllerRegistration");var PR=Symbol("IRemoteNotebookKernelSourceSelector"),_ee=Symbol("ILocalNotebookKernelSourceSelector"),DR=Symbol("ILocalPythonNotebookKernelSourceSelector"),PI=Symbol("IConnectionDisplayData");p();var ds=require("vscode");var uj=class extends MD{constructor(t,n){super();this.controller=t;this.notebook=n}dispose(){this.disposeExistingExecution()}createReferencedObject(t,...n){return this.existingExecutions||(this.existingExecutions=this.controller.createNotebookExecution(this.notebook),this.existingExecutions.start()),this.existingExecutions}destroyReferencedObject(t,n){this.disposeExistingExecution()}disposeExistingExecution(){var t;try{(t=this.existingExecutions)==null||t.end()}catch(n){}this.existingExecutions=void 0}},Zx=class Zx{constructor(e,t,n){this.extensionId=e;this.kernel=t;var o,s;this.executionRefCountedDisposableFactory=n?new uj(n,t.notebook):void 0;let i=((s=(o=ds.extensions.getExtension(e))==null?void 0:o.packageJSON)==null?void 0:s.displayName)||e;this.notebook=ds.workspace.notebookDocuments.find(a=>{var l;return a.uri.toString()===((l=t.resourceUri)==null?void 0:l.toString())}),this.controllerDisplayName=lt(t.kernelConnectionMetadata),this.title=ds.l10n.t("Executing code in {0} from {1}",this.controllerDisplayName,i),this.eventHandler=ds.window.onDidChangeVisibleNotebookEditors(this.showProgressImpl,this)}dispose(){var e,t;this.eventHandler.dispose(),(e=this.disposable)==null||e.dispose(),(t=this.executionRefCountedDisposableFactory)==null||t.dispose()}show(){var t;let e;try{e=(t=this.executionRefCountedDisposableFactory)==null?void 0:t.acquire("")}catch(n){}if(this.deferred&&!this.deferred.completed){let n=this.deferred;this.deferred=Oe(),n.resolve()}else this.deferred=Oe(),this.showProgress().catch(E);return this.disposable=new ds.Disposable(()=>{var n;e==null||e.dispose(),(n=this.deferred)==null||n.resolve()})}async showProgress(){await nc(1e3),!(!this.deferred||this.deferred.completed||this.displayInProgress)&&(this.shouldDisplayProgress=!0,await Promise.all([this.showProgressImpl(),this.waitUntilCompleted()]),this.shouldDisplayProgress=!1)}async showProgressImpl(){let e=Zx.notificationsPerExtension.get(this.kernel)||new Set;Zx.notificationsPerExtension.set(this.kernel,e),!e.has(this.extensionId)&&(e.add(this.extensionId),!(!this.notebook||!this.shouldDisplayProgress)&&ds.window.visibleNotebookEditors.some(t=>t.notebook===this.notebook)&&(this.displayInProgress=!0,await ds.window.withProgress({location:ds.ProgressLocation.Notification,title:this.title},async()=>this.waitUntilCompleted()),this.displayInProgress=!1))}async waitUntilCompleted(){let e=this.deferred;for(;e&&!e.completed;)await e.promise,e=this.deferred}};Zx.notificationsPerExtension=new WeakMap;var TR=Zx;var pj=class extends Error{constructor(){super(qg.l10n.t("Access to Jupyter Kernel has been revoked")),this.name="vscode.jupyter.apiAccessRevoked"}},fj=class r extends Pr{constructor(t,n,i,o){super();this.extensionId=t;this.kernel=n;this.execution=i;this._onDidChangeStatus=this._register(new qg.EventEmitter);this._onDidReceiveDisplayUpdate=this._register(new qg.EventEmitter);this.progress=this._register(new TR(t,n,o)),this._register(Ag(n.onDisposed)(()=>this.progress.dispose())),this.language=n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"?$e:n.kernelConnectionMetadata.kernelSpec.language||$e,this._register(this.kernel.onStatusChanged(()=>this._onDidChangeStatus.fire(this.kernel.status))),this._register(i.onDidReceiveDisplayUpdate(a=>{var c,d;let l=this.kernel.session,u=Hg(a);(u==null?void 0:u.outputType)==="display_data"&&((c=u==null?void 0:u.transient)!=null&&c.display_id)&&l&&mee(this.extensionId,l,(d=u==null?void 0:u.transient)==null?void 0:d.display_id)&&this._onDidReceiveDisplayUpdate.fire(a)}));let s=this;this._api=Object.freeze({language:this.language,get status(){return s.kernel.status},onDidChangeStatus:s.onDidChangeStatus.bind(this),get onDidReceiveDisplayUpdate(){if(![Ge,fD,dD].includes(t)&&!pD.includes(t.split(".")[0]))throw new Error(`Proposed API is not supported for extension ${t}`);return s.onDidReceiveDisplayUpdate.bind(this)},executeCode:(a,l)=>this.executeCode(a,l)})}get status(){return this.kernel.status}get onDidChangeStatus(){return this._onDidChangeStatus.event}get onDidReceiveDisplayUpdate(){return this._onDidReceiveDisplayUpdate.event}static createApiKernel(t,n,i,o){let s=new r(t,n,i,o);return et.instance.get(ve).push(s),{api:s._api,progress:s.progress}}async checkAccess(){if(this.extensionId===Ge)return;if(this.accessAllowed||(this.accessAllowed=this.doCheckAccess(),this._register(vee(()=>this.accessAllowed=void 0))),!await this.accessAllowed)throw new pj}async doCheckAccess(){let n=(await yee(this.extensionId)).accessAllowed;return ne("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:this.extensionId,pemUsed:"getKernel",accessAllowed:n}),n}async*executeCode(t,n){await this.checkAccess();for await(let i of this.executeCodeInternal(t,void 0,n))yield i}async*executeCodeInternal(t,n={},i){var m;let o=!1,s={executionCount:this.execution.executionCount,requestSentAfter:0,requestAcknowledgedAfter:0,cancelledAfter:0,duration:0},a={kernelId:"",extensionId:this.extensionId,cancelled:!1,requestSent:!1,requestAcknowledged:!1,cancelledBeforeRequestSent:!1,cancelledBeforeRequestAcknowledged:!1,mimeTypes:"",failed:!1},l=new bt,u=new Set;if(cSe(this.extensionId,this.kernel,"executeCode",s.executionCount).catch(E),this.kernel.disposed)throw a.failed=!0,dj(this.kernel,s,a).catch(E),new Error("Kernel is disposed");if(!((m=this.kernel.session)!=null&&m.kernel))throw a.failed=!0,dj(this.kernel,s,a).catch(E),this.kernel.status==="dead"||this.kernel.status==="terminating"?new Error("Kernel is dead or terminating"):new Error("Kernel connection not available to execute 3rd party code");let c=[];c.push({dispose:()=>{s.duration=l.elapsedTime,a.mimeTypes=Array.from(u).join(","),o=!0,dj(this.kernel,s,a).catch(E)}});let d=et.instance.get(qe).getKernelExecution(this.kernel),f={started:new qg.EventEmitter,executionAcknowledged:new qg.EventEmitter};f.started.event(()=>{a.requestSent=!0,s.requestSentAfter=l.elapsedTime,!i.isCancellationRequested&&this.extensionId!==Ge&&c.push(this.progress.show())},this,c),f.executionAcknowledged.event(()=>{a.requestAcknowledged=!0,s.requestAcknowledgedAfter=l.elapsedTime},this,c),i.onCancellationRequested(()=>{o||(a.cancelled=!0,s.cancelledAfter=l.elapsedTime,a.cancelledBeforeRequestSent=!a.requestSent,a.cancelledBeforeRequestAcknowledged=!a.requestAcknowledged,C.debug(`Code execution cancelled by extension ${this.extensionId}`))},this,c);try{for await(let g of d.executeCode(t,this.extensionId,f,i))if(ER(this.extensionId,this.kernel.session,g),g.items.forEach(b=>u.add(b.mime)),n&&Eee(g))for await(let b of this.handleChatOutput(g,d,f,u,n,i))yield b;else yield g}finally{Ce(c)}}async*handleChatOutput(t,n,i,o,s={},a){let l=t.items.find(v=>v.mime===hR);if(!l)return;let u=(t.metadata||{}).metadata,c=u.function,d=u.id,f=u.dataIsNone?void 0:new TextDecoder().decode(l.data),m=s[c];if(!m)throw new Error(`Chat Function ${c} not found`);let g=await m(f),b=GZ(d,g);for await(let v of n.executeCode(b,this.extensionId,i,a))if(v.items.forEach(k=>o.add(k.mime)),Eee(v))for await(let k of this.handleChatOutput(v,n,i,o,s,a))yield k;else yield v}};function Eee(r){return r.items.some(e=>e.mime===hR)}async function cSe(r,e,t,n){let i=await Rt(e.id);ne("DATASCIENCE.JUPYTER_NEW_KERNEL_API_USAGE",{executionCount:n},{kernelId:i,pemUsed:t,extensionId:r})}async function dj(r,e,t){t.kernelId=await Rt(r.id),ne("DATASCIENCE.JUPYTER_NEW_KERNEL_API_EXEC",e,t)}function kR(r,e){var i;let t=et.instance.get(qe),n=(i=et.instance.get(Nt).getSelected(e.notebook))==null?void 0:i.controller;return fj.createApiKernel(r,e,t.getKernelExecution(e),n)}p();p();var DI=ae(he());p();var w$e=Symbol("IReservedPythonNamedProvider"),x$e=Symbol("IInterpreterPackages"),Cee=Symbol("IWorkspaceInterpreterTracker");var Ol=class{constructor(e){this.workspaceInterpreterTracker=e;Ol.isActiveWorkspaceInterpreter=this.isActiveWorkspaceInterpreterImpl.bind(this)}activate(){var e;(e=this.workspaceInterpreterTracker)==null||e.activate()}isActiveWorkspaceInterpreterImpl(e,t){var n,i;return(i=(n=this.workspaceInterpreterTracker)==null?void 0:n.isActiveWorkspaceInterpreter(e,t))!=null?i:!1}};Ol.isActiveWorkspaceInterpreter=()=>!1,Ol=U([(0,DI.injectable)(),x(0,(0,DI.inject)(Cee)),x(0,(0,DI.optional)())],Ol);async function eP(r,e){if(!r)return;let t=Wa(r),[n,i]=XN.get(t)||[{resourceType:Al(r),resourceHash:r?await Rt(r.toString()):void 0,kernelSessionId:await Rt(Date.now().toString()),capturedEnvVars:void 0,userExecutedCell:void 0,disableUI:void 0,kernelLanguage:void 0,kernelId:void 0,kernelSpecHash:void 0,isUsingActiveInterpreter:void 0,pythonEnvironmentType:void 0,pythonEnvironmentPath:void 0,pythonEnvironmentVersion:void 0,kernelConnectionType:void 0},{previouslySelectedKernelConnectionId:""}];typeof e.capturedEnvVars=="boolean"&&(n.capturedEnvVars=e.capturedEnvVars),e.userExecutedCell&&(n.userExecutedCell=!0),typeof e.disableUI=="boolean"&&(n.disableUI=e.disableUI);let o=e.kernelConnection;if(o){let s=o.id;i.previouslySelectedKernelConnectionId!==s&&(n.userExecutedCell=e.userExecutedCell,n.disableUI=e.disableUI),i.previouslySelectedKernelConnectionId&&i.previouslySelectedKernelConnectionId!==s&&(n.kernelSessionId=await Rt(Date.now().toString()));let a;switch(o.kind){case"connectToLiveRemoteKernel":a=o.kernelModel.language;break;case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":a=o.kernelSpec.language;break;case"startUsingPythonInterpreter":a=$e;break;default:break}let l="kernelSpec"in o&&o.kernelSpec.specFile?Rt(o.kernelSpec.specFile):Promise.resolve("");n.kernelLanguage=a,[n.kernelId,n.kernelSpecHash]=await Promise.all([Rt(o.id),l]),i.previouslySelectedKernelConnectionId=o.id;let u=o.interpreter;if(u){n.isUsingActiveInterpreter=Ol.isActiveWorkspaceInterpreter(r,u),n.pythonEnvironmentType=br(u);let[c,d]=await Promise.all([Rt(ut(Uc(u.uri))),Dp(u)]);n.pythonEnvironmentPath=c,H2.set(n.pythonEnvironmentPath,u),d?n.pythonEnvironmentVersion=`${d.major}.${d.minor}.${d.micro}`:n.pythonEnvironmentVersion=void 0,q2(n)}n.kernelConnectionType=n.kernelConnectionType||(o==null?void 0:o.kind)}else i.previouslySelectedKernelConnectionId="";XN.set(t,[n,i])}async function Ll(r,e){await eP(r,{kernelConnection:e,userExecutedCell:!0})}var mj=new Map;function xee(r){return mj.has(r)||mj.set(r,{onDidStart:void 0,kernels:new WeakMap}),mj.get(r)}function wee(r,e){let t=xee(e),n=t.kernels.get(r)||kR(e,r);return t.kernels.set(r,n),n}function Pee(r){return{async getKernel(e){let t,n=et.instance.get(qe),i=NR.workspace.notebookDocuments.find(a=>a.uri.toString()===e.toString()),o=n.get(i||e);if(!o||!o.startedAtLeastOnce||!o.userStartedKernel){ne("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:r,pemUsed:"getKernel",accessAllowed:t});return}r!==Ge&&Ll(o.resourceUri,o.kernelConnectionMetadata);let{api:s}=wee(o,r);return s},get onDidStart(){if(![Ge,dD].includes(r)&&!pD.includes(r.split(".")[0]))throw new Error(`Proposed API is not supported for extension ${r}`);let e=xee(r);if(!e.onDidStart){let t=et.instance.get(qe),n=et.instance.get(ve);e.onDidStart=new NR.EventEmitter,n.push(e.onDidStart,t.onDidPostInitializeKernel(({kernel:i,token:o,waitUntil:s})=>{var u;let{api:a,progress:l}=wee(i,r);(u=e.onDidStart)==null||u.fire({uri:i.uri,kernel:a,token:o,waitUntil:c=>{let d=Ka(Promise.resolve(c));s(c);let f=l.show(),m=new bt;d.promise.finally(()=>{C.trace(`${r} took ${m.elapsedTime}ms during kernel startup`),Rr(i.resourceUri,"DATASCIENCE.JUPYTER_NEW_KERNEL_API_KERNEL_STARTUP_WAIT_UNTIL",{duration:m.elapsedTime},{extensionId:r}),f.dispose()})}})}),e.onDidStart)}return e.onDidStart.event}}}p();p();var Dee=Symbol("JupyterServerHelper"),sze=Symbol("INotebookImporter"),TI=Symbol("INotebookExporter"),Tee=Symbol("IJupyterInterpreterDependencyManager"),aze=Symbol("INbConvertInterpreterDependencyChecker"),lze=Symbol("INbConvertExportToPythonService"),RR=Symbol("IJupyterServerProvider"),pr=Symbol("IJupyterServerUriStorage"),AR=Symbol("IJupyterKernelService"),MR=Symbol("IJupyterRequestAgentCreator"),Jg=Symbol("IJupyterRequestCreator"),cze=Symbol("INotebookStarter"),Gg=Symbol("ILiveRemoteKernelConnectionUsageTracker"),OR=Symbol("IJupyterRemoteCachedKernelValidator"),sr=Symbol("IJupyterServerProviderRegistry");function LR(r,e,t,n,i){ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n,pemUsed:"createJupyterServerCollection"});let s=i.get(sr).createJupyterServerCollection(n,r,$v(e),t);return{dispose:()=>{s==null||s.dispose()},get id(){return r},set label(l){s.label=$v(l)},get label(){return s.label},set documentation(l){s.documentation=l},get documentation(){return s.documentation},set commandProvider(l){s.commandProvider=l},get commandProvider(){return s.commandProvider}}}p();var kee=!1;function Nee(r,e){if(kee)return;kee=!0,e.get(my).setApi(r)}p();var $f=require("vscode");p();var kI=ae(he());p();var ou=ae(he());p();var Jf=class extends ot{constructor(t,n){super("remotejupyterserveruriprovider",n.message||n.toString());this.serverProviderHandle=t;this.originalError=n}};p();var Mi=class extends ot{constructor(e){super("jupyterselfcert",e)}static isSelfCertsError(e){var n;let t=(n=e==null?void 0:e.message)!=null?n:"";return t.indexOf("reason: self signed certificate")>=0||t.indexOf("reason: unable to verify the first certificate")>=0||t.indexOf("reason: unable to get issuer certificate")>=0||t.indexOf("is not in the cert's list")>=0}};p();var nu=class extends ot{constructor(e){super("jupyterselfexpiredcert",e)}static isSelfCertsExpiredError(e){return e.message.indexOf("reason: certificate has expired")>=0}};p();var mn=Symbol("IDataScienceErrorHandler"),yi=class extends ot{constructor(t,n,i){super(t,n);this.kernelConnectionMetadata=i}},iu=class extends Ur{constructor(t,n,i){super(t,n);this.kernelConnectionMetadata=i}};p();var ao=class extends ot{constructor(t,n,i){super("remotejupyterserverconnection",W.remoteJupyterConnectionFailedWithServerWithError(Ree(t),i.message||i.toString()));this.url=t;this.serverProviderHandle=n;this.originalError=i;this.baseUrl=Ree(t)}};function Ree(r){let e=new URL(r);return`${e.protocol}//${e.host}/`}var tP=require("vscode");p();var Aee=require("vscode");var Gf=class r extends ac{constructor(t){super();this.serverSettings=t;this._isDisposing=!1;this.kernelSpecManager=new this.jupyterlab.KernelSpecManager({serverSettings:this.serverSettings}),this.kernelManager=new this.jupyterlab.KernelManager({serverSettings:this.serverSettings}),this.sessionManager=new this.jupyterlab.SessionManager({serverSettings:this.serverSettings,kernelManager:this.kernelManager}),this.contentsManager=new this.jupyterlab.ContentsManager({serverSettings:this.serverSettings})}get jupyterlab(){return this._jupyterlab||(this._jupyterlab=Bn()),this._jupyterlab}static create(t){return new r(t)}dispose(){this.isDisposed||this._isDisposing||(this._isDisposing=!0,(async()=>{var t,n,i,o;C.trace("Disposing Jupyter Lab Helper");try{this.contentsManager&&(C.trace("SessionManager - dispose contents manager"),this.contentsManager.dispose()),this.sessionManager&&!this.sessionManager.isDisposed&&(C.trace("ShutdownSessionAndConnection - dispose session manager"),await Ui(1e4,this.sessionManager.ready),this.sessionManager.dispose()),(t=this.kernelManager)!=null&&t.isDisposed||(n=this.kernelManager)==null||n.dispose(),(i=this.kernelSpecManager)!=null&&i.isDisposed||(o=this.kernelSpecManager)==null||o.dispose()}catch(s){C.error("Exception on Jupyter Lab Helper shutdown: ",s)}finally{C.trace("Finished disposing Jupyter Lab Helper")}})().catch(E).finally(()=>super.dispose()))}async getRunningSessions(){if(!this.sessionManager)return[];await Ui(1e4,this.sessionManager.ready).catch(E),await this.sessionManager.refreshRunning();let t=[],n=this.sessionManager.running(),i=n.next().value;for(;i;)t.push(i),i=n.next().value;return t}async getRunningKernels(){let t=await this.jupyterlab.KernelAPI.listRunning(this.serverSettings),n=new Set;return t.map(i=>{let o=i;return{id:i.id,name:i.name,lastActivityTime:o.last_activity?new Date(Date.parse(o.last_activity.toString())):new Date,numberOfConnections:o.connections?parseInt(o.connections.toString(),10):0}}).filter(i=>n.has(i.id)?!1:(n.add(i.id),!0))}async getKernelSpecs(){var t,n,i;if(!this.serverSettings||!this.sessionManager||!this.contentsManager)throw new Qr;try{let o=new bt,s=this.kernelSpecManager;if(!s)return C.error(`No SessionManager to enumerate kernelspecs (no specs manager). Returning a default kernel. Specs ${JSON.stringify(((n=(t=this.kernelSpecManager)==null?void 0:t.specs)==null?void 0:n.kernelspecs)||{})}.`),ne("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,reason:"NoSpecsManager"}),[await Qx()];let a={wasSessionManagerReady:this.sessionManager.isReady,wasSpecsManagerReady:s.isReady,sessionManagerReady:this.sessionManager.isReady,specsManagerReady:s.isReady,waitedForChangeEvent:!1},l=(f={})=>s.specs&&Object.keys(s.specs.kernelspecs).length?s.specs.kernelspecs:f,u=l();await Ui(1e4,this.sessionManager.ready),a.sessionManagerReady=this.sessionManager.isReady,await Ui(1e4,s.refreshSpecs()),a.specsManagerReady=s.isReady;let c=!1;if(s&&Object.keys(((i=s.specs)==null?void 0:i.kernelspecs)||{}).length===0){let f=[],m=Oe(),g=m.resolve.bind(m);s.specsChanged.connect(g),f.push(new Aee.Disposable(()=>s.specsChanged.disconnect(g)));let b=Promise.all([m.promise,s.ready,s.refreshSpecs(),this.sessionManager.ready]);await Ui(1e4,b),a.waitedForChangeEvent=!0,m.completed||(c=!0,ne("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,sessionManagerReady:this.sessionManager.isReady,specsManagerReady:s.isReady,reason:s.isReady?this.sessionManager.isReady?"SpecsDidNotChangeInTime":"SessionManagerIsNotReady":"SpecManagerIsNotReady"})),Ce(f)}let d=l(u);if(Object.keys(d||{}).length){let f=[];return Object.entries(d).forEach(([m,g])=>{g&&f.push(new _I(g))}),ne("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",{duration:o.elapsedTime},a),f}else return C.error(`Jupyter Lab Helper cannot enumerate kernelspecs. Returning a default kernel. Specs ${JSON.stringify(d)}.`),c||ne("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,reason:"NoSpecsEventAfterRefresh"}),[await Qx()]}catch(o){return C.error("Jupyter Lab Helper:getKernelSpecs failure: ",o),[]}}};var hn=class{constructor(e,t,n,i,o){this.jupyterPickerRegistration=e;this.configService=t;this.errorHandler=n;this.requestAgentCreator=i;this.requestCreator=o}async createConnectionInfo(e){let t=await this.getJupyterServerUri(e);if(!t)throw new Error(`Unable to get resolved server information for ${e.extensionId}:${e.id}:${e.handle}`);let n={baseUrl:t.connectionInformation.baseUrl.toString(!0),displayName:t.label,token:t.connectionInformation.token||"",authorizationHeader:t.connectionInformation.headers||{},fetch:t.connectionInformation.fetch,mappedRemoteNotebookDir:void 0,WebSocket:t.connectionInformation.WebSocket};return tj(e,n,this.requestCreator,this.requestAgentCreator,this.configService,tP.Uri.file(""))}async validateRemoteUri(e,t,n){let i;if(!t){let s=await this.getJupyterServerUri(e);if(s)t={baseUrl:s.connectionInformation.baseUrl.toString(!0),displayName:s.label,token:s.connectionInformation.token||"",authorizationHeader:s.connectionInformation.headers||{},fetch:s.connectionInformation.fetch,mappedRemoteNotebookDir:void 0,WebSocket:s.connectionInformation.WebSocket};else throw new Error(`Unable to get resolved server information for ${e.extensionId}:${e.id}:${e.handle}`)}let o=tj(e,t,this.requestCreator,this.requestAgentCreator,this.configService,tP.Uri.file(""));try{i=Gf.create(o.settings),await Promise.all([i.getRunningKernels(),i.getKernelSpecs()])}catch(s){if(Mi.isSelfCertsError(s)){if(!await dR(this.configService,s.message))throw s}else if(nu.isSelfCertsExpiredError(s)){if(!await pR(this.configService,s.message))throw s}else throw t&&!n&&await this.errorHandler.handleError(new ao(t.baseUrl,e,s)),s}finally{o.dispose(),i&&i.dispose()}}async getJupyterServerUri(e){let t=new tP.CancellationTokenSource;try{let n=this.jupyterPickerRegistration.jupyterCollections.find(l=>l.extensionId===e.extensionId&&l.id===e.id)||await this.jupyterPickerRegistration.activateThirdPartyExtensionAndFindCollection(e.extensionId,e.id);if(!n)return;let i=await Promise.resolve(n.serverProvider.provideJupyterServers(t.token)),o=i==null?void 0:i.find(l=>l.id===e.handle);if(!o&&(i==null?void 0:i.length)===0)try{o=await n.serverProvider.resolveJupyterServer({id:e.handle,label:""},t.token)}catch(l){}if(!o)return;if(o.connectionInformation)return o;let s=await Promise.resolve(n.serverProvider.resolveJupyterServer(o,t.token));if(!(s!=null&&s.connectionInformation))return;let a=Object.assign({},o);return a.connectionInformation=s.connectionInformation,a}catch(n){throw n instanceof ot?n:new Jf(e,n)}finally{t.dispose()}}};hn=U([(0,ou.injectable)(),x(0,(0,ou.inject)(sr)),x(1,(0,ou.inject)(Ke)),x(2,(0,ou.inject)(mn)),x(3,(0,ou.inject)(MR)),x(3,(0,ou.optional)()),x(4,(0,ou.inject)(Jg))],hn);var Kl=class{constructor(e,t,n){this.serverUriStorage=e;this.jupyterConnection=t;this.serverProviderRegistry=n}async addJupyterServer(e){if(e.extensionId.toLowerCase()!=tc.toLowerCase())throw new Error("Deprecated API");try{await this.jupyterConnection.validateRemoteUri(e)}catch(t){C.error(`Error in validating the Remote Uri ${e.id}.${e.handle}`,t);return}this.serverProviderRegistry.jupyterCollections.some(t=>t.extensionId===e.extensionId)||await this.serverUriStorage.add(e)}};Kl=U([(0,kI.injectable)(),x(0,(0,kI.inject)(pr)),x(1,(0,kI.inject)(hn)),x(2,(0,kI.inject)(sr))],Kl);p();var Lee=ae(he()),su=require("vscode");p();var Yf=require("vscode");var Mee="Canceled";function qn(r,e=!1){return typeof r!="object"||!r?!1:!!(r instanceof Yf.CancellationError||e&&r instanceof Error&&(r.message.includes("Canceled")||r.message.includes(Ue.canceled))||r.name===Mee&&r.message===Mee)}async function Ls(r,e,...t){let n;return hD(e)?(t.push(e),n=void 0):n=e,r?r.isCancellationRequested?n:new Promise((i,o)=>{if(r.isCancellationRequested)return i(n);let s=r.onCancellationRequested(()=>{s.dispose(),i(n)});Promise.race(t).then(i,o).finally(()=>s.dispose())}):await Promise.race(t)}async function ps(r,...e){if(!r)return Promise.race(e);if(r.isCancellationRequested)throw new Yf.CancellationError;return new Promise((t,n)=>{if(r.isCancellationRequested)return n(new Yf.CancellationError);let i=r.onCancellationRequested(()=>{i.dispose(),n(new Yf.CancellationError)});Promise.race(e).then(t,n).finally(()=>i.dispose())})}function Oee(...r){let e=new Yf.CancellationTokenSource,t=[];for(let i of r)i&&(i.isCancellationRequested&&e.cancel(),i.onCancellationRequested(()=>e.cancel(),void 0,t));let n=e.dispose.bind(e);return e.dispose=()=>{n(),Ce(t)},e}var Kd;(e=>{function r(t){if(t!=null&&t.isCancellationRequested)throw new Yf.CancellationError}e.throwIfCanceled=r})(Kd||(Kd={}));function Kee(r){let e=new Map,t=(a,l)=>{if(!e.has(a)){let u={id:a,label:l.displayName,connectionInformation:{baseUrl:su.Uri.parse(l.baseUrl),token:l.token,fetch:l.fetch,headers:l.authorizationHeader,WebSocket:l.WebSocket}};e.set(a,{serverUri:l,server:u})}return e.get(a).server},n=new su.EventEmitter,i={async provideJupyterServers(a){let l=r.getHandles?await ps(a,r.getHandles()):[];return!l||l.length===0?[]:ps(a,Promise.all(l.map(u=>r.getServerUri(u).then(c=>t(u,c)))))},resolveJupyterServer(a,l){return a},onDidChangeServers:n.event};if(!r.handleQuickPick||!r.getQuickPickEntryItems)return{serverProvider:i};let o=new Map;return{serverProvider:i,commandProvider:{async handleCommand(a,l){let u=o.get(a.label);if(!u||!r.handleQuickPick)return;let c=await ps(l,r.handleQuickPick(u,!0));if(c==="back")return;if(!c)throw new su.CancellationError;let d=await r.getServerUri(c);return t(c,d)},async provideCommands(a,l){return r.getQuickPickEntryItems?(await ps(l,Promise.resolve(r.getQuickPickEntryItems()))).map(c=>{let d={label:$v(c.label),canBeAutoSelected:c.default,description:$v(c.description)};return o.set(d.label,c),d}):[]}}}}var hj=class extends ac{constructor(t,n,i,o){super();this.extensionId=t;this.id=n;this.label=i;this.serverProvider=o;this._onDidChangeProvider=new su.EventEmitter;this.onDidChangeProvider=this._onDidChangeProvider.event}set commandProvider(t){this._commandProvider=t,this._onDidChangeProvider.fire()}get commandProvider(){return this._commandProvider}},NI=class extends Pr{constructor(){super();this._onDidChangeCollections=new su.EventEmitter;this._collections=new Map;et.instance.get(ve).push(this)}get onDidChangeCollections(){return this._onDidChangeCollections.event}get jupyterCollections(){return Array.from(this._collections.values())}async activateThirdPartyExtensionAndFindCollection(t,n){return await this.loadExtension(t,n).catch(E),this.jupyterCollections.find(i=>i.extensionId===t&&i.id===n)}async loadExtension(t,n){if(t===Ge)return;let i=su.extensions.getExtension(t);if(!i)throw new Error(`Extension '${t}' that provides Jupyter Server '${n}' not found`);i.isActive||await i.activate().then(E,E)}createJupyterServerCollection(t,n,i,o){let s=`${t}#${n}`;if(this._collections.has(s)&&t!==Ge)throw new Error(`Jupyter Server Provider with id ${s} already exists`);let a=new hj(t,n,i,o);return this._collections.set(s,a),this._onDidChangeCollections.fire({added:[a],removed:[]}),this._register(a.onDidDispose(()=>{this._collections.delete(s),this._onDidChangeCollections.fire({removed:[a],added:[]})},this)),a}};NI=U([(0,Lee.injectable)()],NI);p();var KR=Symbol("IExportedKernelServiceFactory");function uSe(r,e){return new Promise(t=>{e.onDidChange(n=>{for(let i of n.added)Wt(i.connection)&&i.connection.serverProviderHandle.id===r.id&&i.connection.serverProviderHandle.handle===r.handle&&t()})})}function Fee(r,e){let t=e.get(qa),n=r.id.startsWith("_builtin")?Ge:t.determineExtensionFromCallStack().extensionId;if(C.error(`The API registerRemoteServerProvider has being deprecated and will be removed soon, please use createJupyterServerCollection (extension ${n}).`),n.toLowerCase()!=tc.toLowerCase())throw new Error("Deprecated API");ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n,pemUsed:"registerRemoteServerProvider"});let{serverProvider:i,commandProvider:o}=Kee(r),s=LR(r.id,r.displayName||r.detail||r.id,i,n,e);return o&&(s.commandProvider=o),{dispose:()=>{s.dispose()}}}function Uee(r){return r.then(()=>void 0).catch(e=>(C.error("Failure during activation.",e),Promise.reject(e)))}function Wee(r){let e=r.get(qa);return ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:e.determineExtensionFromCallStack().extensionId,pemUsed:"registerRemoteServerProvider"}),r.get(KR).getService()}async function Vee(r,e,t){let n=t.get(qa);C.error("The API addRemoteJupyterServer has being deprecated and will be removed soon, please use createJupyterServerCollection.");let i=n.determineExtensionFromCallStack().extensionId;if(i.toLowerCase()!=tc.toLowerCase())throw new Error("Deprecated API");ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:i,pemUsed:"addRemoteJupyterServer"});let o=t.get(Kl),s=t.get(Nt),a=uSe({id:r,handle:e},s);await o.addJupyterServer({id:r,handle:e,extensionId:i}),await a}async function jee(r,e,t){var u,c,d,f,m,g;let n=t.get(qa);ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n.determineExtensionFromCallStack().extensionId,pemUsed:"openNotebook"});let i=t.get(Nt),o=typeof e=="string"?e:void 0,s=typeof e=="string"?void 0:e,a=o&&((u=i.all.find(b=>b.id===e))==null?void 0:u.id);if(!a&&s&&!ic()&&(a=(c=i.all.find(b=>b.kind==="startUsingPythonInterpreter"&&b.interpreter.id===s.id))==null?void 0:c.id,!a)){let v=await t.get(DR).getKernelConnection(s);a=v&&((d=i.all.find(k=>k.id===(v==null?void 0:v.id)))==null?void 0:d.id)}if(!a)throw new Error(`Kernel ${e} not found.`);let l=((g=(m=(f=$f.window.activeNotebookEditor)==null?void 0:f.notebook)==null?void 0:m.uri)==null?void 0:g.toString())===r.toString()?$f.window.activeNotebookEditor:await $f.window.showNotebookDocument(await $f.workspace.openNotebookDocument(r));return await $f.commands.executeCommand("notebook.selectKernel",{notebookEditor:l,id:a,extension:Ge}),l.notebook}p();var Oo=Symbol("INotebookEditorProvider"),FR=Symbol("INotebookPythonEnvironmentService");function Bee(r,e,t,n){let i=t.get(qa),o=t.get(FR),s={ready:Uee(r),registerPythonApi:a=>Nee(a,t),registerRemoteServerProvider:a=>Fee(a,t),getKernelService:()=>Wee(t),addRemoteJupyterServer:(a,l)=>Vee(a,l,t),openNotebook:async(a,l)=>jee(a,l,t),createJupyterServerCollection:(a,l,u)=>LR(a,l,u,i.determineExtensionFromCallStack().extensionId,t),get kernels(){return Pee(i.determineExtensionFromCallStack().extensionId)},onDidChangePythonEnvironment:o.onDidChangeEnvironment,getPythonEnvironment(a){return o.getPythonEnvironment(a)}};return(vn()||n.extensionMode===gj.ExtensionMode.Development||n.extensionMode===gj.ExtensionMode.Test)&&(s.serviceContainer=t,s.serviceManager=e),s}p();var Hee=require("vscode"),qee={codeLoadingTime:0,endActivateTime:0,startActivateTime:0,totalActivateTime:0,workspaceFolderCount:0};function Jee(r,e){if(!vn())try{r.endActivateTime=e.elapsedTime,r.totalActivateTime=e.elapsedTime,Object.assign(qee,r),Yee(r),ne("EXTENSION.LOAD",r)}catch(t){C.error("sendStartupTelemetry() failed.",t)}}function Gee(r,e,t){try{let n={};e.endActivateTime=t.elapsedTime,e.totalActivateTime=t.elapsedTime,Object.assign(qee,e),Yee(e),ne("EXTENSION.LOAD",e,n,r)}catch(n){C.error("sendErrorTelemetry() failed.",n)}}function Yee(r){var t,n;let e=(n=(t=Hee.workspace.workspaceFolders)==null?void 0:t.length)!=null?n:0;r.workspaceFolderCount=e}p();p();var UR=Symbol("IWorkspaceService"),lo=Symbol("IDebugManager"),RI=Symbol("IApplicationEnvironment"),yXe=Symbol("IWebviewPanelMessageListener"),bXe=Symbol("IWebviewViewMessageListener"),IXe=Symbol("IWebview"),SXe=Symbol("IWebviewView"),_Xe=Symbol("IWebviewPanel"),AI=Symbol("IWebviewPanelProvider"),WR=Symbol("IWebviewViewProvider"),rP=Symbol("IEncryptedStorage");p();var $ee=ae(he());p();var bi=require("vscode");p();var Fd=require("vscode");var Yg=class Yg{constructor(e){this.jupyterConfig=e}async migrateSettings(){let e=[];for(let t of Object.keys(Yg.migratedSettings))e.push(...this.migrateSetting(t,Yg.migratedSettings[t]));e.push(this.migrateIntellisenseSettings());try{await Promise.all(e)}catch(t){MI(t)}}async migrateIntellisenseSettings(){let e="pythonCompletionTriggerCharacters",t="completionTriggerCharacters",n=this.jupyterConfig.inspect(e),i=this.jupyterConfig.inspect(t);try{if((n==null?void 0:n.globalValue)===(n==null?void 0:n.defaultValue)||!i||i!=null&&i.globalValue&&i.globalValue[$e])return;if(typeof(n==null?void 0:n.globalValue)=="string"){let o=i.globalValue||i.defaultValue||{};o[$e]=n.globalValue.split(""),await this.jupyterConfig.update(t,o,Fd.ConfigurationTarget.Global).then(E,MI)}}finally{n!=null&&n.globalValue&&await this.jupyterConfig.update(e,void 0,Fd.ConfigurationTarget.Global).then(E,MI)}}migrateSetting(e,t){let n=this.jupyterConfig.inspect(e),i=this.jupyterConfig.inspect(t),o=[];if((n==null?void 0:n.workspaceValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.workspaceValue)===void 0&&(s=this.jupyterConfig.update(t,n.workspaceValue,Fd.ConfigurationTarget.Workspace)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Fd.ConfigurationTarget.Workspace),MI))}if((n==null?void 0:n.workspaceFolderValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.workspaceFolderValue)===void 0&&(s=this.jupyterConfig.update(t,n.workspaceFolderValue,Fd.ConfigurationTarget.WorkspaceFolder)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Fd.ConfigurationTarget.WorkspaceFolder),MI))}if((n==null?void 0:n.globalValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.globalValue)===void 0&&(s=this.jupyterConfig.update(t,n.globalValue,Fd.ConfigurationTarget.Global)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Fd.ConfigurationTarget.Global),MI))}return o}};Yg.migratedSettings={interactiveWindowMode:"interactiveWindow.creationMode",interactiveWindowViewColumn:"interactiveWindow.viewColumn",splitRunFileIntoCells:"interactiveWindow.splitRunFileIntoCells",interactiveReplNotebook:"interactiveWindow.notebookRepl",sendSelectionToInteractiveWindow:"interactiveWindow.textEditor.executeSelection",normalizeSelectionForInteractiveWindow:"interactiveWindow.textEditor.normalizeSelection",magicCommandsAsComments:"interactiveWindow.textEditor.magicCommandsAsComments",enableAutoMoveToNextCell:"interactiveWindow.textEditor.autoMoveToNextCell",newCellOnRunLast:"interactiveWindow.textEditor.autoAddNewCell",pythonCellFolding:"interactiveWindow.textEditor.cellFolding",enableCellCodeLens:"interactiveWindow.codeLens.enable",addGotoCodeLenses:"interactiveWindow.codeLens.enableGotoCell",codeLenses:"interactiveWindow.codeLens.commands",debugCodeLenses:"interactiveWindow.codeLens.debugCommands","interactiveWindow.codeLes.debugCommands":"interactiveWindow.codeLens.debugCommands",codeRegularExpression:"interactiveWindow.cellMarker.codeRegex",markdownRegularExpression:"interactiveWindow.cellMarker.markdownRegex",decorateCells:"interactiveWindow.cellMarker.decorateCells",defaultCellMarker:"interactiveWindow.cellMarker.default",enableExtendedKernelCompletions:"enableExtendedPythonKernelCompletions"},Yg.fullSettingIds={...Yg.migratedSettings};var nP=Yg;function MI(r){C.warn("Error migrating Jupyter configuration",r)}p();function dSe(r){return(e,t,n)=>{let i=null,o=null;if(typeof n.value=="function"?(i="value",o=n.value):typeof n.get=="function"&&(i="get",o=n.get),!o)throw new Error("not supported");n[i]=r(o,t)}}function VR(r,e,t){return dSe((n,i)=>{let o=`$debounce$${i}`,s=`$debounce$result$${i}`;return function(...a){this[s]||(this[s]=t?t():void 0),clearTimeout(this[o]),e&&(this[s]=e(this[s],...a),a=[this[s]]),this[o]=setTimeout(()=>{n.apply(this,a),this[s]=t?t():void 0},r)}})}var Pa=class Pa{constructor(e,t,n){this._systemVariablesCtor=t;this._type=n;this.allowUnauthorizedRemoteConnection=!1;this.jupyterInterruptTimeout=1e4;this.jupyterLaunchTimeout=6e4;this.jupyterLaunchRetries=3;this.notebookFileRoot="";this.useDefaultConfigForJupyter=!1;this.sendSelectionToInteractiveWindow=!1;this.splitRunFileIntoCells=!0;this.markdownRegularExpression="";this.codeRegularExpression="";this.errorBackgroundColor="";this.variableExplorerExclude="";this.decorateCells="currentCell";this.enableCellCodeLens=!1;this.askForLargeDataFrames=!1;this.enableAutoMoveToNextCell=!1;this.askForKernelRestart=!1;this.codeLenses="";this.debugCodeLenses="";this.debugpyDistPath="";this.stopOnFirstLineWhileDebugging=!1;this.magicCommandsAsComments=!1;this.pythonExportMethod="direct";this.stopOnError=!1;this.addGotoCodeLenses=!1;this.runStartupCommands=[];this.debugJustMyCode=!1;this.defaultCellMarker="";this.themeMatplotlibPlots=!1;this.disableJupyterAutoStart=!1;this.enablePythonKernelLogging=!1;this.jupyterCommandLineArguments=[];this.widgetScriptSources=[];this.interactiveWindowMode="multiple";this.pythonCellFolding=!0;this.interactiveWindowViewColumn="secondGroup";this.disableZMQSupport=!1;this.forceIPyKernelDebugger=!1;this.verboseLogging=!1;this.showVariableViewWhenDebugging=!0;this.newCellOnRunLast=!0;this.logKernelOutputSeparately=!1;this.development=!1;this.poetryPath="";this.excludeUserSitePackages=!1;this.enableExtendedPythonKernelCompletions=!1;this.formatStackTraces=!1;this.interactiveReplNotebook=!1;this._changeEmitter=new bi.EventEmitter;this._disposables=[];this._workspaceRoot=e,this.initialize(),bi.workspace.isTrusted===!1&&(this.disableJupyterAutoStart=!0)}get onDidChange(){return this._changeEmitter.event}static getInstance(e,t,n){let i=Pa.getSettingsUriAndTarget(e).uri,o=i?i.path:"",s=Pa.jupyterSettings.get(o);return s?s._type==="web"&&n==="node"&&(s._systemVariablesCtor=t,s._type=n):(s=new Pa(i,t,n),Pa.jupyterSettings.set(o,s)),s}static getSettingsUriAndTarget(e){let t=e?bi.workspace.getWorkspaceFolder(e):void 0,n=t?t.uri:void 0;!n&&Array.isArray(bi.workspace.workspaceFolders)&&bi.workspace.workspaceFolders.length>0&&(n=bi.workspace.workspaceFolders[0].uri);let i=n?bi.ConfigurationTarget.WorkspaceFolder:bi.ConfigurationTarget.Global;return{uri:n,target:i}}static dispose(){if(!vn())throw new Error("Dispose can only be called from unit tests");Pa.jupyterSettings.forEach(e=>e&&e.dispose()),Pa.jupyterSettings.clear()}dispose(){this._disposables.forEach(e=>e&&e.dispose()),this._disposables=[]}createSystemVariables(e){return new this._systemVariablesCtor(e,this._workspaceRoot)}toJSON(){let e={};return this.getSerializableKeys().forEach(n=>e[n]=this[n]),e}update(e,t){let n=this.createSystemVariables(void 0),i=n.resolveAny(e.get("experiments"));this.experiments?Object.assign(this.experiments,i):this.experiments=i,this.experiments=this.experiments?this.experiments:{enabled:!0,optInto:[],optOutFrom:[]};let o=(a,l)=>{let u=nP.fullSettingIds[a],c=u&&l.get(u)!==void 0?l.get(u):l.get(a),d=n.resolveAny(c);d!==void 0&&(this[a]=d)};this.getSerializableKeys().filter(a=>a!=="experiments"&&a!=="logging"&&a!=="kernelPickerType").forEach(a=>o(a,e)),t&&o("poetryPath",t)}onWorkspaceFoldersChanged(){let e=(bi.workspace.workspaceFolders||[]).map(i=>i.uri.path),n=Array.from(Pa.jupyterSettings.keys()).filter(i=>e.indexOf(i)<0);if(n.length>0)for(let i of n)Pa.jupyterSettings.delete(i)}initialize(){let e=()=>{let i=bi.workspace.getConfiguration("jupyter",this._workspaceRoot),o=bi.workspace.getConfiguration("python",this._workspaceRoot);this.update(i,o),this.debounceChangeNotification()};this._disposables.push(bi.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this)),this._disposables.push(bi.workspace.onDidChangeConfiguration(i=>{i.affectsConfiguration("jupyter")&&e(),i.affectsConfiguration("python.poetryPath")&&e()}));let t=bi.workspace.getConfiguration("jupyter",this._workspaceRoot),n=bi.workspace.getConfiguration("python",this._workspaceRoot);t&&(this.update(t,n),this.migrateSettings(t).catch(E))}async migrateSettings(e){await new nP(e).migrateSettings()}debounceChangeNotification(){this._changeEmitter.fire()}fireChangeNotification(){this._changeEmitter.fire()}getSerializableKeys(){return Object.getOwnPropertyNames(this).filter(e=>!e.startsWith("_"))}};Pa.jupyterSettings=new Map,U([VR(1)],Pa.prototype,"debounceChangeNotification",1);var OI=Pa;p();var au=require("vscode");p();p();var vj={number:"number",string:"string",undefined:"undefined",object:"object",function:"function"};function yj(r){return Array.isArray?Array.isArray(r):!!(r&&typeof r.length===vj.number&&r.constructor===Array)}function jR(r){return typeof r===vj.string||r instanceof String}function bj(r){return typeof r===vj.object&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}var BR=class{resolve(e){return jR(e)?this.__resolveString(e):yj(e)?this.__resolveArray(e):bj(e)?this.__resolveLiteral(e):e}resolveAny(e){return jR(e)?this.__resolveString(e):yj(e)?this.__resolveAnyArray(e):bj(e)?this.__resolveAnyLiteral(e):e}__resolveString(e){let t=/\$\{(.*?)\}/g;return e.replace(t,(n,i)=>{let o=this[i];return jR(o)?o:n&&(n.indexOf("env.")>0||n.indexOf("env:")>0)?"":n})}__resolveLiteral(e){let t=Object.create(null);return Object.keys(e).forEach(n=>{let i=e[n];t[n]=this.resolve(i)}),t}__resolveAnyLiteral(e){let t=Object.create(null);return Object.keys(e).forEach(n=>{let i=e[n];t[n]=this.resolveAny(i)}),t}__resolveArray(e){return e.map(t=>this.__resolveString(t))}__resolveAnyArray(e){return e.map(t=>this.resolveAny(t))}};var HR=class extends BR{constructor(e,t){super();let n=e?au.workspace.getWorkspaceFolder(e):void 0;this._workspaceFolder=n?n.uri.path:t||"",this._filePath=e?e.path:void 0,au.window.activeTextEditor&&(this._lineNumber=au.window.activeTextEditor.selection.anchor.line+1,this._selectedText=au.window.activeTextEditor.document.getText(new au.Range(au.window.activeTextEditor.selection.start,au.window.activeTextEditor.selection.end)))}get cwd(){return this.workspaceFolder}get workspaceRoot(){return this._workspaceFolder}get workspaceFolder(){return this._workspaceFolder}get file(){return this._filePath}get lineNumber(){return this._lineNumber}get selectedText(){return this._selectedText}};p();var lu=require("vscode");var qR=class{async updateSectionSetting(e,t,n,i,o){let a={uri:i,target:o||lu.ConfigurationTarget.WorkspaceFolder};e==="jupyter"&&o!==lu.ConfigurationTarget.Global&&(a=OI.getSettingsUriAndTarget(i));let l=lu.workspace.getConfiguration(e,a.uri),u=l.inspect(t);u!==void 0&&(o===lu.ConfigurationTarget.Global&&u.globalValue===n||o===lu.ConfigurationTarget.Workspace&&u.workspaceValue===n||o===lu.ConfigurationTarget.WorkspaceFolder&&u.workspaceFolderValue===n)||(await l.update(t,n,o),o&&await this.verifySetting(l,o,t,n))}async updateSetting(e,t,n,i){return this.updateSectionSetting("jupyter",e,t,n,i)}async verifySetting(e,t,n,i){if(vn()&&!FE()){let o=0;do{let s=e.inspect(n);if(!s&&i===void 0||s&&i!==void 0&&(t===lu.ConfigurationTarget.Global?s.globalValue:t===lu.ConfigurationTarget.Workspace?s.workspaceValue:s.workspaceFolderValue)===i)break;await new Promise(a=>setTimeout(a,250)),o+=1}while(o<20)}}};var LI=class extends qR{getSettings(e){return OI.getInstance(e,HR,"web")}};LI=U([(0,$ee.injectable)()],LI);p();function zee(r){r.addSingleton(my,lI),r.addSingleton(bo,Rf)}p();p();var Zf=ae(he()),mte=require("vscode"),iP=ae(fte());p();var nA=class{setSharedProperty(e,t){Gb(e,t)}postEvent(e,t){let n={};t.forEach((i,o)=>{n[o]=i}),ne(e,void 0,n)}};p();var Oj=ae(require("vscode")),iA=ae(he());var WI=class{constructor(e){this.extensionContext=e}get extensionVersion(){return this.extensionContext.extension.packageJSON.version}};WI=U([(0,iA.injectable)(),x(0,(0,iA.inject)(st))],WI);function Ud(){return Oj.env.appName.indexOf("Insider")>0||Oj.env.appName.indexOf("Code - OSS Dev")>=0?"insiders":"stable"}var MSe="VSCode.ABExp.FeatureData",Lj="vscode",VI=class{constructor(e,t,n){this.configurationService=e;this.appEnvironment=t;this.globalState=n;this._optInto=[];this._optOutFrom=[];this.settings=e.getSettings(void 0);let i=this.settings.experiments.optInto,o=this.settings.experiments.optOutFrom;if(this._optInto=i.filter(l=>!l.endsWith("control")),this._optOutFrom=o.filter(l=>!l.endsWith("control")),!this.enabled)return;let s;Ud()==="insiders"?s=iP.TargetPopulation.Insiders:s=iP.TargetPopulation.Public;let a=new nA;this.experimentationService=(0,iP.getExperimentationService)(Ge,this.appEnvironment.extensionVersion,s,a,this.globalState)}get enabled(){return this.settings.experiments.enabled&&!this.settings.experiments.optOutFrom.includes("All")}async activate(){this.experimentationService&&this.enabled&&(await this.experimentationService.initializePromise,this.getFeatures().length===0&&await this.experimentationService.initialFetch,this.logExperiments())}inExperiment(e){return!this.experimentationService||!this.enabled||this._optOutFrom.includes(e.toString())?!1:this._optInto.includes(e.toString())||this._optInto.includes("All")?(this.experimentationService.getTreatmentVariable(Lj,e),!0):e==="DoNotWaitForZmqPortsToBeUsed"&&(Ud()==="insiders"||Vv())||e==="DataViewerContribution"&&(Ud()==="insiders"||Vv())?!0:this.experimentationService.getTreatmentVariable(Lj,e)===!0}async getExperimentValue(e){if(!(!this.experimentationService||!this.enabled||this._optOutFrom.includes(e)))return this.experimentationService.getTreatmentVariable(Lj,e)}getFeatures(){return this.globalState.get(MSe,{features:[]}).features}logExperiments(){let e=mte.workspace.getConfiguration("telemetry"),t=!1;if(e&&e.get("enableTelemetry")===!1&&(C.info("Telemetry is disabled"),t=!0),e&&e.get("telemetryLevel")==="off"&&(C.info("Telemetry level is off"),t=!0),t&&C.info("Experiments are disabled, only manually opted experiments are active."),this._optOutFrom.includes("All"))return;if(this._optInto.includes("All")){C.info(Tp.inGroup("All"));return}let n=new Set(this._optInto),i=new Set;this._optOutFrom.filter(o=>o!=="All").forEach(o=>{C.info(Tp.notInGroup(o))}),this._optInto.filter(o=>o!=="All").forEach(o=>{i.add(o),C.info(Tp.inGroup(o))}),t&&!i.has("DoNotWaitForZmqPortsToBeUsed")&&(Ud()==="insiders"||Vv())&&C.info(Tp.inGroup("DoNotWaitForZmqPortsToBeUsed")),t||this.getFeatures().forEach(o=>{o.toLowerCase().startsWith("jupyter")&&!this._optOutFrom.includes(o)&&!this._optInto.includes(o)&&(n.add(o),C.info(Tp.inGroup(o)))})}};VI=U([(0,Zf.injectable)(),x(0,(0,Zf.inject)(Ke)),x(1,(0,Zf.inject)(RI)),x(2,(0,Zf.inject)(Et)),x(2,(0,Zf.named)(rr))],VI);p();var sA=ae(he()),Ks=require("vscode");p();var oA=require("vscode");function jI(r){oA.env.openExternal(typeof r=="string"?oA.Uri.parse(r):r).then(E,E)}var OSe=[{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE",message:ly.SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/309",setting:{setting:"formatting.formatOnSave",values:["true",!0]}},{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE",message:ly.SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/313",setting:{setting:"linting.lintOnTextChange",values:["true",!0]}},{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES",message:ly.SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/1704",setting:{setting:"autoComplete.preloadModules"}}],BI=class{constructor(e){this.persistentStateFactory=e;this._onDidChangeFeatures=new Ks.EventEmitter;this.onDidChangeFeatures=this._onDidChangeFeatures.event;this._features={};this.disposables=[];this._updateFeatures(),this.disposables.push(Ks.workspace.onDidChangeConfiguration(()=>{this._updateFeatures()}))}get features(){return this._features}set features(e){this._features=e,this._onDidChangeFeatures.fire()}_updateFeatures(){this.features={}}dispose(){this.disposables.forEach(e=>e.dispose())}initialize(){OSe.forEach(this.registerDeprecation.bind(this))}registerDeprecation(e){Array.isArray(e.commands)&&e.commands.forEach(t=>{this.disposables.push(Ks.commands.registerCommand(t,()=>this.notifyDeprecation(e),this))}),e.setting&&this.checkAndNotifyDeprecatedSetting(e)}async notifyDeprecation(e){let t=this.persistentStateFactory.createGlobalPersistentState(e.doNotDisplayPromptStateKey,!0);if(!t.value)return;let n="Learn more",i="Never show again",o=await Ks.window.showInformationMessage(e.message,n,i);if(o)switch(o){case n:{jI(e.moreInfoUrl);break}case i:{await t.updateValue(!1);break}default:throw new Error("Selected option not supported.")}}checkAndNotifyDeprecatedSetting(e){let t=!1;Array.isArray(Ks.workspace.workspaceFolders)&&Ks.workspace.workspaceFolders.length>0?Ks.workspace.workspaceFolders.forEach(n=>{t||(t=this.isDeprecatedSettingAndValueUsed(Ks.workspace.getConfiguration("jupyter",n.uri),e.setting))}):t=this.isDeprecatedSettingAndValueUsed(Ks.workspace.getConfiguration("jupyter"),e.setting),t&&this.notifyDeprecation(e).catch(n=>C.debug("Jupyter Extension: notifyDeprecation",n))}isDeprecatedSettingAndValueUsed(e,t){if(!e.has(t.setting))return!1;let n=e.get(t.setting);return!Array.isArray(t.values)||t.values.length===0?Array.isArray(n)?n.length>0:!0:!Array.isArray(t.values)||t.values.length===0?n===void 0?!1:Array.isArray(n)?n.length>0:!0:t.values.indexOf(e.get(t.setting))>=0}};BI=U([(0,sA.injectable)(),x(0,(0,sA.inject)(IT))],BI);p();var em=ae(he());var aA=class{constructor(e,t,n,i){this.storage=e;this.key=t;this.defaultValue=n;this.expiryDurationMs=i}get value(){if(this.expiryDurationMs){let e=this.storage.get(this.key,{data:this.defaultValue});return!e||!e.expiry||e.expiry<Date.now()?this.defaultValue:e.data}else return this.storage.get(this.key,this.defaultValue)}async updateValue(e){this.expiryDurationMs?await this.storage.update(this.key,{data:e,expiry:Date.now()+this.expiryDurationMs}):await this.storage.update(this.key,e)}},HI=class{constructor(e,t){this.globalState=e;this.workspaceState=t}createGlobalPersistentState(e,t,n){return new aA(this.globalState,e,t,n)}createWorkspacePersistentState(e,t,n){return new aA(this.workspaceState,e,t,n)}};HI=U([(0,em.injectable)(),x(0,(0,em.inject)(Et)),x(0,(0,em.named)(rr)),x(1,(0,em.inject)(Et)),x(1,(0,em.named)(Es))],HI);p();p();var hte=ae(he());var qI=class{constructor(){this.osType="Unknown"}get tempDir(){}get homeDir(){}get pathVariableName(){return""}get isWindows(){return this.osType==="Windows"}get isMac(){return this.osType==="OSX"}get isLinux(){return this.osType==="Linux"}};qI=U([(0,hte.injectable)()],qI);p();var fs=Symbol("IPlatformService"),Pt=Symbol("IFileSystem");function gte(r){r.addSingleton(fs,qI)}p();var vte=ae(he()),lA=require("vscode");var JI=class{determineExtensionFromCallStack(e){if(e=e||new Error().stack,e){let t=lA.extensions.getExtension(Ge).extensionUri.toString().toLowerCase(),n=e.split(`
`).map(i=>{let o=/\((.*)\)/.exec(i);if(o)return o[1]}).filter(i=>i&&i.toLowerCase().startsWith("http")).filter(i=>i&&!i.toLowerCase().startsWith(t));vK(new Error("Ex")).forEach(i=>{let o=i.getFileName();o&&!o.toLowerCase().startsWith(t)&&n.push(o)});for(let i of n){let o=lA.extensions.all.find(s=>s.id!==Ge&&i.startsWith(s.extensionUri.toString()));if(o)return{extensionId:o.id,displayName:o.packageJSON.displayName}}try{C.error("Unable to determine the caller of the extension API for trace stack.",e,JSON.stringify(lA.extensions.all.map(i=>({id:i.id,extensionUri:i.extensionUri,extensionPath:i.extensionPath,displayName:i.packageJSON.displayName}))))}catch(i){C.error("Unable to determine the caller of the extension API for trace stack.",e,i)}}return{extensionId:mD,displayName:W.unknownPackage}}};JI=U([(0,vte.injectable)()],JI);p();var cA=ae(he()),Kj=require("vscode");var GI=class{constructor(e){this.extensionContext=e;this.testingState=new Map}async store(e,t,n){if(li&&this.extensionContext.extensionMode!==Kj.ExtensionMode.Production){this.testingState.set(`${e}#${t}`,n||"");return}if(n)await this.extensionContext.secrets.store(`${e}.${t}`,n);else try{await this.extensionContext.secrets.delete(`${e}.${t}`)}catch(i){C.error(i)}}async retrieve(e,t){if(li&&this.extensionContext.extensionMode!==Kj.ExtensionMode.Production)return this.testingState.get(`${e}#${t}`);try{return await this.extensionContext.secrets.get(`${e}.${t}`)}catch(n){try{await this.extensionContext.secrets.delete(`${e}.${t}`);return}catch(i){C.error(i)}}}};GI=U([(0,cA.injectable)(),x(0,(0,cA.inject)(st))],GI);p();var yte=ae(he());var YI=class{constructor(){this._list=[]}async dispose(){let e=this._list.map(t=>t.dispose());await Promise.all(e),this._list=[]}push(e){e&&this._list.push(e)}get list(){return this._list}};YI=U([(0,yte.injectable)()],YI);p();var bte=ae(he()),uu=require("vscode");var tm=class tm extends Error{};tm.back=new tm("back"),tm.cancel=new tm("cancel"),tm.resume=new tm("resume");var ze=tm,oP=class{constructor(){this.steps=[]}run(e,t){return this.stepThrough(e,t)}async showQuickPick(e){return this.showLazyLoadQuickPick(e).selection}showLazyLoadQuickPick({title:e,step:t,totalSteps:n,items:i,activeItem:o,placeholder:s,buttons:a,shouldResume:l,matchOnDescription:u,matchOnDetail:c,acceptFilterBoxTextAsSelection:d,startBusy:f,stopBusy:m,validate:g,onDidTriggerItemButton:b,onDidTriggerButton:v,supportBackInFirstStep:k,onDidChangeItems:R,ignoreFocusOut:P}){let D=[],K=Oe(),L=uu.window.createQuickPick();return L.title=e,L.step=t,L.totalSteps=n,L.placeholder=s,L.ignoreFocusOut=P!=null?P:!0,L.items=i,m&&(L.busy=f!=null?f:!1,m(()=>{L.enabled&&(L.busy=!1)},this,D)),R&&(L.keepScrollPosition=!0,R(B=>{L.items=B},this,D)),b&&L.onDidTriggerItemButton(B=>b(B),void 0,D),L.matchOnDescription=u||!1,L.matchOnDetail=c||!1,o?L.activeItems=[o]:L.activeItems=[],L.buttons=[...this.steps.length>1||k?[uu.QuickInputButtons.Back]:[],...a||[]],D.push(L.onDidTriggerButton(B=>{B===uu.QuickInputButtons.Back?K.reject(ze.back):v?v(B):K.resolve(B)}),L.onDidChangeSelection(async B=>{let N=B.length?B[0].label:"",O=!!N;if(N&&g&&B.length){L.enabled=!1,L.busy=!0;let h=await g(B[0]);h&&(O=!1,await uu.window.showErrorMessage(h,{modal:!0})),L.enabled=!0,L.busy=!1}O&&K.resolve(B[0])}),L.onDidHide(()=>{(async()=>{K.reject(l&&await l()?ze.resume:ze.cancel)})().catch(K.reject)})),d&&D.push(L.onDidAccept(async()=>{if(!L.busy){let B=g?await g(L):void 0;B?(L.enabled=!1,L.busy=!0,await uu.window.showErrorMessage(B),L.enabled=!0,L.busy=!1):K.resolve(L.value)}})),this.current&&this.current.dispose(),this.current=L,this.current.show(),K.promise.finally(()=>Ce(D)).catch(E),{quickPick:L,selection:K.promise}}async showInputBox({title:e,step:t,totalSteps:n,value:i,prompt:o,validate:s,password:a,buttons:l,shouldResume:u,validationMessage:c}){let d=[];try{return await new Promise((f,m)=>{let g=uu.window.createInputBox();g.title=e,g.step=t,g.totalSteps=n,g.password=!!a,g.value=i||"",g.prompt=o,g.validationMessage=c||"",g.ignoreFocusOut=!0,g.validationMessage=c||"",g.buttons=[...this.steps.length>1?[uu.QuickInputButtons.Back]:[],...l||[]],d.push(g.onDidTriggerButton(b=>{b===uu.QuickInputButtons.Back?m(ze.back):f(b)}),g.onDidAccept(async()=>{let b=g.value;g.enabled=!1,g.busy=!0;let v=await s(b);v?(g.validationMessage=v,g.show()):(g.validationMessage="",f(b)),g.enabled=!0,g.busy=!1}),g.onDidChangeValue(async()=>{g.validationMessage=""}),g.onDidHide(()=>{(async()=>{g.busy||m(u&&await u()?ze.resume:ze.cancel)})().catch(m)})),this.current&&this.current.dispose(),this.current=g,this.current.show()})}finally{d.forEach(f=>f.dispose())}}async stepThrough(e,t){let n=e;for(;n;){this.steps.push(n),this.current&&(this.current.enabled=!1,this.current.busy=!0);try{n=await n(this,t)}catch(i){if(i===ze.back)this.steps.pop(),n=this.steps.pop();else if(i===ze.resume)n=this.steps.pop();else if(i===ze.cancel)n=void 0;else throw i;if(!n)return i}}this.current&&this.current.dispose()}},Ite=Symbol("IMultiStepInputFactory"),$I=class{create(){return new oP}};$I=U([(0,bte.injectable)()],$I);p();var Ste=ae(he()),Lo=require("vscode");var Wd=class{get activeDebugConsole(){return Lo.debug.activeDebugConsole}get activeDebugSession(){var e;return C.ci(`Getting active debug session, ${(e=Lo.debug.activeDebugSession)==null?void 0:e.name}`),Lo.debug.activeDebugSession}get breakpoints(){return Lo.debug.breakpoints}get onDidChangeActiveDebugSession(){return Lo.debug.onDidChangeActiveDebugSession}get onDidStartDebugSession(){return Lo.debug.onDidStartDebugSession}get onDidReceiveDebugSessionCustomEvent(){return Lo.debug.onDidReceiveDebugSessionCustomEvent}get onDidTerminateDebugSession(){return Lo.debug.onDidTerminateDebugSession}get onDidChangeBreakpoints(){return Lo.debug.onDidChangeBreakpoints}registerDebugConfigurationProvider(e,t){return Lo.debug.registerDebugConfigurationProvider(e,t)}registerDebugAdapterTrackerFactory(e,t){return Lo.debug.registerDebugAdapterTrackerFactory(e,t)}startDebugging(e,t,n){return Lo.debug.startDebugging(e,t,n)}addBreakpoints(e){Lo.debug.addBreakpoints(e)}removeBreakpoints(e){Lo.debug.removeBreakpoints(e)}};Wd.instance=new Wd,Wd=U([(0,Ste.injectable)()],Wd);p();var sP=ae(he());var Ete=ae(uA());var _te="_VSCODE_getDataFrame",dA=Ete.default`
                            try:
                                del _VSCODE_getDataFrame
                            except:
                                pass
                            `,du=class{constructor(e,t){this.fs=e;this.context=t}async generateCodeToGetDataFrameInfo(e){let t=await this.getContentsOfDataFrameScript(),n=e.isDebugging?"True":"False",i=`${_te}("info", ${n}, ${e.variableName})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:dA}:{code:`${t}

${i}

${dA}`}}async generateCodeToGetDataFrameRows(e){let t=await this.getContentsOfDataFrameScript(),n=e.isDebugging?"True":"False",i=`${_te}("rows", ${n}, ${e.variableName}, ${e.startIndex}, ${e.endIndex})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:dA}:{code:`${t}

${i}

${dA}`}}async getContentsOfDataFrameScript(){if(du.contentsOfDataFrameScript)return du.contentsOfDataFrameScript;let e=Vi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","dataframes","vscodeDataFrame.py"),t=await this.fs.readFile(e);return du.contentsOfDataFrameScript=t,t}};du=U([(0,sP.injectable)(),x(0,(0,sP.inject)(Pt)),x(1,(0,sP.inject)(st))],du);p();var aP=ae(he());var Wj=ae(uA());var Uj="_VSCODE_getVariable",zI=Wj.default`
                            try:
                                del _VSCODE_getVariable
                            except:
                                pass
                            `,Fs=class{constructor(e,t){this.fs=e;this.context=t}async generateCodeToGetVariableInfo(e){let t=await this.getContentsOfScript(),n=e.isDebugging?"True":"False",i=`${Uj}("info", ${n}, ${e.variableName})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:zI}:{code:`${t}

${i}

${zI}`}}async generateCodeToGetVariableProperties(e){let t=await this.getContentsOfScript(),n=e.isDebugging?"True":"False",i=`${Uj}("properties", ${n}, ${e.variableName}, ${e.stringifiedAttributeNameList})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:zI}:{code:`${t}

${i}

${zI}`}}async generateCodeToGetAllVariableDescriptions(e){let t=await this.getContentsOfVariablesScript();return e?t=t+`

return _VSCODE_getAllChildrenDescriptions('${e.root}', ${JSON.stringify(e.propertyChain)}, ${e.startIndex})`:t=t+`

variables= %who_ls
return _VSCODE_getVariableDescriptions(variables)`,t}async generateCodeToGetVariableTypes(e){let n=`${await this.getContentsOfScript()}

_VSCODE_rwho_ls = %who_ls
`,i=e.isDebugging?"True":"False",o=Wj.default`
        try:
            del _VSCODE_rwho_ls
        except:
            pass
        `,s=`${Uj}("types", ${i}, _VSCODE_rwho_ls)`;return e.isDebugging?{initializeCode:n,code:s,cleanupCode:`${zI}
${o}`}:{code:`${n}${s}

${zI}
${o}`}}async generateCodeToGetVariableValueSummary(e){let t=await this.getContentsOfVariablesScript();return t=t+`

variables= %who_ls
return _VSCODE_getVariableSummary(${e})`,t}async getContentsOfScript(){if(Fs.contentsOfScript)return Fs.contentsOfScript;let e=Vi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","getVariableInfo","vscodeGetVariableInfo.py"),t=await this.fs.readFile(e);return Fs.contentsOfScript=t,t}async getContentsOfVariablesScript(){if(Fs.contentsOfVariablesScript)return Fs.contentsOfVariablesScript;let e=Vi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","getVariableInfo","vscodeGetVariablesForProvider.py"),t=await this.fs.readFile(e);return Fs.contentsOfVariablesScript=t,t}};Fs=U([(0,aP.injectable)(),x(0,(0,aP.inject)(Pt)),x(1,(0,aP.inject)(st))],Fs);p();var pA=Symbol("IExtensionActivationManager"),Ve=Symbol("IExtensionSyncActivationService");p();var lP=require("vscode");var pu=ae(he());var Cte=["currentServerHash","connectToLocalKernelsOnly","JUPYTER_LOCAL_KERNELSPECS","JUPYTER_LOCAL_KERNELSPECS_V1","JUPYTER_LOCAL_KERNELSPECS_V2","JUPYTER_LOCAL_KERNELSPECS_V3","JUPYTER_REMOTE_KERNELSPECS","JUPYTER_REMOTE_KERNELSPECS_V1","JUPYTER_REMOTE_KERNELSPECS_V2","JUPYTER_REMOTE_KERNELSPECS_V3","JUPYTER_LOCAL_KERNELSPECS_V4","JUPYTER_REMOTE_KERNELSPECS_V4-","LOCAL_KERNEL_SPECS_CACHE_KEY_V_2022_10","LOCAL_KERNEL_PYTHON_AND_RELATED_SPECS_CACHE_KEY_V_2022_10","user-jupyter-server-uri-list-v2","REGISTRATION_ID_EXTENSION_OWNER_MEMENTO_KEY","jupyter.jupyterServer.uriList"],QI=class{constructor(e,t,n,i){this.globalState=e;this.crypto=t;this.workspaceState=n;this.extensionContext=i}activate(){this.removeOldCachedItems().then(E,E)}async removeOldCachedItems(){await Promise.all([await this.getUriAccountKey()].concat(Cte).filter(t=>this.globalState.get(t,void 0)!==void 0).map(t=>this.globalState.update(t,void 0).then(E,E)));let e=this.workspaceState.keys().filter(t=>t.startsWith("LAST_EXECUTED_CELL_")&&!t.startsWith("LAST_EXECUTED_CELL_V2_"));await Promise.all(e.map(t=>this.workspaceState.update(t,void 0))),await Promise.all(Cte.map(t=>this.globalState.keys().filter(n=>n.startsWith(t)).map(n=>this.globalState.update(n,void 0).then(E,E))).flat()),await this.extensionContext.secrets.delete(`${ai.JupyterServerRemoteLaunchService}.remote-uri-list`).then(E,E)}async getUriAccountKey(){let e=nI();return e?this.crypto.createHash(ut(e),"SHA-512"):lP.workspace.workspaceFile?this.crypto.createHash(ut(lP.workspace.workspaceFile),"SHA-512"):lP.env.machineId}};QI=U([(0,pu.injectable)(),x(0,(0,pu.inject)(Et)),x(0,(0,pu.named)(rr)),x(1,(0,pu.inject)(cy)),x(2,(0,pu.inject)(Et)),x(2,(0,pu.named)(Es)),x(3,(0,pu.inject)(st))],QI);function wte(r){r.addSingletonInstance(J7,!1),r.addSingleton(uy,VI),r.addSingleton(ST,BI),r.addSingleton(IT,HI),r.addSingleton(qa,JI),r.addSingleton(cy,ay),r.addSingleton(rP,GI),r.addSingleton(lo,Wd),r.addSingleton(Vu,YI),r.addSingleton(Ite,$I),r.addSingleton(py,du),r.addSingleton(dy,Fs),r.addSingleton(Ve,QI),gte(r)}p();p();var fA=ae(he()),Vd=require("vscode");var jd=class{constructor(e){this.disposables=[];this._onDidChange=new Vd.EventEmitter;e.push(this),zr()||Vd.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("jupyter.kernels.excludePythonEnvironments")&&this._onDidChange.fire()},this,this.disposables)}get onDidChange(){return this._onDidChange.event}dispose(){this._onDidChange.dispose(),Ce(this.disposables)}isPythonEnvironmentExcluded(e){if(zr())return!1;let t=this.getExcludedPythonEnvironments(),n=KSe(e,t),i="uri"in e?e.uri:e.executable.uri;return n&&(ne("DATASCIENCE.JUPYTER_KERNEL_HIDDEN_VIA_FILTER"),C.debug(`Python Env hidden via filter: ${Ee(i)}`)),n}getExcludedPythonEnvironments(){if(!Vd.workspace.workspaceFolders||Vd.workspace.workspaceFolders.length===0)return Vd.workspace.getConfiguration("jupyter",void 0).get("kernels.excludePythonEnvironments",[]);let e=[];return Vd.workspace.workspaceFolders.forEach(t=>{e.push(...Vd.workspace.getConfiguration("jupyter",t.uri).get("kernels.excludePythonEnvironments",[]))}),e}};jd=U([(0,fA.injectable)(),x(0,(0,fA.inject)(ve))],jd);function KSe(r,e){var o;let t="uri"in r?r.envPath:(o=r.environment)==null?void 0:o.folderUri,n="uri"in r?r.uri:r.executable.uri;return!n&&!t?!1:e.some(s=>{let a=Ee(s.trim()).toLowerCase().replace(/\\/g,"/");if(s=s.trim().toLowerCase().replace(/\\/g,"/"),s.length===0||a.length===0)return!1;let l=Ee(n).toLowerCase().replace(/\\/g,"/"),u=n?n.fsPath.toLowerCase().replace(/\\/g,"/"):"";if(s===l||a===l||s===u||a===u)return!0;let c=Ee(t||"").toLowerCase().replace(/\\/g,"/"),d=Ee(t||"").toLowerCase().replace(/\\/g,"/");return s===c||a===c||s===d||a===d})}p();var xte=ae(he()),co=require("vscode");var XI=class{activate(){this.migrateFilters().catch(E)}async migrateFilters(){let e=Array.isArray(co.workspace.workspaceFolders)?co.workspace.workspaceFolders:[];await this.migrateWorkspaceFilters(co.workspace.getConfiguration("jupyter",void 0),co.ConfigurationTarget.Global),e.length===0?await this.migrateWorkspaceFilters(co.workspace.getConfiguration("jupyter",void 0),co.ConfigurationTarget.Global):e.length===1?await this.migrateWorkspaceFilters(co.workspace.getConfiguration("jupyter",e[0].uri),co.ConfigurationTarget.WorkspaceFolder):(await this.migrateWorkspaceFilters(co.workspace.getConfiguration("jupyter",void 0),co.ConfigurationTarget.Workspace),await Promise.all(e.map(t=>this.migrateWorkspaceFilters(co.workspace.getConfiguration("jupyter",t.uri),co.ConfigurationTarget.WorkspaceFolder))))}async migrateWorkspaceFilters(e,t){let n=e.inspect("kernels.filter"),i=[];switch(t){case co.ConfigurationTarget.Global:i=(n==null?void 0:n.globalValue)||[];break;case co.ConfigurationTarget.Workspace:i=(n==null?void 0:n.workspaceValue)||[];break;default:i=(n==null?void 0:n.workspaceFolderValue)||[]}let o=i.filter(s=>s.type==="pythonEnvironment").map(s=>s.path);i.length&&await e.update("kernels.filter",void 0,t),o.length&&await e.update("kernels.excludePythonEnvironments",Array.from(new Set(o)),t)}};XI=U([(0,xte.injectable)()],XI);p();var mA=ae(he());var Vj=require("vscode");var ZI=class{constructor(e){this.disposables=e}activate(){this.disposables.push(Vj.commands.registerCommand("jupyter.filterKernels",()=>Vj.commands.executeCommand("workbench.action.openSettings","jupyter.kernels.excludePythonEnvironments").then(E,E),this))}};ZI=U([(0,mA.injectable)(),x(0,(0,mA.inject)(ve))],ZI);function Pte(r){r.addSingleton(Ve,XI),r.addSingleton(Ve,ZI),r.addSingleton(jd,jd)}p();var Rte=ae(he()),eS=require("vscode");p();var Tte=new Set;function kte(r){Tte.add(r)}function Dte(r){try{Tte.forEach(e=>e.report(r))}catch(e){C.error("Failed to report progress",e)}}function Nte(r){return function(e,t,n){let i=n.value;n.value=async function(...o){return Dte({action:r,phase:"started"}),i.apply(this,o).finally(()=>{Dte({action:r,phase:"completed"})})}}}p();p();var USe={JupyterSessionWaitForIdleSession:W.waitingForJupyterSessionToBeIdle,KernelsGetKernelForRemoteConnection:W.gettingListOfKernelsForRemoteConnection,KernelsGetKernelSpecs:W.gettingListOfKernelSpecs,KernelsRegisterKernel:W.registeringKernel,NotebookConnect:W.connectingToJupyter,NotebookStart:W.startingJupyterNotebook,InstallingMissingDependencies:W.installingMissingDependencies,ExportNotebookToPython:W.exportNotebookToPython,PerformingExport:W.performingExport};function hA(r){return USe[r]}var Fl=class{constructor(){this.progressReporters=[];this.actionPhases=new Map;this.currentActions=[];kte(this)}get currentAction(){return this.currentActions.length===0?void 0:this.currentActions[this.currentActions.length-1]}createProgressIndicator(e,t=!1){let n=new eS.CancellationTokenSource,i=Oe(),o={location:eS.ProgressLocation.Notification,cancellable:t,title:e};return eS.window.withProgress(o,async(s,a)=>{a.onCancellationRequested(()=>{a.isCancellationRequested&&n.cancel(),i.resolve()}),n.token.onCancellationRequested(()=>{i.resolve()}),this.progressReporters.push(s),await i.promise}).then(E,E),{token:n.token,dispose:()=>i.resolve()}}report(e){if(this.progressReporters.length!==0&&(this.actionPhases.set(e.action,e.phase),e.phase==="started"&&this.currentActions.push(e.action),!!this.currentAction)){for(;this.actionPhases.get(this.currentAction)&&this.actionPhases.get(this.currentAction)!=="started";)this.actionPhases.delete(this.currentAction),this.currentActions.pop();this.updateProgressMessage()}}updateProgressMessage(){if(!this.currentAction||this.progressReporters.length===0)return;let e=hA(this.currentAction);e&&this.progressReporters.forEach(t=>t.report({message:e}))}};Fl=U([(0,Rte.injectable)()],Fl);p();var Ate=ae(he());var Mte=require("vscode");var tS=class extends YN{async computeWorkingDirectory(e){var t;if(e){let n=ut(e);return n.includes(".")?ut(Am(e)):n}return e=(e?(t=Mte.workspace.getWorkspaceFolder(e))==null?void 0:t.uri:void 0)||nI(),e?ut(e):"."}};tS=U([(0,Ate.injectable)()],tS);p();var $g=ae(he());var Ote=require("vscode");var rS=class{constructor(e,t){this.jupyterOutput=e;this.disposableRegistry=t}register(){this.disposableRegistry.push(Ote.commands.registerCommand(de.ViewJupyterOutput,this.viewJupyterOutput,this))}viewJupyterOutput(){this.jupyterOutput.show(!0)}};rS=U([(0,$g.injectable)(),x(0,(0,$g.inject)(Um)),x(0,(0,$g.named)(Hv)),x(1,(0,$g.inject)(ve))],rS);p();var jte=ae(he()),rm=ae(require("vscode"));p();var nS=ae(require("vscode")),jj;(l=>{let r=nS.FileSystemError.FileNotFound().name,e=nS.FileSystemError.FileExists().name,t=nS.FileSystemError.FileIsADirectory().name,n=nS.FileSystemError.FileNotADirectory().name,i=nS.FileSystemError.NoPermissions().name,o=[r,e,t,n,i];function s(u,c){if(o.includes(u.name))return u.name===c}function a(u){return s(u,r)}l.isFileNotFound=a})(jj||(jj={}));function WSe(r,e){let t=r.code;if(t)return t===e}function Lte(r){let e=jj.isFileNotFound(r);return e!==void 0?e:WSe(r,"ENOENT")}p();var Wte=ae(Ute()),Vte=require("vscode"),fu=class{constructor(e=Wte.fetch){this.fetchImplementation=e;this.requestOptions={};let t=Vte.workspace.getConfiguration("http").get("proxy","");t&&(this.requestOptions={headers:{proxy:t}})}async downloadFile(e){return this.fetchImplementation(e,this.requestOptions)}async exists(e){try{return(await this.downloadFile(e)).status===200}catch(t){return C.debug(`HttpClient - Failure checking for file ${e}: ${t}`),!1}}};var oS=class{constructor(){this.vscfs=rm.workspace.fs}arePathsSame(e,t){return Xs(e,t)}async getFiles(e){return(await this.vscfs.readDirectory(e)).filter(n=>n[1]===rm.FileType.File).map(n=>rm.Uri.file(n[0]))}async copy(e,t,n){await this.vscfs.copy(e,t,n)}async createDirectory(e){await this.vscfs.createDirectory(e)}async delete(e){await this.vscfs.delete(e)}async readFile(e){let t=await this.vscfs.readFile(e);return new TextDecoder().decode(t)}async stat(e){return this.vscfs.stat(e)}async writeFile(e,t){return this.vscfs.writeFile(e,typeof t=="string"?new TextEncoder().encode(t):t)}async exists(e,t){if(e.scheme.toLowerCase()==="http"||e.scheme.toLowerCase()==="https")return new fu().exists(e.toString());let n;try{n=await this.stat(e)}catch(i){return Lte(i)||C.error(`stat() failed for "${e}"`,i),!1}return t===void 0?!0:t===rm.FileType.Unknown?n.type===rm.FileType.Unknown:(n.type&t)===t}async getFileHash(e){let t=await this.stat(e),n=`${t.ctime}-${t.mtime}`;return Ha(n,"SHA-512")}};oS=U([(0,jte.injectable)()],oS);p();var vA=ae(he()),Ul=require("vscode");var Kt=class{constructor(e){this.kernelResourceProgressReporter=new Map;e.push(this),Kt.instance=this}activate(){}dispose(){Ce(Array.from(Kt.disposables))}static createProgressReporter(e,t,n){if(!Kt.instance)return new Ul.Disposable(E);let i=e?Wa(e):"";return Kt.instance.kernelResourceProgressReporter.has(i)?Kt.reportProgress(e,t):Kt.createProgressReporterInternal(i,t,n)}static wrapAndReportProgress(e,t,n){let i=e?Wa(e):"";if(!Kt.instance)return n();let o=new ln,s=setTimeout(()=>{o.isDisposed||o.add(Kt.reportProgressInternal(i,t))},2e3);return o.add(new Ul.Disposable(()=>clearTimeout(s))),n().finally(()=>o.dispose())}static reportProgress(e,t){let n=hA(t)||t,i=e?Wa(e):"";return n?Kt.reportProgressInternal(i,n||""):new Ul.Disposable(()=>E)}static reportProgressInternal(e,t){if(!Kt.instance)return new Ul.Disposable(E);let n=Kt.instance.kernelResourceProgressReporter.get(e);if(n||(n={title:t,pendingProgress:[],progressList:[],dispose:E},Kt.instance.kernelResourceProgressReporter.set(e,n)),n.reporter)n.progressList.push(t),n.reporter.report({message:t});else{if(n.progressList.includes(t))return new Ul.Disposable(E);n.pendingProgress.push(t)}return{dispose:()=>{try{if(!n)return;let i=n.progressList.findIndex(o=>o===t);if(i>=0&&n.progressList.splice(i),n.progressList.length>0){let o=n.progressList[n.progressList.length-1];n.reporter&&n.reporter.report({message:o===n.title&&n.reporter?"":o})}else Kt.instance.kernelResourceProgressReporter.delete(e),n.dispose()}catch(i){C.error(`Failed to dispose Progress reporter for ${e}`,i)}}}}static createProgressReporterInternal(e,t,n){let i=Oe(),o=new Ul.Disposable(()=>i.resolve()),s=Kt.instance.kernelResourceProgressReporter.get(e)||{title:t,pendingProgress:[],progressList:[],tokenSources:[],dispose:()=>{o.dispose()}},a=!1,l=()=>{a||(a=!0,Ul.window.withProgress({location:Ul.ProgressLocation.Notification,title:t},async(u,c)=>{let d=Kt.instance.kernelResourceProgressReporter.get(e);if(d){for(d.reporter=u;d.pendingProgress.length>0;){let f=d.pendingProgress.shift();f===t?d.progressList.push(f):f!==t&&f&&(d.progressList.push(f),u.report({message:f}))}await Ls(c,i.promise),Kt.instance.kernelResourceProgressReporter.get(e)===d&&Kt.instance.kernelResourceProgressReporter.delete(e),Kt.disposables.delete(o)}}).then(E,E))};return Kt.instance.kernelResourceProgressReporter.set(e,{...s,dispose:()=>o.dispose(),show:l}),Kt.disposables.add(o),s.pendingProgress.push(t),n||l(),{dispose:()=>o.dispose(),show:l}}};Kt.disposables=new Set,Kt=U([(0,vA.injectable)(),x(0,(0,vA.inject)(ve))],Kt);p();var lS=ae(he()),yA=require("vscode");p();var Bte=require("vscode");var sS=class{constructor(e,t,n,i=[]){this.fs=e;this.disposableRegistry=t;this.options=n;this.loadFailedEmitter=new Bte.EventEmitter;let o={enableScripts:!0,localResourceRoots:[this.options.rootPath,this.options.cwd,...i]};n.webviewHost?(this.webviewHost=n.webviewHost,this.webviewHost.webview.options=o):this.webviewHost=this.createWebview(o),this.loadPromise=this.load()}get loadFailed(){return this.loadFailedEmitter.event}asWebviewUri(e){var t;if(!((t=this.webviewHost)!=null&&t.webview))throw new Error("WebView not initialized, too early to get a Uri");return this.webviewHost.webview.asWebviewUri(e)}postMessage(e){var t,n;(t=this.webviewHost)!=null&&t.webview&&((n=this.webviewHost)==null||n.webview.postMessage(e))}async generateLocalReactHtml(){var o;if(!((o=this.webviewHost)!=null&&o.webview))throw new Error("WebView not initialized, too early to get a Uri");let e=this.webviewHost.webview.asWebviewUri(this.options.cwd).toString(),t=this.options.scripts.map(s=>this.webviewHost.webview.asWebviewUri(s)),n=this.webviewHost.webview.asWebviewUri(this.options.rootPath).toString();return`<!doctype html>
        <html lang="en">
            <head>
                <meta charset="utf-8">
                <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
                <meta http-equiv="Content-Security-Policy" content="img-src 'self' data: https: http: blob: ${this.webviewHost.webview.cspSource}; default-src 'unsafe-inline' 'unsafe-eval' data: https: http: blob: ${this.webviewHost.webview.cspSource};">
                <meta name="theme-color" content="#000000">
                <meta name="theme" content="${nt.GeneratedThemeName}"/>
                <title>VS Code Python React UI</title>
                <base href="${e}${e.endsWith("/")?"":"/"}"/>
                </head>
            <body>
                <noscript>You need to enable JavaScript to run this app.</noscript>
                <div id="root"></div>
                <script type="text/javascript">
                    // Public path that will be used by webpack.
                    window.__PVSC_Public_Path = "${n}/";
                    function resolvePath(relativePath) {
                        if (relativePath && relativePath[0] == '.' && relativePath[1] != '.') {
                            return "${e}" + relativePath.substring(1);
                        }

                        return "${e}" + relativePath;
                    }
                    function forceTestMiddleware() {
                        return false;
                    }
                <\/script>
                ${t.map(s=>`<script type="text/javascript" src="${s}"><\/script>`).join(`
`)}
            </body>
        </html>`}async load(){var e;try{(e=this.webviewHost)!=null&&e.webview&&((await Promise.all(this.options.scripts.map(n=>this.fs.exists(n)))).every(n=>n===!0)?(this.webviewHost.webview.html=await this.generateLocalReactHtml(),this.postLoad(this.webviewHost)):this.webviewHost.webview.html=W.badWebPanelFormatString(this.options.scripts.join(", ")))}catch(t){C.error(`Error Loading WebviewPanel: ${t}`),this.loadFailedEmitter.fire()}}};var Bj=class extends sS{get panel(){return this.webviewHost}get panelOptions(){return this.options}constructor(e,t,n,i=[]){super(e,t,n,i)}async show(e){await this.loadPromise,this.panel&&(e?this.panel.visible||this.panel.reveal(this.panel.viewColumn,e):this.panel.active||this.panel.reveal(this.panel.viewColumn,e))}close(){this.panel&&this.panel.dispose()}get viewColumn(){var e;return(e=this.panel)==null?void 0:e.viewColumn}isVisible(){return this.panel?this.panel.visible:!1}isActive(){return this.panel?this.panel.active:!1}setTitle(e){this.panelOptions.title=e,this.panel&&(this.panel.title=e)}createWebview(e){return yA.window.createWebviewPanel(this.panelOptions.title.toLowerCase().replace(" ",""),this.panelOptions.title,{viewColumn:this.panelOptions.viewColumn,preserveFocus:!0},{retainContextWhenHidden:!0,enableFindWidget:!0,...e})}postLoad(e){this.disposableRegistry.push(e.onDidDispose(()=>{this.webviewHost=void 0,this.panelOptions.listener.dispose()})),this.disposableRegistry.push(e.webview.onDidReceiveMessage(t=>{this.panelOptions.listener.onMessage(t.type,t.payload)})),this.disposableRegistry.push(e.onDidChangeViewState(t=>{this.panelOptions.listener.onChangeViewState(this)})),this.panelOptions.listener.onChangeViewState(this)}},aS=class{constructor(e,t,n){this.disposableRegistry=e;this.fs=t;this.context=n}async create(e){let t=[yA.Uri.file(BE(this.context.extensionPath,"temp"))];return Array.isArray(e.additionalPaths)&&t.push(...e.additionalPaths),new Bj(this.fs,this.disposableRegistry,e,t)}};aS=U([(0,lS.injectable)(),x(0,(0,lS.inject)(ve)),x(1,(0,lS.inject)(Pt)),x(2,(0,lS.inject)(st))],aS);p();var cP=ae(he()),Hte=require("vscode");var Hj=class extends sS{constructor(t,n,i,o=[]){super(t,n,i,o);this.panelOptions=i;this._onDidChangeVisibility=new Hte.EventEmitter}get visible(){return this.webviewHost?this.webviewHost.visible:!1}get onDidChangeVisibility(){return this._onDidChangeVisibility.event}createWebview(t){throw new Error("Webview Views must be passed in an initial view")}postLoad(t){this.disposableRegistry.push(t.onDidDispose(()=>{this.webviewHost=void 0,this.panelOptions.listener.dispose()})),this.disposableRegistry.push(t.webview.onDidReceiveMessage(n=>{this.panelOptions.listener.onMessage(n.type,n.payload)})),this.disposableRegistry.push(t.onDidChangeVisibility(()=>{this._onDidChangeVisibility.fire()})),this._onDidChangeVisibility.fire()}},cS=class{constructor(e,t){this.disposableRegistry=e;this.fs=t}async create(e){return new Hj(this.fs,this.disposableRegistry,e)}};cS=U([(0,cP.injectable)(),x(0,(0,cP.inject)(ve)),x(1,(0,cP.inject)(Pt))],cS);function qte(r){r.addSingleton(Pt,oS),r.addSingleton(UR,tS),r.addSingleton(RI,WI),r.addSingleton(Ke,LI),r.addSingleton(_T,rS),r.addSingleton(Fl,Fl),wte(r),zee(r),Pte(r),r.addSingleton(Ve,Kt),r.addSingleton(Ve,Ol),r.add(WR,cS),r.add(AI,aS)}p();p();var $it=Symbol("IKernelLauncher"),Hd=Symbol("IRawNotebookSupportedService"),Jte=Symbol("IRawKernelSessionFactory");p();var uP=ae(he()),qj=require("vscode");p();var bA=require("vscode");var Mr;(n=>{let r=Lu(new bA.EventEmitter);n.onDidChangeNotebookCellExecutionState=r.event;function t(i,o,s){if(o!==1||!s){r.fire({cell:i,state:o});return}let a=Lu(bA.workspace.onDidChangeNotebookDocument(l=>{var c,d;if(l.notebook!==i.notebook)return;let u=l.cellChanges.find(f=>f.cell===i);((d=(c=u==null?void 0:u.cell)==null?void 0:c.executionSummary)==null?void 0:d.executionOrder)===s&&(a.dispose(),r.fire({cell:i,state:1}))}))}n.changeCellState=t})(Mr||(Mr={}));var zg=class{constructor(e,t){this.disposableRegistry=e;this.kernelProvider=t;this.lastExecutedCellPerKernel=new WeakMap;this.kernelsStartedSuccessfully=new WeakSet}activate(){this.kernelProvider.onKernelStatusChanged(this.onKernelStatusChanged,this,this.disposableRegistry),this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposableRegistry)}onDidStartKernel(e){this.kernelsStartedSuccessfully.add(e),Mr.onDidChangeNotebookCellExecutionState(t=>{t.cell.notebook===e.notebook&&this.kernelProvider.get(t.cell.notebook)===e&&this.lastExecutedCellPerKernel.set(e,t.cell)})}async onKernelStatusChanged({kernel:e}){this.kernelsStartedSuccessfully.has(e)&&(e.disposed||e.disposing||!e.session||(e.session.kind==="localRaw"&&e.status==="dead"&&(qj.window.showErrorMessage(W.kernelDiedWithoutError(lt(e.kernelConnectionMetadata))).then(E,E),await this.endCellAndDisplayErrorsInCell(e)),e.session.kind!=="localRaw"&&e.status==="autorestarting"&&(qj.window.showErrorMessage(W.kernelDiedWithoutErrorAndAutoRestarting(lt(e.kernelConnectionMetadata))).then(E,E),await this.endCellAndDisplayErrorsInCell(e))))}async endCellAndDisplayErrorsInCell(e){let t=this.lastExecutedCellPerKernel.get(e);if(Rr(e.resourceUri,"DATASCIENCE.KERNEL_CRASH"),!!t)return Ld(t,e.controller,W.kernelCrashedDueToCodeInCurrentOrPreviousCell,!1)}};U([yn()],zg.prototype,"onKernelStatusChanged",1),zg=U([(0,uP.injectable)(),x(0,(0,uP.inject)(ve)),x(1,(0,uP.inject)(qe))],zg);p();p();var Zte=ae(he());p();var Da=ae(he());p();var uS=class extends ot{constructor(e){super("jupyterinstall",e)}};var Or=require("vscode");p();var IA=class extends yi{constructor(e){super("timeout",W.rawKernelStartFailedDueToTimeout(lt(e)),e)}};p();var dS=class extends iu{constructor(t,n,i,o){super(t,i,o);this.stdErr=n}};p();var SA=class extends yi{constructor(e){super("timeout",W.rawKernelStartFailedDueToTimeoutWaitingForPort(lt(e)),e)}};p();var pS=class extends yi{constructor(t=-1,n,i){super("kerneldied",W.kernelDied(n.trim()),i);this.exitCode=t;this.stdErr=n}};p();p();var Lot=Symbol("IModuleInstaller"),Kot=Symbol("IPythonInstallation"),Fot=Symbol("IInstallationChannelManager"),Uot=Symbol("IProductService"),Wot=Symbol("IProductPathService");var Vot=Symbol("IInstaller");function Jj(r){switch(r){case 18:return"jupyter";case 20:return"notebook";case 23:return"pandas";case 19:return"ipykernel";case 22:return"nbconvert";case 21:return"kernelspec";case 27:return"pip";case 28:return"ensurepip";default:throw new Ur(`Product ${r} cannot be installed as a Python Module.`,void 0,"unknownProduct")}}p();var Ii=new Map;Ii.set(18,"jupyter");Ii.set(20,"notebook");Ii.set(19,"ipykernel");Ii.set(22,"nbconvert");Ii.set(21,"kernelspec");Ii.set(23,"pandas");Ii.set(27,"pip");Ii.set(28,"ensurepip");p();var dP=class extends yi{constructor(t,n){super("noipykernel",W.kernelInvalid(lt(n)),n);this.reason=t}};p();var Wl=class extends iu{constructor(e){super(W.kernelDiedWithoutError(lt(e)),void 0,e)}};p();var Gte=require("vscode"),fr=class{constructor(e){this._event=new Gte.EventEmitter;this._disableUI=e}get disableUI(){return this._disableUI}set disableUI(e){let t=this._disableUI!==e;this._disableUI=e,t&&this._event.fire()}get onDidChangeDisableUI(){return this._event.event}dispose(){this._event.dispose()}},EA=class extends fr{constructor(t,n){super(t);this.ignoreTriggeringOnPostInitialized=n}};p();var CA=class extends ot{constructor(e){super("jupyterexpiredcert",e)}};p();var nm=class extends ot{constructor(t){super("invalidremotejupyterserverurihandle","Server handle not in list of known handles");this.serverProviderHandle=t}};p();var im=Symbol("IInterpreterService");p();var wA=class extends ot{constructor(t,n,i){super("windowsLongPathNotEnabled",i);this.product=t;this.interpreter=n;this.originalMessage=i}};p();var pP=class extends ot{constructor(t,n,i){super("jupyternotebooknotinstalled",t+(n?`
${n}`:""));this.interpreter=i}};p();var Yte=new Map;function xA(r,e){Yte.set(Vt(r),e)}function fS(r,e,t){let n=e.jupyterCollections.find(i=>i.extensionId===r.extensionId&&i.id===r.id);return Yte.get(Vt(r))||(n==null?void 0:n.label)||t||`${r.id}:${r.handle}`}p();var VSe=new Set;async function $te(r,e,t){let n=`${await Yb(t)}#${Ii.get(e)}`;await r.update(n,void 0)}function zte(r){return VSe.has(r.id)}var hS=class{constructor(e,t,n,i,o,s,a){this.dependencyManager=e;this.configuration=t;this.kernelDependency=n;this.serverUriStorage=i;this.jupyterUriProviderRegistration=o;this.fs=s;this.interpreterService=a;this.handledErrors=new WeakSet;this.handledKernelErrors=new WeakSet}async handleError(e){var t;if(C.warn("DataScience Error",e),e=Ur.unwrap(e),!this.handledErrors.has(e)){if(this.handledErrors.add(e),e instanceof uS)await((t=this.dependencyManager)==null?void 0:t.installMissingDependencies(e));else if(e instanceof Mi)await dR(this.configuration,e.message);else if(e instanceof CA)await pR(this.configuration,e.message);else if(!qn(e))if(e instanceof IA||e instanceof SA)Or.window.showErrorMessage(e.message).then(E,E);else if(e instanceof dS||e instanceof pS||e instanceof pP||e instanceof Rp)Or.window.showErrorMessage(mS(e)).then(E,E);else if(e instanceof ao&&zr())Or.window.showErrorMessage(W.jupyterNotebookRemoteConnectFailedWeb(e.baseUrl)).then(E,E);else if(e instanceof ao){let n=await this.handleJupyterServerConnectionError(e,void 0);Or.window.showErrorMessage(n).then(E,E)}else if(e instanceof Jf){let n=await this.handleJupyterServerUriProviderError(e,void 0);Or.window.showErrorMessage(n).then(E,E)}else{let n=Xte(e.message||e.toString());Or.window.showErrorMessage(n).then(E,E)}}}async getErrorMessageForDisplayInCell(e,t,n){return this.getErrorMessageForDisplayInCellImpl(e,t,n,!1)}async getErrorMessageForDisplayInCellOutput(e,t,n){return this.getErrorMessageForDisplayInCellImpl(e,t,n,!0)}async getErrorMessageForDisplayInCellImpl(e,t,n,i){var o;if(e=Ur.unwrap(e),qn(e)||C.error("Error in execution (get message for cell)",e),e instanceof Wl)return"";if(e instanceof dP){let s=this.interpreterService?await this.interpreterService.hasWorkspaceSpecificEnvironment():!1;return Gj(e.kernelConnectionMetadata,!s&&!zr()&&i)||e.message}else{if(e instanceof uS)return HSe(e)||e.message;if(e instanceof ao&&!zr())return e.message;if(e instanceof ao&&zr())return W.jupyterNotebookRemoteConnectFailedWeb(e.baseUrl);if(qn(e))return"";if(e instanceof wA){let s=typeof e.product=="string"?e.product:Ii.get(e.product)||`${e.product}`,a=Uu(e.interpreter)||e.interpreter.id||"",l=Ji(e.interpreter),u=Ee(l==null?void 0:l.executable.uri),c=a?` ${a} (${u})`:u;return W.packageNotInstalledWindowsLongPathNotEnabledError(s,c)}else{if((e instanceof dS||e instanceof pS)&&(e.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||e.kernelConnectionMetadata.kind==="startUsingPythonInterpreter")&&e.kernelConnectionMetadata.interpreter&&!await this.fs.exists(e.kernelConnectionMetadata.interpreter.uri))return W.failedToStartKernelDueToMissingPythonEnv(Uu(e.kernelConnectionMetadata.interpreter)||_s(e.kernelConnectionMetadata.interpreter)||Ee(e.kernelConnectionMetadata.interpreter.uri));if((e instanceof dS||e instanceof pS)&&(e.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||e.kernelConnectionMetadata.kind==="startUsingPythonInterpreter")&&e.kernelConnectionMetadata.interpreter&&this.kernelDependency&&!await this.kernelDependency.areDependenciesInstalled(e.kernelConnectionMetadata,void 0,!0)){let s=this.interpreterService?await this.interpreterService.hasWorkspaceSpecificEnvironment():!1;return Gj(e.kernelConnectionMetadata,!s&&!zr()&&i)||e.message}else if(e instanceof yi||e instanceof iu){let[s,a]=await Promise.all([this.getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(n),cK(e.kernelConnectionMetadata.interpreter)]),l=Wm(Or.workspace.workspaceFolders||[],e,lt(e.kernelConnectionMetadata),a,s.map(u=>u.uri));if(l){if(l.reason==="moduleNotFound"&&["ipykernel_launcher","ipykernel"].includes(l.moduleName)){let c=this.interpreterService?await this.interpreterService.hasWorkspaceSpecificEnvironment():!1;return Gj(e.kernelConnectionMetadata,!c&&!zr()&&i)||e.message}let u=[l.message];return l.moreInfoLink&&u.push(Ue.clickHereForMoreInfoWithHtml(l.moreInfoLink)),jt(e.kernelConnectionMetadata)&&l.reason==="moduleNotFound"&&!["ipykernel_launcher","ipykernel"].includes(l.moduleName)&&await this.addErrorMessageIfPythonArePossiblyOverridingPythonModules(u,n),u.join(`
`)}}else{if(e instanceof ao)return this.handleJupyterServerConnectionError(e,t);if(e instanceof Jf)return this.handleJupyterServerUriProviderError(e,t);if(e instanceof nm){let s=((o=Or.extensions.getExtension(e.serverProviderHandle.extensionId))==null?void 0:o.packageJSON.displayName)||e.serverProviderHandle.extensionId;return mS(W.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid(s),t)}}}}return mS(e,t)}async handleJupyterServerUriProviderError(e,t){var o;let n=await fS(e.serverProviderHandle,this.jupyterUriProviderRegistration),i=((o=e.originalError)==null?void 0:o.message)||e.message;return mS(W.remoteJupyterConnectionFailedWithServerWithError(n,i),t)}async handleJupyterServerConnectionError(e,t){let n=await fS(e.serverProviderHandle,this.jupyterUriProviderRegistration,e.baseUrl),i=e.originalError.message||"";return mS(W.remoteJupyterConnectionFailedWithServerWithError(n,i),t)}async handleJupyterServerProviderConnectionError(e,t){let n=new Or.CancellationTokenSource;try{let i=await Promise.resolve(t.serverProvider.provideJupyterServers(n.token));return i&&(i.find(o=>o.id===e.handle)||await this.serverUriStorage.remove(e).catch(E)),!0}catch(i){return!1}finally{n.dispose()}}async handleKernelError(e,t,n,i,o){var s,a;if(qn(e)||C.warn(`Kernel Error, context = ${t}`,e),e=Ur.unwrap(e),qn(e))return this.sendKernelTelemetry(e,t,i,"cancelled"),1;if(e instanceof dP)if(C.warn(`Jupyter Kernel Dependency Error, reason=${e.reason}`,e),this.sendKernelTelemetry(e,t,i,e.category),e.reason===4&&this.kernelDependency){let l=new Or.CancellationTokenSource;try{let u=o==="3rdPartyExtension";return this.kernelDependency.installMissingDependencies({resource:i,kernelConnection:n,ui:new fr(!1),token:l.token,ignoreCache:!0,cannotChangeKernels:u})}finally{l.dispose()}}else return e.reason;else{if((t==="start"||t==="restart")&&e instanceof uS)return this.sendKernelTelemetry(e,t,i,e.category),(this.dependencyManager?await this.dependencyManager.installMissingDependencies(e):2)===0?0:1;if(e instanceof ao||e instanceof Jf||e instanceof nm){this.sendKernelTelemetry(e,t,i,e.category);let l=e instanceof nm?"":e instanceof ao?e.originalError.message||"":((s=e.originalError)==null?void 0:s.message)||e.message,u=e.serverProviderHandle.extensionId,c=e.serverProviderHandle.id,d=this.jupyterUriProviderRegistration.jupyterCollections.find(k=>k.extensionId===u&&k.id==c);if(!d||await this.handleJupyterServerProviderConnectionError(e.serverProviderHandle,d))return 3;let f=e instanceof ao?e.baseUrl:"",m=fS(e.serverProviderHandle,this.jupyterUriProviderRegistration,f),g=e instanceof nm?((a=Or.extensions.getExtension(e.serverProviderHandle.extensionId))==null?void 0:a.packageJSON.displayName)||e.serverProviderHandle.extensionId:"",b=o==="jupyterExtension"?[W.selectDifferentKernel]:[];switch(await Or.window.showErrorMessage(e instanceof nm?W.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid(g):W.remoteJupyterConnectionFailedWithServer(m),{detail:l,modal:!0},W.removeRemoteJupyterConnectionButtonText,W.changeRemoteJupyterConnectionButtonText,...b)){case W.removeRemoteJupyterConnectionButtonText:return await this.serverUriStorage.remove(e.serverProviderHandle).catch(E),1;case W.changeRemoteJupyterConnectionButtonText:return 1;case W.selectDifferentKernel:return 3}return 1}else if(e instanceof Mi){this.sendKernelTelemetry(e,t,i,e.category);let l=W.jupyterSelfCertEnable,u=W.jupyterSelfCertClose;return Or.window.showErrorMessage(W.jupyterSelfCertFail(e.message),l,u).then(c=>{c===l?(ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),this.configuration.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,Or.ConfigurationTarget.Workspace).catch(E)):c===u&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE")}).then(E,E),2}else{if((t==="start"||t==="restart")&&n.kind==="startUsingPythonInterpreter"&&this.interpreterService&&!await this.fs.exists(n.interpreter.uri))return this.sendKernelTelemetry(e,t,i,"pythonEnvironmentMissing"),Or.window.showErrorMessage(W.failedToStartKernelDueToMissingPythonEnv(Uu(n.interpreter)||_s(n.interpreter)||Ee(n.interpreter.uri))).then(E,E),this.interpreterService.refreshInterpreters(!0).catch(E),2;if((t==="start"||t==="restart")&&this.kernelDependency&&!await this.kernelDependency.areDependenciesInstalled(n,void 0,!0)){this.sendKernelTelemetry(e,t,i,"noipykernel");let l=new Or.CancellationTokenSource;try{let u=o==="3rdPartyExtension";return this.kernelDependency.installMissingDependencies({resource:i,kernelConnection:n,ui:new fr(!1),token:l.token,ignoreCache:!0,cannotChangeKernels:u})}finally{l.dispose()}}else{let[l,u]=await Promise.all([this.getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(i),cK(n.interpreter)]),c=Wm(Or.workspace.workspaceFolders||[],e,lt(n),u,l.map(d=>d.uri));return this.sendKernelTelemetry(e,t,i,c==null?void 0:c.reason),c?this.showMessageWithMoreInfo(c.message,c==null?void 0:c.moreInfoLink).catch(E):this.showMessageWithMoreInfo(mS(e,t)).catch(E),2}}}}sendKernelTelemetry(e,t,n,i){this.handledKernelErrors.has(e)||(this.handledKernelErrors.add(e),t==="start"&&Rr(n,"DATASCIENCE.NOTEBOOK_START",void 0,{disableUI:!1,failureCategory:i},e))}async showMessageWithMoreInfo(e,t){e.includes(de.ViewJupyterOutput)||(e=`${e} 
${W.viewJupyterLogForFurtherInfo}`);let n=t?[Ue.learnMore]:[];await Or.window.showErrorMessage(e,...n).then(i=>{i===Ue.learnMore&&t&&Or.env.openExternal(Or.Uri.parse(t))})}};hS=U([x(0,(0,Da.inject)(Tee)),x(0,(0,Da.optional)()),x(1,(0,Da.inject)(Ke)),x(2,(0,Da.inject)(II)),x(2,(0,Da.optional)()),x(3,(0,Da.inject)(pr)),x(4,(0,Da.inject)(sr)),x(5,(0,Da.inject)(Pt)),x(6,(0,Da.inject)(im)),x(6,(0,Da.optional)())],hS);var jSe={restart:W.failedToRestartKernel,start:W.failedToStartKernel,interrupt:W.failedToInterruptKernel,execution:""};function mS(r,e){r=typeof r=="string"?r:Ur.unwrap(r);let t=e?jSe[e]:"",n="";return r instanceof pP?n=W.jupyterNotebookNotInstalledOrNotFound(r.interpreter):r instanceof ot?n=c8(r.stdErr)||r.stdErr||r.message:n=typeof r=="string"?r:r.message,Xte(t,n)}function BSe(r){var t,n;return((n=(t=new RegExp(/\[([^\[]+)\]\((.*)\)/).exec(r))==null?void 0:t.length)!=null?n:0)>0}function Xte(r="",e=""){r&&e.startsWith(r.substring(0,r.length-1))&&(r="");let t=[r,e].map(n=>n.trim()).filter(n=>n.length>0).join(` 
`);return!BSe(t)&&t.length&&t.indexOf("command:jupyter.viewOutput")===-1?`${t.endsWith(".")?t:t+"."} 
${W.viewJupyterLogForFurtherInfo}`:t}function Gj(r,e){var a,l,u,c;if(r.kind==="connectToLiveRemoteKernel"||r.kind==="startUsingRemoteKernelSpec"||!r.interpreter)return;let t=Uu(r.interpreter)||ut(r.interpreter.uri),n=Ii.get(19),i=Jj(19),o=`${gL(ut(r.interpreter.uri))} -m pip install ${i} -U --force-reinstall`;if(r.interpreter&&br(r.interpreter)==="Conda"){let d=Ji(r.interpreter);(a=d==null?void 0:d.environment)!=null&&a.name?o=`conda install -n ${(l=d==null?void 0:d.environment)==null?void 0:l.name} ${i} --update-deps --force-reinstall`:(u=d==null?void 0:d.environment)!=null&&u.folderUri&&(o=`conda install -p ${ut((c=d==null?void 0:d.environment)==null?void 0:c.folderUri)} ${i} --update-deps --force-reinstall`)}else r.interpreter&&br(r.interpreter)==="Unknown"&&(o=`${gL(ut(r.interpreter.uri))} -m pip install ${i} -U --user --force-reinstall`);let s=[W.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreter(t,Ii.get(19))];return e?zte(r.interpreter)?s.push(W.createANewPythonEnvironment()):(s.push(W.createANewPythonEnvironment()),s.push(W.OrInstallPackageInstructions(n,o))):s.push(W.installPackageInstructions(n,o)),s.join(`
`)}function HSe(r){let e=`${Ii.get(18)} ${Ue.and} ${Ii.get(20)}`,t=[18,20].map(Jj).join(" "),n=`python -m pip install ${t} -U
or
conda install ${t} -U`,i=W.installPackageInstructions(e,n);return r.message+`
`+i+`
`+Ue.clickHereForMoreInfoWithHtml("https://aka.ms/installJupyterForVSCode")}var gS=class extends hS{async addErrorMessageIfPythonArePossiblyOverridingPythonModules(e,t){}async getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(e){return[]}};gS=U([(0,Zte.injectable)()],gS);p();var ere=ae(he());var Qg=class{async ensureKernelIsUsable(e,t,n,i,o){C.debug("Check if a kernel is usable")}};U([x(1,fK("id")),x(2,fK("disableUI")),x(3,H7())],Qg.prototype,"ensureKernelIsUsable",1),Qg=U([(0,ere.injectable)()],Qg);p();var fP=ae(he());var tre=require("vscode");var vS=class{constructor(e,t){this.liveKernelConnectionTracker=e;this.providerRegistration=t}async isValid(e){if(!this.liveKernelConnectionTracker.wasKernelUsed(e))return!1;let t=await this.providerRegistration.jupyterCollections.find(i=>i.extensionId===e.serverProviderHandle.extensionId&&i.id===e.serverProviderHandle.id);if(!t)return C.warn(`Extension ${e.serverProviderHandle.extensionId} may have been uninstalled for provider ${e.serverProviderHandle.id}, handle ${e.serverProviderHandle.handle}`),!1;let n=new tre.CancellationTokenSource;try{let i=await Promise.resolve(t.serverProvider.provideJupyterServers(n.token));return i?i.map(o=>o.id).includes(e.serverProviderHandle.handle)?!0:(C.warn(`Hiding remote kernel ${e.id} for ${t.id} as the remote Jupyter Server ${e.serverProviderHandle.extensionId}:${e.serverProviderHandle.id}:${e.serverProviderHandle.handle} is no longer available`),!1):!1}catch(i){return C.warn(`Failed to fetch remote servers from ${e.serverProviderHandle.extensionId}:${e.serverProviderHandle.id}`,i),!1}finally{n.dispose()}}};vS=U([(0,fP.injectable)(),x(0,(0,fP.inject)(Gg)),x(1,(0,fP.inject)(sr))],vS);p();var rre=ae(he());var yS=class{async getOrStartServer(e){throw new Error("Invalid Operation in Web")}};yS=U([(0,rre.injectable)()],yS);p();var mu=require("vscode"),Xg=ae(he());var bS=class extends Pr{constructor(t,n){super();this._onDidLoad=this._register(new mu.EventEmitter);this._onDidChangeUri=this._register(new mu.EventEmitter);this._onDidRemoveUris=this._register(new mu.EventEmitter);this._onDidAddUri=this._register(new mu.EventEmitter);this._all=[];n.push(this),this.newStorage=this._register(new Yj(t))}get onDidLoad(){return this._onDidLoad.event}get onDidChange(){return this._onDidChangeUri.event}get onDidRemove(){return this._onDidRemoveUris.event}get onDidAdd(){return this._onDidAddUri.event}get all(){return this.updateStore(),this._all}hookupStorageEvents(){this.storageEventsHooked||(this.storageEventsHooked=!0,this._register(this.newStorage.onDidAdd(t=>this._onDidAddUri.fire(t),this)),this._register(this.newStorage.onDidChange(t=>this._onDidChangeUri.fire(t),this)),this._register(this.newStorage.onDidRemove(t=>this._onDidRemoveUris.fire(t),this)))}updateStore(){this.hookupStorageEvents();let t=this._all;return this._all=this.newStorage.getAll(),(t.length!==this._all.length||JSON.stringify(this._all)!==JSON.stringify(t))&&this._onDidLoad.fire(),this._all}async clear(){this.hookupStorageEvents(),await this.newStorage.clear(),this._all=[],this._onDidLoad.fire()}async add(t,n){var o;this.hookupStorageEvents(),C.ci(`setUri: ${t.id}.${t.handle}`);let i={time:(o=n==null?void 0:n.time)!=null?o:Date.now(),displayName:"",provider:t};await this.newStorage.add(i),this.updateStore()}async update(t){this.hookupStorageEvents(),await this.newStorage.update(t),this.updateStore()}async remove(t){this.hookupStorageEvents(),await this.newStorage.remove(t),this.updateStore()}};bS=U([(0,Xg.injectable)(),x(0,(0,Xg.inject)(Et)),x(0,(0,Xg.named)(rr)),x(1,(0,Xg.inject)(ve))],bS);var Yj=class{constructor(e){this.memento=e;this._onDidChangeUri=new mu.EventEmitter;this._onDidRemoveUris=new mu.EventEmitter;this._onDidAddUri=new mu.EventEmitter;this.updatePromise=Promise.resolve();this.mementoKey=`MEMENTO_KEY_FOR_STORING_USED_JUPYTER_PROVIDERS_${mu.env.machineId}`}get onDidChange(){return this._onDidChangeUri.event}get onDidRemove(){return this._onDidRemoveUris.event}get onDidAdd(){return this._onDidAddUri.event}dispose(){this._onDidAddUri.dispose(),this._onDidChangeUri.dispose(),this._onDidRemoveUris.dispose()}async add(e){return this.updatePromise=this.updatePromise.then(async()=>{let t=this.getAll(),n=t.find(a=>Vt(a.provider)===Vt(e.provider)),o=[{displayName:e.displayName||(n==null?void 0:n.displayName)||Vt(e.provider),serverHandle:e.provider,time:e.time}].concat(t.sort((a,l)=>l.time-a.time).filter(a=>Vt(a.provider)!==Vt(e.provider)).map(a=>({displayName:a.displayName,serverHandle:a.provider,time:a.time}))),s=o.splice(ai.JupyterServerUriListMax);if(await this.memento.update(this.mementoKey,o),n||this._onDidAddUri.fire(e),s.length){let a=s.map(l=>({provider:l.serverHandle,time:l.time,displayName:l.displayName||""}));this._onDidRemoveUris.fire(a.map(l=>l.provider))}this._onDidChangeUri.fire()}).catch(E)}async update(e){let n=this.getAll().find(o=>o.provider.id===e.id&&o.provider.handle===e.handle),i={provider:e,time:Date.now(),displayName:(n==null?void 0:n.displayName)||""};await this.add(i)}async remove(e){await(this.updatePromise=this.updatePromise.then(async()=>{let t=!1;try{let n=this.getAll();if(n.length===0)return;let i=n.filter(s=>s.provider.id!==e.id||s.provider.handle!==e.handle),o=n.filter(s=>s.provider.id===e.id&&s.provider.handle===e.handle);if(i.length===0)await this.clear();else if(o.length){let s=i.map(a=>({displayName:a.displayName,serverHandle:a.provider,time:a.time}));t=!0,await this.memento.update(this.mementoKey,s),this._onDidRemoveUris.fire(o.map(a=>a.provider))}}finally{t||this._onDidRemoveUris.fire([e])}}).catch(t=>C.error(`Failed to remove Server handle ${JSON.stringify(e)}`,t)))}getAll(){let e=this.memento.get(this.mementoKey,[]),t=[];return e.forEach(async n=>{let i=Vt(n.serverHandle),o={time:n.time,displayName:n.displayName||i,provider:n.serverHandle};t.push(o)}),t}async clear(){let e=this.getAll();await this.memento.update(this.mementoKey,[]),e.length&&this._onDidRemoveUris.fire(e.map(t=>t.provider))}};p();var om=ae(he());var PA="removeKernelUrisAndSessionsUsedByResources",IS=class{constructor(e,t,n){this.disposables=e;this.uriStorage=t;this.memento=n;this.usedRemoteKernelServerIdsAndSessions={}}activate(){this.usedRemoteKernelServerIdsAndSessions=this.memento.get(PA,{}),this.uriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}wasKernelUsed(e){let t=Vt(e.serverProviderHandle);return t in this.usedRemoteKernelServerIdsAndSessions&&typeof e.kernelModel.id=="string"&&e.kernelModel.id in this.usedRemoteKernelServerIdsAndSessions[t]}trackKernelIdAsUsed(e,t,n){let i=Vt(t);this.usedRemoteKernelServerIdsAndSessions[i]=this.usedRemoteKernelServerIdsAndSessions[i]||{},this.usedRemoteKernelServerIdsAndSessions[i][n]=this.usedRemoteKernelServerIdsAndSessions[i][n]||[];let o=this.usedRemoteKernelServerIdsAndSessions[i][n];o.includes(e.toString())||(o.push(e.toString()),this.memento.update(PA,this.usedRemoteKernelServerIdsAndSessions).then(E,E))}trackKernelIdAsNotUsed(e,t,n){let i=Vt(t);if(!(i in this.usedRemoteKernelServerIdsAndSessions)||!(n in this.usedRemoteKernelServerIdsAndSessions[i]))return;let o=this.usedRemoteKernelServerIdsAndSessions[i][n];!Array.isArray(o)||!o.includes(e.toString())||(o.splice(o.indexOf(e.toString()),1),o.length===0&&delete this.usedRemoteKernelServerIdsAndSessions[i][n],Object.keys(this.usedRemoteKernelServerIdsAndSessions[i]).length===0&&delete this.usedRemoteKernelServerIdsAndSessions[i],this.memento.update(PA,this.usedRemoteKernelServerIdsAndSessions).then(E,E))}onDidRemoveServers(e){e.forEach(t=>{let n=Vt(t);delete this.usedRemoteKernelServerIdsAndSessions[n],this.memento.update(PA,this.usedRemoteKernelServerIdsAndSessions).then(E,E)})}};IS=U([(0,om.injectable)(),x(0,(0,om.inject)(ve)),x(1,(0,om.inject)(pr)),x(2,(0,om.inject)(Et)),x(2,(0,om.named)(rr))],IS);p();var sre=ae(he()),are=ae(ire());p();var ore=require("vscode");function $j(r){return class extends r{constructor(...n){super(...n);this._onAnyMessage=new ore.EventEmitter;this.onAnyMessage=this._onAnyMessage.event;this.msgChain=Promise.resolve(),this.sendChain=Promise.resolve(),this.receiveHooks=[],this.sendHooks=[]}patchSuperEmit(n){super.emit=n}send(n,i){this.sendHooks?this.sendChain=this.sendChain.then(()=>Promise.all(this.sendHooks.map(o=>o(n,i)))).then(()=>super.send(n,i)):super.send(n,i)}handleEvent(n,i,...o){return i==="message"&&this.receiveHooks.length?(this.msgChain=this.msgChain.then(()=>Promise.all(this.receiveHooks.map(s=>s(o[0])))).then(()=>n(i,...o)).catch(s=>C.error(`Exception while handling messages: ${s}`)),!0):n(i,...o)}emit(n,...i){if(n==="unexpected-response"&&i.length===2){let o=i[1];C.error(`Error in websocket: (${o==null?void 0:o.statusCode}) ${o==null?void 0:o.statusMessage}, ${o==null?void 0:o.path}, Headers = ${JSON.stringify(o==null?void 0:o.headers)}`)}return n==="error"&&C.error("Error in websocket",i.length?i[0]:void 0),this.handleEvent((o,...s)=>super.emit(o,...s),n,...i)}addReceiveHook(n){this.receiveHooks.push(n)}removeReceiveHook(n){this.receiveHooks=this.receiveHooks.filter(i=>i!==n)}addSendHook(n){this.sendHooks.push(n)}removeSendHook(n){this.sendHooks=this.sendHooks.filter(i=>i!==n)}}}p();var Ko=new Map;var _S=class{getRequestCtor(e,t,n){class i extends Request{constructor(s,a){super(s,a);let l=this.headers;if(n){let u=n();Object.keys(u).forEach(f=>l.append(f,u[f].toString())),l.set("Content-Type","application/json");let d=l.append.bind(l);l.append=(f,m)=>{f.toLowerCase()!=="authorization"&&d(f,m)}}e&&this.headers.append("Cookie",e)}}return i}wrapWebSocketCtor(e){class t extends $j(e){constructor(o,s){super(o,s);this.timer=0;this.boundOpenHandler=this.openHandler.bind(this);let a,l=/.*\/kernels\/(.*)\/.*/.exec(o);l&&l.length>1&&(this.kernelId=l[1]),this.kernelId?(Ko.set(this.kernelId,this),this.onclose=()=>{a&&this.timer!==a&&clearInterval(a),Ko.get(this.kernelId)===this&&Ko.delete(this.kernelId)}):C.error("KernelId not extracted from Kernel WebSocket URL"),this.addEventListener&&this.addEventListener("open",this.boundOpenHandler)}openHandler(){let o=this.onmessage;this.onmessage=s=>{this.handleEvent((a,...l)=>{let u={data:l[0],type:a.toString(),target:this};return o(u),!0},"message",s.data)},this.removeEventListener("open",this.boundOpenHandler)}}return t}getWebsocketCtor(e,t,n){class i extends $j(are.default){constructor(a,l){super(a,l);this.timer=0;this.boundOpenHandler=this.openHandler.bind(this);let u,c=/.*\/kernels\/(.*)\/.*/.exec(a);c&&c.length>1&&(this.kernelId=c[1]),this.kernelId?(Ko.set(this.kernelId,this),this.onclose=()=>{u&&this.timer!==u&&clearInterval(u),Ko.get(this.kernelId)===this&&Ko.delete(this.kernelId)}):C.error("KernelId not extracted from Kernel WebSocket URL"),this.addEventListener("open",this.boundOpenHandler)}openHandler(){let a=this.onmessage;this.onmessage=l=>{this.handleEvent((u,...c)=>{let d={data:c[0],type:u.toString(),target:this};return a(d),!0},"message",l.data)},this.removeEventListener("open",this.boundOpenHandler)}}return i}getFetchMethod(){return fetch}getHeadersCtor(){return Headers}getRequestInit(){return{cache:"no-store"}}};_S=U([(0,sre.injectable)()],_S);p();var Ws=ae(he());p();var Us=require("vscode");p();var qSe=["/bin/sh","/bin/bash","/bin/zsh"];function lre(r,e){let t=(r.argv||[]).some(n=>(n=n.toLowerCase(),qSe.some(i=>n.includes(i))));ne("DATASCIENCE.KERNEL_SPEC_LANGUAGE",void 0,{language:r.language,kind:e,usesShell:t})}p();p();var ES="remoteKernelSpecCache.json";var JSe=2e3,TA=class extends ac{constructor(t,n,i,o,s,a,l,u,c,d){super();this.id=t;this.displayName=n;this.env=i;this.cachedRemoteKernelValidator=o;this.kernelProvider=a;this.serverProviderHandle=l;this.jupyterConnection=u;this.fs=c;this.context=d;this._status="idle";this._onDidChangeStatus=new Us.EventEmitter;this.onDidChangeStatus=this._onDidChangeStatus.event;this.promiseMonitor=new $b;this.kernelIdsToHide=new Set;this.kind="remote";this.cache=[];this._onDidChangeKernels=new Us.EventEmitter;this.onDidChangeKernels=this._onDidChangeKernels.event;this._onDidChange=new Us.EventEmitter;this.onDidChange=this._onDidChange.event;this.cacheFile=Us.Uri.joinPath(d.globalStorageUri,ES),this.cacheKey=Vt(l),this._register(s.registerKernelFinder(this)),this._register(this._onDidChangeKernels.event(()=>this._onDidChange.fire(),this)),this._register(this._onDidChangeKernels),this._register(this._onDidChange),this._register(this._onDidChangeStatus),this._register(this.promiseMonitor)}get status(){return this._status}set status(t){this._status!==t&&(this._status=t,this._onDidChangeStatus.fire())}get lastError(){return this._lastError}get kernels(){return this.cache}get items(){return this.kernels}get title(){return this.displayName}dispose(){var t,n;super.dispose(),(t=this._cacheUpdateCancelTokenSource)==null||t.dispose(),(n=this.kernelDisposeDelayTimer)==null||n.dispose()}async activate(){this.promiseMonitor.onStateChange(()=>{this.status=this.promiseMonitor.isComplete?"idle":"discovering"}),this.loadCache().then(E,E),this._register(this.kernelProvider.onDidStartKernel(t=>{Wt(t.kernelConnectionMetadata)&&this.updateCache().then(E,E)},this)),this._register(this.kernelProvider.onDidDisposeKernel(t=>{var n;if(t&&Wt(t.kernelConnectionMetadata)){(n=this.kernelDisposeDelayTimer)==null||n.dispose();let i=setTimeout(()=>{this.updateCache().then(E,E)},JSe);return this.kernelDisposeDelayTimer=new Us.Disposable(()=>clearTimeout(i)),i}},this))}async refresh(){await this.loadCache(!0,!0)}getListOfKernelsWithCachedConnection(t,n=!1){return(!this.cachedConnection||n)&&(this.cachedConnection=this.getRemoteConnectionInfo(t)),this.cachedConnection.then(i=>i?(this.cachedConnection=Promise.resolve(i),this.listKernelsFromConnection(i)):Promise.resolve([])).catch(i=>this.isDisposed?Promise.reject(i):n?(this.cachedConnection=void 0,Promise.reject(i)):this.getListOfKernelsWithCachedConnection(t,!0))}async loadCache(t=!1,n=!1){C.ci(`Remote Kernel Finder load cache Server: ${this.id}`);let i=(async()=>{let o=t?[]:await this.getFromCache(),s=[];if(!t&&Array.isArray(o)&&o.length>0)s=o,this.updateCache().then(E,E),this.loadCache(!0).then(E,E);else try{s=await this.getListOfKernelsWithCachedConnection(n),this._lastError=void 0}catch(a){a instanceof Us.CancellationError||(C.error("UniversalRemoteKernelFinder: Failed to get kernels without cache",a),this._lastError=a,this._onDidChange.fire())}await this.writeToCache(s)})();this.promiseMonitor.push(i),await i}async updateCache(){let t=(async()=>{var o;let n=[];(o=this._cacheUpdateCancelTokenSource)==null||o.dispose();let i=new Us.CancellationTokenSource;this._cacheUpdateCancelTokenSource=i;try{n=await this.getListOfKernelsWithCachedConnection(!1)}catch(s){C.warn(`Could not fetch kernels from the ${this.kind} server, falling back to cache: ${s}`),n=await this.getFromCache(i.token),n=n.filter(a=>a.kind==="connectToLiveRemoteKernel")}i.token.isCancellationRequested||await this.writeToCache(n)})();this.promiseMonitor.push(t),await t}async getRemoteConnectionInfo(t=!0){let n=[];return t&&n.push(Kt.createProgressReporter(void 0,W.connectingToJupyter)),this.jupyterConnection.createConnectionInfo(this.serverProviderHandle).finally(()=>Ce(n))}async getFromCache(t){try{if(t!=null&&t.isCancellationRequested)throw new Us.CancellationError;let n=this.cache;(!n||n.length===0)&&(n=await this.getCacheContents());let i=[],o=Promise.all(n.map(async s=>{await this.isValidCachedKernel(s)&&i.push(s)}));return await Ls(t,o),i}catch(n){C.error("UniversalRemoteKernelFinder: Failed to get from cache",n)}return[]}async getCacheContents(){try{let t=await this.fs.readFile(this.cacheFile),n=JSON.parse(t);if(n.extensionVersion!==this.env.extensionVersion)return[];let i=n.data[this.cacheKey]||[];return Array.isArray(i)?i.map(o=>tu.fromJSON(o)):[]}catch(t){return[]}}async listKernelsFromConnection(t){let n=[];try{let i=Gf.create(t.settings);n.push({dispose:()=>Lg(i)});let[o,s,a,l]=await Promise.all([i.getRunningKernels(),i.getKernelSpecs(),i.getRunningSessions(),HZ(t.serverProviderHandle)]),u=s.map(f=>(lre(f,"remote"),qx.create({kernelSpec:f,id:yR(f,void 0,l),baseUrl:t.baseUrl,serverProviderHandle:t.serverProviderHandle})));return[...a.map(f=>{var P,D;let m=f.kernel,g=m.last_activity?new Date(Date.parse(m.last_activity.toString())):new Date,b=m.connections?parseInt(m.connections.toString(),10):0,v=o.find(K=>{var L;return K.id===((L=f.kernel)==null?void 0:L.id)})||{},k=s.find(K=>{var L;return K.name===((L=f.kernel)==null?void 0:L.name)})||{};return Hx.create({kernelModel:{...f.kernel,...k,...v,name:((P=f.kernel)==null?void 0:P.name)||"",lastActivityTime:g,numberOfConnections:b,model:f},baseUrl:t.baseUrl,id:((D=f.kernel)==null?void 0:D.id)||"",serverProviderHandle:t.serverProviderHandle})}).filter(f=>!this.kernelIdsToHide.has(f.kernelModel.id||"")),...u]}catch(i){throw C.error(`Error fetching kernels from ${t.baseUrl} (${t.displayName}):`,i),i}finally{await Promise.all(n.map(i=>i.dispose().catch(E)))}}async writeToCache(t){try{C.trace(`UniversalRemoteKernelFinder: Writing ${t.length} remote kernel connection metadata to cache`);let n=this.cache,i=new Map(n.map(f=>[f.id,f])),o=new Map(t.map(f=>[f.id,f])),s=t.filter(f=>!i.has(f.id)),a=t.filter(f=>i.has(f.id)&&!_B(f,i.get(f.id))),l=n.filter(f=>!o.has(f.id)),u=this.cacheKey;this.cache=n.filter(f=>o.has(f.id)).concat(s),this.cache.forEach(f=>{let m=o.get(f.id);f!==m&&m.kind==="connectToLiveRemoteKernel"&&f.kind==="connectToLiveRemoteKernel"&&f.updateModel(m.kernelModel)});let c=t.map(f=>f.toJSON()),d={extensionVersion:this.env.extensionVersion,data:{}};try{let f=await this.fs.readFile(this.cacheFile),m=JSON.parse(f);m.extensionVersion===this.env.extensionVersion&&(d=m)}catch(f){}d.data[u]=c,await this.fs.createDirectory(this.context.globalStorageUri).then(()=>this.fs.writeFile(this.cacheFile,JSON.stringify(d))).catch(f=>{C.error("Failed to cache the remote kernels.",f)}),(s.length||a.length||l.length)&&this._onDidChangeKernels.fire({removed:l})}catch(n){C.error("UniversalRemoteKernelFinder: Failed to write to cache",n)}}async isValidCachedKernel(t){switch(t.kind){case"startUsingRemoteKernelSpec":return!1;case"connectToLiveRemoteKernel":return this.cachedRemoteKernelValidator.isValid(t)}}};var kA=require("vscode");var qd=class{constructor(e,t,n,i,o,s,a,l,u,c){this.serverUriStorage=e;this.env=t;this.cachedRemoteKernelValidator=n;this.kernelFinder=i;this.kernelProvider=o;this.jupyterConnection=s;this.disposables=a;this.fs=l;this.context=u;this.jupyterServerProviderRegistry=c;this.serverFinderMapping=new Map;this.handledProviders=new WeakSet;this.mappedProviders=new WeakSet;this.mappedServers=new Set}activate(){this.serverUriStorage.onDidAdd(e=>this.validateAndCreateFinder(e),this,this.disposables),this.serverUriStorage.onDidChange(this.buildListOfFinders,this,this.disposables),this.serverUriStorage.onDidLoad(this.handleProviderChanges,this,this.disposables),this.serverUriStorage.onDidLoad(this.buildListOfFinders,this,this.disposables),this.jupyterServerProviderRegistry.onDidChangeCollections(this.handleProviderHandleChanges,this,this.disposables),this.serverUriStorage.onDidRemove(this.urisRemoved,this,this.disposables),this.jupyterServerProviderRegistry.onDidChangeCollections(this.handleProviderChanges,this,this.disposables),this.buildListOfFinders(),this.handleProviderChanges().catch(E)}buildListOfFinders(){this.serverUriStorage.all.map(e=>this.validateAndCreateFinder(e).catch(E))}handleProviderHandleChanges(){this.jupyterServerProviderRegistry.jupyterCollections.forEach(e=>{this.handledProviders.has(e)||(this.handledProviders.add(e),e.serverProvider.onDidChangeServers&&e.serverProvider.onDidChangeServers(this.buildListOfFinders,this,this.disposables))}),this.buildListOfFinders()}async handleProviderChanges(){if(!this.serverUriStorage.all.length)return;let e=new kA.CancellationTokenSource;this.disposables.push(e),await Promise.all(this.jupyterServerProviderRegistry.jupyterCollections.map(t=>{let n=t.serverProvider;if(!(!n||this.mappedProviders.has(n)))return this.mappedProviders.add(n),n!=null&&n.onDidChangeServers&&(n==null||n.onDidChangeServers(()=>this.lookForServersInCollectionAndRemoveOldServers(t),this,this.disposables)),this.serverUriStorage.onDidLoad(()=>this.lookForServersInCollectionAndRemoveOldServers(t),this,this.disposables),this.lookForServersInCollectionAndRemoveOldServers(t).catch(E)})),e.dispose()}async lookForServersInCollectionAndRemoveOldServers(e){if(!this.serverUriStorage.all.length)return;let t=new Set(this.serverUriStorage.all.map(o=>Vt(o.provider))),n=e.serverProvider;if(!n)return;let i=new kA.CancellationTokenSource;try{let o=await Promise.resolve(n.provideJupyterServers(i.token)),s=new Set;(o||[]).forEach(a=>{let l={extensionId:e.extensionId,handle:a.id,id:e.id},u=Vt(l);s.add(u),xA(l,a.label),!(this.mappedServers.has(u)||!t.has(u))&&(this.mappedServers.add(u),this.createRemoteKernelFinder(l,a.label))}),this.serverFinderMapping.forEach((a,l)=>{a.serverProviderHandle.extensionId===e.extensionId&&a.serverProviderHandle.id===e.id&&!s.has(Vt(a.serverProviderHandle))&&(a.dispose(),this.serverFinderMapping.delete(l))})}catch(o){C.error(`Failed to get servers for Collection ${e.id} in ${e.extensionId}`,o)}finally{i.dispose()}}async validateAndCreateFinder(e){let t=Vt(e.provider);if(this.serverFinderMapping.has(t))return;let n=new kA.CancellationTokenSource,i=async()=>{var u;let s=this.jupyterServerProviderRegistry.jupyterCollections.find(c=>c.extensionId===e.provider.extensionId&&c.id===e.provider.id);if(!s||!s.serverProvider)return;let a=await Promise.resolve(s.serverProvider.provideJupyterServers(n.token)),l=(u=a==null?void 0:a.find(c=>c.id===e.provider.handle))==null?void 0:u.label;l&&this.createRemoteKernelFinder(e.provider,l)},o=async()=>{var a;let s=await((a=this.jupyterServerProviderRegistry.jupyterCollections.find(l=>l.extensionId===e.provider.extensionId&&l.extensionId===tc&&l.id===e.provider.id))==null?void 0:a.label);s&&this.createRemoteKernelFinder(e.provider,s)};await Promise.all([i().catch(E),o().catch(E)]),n.dispose()}getOrCreateRemoteKernelFinder(e,t){let n=Vt(e);if(!this.serverFinderMapping.has(n)){let i=new TA(`remote-${n}`,t,this.env,this.cachedRemoteKernelValidator,this.kernelFinder,this.kernelProvider,e,this.jupyterConnection,this.fs,this.context);this.disposables.push(i),this.serverFinderMapping.set(n,i),i.activate().then(E,E)}return this.serverFinderMapping.get(n)}createRemoteKernelFinder(e,t){this.getOrCreateRemoteKernelFinder(e,t)}urisRemoved(e){e.forEach(t=>{let n=Vt(t),i=this.serverFinderMapping.get(n);i&&i.dispose(),this.serverFinderMapping.delete(n)})}dispose(){this.serverFinderMapping.forEach(e=>e.dispose())}};U([yn("Handle Jupyter Provider Changes")],qd.prototype,"handleProviderChanges",1),U([yn("Check Servers in Jupyter Server Provider")],qd.prototype,"lookForServersInCollectionAndRemoveOldServers",1),U([yn("Failed to create a Remote Kernel Finder")],qd.prototype,"validateAndCreateFinder",1),qd=U([(0,Ws.injectable)(),x(0,(0,Ws.inject)(pr)),x(1,(0,Ws.inject)(RI)),x(2,(0,Ws.inject)(OR)),x(3,(0,Ws.inject)(ri)),x(4,(0,Ws.inject)(qe)),x(5,(0,Ws.inject)(hn)),x(6,(0,Ws.inject)(ve)),x(7,(0,Ws.inject)(Pt)),x(8,(0,Ws.inject)(st)),x(9,(0,Ws.inject)(sr))],qd);p();var sm=ae(he());p();var WA=require("vscode");var hu=ae(he());p();var NA=class extends ot{constructor(t){super("localjupyterserverconnection",W.jupyterNotebookFailure(t.message||t.toString()));this.originalError=t}};p();function cre(r){if(vn()){let e=r;if(e&&e._futures){let t=e._futures;t.forEach&&t.forEach(n=>{n._status!==void 0&&(n._status|=4)})}e&&e._reconnectLimit&&(e._reconnectLimit=0)}}var CS=class extends Ur{constructor(e){super(e.message,e)}};p();var hP=require("vscode");p();var Zg=class extends yi{constructor(e){super("invalidkernel",W.kernelInvalid(lt(e)),e)}};p();var RA=class extends yi{constructor(e){super("timeout",W.jupyterLaunchTimedOut,e)}};async function AA(r,e,t,n,i){var a;if(!t.kernel)throw new Zg(r);let o=Kt.reportProgress(e,W.waitingForJupyterSessionToBeIdle),s=[];o&&s.push(o);try{C.trace(`Waiting for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`);let l=Oe();i.onCancellationRequested(()=>l.reject(new hP.CancellationError),void 0,s);let u=(m,g)=>{C.trace(`Got status ${g} in waitForIdleOnSession`),g=="idle"&&l.resolve(g)};(a=t.kernel.statusChanged)==null||a.connect(u),s.push(new hP.Disposable(()=>zs(()=>{var m,g;return(g=(m=t.kernel)==null?void 0:m.statusChanged)==null?void 0:g.disconnect(u)}))),t.kernel.status=="idle"&&l.resolve(t.kernel.status);let c=Oe(),d=()=>c.resolve("");t.disposed.connect(d,c),s.push(new hP.Disposable(()=>zs(()=>t.disposed.disconnect(d,c)))),c.promise.catch(E),l.promise.catch(E);let f=await Ui(n,"",l.promise,c.promise);if(t.isDisposed)throw C.error("Session disposed while waiting for session to be idle."),new Zg(r);if(C.trace(`Finished waiting for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`),f=="idle")return;throw C.error(`Shutting down after failing to wait for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`),new RA(r)}catch(l){throw C.ci("Error waiting for idle",l),l}finally{Ce(s)}}p();var UA=require("vscode");p();p();p();var MA;(function(r){function e(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=B.length;if(y===0)return-1;O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1);var w;h<O?w=h+1+(y-O):w=h-O+1;for(var T=0;T<w;++T){var H=(O+T)%y;if(B[H]===N)return H}return-1}r.firstIndexOf=e;function t(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var y=B.length;if(y===0)return-1;O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1);var w;O<h?w=O+1+(y-h):w=O-h+1;for(var T=0;T<w;++T){var H=(O-T+y)%y;if(B[H]===N)return H}return-1}r.lastIndexOf=t;function n(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=B.length;if(y===0)return-1;O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1);var w;h<O?w=h+1+(y-O):w=h-O+1;for(var T=0;T<w;++T){var H=(O+T)%y;if(N(B[H],H))return H}return-1}r.findFirstIndex=n;function i(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var y=B.length;if(y===0)return-1;O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1);var w;O<h?w=O+1+(y-h):w=O-h+1;for(var T=0;T<w;++T){var H=(O-T+y)%y;if(N(B[H],H))return H}return-1}r.findLastIndex=i;function o(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=n(B,N,O,h);return y!==-1?B[y]:void 0}r.findFirstValue=o;function s(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var y=i(B,N,O,h);return y!==-1?B[y]:void 0}r.findLastValue=s;function a(B,N,O,h,y){h===void 0&&(h=0),y===void 0&&(y=-1);var w=B.length;if(w===0)return 0;h<0?h=Math.max(0,h+w):h=Math.min(h,w-1),y<0?y=Math.max(0,y+w):y=Math.min(y,w-1);for(var T=h,H=y-h+1;H>0;){var Y=H>>1,Z=T+Y;O(B[Z],N)<0?(T=Z+1,H-=Y+1):H=Y}return T}r.lowerBound=a;function l(B,N,O,h,y){h===void 0&&(h=0),y===void 0&&(y=-1);var w=B.length;if(w===0)return 0;h<0?h=Math.max(0,h+w):h=Math.min(h,w-1),y<0?y=Math.max(0,y+w):y=Math.min(y,w-1);for(var T=h,H=y-h+1;H>0;){var Y=H>>1,Z=T+Y;O(B[Z],N)>0?H=Y:(T=Z+1,H-=Y+1)}return T}r.upperBound=l;function u(B,N,O){if(B===N)return!0;if(B.length!==N.length)return!1;for(var h=0,y=B.length;h<y;++h)if(O?!O(B[h],N[h]):B[h]!==N[h])return!1;return!0}r.shallowEqual=u;function c(B,N){N===void 0&&(N={});var O=N.start,h=N.stop,y=N.step;if(y===void 0&&(y=1),y===0)throw new Error("Slice `step` cannot be zero.");var w=B.length;O===void 0?O=y<0?w-1:0:O<0?O=Math.max(O+w,y<0?-1:0):O>=w&&(O=y<0?w-1:w),h===void 0?h=y<0?-1:w:h<0?h=Math.max(h+w,y<0?-1:0):h>=w&&(h=y<0?w-1:w);var T;y<0&&h>=O||y>0&&O>=h?T=0:y<0?T=Math.floor((h-O+1)/y+1):T=Math.floor((h-O-1)/y+1);for(var H=[],Y=0;Y<T;++Y)H[Y]=B[O+Y*y];return H}r.slice=c;function d(B,N,O){var h=B.length;if(!(h<=1)&&(N<0?N=Math.max(0,N+h):N=Math.min(N,h-1),O<0?O=Math.max(0,O+h):O=Math.min(O,h-1),N!==O)){for(var y=B[N],w=N<O?1:-1,T=N;T!==O;T+=w)B[T]=B[T+w];B[O]=y}}r.move=d;function f(B,N,O){N===void 0&&(N=0),O===void 0&&(O=-1);var h=B.length;if(!(h<=1))for(N<0?N=Math.max(0,N+h):N=Math.min(N,h-1),O<0?O=Math.max(0,O+h):O=Math.min(O,h-1);N<O;){var y=B[N],w=B[O];B[N++]=w,B[O--]=y}}r.reverse=f;function m(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=B.length;if(!(y<=1)&&(O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1),!(O>=h))){var w=h-O+1;if(N>0?N=N%w:N<0&&(N=(N%w+w)%w),N!==0){var T=O+N;f(B,O,T-1),f(B,T,h),f(B,O,h)}}}r.rotate=m;function g(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=B.length;if(y!==0){O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1);var w;h<O?w=h+1+(y-O):w=h-O+1;for(var T=0;T<w;++T)B[(O+T)%y]=N}}r.fill=g;function b(B,N,O){var h=B.length;N<0?N=Math.max(0,N+h):N=Math.min(N,h);for(var y=h;y>N;--y)B[y]=B[y-1];B[N]=O}r.insert=b;function v(B,N){var O=B.length;if(N<0&&(N+=O),!(N<0||N>=O)){for(var h=B[N],y=N+1;y<O;++y)B[y-1]=B[y];return B.length=O-1,h}}r.removeAt=v;function k(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=e(B,N,O,h);return y!==-1&&v(B,y),y}r.removeFirstOf=k;function R(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var y=t(B,N,O,h);return y!==-1&&v(B,y),y}r.removeLastOf=R;function P(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=B.length;if(y===0)return 0;O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1);for(var w=0,T=0;T<y;++T)O<=h&&T>=O&&T<=h&&B[T]===N||h<O&&(T<=h||T>=O)&&B[T]===N?w++:w>0&&(B[T-w]=B[T]);return w>0&&(B.length=y-w),w}r.removeAllOf=P;function D(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y,w=n(B,N,O,h);return w!==-1&&(y=v(B,w)),{index:w,value:y}}r.removeFirstWhere=D;function K(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var y,w=i(B,N,O,h);return w!==-1&&(y=v(B,w)),{index:w,value:y}}r.removeLastWhere=K;function L(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var y=B.length;if(y===0)return 0;O<0?O=Math.max(0,O+y):O=Math.min(O,y-1),h<0?h=Math.max(0,h+y):h=Math.min(h,y-1);for(var w=0,T=0;T<y;++T)O<=h&&T>=O&&T<=h&&N(B[T],T)||h<O&&(T<=h||T>=O)&&N(B[T],T)?w++:w>0&&(B[T-w]=B[T]);return w>0&&(B.length=y-w),w}r.removeAllWhere=L})(MA||(MA={}));function dre(r){var e;return typeof r.iter=="function"?e=r.iter():e=new GSe(r),e}function OA(r,e){for(var t=0,n=dre(r),i;(i=n.next())!==void 0;)if(e(i,t++)===!1)return}var GSe=function(){function r(e){this._index=0,this._source=e}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._source.length))return this._source[this._index++]},r}(),Xct=function(){function r(e,t){t===void 0&&(t=Object.keys(e)),this._index=0,this._source=e,this._keys=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source,this._keys);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._keys.length)){var e=this._keys[this._index++];return e in this._source?e:this.next()}},r}(),Zct=function(){function r(e,t){t===void 0&&(t=Object.keys(e)),this._index=0,this._source=e,this._keys=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source,this._keys);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._keys.length)){var e=this._keys[this._index++];return e in this._source?this._source[e]:this.next()}},r}(),eut=function(){function r(e,t){t===void 0&&(t=Object.keys(e)),this._index=0,this._source=e,this._keys=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source,this._keys);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._keys.length)){var e=this._keys[this._index++];return e in this._source?[e,this._source[e]]:this.next()}},r}(),tut=function(){function r(e){this._fn=e}return r.prototype.iter=function(){return this},r.prototype.clone=function(){throw new Error("An `FnIterator` cannot be cloned.")},r.prototype.next=function(){return this._fn.call(void 0)},r}();var rut=function(){function r(e){this._cloned=!1,this._source=e,this._active=void 0}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source.clone());return e._active=this._active&&this._active.clone(),e._cloned=!0,this._cloned=!0,e},r.prototype.next=function(){if(this._active===void 0){var e=this._source.next();if(e===void 0)return;this._active=this._cloned?e.clone():e}var t=this._active.next();return t!==void 0?t:(this._active=void 0,this.next())},r}();var nut=function(){function r(){}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r},r.prototype.next=function(){},r}();var iut=function(){function r(e,t){this._source=e,this._index=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._source.clone(),this._index)},r.prototype.next=function(){var e=this._source.next();if(e!==void 0)return[this._index++,e]},r}();var out=function(){function r(e,t){this._index=0,this._source=e,this._fn=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source.clone(),this._fn);return e._index=this._index,e},r.prototype.next=function(){for(var e=this._fn,t=this._source,n;(n=t.next())!==void 0;)if(e(n,this._index++))return n},r}();function pre(r,e){for(var t=0,n=dre(r),i;(i=n.next())!==void 0;)if(e(i,t++))return i}var sut=function(){function r(e,t){this._index=0,this._source=e,this._fn=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source.clone(),this._fn);return e._index=this._index,e},r.prototype.next=function(){var e=this._source.next();if(e!==void 0)return this._fn.call(void 0,e,this._index++)},r}();var aut=function(){function r(e,t,n){this._index=0,this._start=e,this._stop=t,this._step=n,this._length=zj.rangeLength(e,t,n)}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._start,this._stop,this._step);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._length))return this._start+this._step*this._index++},r}(),zj;(function(r){function e(t,n,i){return i===0?1/0:t>n&&i>0||t<n&&i<0?0:Math.ceil((n-t)/i)}r.rangeLength=e})(zj||(zj={}));var lut=function(){function r(e,t){this._value=e,this._count=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._value,this._count)},r.prototype.next=function(){if(!(this._count<=0))return this._count--,this._value},r}();var cut=function(){function r(e){this._source=e,this._index=e.length-1}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index<0||this._index>=this._source.length))return this._source[this._index--]},r}();var uut=function(){function r(e,t){this._source=e,this._step=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._source.clone(),this._step)},r.prototype.next=function(){for(var e=this._source.next(),t=this._step-1;t>0;--t)this._source.next();return e},r}(),ure;(function(r){function e(s,a,l){l===void 0&&(l=0);for(var u=new Array(a.length),c=0,d=l,f=a.length;c<f;++c,++d){if(d=s.indexOf(a[c],d),d===-1)return null;u[c]=d}return u}r.findIndices=e;function t(s,a,l){l===void 0&&(l=0);var u=e(s,a,l);if(!u)return null;for(var c=0,d=0,f=u.length;d<f;++d){var m=u[d]-l;c+=m*m}return{score:c,indices:u}}r.matchSumOfSquares=t;function n(s,a,l){l===void 0&&(l=0);var u=e(s,a,l);if(!u)return null;for(var c=0,d=l-1,f=0,m=u.length;f<m;++f){var g=u[f];c+=g-d-1,d=g}return{score:c,indices:u}}r.matchSumOfDeltas=n;function i(s,a,l){for(var u=[],c=0,d=0,f=a.length;c<f;){for(var m=a[c],g=a[c];++c<f&&a[c]===g+1;)g++;d<m&&u.push(s.slice(d,m)),m<g+1&&u.push(l(s.slice(m,g+1))),d=g+1}return d<s.length&&u.push(s.slice(d)),u}r.highlight=i;function o(s,a){return s<a?-1:s>a?1:0}r.cmp=o})(ure||(ure={}));var dut=function(){function r(e,t){this._source=e,this._count=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._source.clone(),this._count)},r.prototype.next=function(){if(!(this._count<=0)){var e=this._source.next();if(e!==void 0)return this._count--,e}},r}();var put=function(){function r(e){this._source=e}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._source.map(function(e){return e.clone()}))},r.prototype.next=function(){for(var e=new Array(this._source.length),t=0,n=this._source.length;t<n;++t){var i=this._source[t].next();if(i===void 0)return;e[t]=i}return e},r}();p();var LA=function(){function r(e){this._pid=ev.nextPID(),this.name=e.name,this._create=e.create,this._coerce=e.coerce||null,this._compare=e.compare||null,this._changed=e.changed||null}return r.prototype.get=function(e){var t,n=ev.ensureMap(e);return this._pid in n?t=n[this._pid]:t=n[this._pid]=this._createValue(e),t},r.prototype.set=function(e,t){var n,i=ev.ensureMap(e);this._pid in i?n=i[this._pid]:n=i[this._pid]=this._createValue(e);var o=this._coerceValue(e,t);this._maybeNotify(e,n,i[this._pid]=o)},r.prototype.coerce=function(e){var t,n=ev.ensureMap(e);this._pid in n?t=n[this._pid]:t=n[this._pid]=this._createValue(e);var i=this._coerceValue(e,t);this._maybeNotify(e,t,n[this._pid]=i)},r.prototype._createValue=function(e){var t=this._create;return t(e)},r.prototype._coerceValue=function(e,t){var n=this._coerce;return n?n(e,t):t},r.prototype._compareValue=function(e,t){var n=this._compare;return n?n(e,t):e===t},r.prototype._maybeNotify=function(e,t,n){var i=this._changed;i&&!this._compareValue(t,n)&&i(e,t,n)},r}();(function(r){function e(t){ev.ownerData.delete(t)}r.clearData=e})(LA||(LA={}));var ev;(function(r){r.ownerData=new WeakMap,r.nextPID=function(){var t=0;return function(){var n=Math.random(),i=(""+n).slice(2);return"pid-"+i+"-"+t++}}();function e(t){var n=r.ownerData.get(t);return n||(n=Object.create(null),r.ownerData.set(t,n),n)}r.ensureMap=e})(ev||(ev={}));var Vs=function(){function r(e){this._blockedCount=0,this.sender=e}return r.prototype.block=function(e){this._blockedCount++;try{e()}finally{this._blockedCount--}},r.prototype.connect=function(e,t){return ms.connect(this,e,t)},r.prototype.disconnect=function(e,t){return ms.disconnect(this,e,t)},r.prototype.emit=function(e){this._blockedCount||ms.emit(this,e)},r}();(function(r){function e(u,c){var d=ms.blockedProperty;d.set(u,d.get(u)+1);try{c()}finally{d.set(u,d.get(u)-1)}}r.blockAll=e;function t(u,c){ms.disconnectBetween(u,c)}r.disconnectBetween=t;function n(u){ms.disconnectSender(u)}r.disconnectSender=n;function i(u){ms.disconnectReceiver(u)}r.disconnectReceiver=i;function o(u){ms.disconnectAll(u)}r.disconnectAll=o;function s(u){ms.disconnectAll(u)}r.clearData=s;function a(){return ms.exceptionHandler}r.getExceptionHandler=a;function l(u){var c=ms.exceptionHandler;return ms.exceptionHandler=u,c}r.setExceptionHandler=l})(Vs||(Vs={}));var ms;(function(r){r.exceptionHandler=function(R){console.error(R)};function e(R,P,D){D=D||void 0;var K=l.get(R.sender);if(K||(K=[],l.set(R.sender,K)),f(K,R,P,D))return!1;var L=D||P,B=u.get(L);B||(B=[],u.set(L,B));var N={signal:R,slot:P,thisArg:D};return K.push(N),B.push(N),!0}r.connect=e;function t(R,P,D){D=D||void 0;var K=l.get(R.sender);if(!K||K.length===0)return!1;var L=f(K,R,P,D);if(!L)return!1;var B=D||P,N=u.get(B);return L.signal=null,g(K),g(N),!0}r.disconnect=t;function n(R,P){var D=l.get(R);if(!(!D||D.length===0)){var K=u.get(P);!K||K.length===0||(OA(K,function(L){L.signal&&L.signal.sender===R&&(L.signal=null)}),g(D),g(K))}}r.disconnectBetween=n;function i(R){var P=l.get(R);!P||P.length===0||(OA(P,function(D){if(D.signal){var K=D.thisArg||D.slot;D.signal=null,g(u.get(K))}}),g(P))}r.disconnectSender=i;function o(R){var P=u.get(R);!P||P.length===0||(OA(P,function(D){if(D.signal){var K=D.signal.sender;D.signal=null,g(l.get(K))}}),g(P))}r.disconnectReceiver=o;function s(R){i(R),o(R)}r.disconnectAll=s;function a(R,P){if(!(r.blockedProperty.get(R.sender)>0)){var D=l.get(R.sender);if(!(!D||D.length===0))for(var K=0,L=D.length;K<L;++K){var B=D[K];B.signal===R&&m(B,P)}}}r.emit=a;var l=new WeakMap,u=new WeakMap,c=new Set,d=function(){var R=typeof requestAnimationFrame=="function";return R?requestAnimationFrame:setImmediate}();function f(R,P,D,K){return pre(R,function(L){return L.signal===P&&L.slot===D&&L.thisArg===K})}function m(R,P){var D=R.signal,K=R.slot,L=R.thisArg;try{K.call(L,D.sender,P)}catch(B){r.exceptionHandler(B)}}function g(R){c.size===0&&d(b),c.add(R)}function b(){c.forEach(v),c.clear()}function v(R){MA.removeAllWhere(R,k)}function k(R){return R.signal===null}r.blockedProperty=new LA({name:"blocked",create:function(){return 0}})})(ms||(ms={}));var Qj=require("vscode");var KA=class extends ac{constructor(t,n){super();this.kind=t;this.session=n;this.propertyChanged=new Vs(this);this.kernelChanged=new Vs(this);this.statusChanged=new Vs(this);this.connectionStatusChanged=new Vs(this);this.iopubMessage=new Vs(this);this.unhandledMessage=new Vs(this);this.anyMessage=new Vs(this);this.pendingInput=new Vs(this);this.disposed=new Vs(this);this.didShutdown=this._register(new Qj.EventEmitter);this._onDidKernelSocketChange=this._register(new Qj.EventEmitter);n.propertyChanged.connect(this.onPropertyChanged,this),n.kernelChanged.connect(this.onKernelChanged,this),n.statusChanged.connect(this.onStatusChanged,this),n.connectionStatusChanged.connect(this.onConnectionStatusChanged,this),n.iopubMessage.connect(this.onIOPubMessage,this),n.unhandledMessage.connect(this.onUnhandledMessage,this),n.pendingInput.connect(this.onPendingInput,this),n.anyMessage.connect(this.onAnyMessage,this),this._register({dispose:()=>{this.session.propertyChanged.disconnect(this.onPropertyChanged,this),this.session.kernelChanged.disconnect(this.onKernelChanged,this),this.session.statusChanged.disconnect(this.onStatusChanged,this),this.session.connectionStatusChanged.disconnect(this.onConnectionStatusChanged,this),this.session.iopubMessage.disconnect(this.onIOPubMessage,this),this.session.unhandledMessage.disconnect(this.onUnhandledMessage,this),this.session.pendingInput.disconnect(this.onPendingInput,this),this.session.anyMessage.disconnect(this.onAnyMessage,this)}})}get id(){return this.session.id}get path(){return this.session.path}get name(){return this.session.name}get type(){return this.session.type}get serverSettings(){return this.session.serverSettings}get model(){return this.session.model}get kernel(){return this.isDisposed||!this.session.kernel?null:this.session.kernel}get onDidShutdown(){return this.didShutdown.event}get kernelId(){var t,n;return((n=(t=this.session)==null?void 0:t.kernel)==null?void 0:n.id)||""}get onDidKernelSocketChange(){return this._onDidKernelSocketChange.event}dispose(){this.isDisposed||(super.dispose(),this.statusChanged.emit("dead"),this.disposed.emit(),Vs.disconnectAll(this))}async restart(){var t,n,i;await((t=this.session.kernel)==null?void 0:t.restart()),this.initializeKernelSocket(),C.info(`Restarted ${(i=(n=this.session)==null?void 0:n.kernel)==null?void 0:i.id}`)}initializeKernelSocket(){var n,i,o,s,a,l;if(!this.session.kernel)throw new Error("Kernel not initialized in Session");let t={kernel:this.session.kernel,options:{clientId:this.session.kernel.clientId,id:this.session.kernel.id,model:{...this.session.kernel.model},userName:this.session.kernel.username},socket:Ko.get(this.session.kernel.id)};JSON.stringify((n=this.previousKernelSocketInformation)==null?void 0:n.kernel.model)===JSON.stringify(t.kernel.model)&&((i=this.previousKernelSocketInformation)==null?void 0:i.kernel)===t.kernel&&((o=this.previousKernelSocketInformation)==null?void 0:o.kernel.id)===t.kernel.id&&((s=this.previousKernelSocketInformation)==null?void 0:s.socket)===t.socket||(this.previousKernelSocketInformation=t,(a=this.session.kernel)==null||a.connectionStatusChanged.disconnect(this.onKernelConnectionStatusHandler,this),(l=this.session.kernel)==null||l.connectionStatusChanged.connect(this.onKernelConnectionStatusHandler,this),this._onDidKernelSocketChange.fire())}onPropertyChanged(t,n){this.propertyChanged.emit(n)}onKernelChanged(t,n){this.kernelChanged.emit(n)}onStatusChanged(t,n){this.statusChanged.emit(n);let i=this.status;C.ci(`Server Status = ${i}`)}onConnectionStatusChanged(t,n){this.connectionStatusChanged.emit(n)}onIOPubMessage(t,n){this.iopubMessage.emit(n)}onUnhandledMessage(t,n){C.warn(`Unhandled message found: ${n.header.msg_type}`),this.unhandledMessage.emit(n)}onAnyMessage(t,n){this.anyMessage.emit(n)}onPendingInput(t,n){this.pendingInput.emit(n)}setPath(t){return this.session.setPath(t)}setName(t){return this.session.setName(t)}setType(t){return this.session.setType(t)}changeKernel(t){return this.session.changeKernel(t)}onKernelConnectionStatusHandler(t,n){C.ci(`Server Kernel Status = ${n}`)}};var FA=class extends KA{constructor(t,n,i,o,s){super(jt(i)?"localJupyter":"remoteJupyter",t);this.resource=n;this.kernelConnectionMetadata=i;this.kernelService=o;this.creator=s;this.isShuttingDown=!1;this.initializeKernelSocket()}get status(){var t,n;return this.isDisposed?"dead":(t=this.session)!=null&&t.kernel?this.session.kernel.status:(C.ci(`Kernel status not started because real session is ${this.session?"defined":"undefined"} & real kernel is ${(n=this.session)!=null&&n.kernel?"defined":"undefined"}`),"unknown")}dispose(){var t,n;(t=this.restartToken)==null||t.cancel(),(n=this.restartToken)==null||n.dispose(),this.shutdownImplementation(!1).finally(()=>super.dispose())}async waitForIdle(t,n){try{await AA(this.kernelConnectionMetadata,this.resource,this.session,t,n)}catch(i){throw C.ci("Error waiting for idle",i),await this.shutdown().catch(E),i}}async restart(){let t=[],n=new UA.CancellationTokenSource;this.restartToken=n;let i=new fr(!1);t.push(i),t.push(n);try{await this.validateLocalKernelDependencies(n.token,i),await super.restart()}finally{Ce(t)}}async validateLocalKernelDependencies(t,n){var i;if(!(!((i=this.kernelConnectionMetadata)!=null&&i.interpreter)||!jt(this.kernelConnectionMetadata)||!this.kernelService)){if(t.isCancellationRequested)throw new UA.CancellationError;await this.kernelService.ensureKernelIsUsable(this.resource,this.kernelConnectionMetadata,n,t,this.creator==="3rdPartyExtension")}}async shutdown(){var t,n;return(t=this.restartToken)==null||t.cancel(),(n=this.restartToken)==null||n.dispose(),this.shutdownImplementation(!0)}async shutdownImplementation(t){var o;if(this.isDisposed||this.isShuttingDown)return;this.isShuttingDown=!0;let n=(new Error().stack||"").split(`
`).filter(s=>s.includes(Ge));C.trace(`Shutdown session - current session, called from 
 ${n.map(s=>`    ${s}`).join(`
`)}`);let i=`${(o=this.session.kernel)==null?void 0:o.id}, ${this.kernelConnectionMetadata.id}`;C.debug(`shutdownSession ${i} - start`);try{if(t||this.canShutdownSession())try{C.debug(`Session can be shutdown ${this.kernelConnectionMetadata.id}`),cre(this.session.kernel),this.session.isDisposed||await Ui(1e3,this.session.shutdown().catch(E))}catch(s){try{this.session.isDisposed||this.session.dispose()}catch(a){C.warn("Failures in disposing the session",a)}}finally{this.didShutdown.fire()}else C.debug(`Session cannot be shutdown ${this.kernelConnectionMetadata.id}`);try{this.session.isDisposed||this.session.dispose()}catch(s){C.warn("Failures in disposing the session",s)}super.dispose(),C.trace("Shutdown session -- complete")}catch(s){C.warn("Failures in disposing the session",s)}C.debug(`shutdownSession ${i} - shutdown complete`)}canShutdownSession(){return jt(this.kernelConnectionMetadata)?!0:this.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"?!1:this.resource&&Al(this.resource)==="interactive"?!0:!(this.resource&&Al(this.resource)==="notebook"&&Wt(this.kernelConnectionMetadata))}};p();var Oi=function(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let r=new Uint8Array(16),e=[];for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return function(){crypto.getRandomValues(r),r[6]=r[6]&15|64,r[8]=r[8]&63|128;let n=0,i="";return i+=e[r[n++]],i+=e[r[n++]],i+=e[r[n++]],i+=e[r[n++]],i+="-",i+=e[r[n++]],i+=e[r[n++]],i+="-",i+=e[r[n++]],i+=e[r[n++]],i+="-",i+=e[r[n++]],i+=e[r[n++]],i+="-",i+=e[r[n++]],i+=e[r[n++]],i+=e[r[n++]],i+=e[r[n++]],i+=e[r[n++]],i+=e[r[n++]],i}}();var Jd=class{constructor(e,t,n,i,o){this.jupyterNotebookProvider=e;this.jupyterConnection=t;this.asyncDisposables=n;this.kernelService=i;this.configService=o}async create(e){let t=[],n,i=()=>{e.ui.disableUI||n||(n=Kt.createProgressReporter(e.resource,Wt(e.kernelConnection)?W.connectingToJupyter:W.startingJupyter),t.push(n))};e.ui.disableUI&&e.ui.onDidChangeDisableUI(i,this,t),i();let o,s=[],a=this.configService.getSettings(e.resource).jupyterLaunchTimeout;try{o=Wt(e.kernelConnection)?await ps(e.token,this.jupyterConnection.createConnectionInfo(e.kernelConnection.serverProviderHandle)):await this.jupyterNotebookProvider.getOrStartServer({resource:e.resource,token:e.token,ui:e.ui}),await ps(e.token,this.validateLocalKernelDependencies(e));let l=Gf.create(o.settings);this.asyncDisposables.push({dispose:()=>Lg(l)}),s.push(l),await ps(e.token,this.validateRemoteServer(e,l));let u=await this.connectToOrCreateSession({...e,contentsManager:l.contentsManager,sessionManager:l.sessionManager,kernelManager:l.kernelManager,kernelSpecManager:l.kernelSpecManager,idleTimeout:a,connection:o});e.token.isCancellationRequested&&(await u.shutdown().catch(E),zs(()=>u.dispose())),Kd.throwIfCanceled(e.token),C.info(`Started session for kernel ${e.kernelConnection.kind}:${e.kernelConnection.id}`);let c=new FA(u,e.resource,e.kernelConnection,this.kernelService,e.creator),d=u.disposed,f=()=>{l.dispose(),d.disconnect(f)};this.asyncDisposables.push({dispose:()=>c.shutdown().finally(()=>c.dispose())}),u.disposed.connect(f);let m=c.onDidDispose(f);return this.asyncDisposables.push(m),c}catch(l){throw Ce(s),Wt(e.kernelConnection)?o?Mi.isSelfCertsError(l)?new Mi(`${o.baseUrl}, ${l.message}`):nu.isSelfCertsExpiredError(l)?new nu(o.baseUrl):new ao(o.baseUrl,e.kernelConnection.serverProviderHandle,l):l:l instanceof ot?l:new NA(l)}finally{Ce(t)}}async validateRemoteServer(e,t){if(t.isDisposed)throw new Qr;if(!jt(e.kernelConnection))try{await Promise.all([t.getRunningKernels(),t.getKernelSpecs()])}catch(n){throw C.error("Failed to fetch running kernels from remote server, connection may be outdated or remote server may be unreachable",n),new ao(e.kernelConnection.baseUrl,e.kernelConnection.serverProviderHandle,n)}}async validateLocalKernelDependencies(e){var t;if(e.token.isCancellationRequested)throw new WA.CancellationError;(t=e.kernelConnection)!=null&&t.interpreter&&jt(e.kernelConnection)&&this.kernelService&&await this.kernelService.ensureKernelIsUsable(e.resource,e.kernelConnection,e.ui,e.token,e.creator==="3rdPartyExtension")}async connectToOrCreateSession(e){var n;if(e.token.isCancellationRequested)throw new WA.CancellationError;let t;try{if(e.kernelConnection&&e.kernelConnection.kind==="connectToLiveRemoteKernel"&&e.kernelConnection.kernelModel.id&&e.kernelConnection.kernelModel.model){if(!e.kernelConnection.kernelModel.model)throw new Error("Kernel model not defined when connecting to an existing session");t=e.sessionManager.connectTo({...e.kernelConnection.kernelModel,model:e.kernelConnection.kernelModel.model}),await ps(e.token,gD(async()=>{var i;return((i=t.kernel)==null?void 0:i.connectionStatus)==="connected"||e.token.isCancellationRequested},e.idleTimeout,100))}else C.trace(`createNewKernelSession ${(n=e.kernelConnection)==null?void 0:n.id}`),t=await this.createNewSession(e),await AA(e.kernelConnection,e.resource,t,e.idleTimeout,e.token).catch(E);if(e.token.isCancellationRequested)throw new WA.CancellationError;return t}catch(i){let o=e.ui.disableUI?C.debug:C.error;throw i instanceof ot?(o("Failed to change kernel, re-throwing",i),i):(o("Failed to change kernel",i),new Zg(e.kernelConnection))}}async createNewSession(e){var a,l,u,c,d,f;let t=(e.connection,e.resource,void 0),n=t==null?void 0:t.path,i=(c=(u=QZ(e.kernelConnection))!=null?u:(l=(a=e.kernelSpecManager)==null?void 0:a.specs)==null?void 0:l.default)!=null?c:"",o;if(t!=null&&t.name)o=t.name;else{let m=e.resource?Xv(e.resource):"";o=`${e.resource?di(e.resource,m):""}-${Oi()}${m}`}let s={path:n||zSe(e.resource),kernel:{name:i},name:o,type:(((d=e.resource)==null?void 0:d.path)||"").toLowerCase().endsWith(".ipynb")?"notebook":"console"};try{let m=await ps(e.token,e.sessionManager.startNew(s,{kernelConnectionOptions:{handleComms:!0}}));if(!m.kernel)throw new CS(new Error("No kernel created"));return C.info(W.createdNewKernel(e.connection.baseUrl,((f=m==null?void 0:m.kernel)==null?void 0:f.id)||"")),m}catch(m){throw m instanceof CS?m:new CS(m)}}};Jd=U([(0,hu.injectable)(),x(0,(0,hu.inject)(RR)),x(1,(0,hu.inject)(hn)),x(2,(0,hu.inject)(Vu)),x(3,(0,hu.inject)(AR)),x(3,(0,hu.optional)()),x(4,(0,hu.inject)(Ke))],Jd);function $Se(){return`${jf}${Oi()}`}function zSe(r){let e=`${$Se()}${Oi()}.ipynb`;return r?`${di(r,".ipynb")}${e}`:`${W.defaultNotebookName}${e}`}var wS=class{constructor(e,t,n){this.rawKernelSupported=e;this.newRawKernelSessionFactory=t;this.newJupyterSessionFactory=n}async create(e){let t=e.kernelConnection;return this.rawKernelSupported.isSupported&&jt(t)&&this.newRawKernelSessionFactory?this.newRawKernelSessionFactory.create({...e,kernelConnection:t}):this.newJupyterSessionFactory.create(e)}};wS=U([(0,sm.injectable)(),x(0,(0,sm.inject)(Hd)),x(1,(0,sm.inject)(Jte)),x(1,(0,sm.optional)()),x(2,(0,sm.inject)(Jd))],wS);p();var gP=Symbol("RemoteKernelFinderController");function fre(r,e){r.addSingleton(Kl,Kl),r.addSingleton(AR,Qg),r.addSingleton(pr,bS),r.addSingleton(Gx,wS),r.addSingleton(Jd,Jd),r.addSingleton(RR,yS),r.addSingleton(Jg,_S),r.addSingleton(hn,hn),r.addSingleton(Gg,IS),r.addBinding(Gg,Ve),r.addSingleton(OR,vS),r.addSingleton(mn,gS),r.addSingleton(gP,qd),r.addBinding(gP,Ve),r.addSingleton(sr,NI)}var Tre=ae(he());p();var gn=ae(he());p();var Li=require("vscode");var VA=class{constructor(e,t){this.asyncDisposables=e;this.disposables=t;this.executions=new WeakMap;this.kernelsByNotebook=new WeakMap;this.kernelsById=new Map;this.pendingDisposables=new Set;this._onDidRestartKernel=new Li.EventEmitter;this._onDidStartKernel=new Li.EventEmitter;this._onDidCreateKernel=new Li.EventEmitter;this._onDidDisposeKernel=new Li.EventEmitter;this._onKernelStatusChanged=new Li.EventEmitter;this._onDidPostInitializeKernel=new Rg;this.onKernelStatusChanged=this._onKernelStatusChanged.event;this.asyncDisposables.push(this),Li.workspace.onDidCloseNotebookDocument(n=>this.disposeOldKernel(n,"notebookClosed"),this,t),t.push(this._onDidDisposeKernel),t.push(this._onDidRestartKernel),t.push(this._onKernelStatusChanged),t.push(this._onDidStartKernel),t.push(this._onDidCreateKernel),t.push(this._onDidPostInitializeKernel)}get kernels(){let e=new Set;return Li.workspace.notebookDocuments.forEach(t=>{let n=this.get(t);n&&e.add(n)}),Array.from(e)}get onDidDisposeKernel(){return this._onDidDisposeKernel.event}get onDidRestartKernel(){return this._onDidRestartKernel.event}get onDidStartKernel(){return this._onDidStartKernel.event}get onDidCreateKernel(){return this._onDidCreateKernel.event}get onDidPostInitializeKernel(){return this._onDidPostInitializeKernel.event}get(e){var t,n;if(ci(e)){let i=Li.workspace.notebookDocuments.find(o=>o.uri.toString()===e.toString());return i?this.get(i):void 0}else return typeof e=="string"?(t=this.kernelsById.get(e))==null?void 0:t.kernel:(n=this.kernelsByNotebook.get(e))==null?void 0:n.kernel}getKernelExecution(e){return this.executions.get(e)}getInternal(e){return this.kernelsByNotebook.get(e)}async dispose(){C.ci("Disposing all kernels from kernel provider");let e=Array.from(this.pendingDisposables.values());this.pendingDisposables.clear(),await Promise.all(e),await Promise.all(this.kernels.map(t=>t.dispose()))}storeKernel(e,t,n){this.kernelsByNotebook.set(e,{options:t,kernel:n}),this.kernelsById.set(n.id,{options:t,kernel:n}),this._onDidCreateKernel.fire(n)}deleteMappingIfKernelIsDisposed(e){e.onDisposed(()=>{this.get(e.notebook)===e&&(this.kernelsByNotebook.delete(e.notebook),this.kernelsById.delete(e.id),C.debug(`Kernel got disposed, hence there is no longer a kernel associated with ${Ee(e.uri)}`)),this.pendingDisposables.delete(e)},this,this.disposables)}disposeOldKernel(e,t){let n=this.kernelsByNotebook.get(e);n&&(C.debug(`Disposing kernel associated with ${Ee(e.uri)}, isClosed=${e.isClosed}, reason = ${t}`),this.kernelsById.delete(n.kernel.id),this.pendingDisposables.add(n.kernel),n.kernel.dispose().catch(i=>C.warn("Failed to dispose old kernel",i)).finally(()=>this.pendingDisposables.delete(n.kernel)).catch(E)),this.kernelsByNotebook.delete(e)}handleServerRemoval(e){Li.workspace.notebookDocuments.forEach(t=>{let n=this.kernelsByNotebook.get(t);if(n){let i=n.options.metadata;(i.kind==="connectToLiveRemoteKernel"||i.kind==="startUsingRemoteKernelSpec")&&e.find(s=>s.id===i.serverProviderHandle.id&&s.handle===i.serverProviderHandle.handle)&&(this.kernelsByNotebook.delete(t),this.kernelsById.delete(n.kernel.id))}})}},jA=class{constructor(e,t){this.asyncDisposables=e;this.disposables=t;this.kernelsByUri=new Map;this.kernelsById=new Map;this.pendingDisposables=new Set;this._onDidRestartKernel=new Li.EventEmitter;this._onDidStartKernel=new Li.EventEmitter;this._onDidCreateKernel=new Li.EventEmitter;this._onDidDisposeKernel=new Li.EventEmitter;this._onDidPostInitializeKernel=new Rg;this._onKernelStatusChanged=new Li.EventEmitter;this.onKernelStatusChanged=this._onKernelStatusChanged.event;this.asyncDisposables.push(this),Li.workspace.onDidCloseNotebookDocument(n=>{C.debug(`Notebook document ${Ee(n.uri)} got closed`),this.disposeOldKernel(n.uri)},this,t),t.push(this._onDidDisposeKernel),t.push(this._onDidRestartKernel),t.push(this._onKernelStatusChanged),t.push(this._onDidStartKernel),t.push(this._onDidCreateKernel),t.push(this._onDidPostInitializeKernel)}get kernels(){return Array.from(this.kernelsByUri.values()).map(e=>e.kernel)}get onDidDisposeKernel(){return this._onDidDisposeKernel.event}get onDidRestartKernel(){return this._onDidRestartKernel.event}get onDidStartKernel(){return this._onDidStartKernel.event}get onDidCreateKernel(){return this._onDidCreateKernel.event}get onDidPostInitializeKernel(){return this._onDidPostInitializeKernel.event}get(e){var t,n;return((t=this.kernelsByUri.get(e.toString()))==null?void 0:t.kernel)||((n=this.kernelsById.get(e.toString()))==null?void 0:n.kernel)}getInternal(e){return this.kernelsByUri.get(e.toString())}async dispose(){C.ci("Disposing all kernels from kernel provider");let e=Array.from(this.pendingDisposables.values());this.pendingDisposables.clear(),await Promise.all(e),await Promise.all(this.kernels.map(t=>t.dispose()))}storeKernel(e,t,n){this.kernelsByUri.set(e.toString(),{options:t,kernel:n}),this.kernelsById.set(n.id,{options:t,kernel:n}),this._onDidCreateKernel.fire(n)}deleteMappingIfKernelIsDisposed(e,t){t.onDisposed(()=>{this.get(e)===t&&(this.kernelsByUri.delete(e.toString()),this.kernelsById.delete(t.id),C.debug(`Kernel got disposed, hence there is no longer a kernel associated with ${Ee(e)}`)),this.pendingDisposables.delete(t)},this,this.disposables)}disposeOldKernel(e){let t=this.kernelsByUri.get(e.toString());t&&(C.ci(`Disposing kernel associated with ${Ee(e)}`),this.kernelsById.delete(t.kernel.id),this.pendingDisposables.add(t.kernel),t.kernel.dispose().catch(n=>C.warn("Failed to dispose old kernel",n)).finally(()=>this.pendingDisposables.delete(t.kernel)).catch(E)),this.kernelsByUri.delete(e.toString())}};p();var Lr=require("vscode");var vre=ae(uA());p();var Xj="KERNEL_INFO",QSe=1e3*60*60*24*2;async function hre(r,e,t){var a;let n=[],i={banner:"",help_links:[],implementation:"",implementation_version:"",language_info:{name:"",version:""},protocol_version:"",status:"ok"};if(!r.kernel)return;(a=r.kernel)!=null&&a.info&&(n.push(r.kernel.info),r.kernel.info.then(l=>mre(t,e,l)).catch(E));let o=r.kernel.requestKernelInfo().then(l=>l==null?void 0:l.content);if(n.push(o),o.then(l=>mre(t,e,l)).catch(E),e.kind==="connectToLiveRemoteKernel"){let l=XSe(t,e);l?n.push(Promise.resolve(l)):n.push(nc(5e3).then(()=>i))}let s=await Promise.race(n);return s===i?C.warn("Failed to Kernel info in a timely manner, defaulting to empty info!"):C.trace("Got Kernel info"),s}async function mre(r,e,t){if(!t||!Wt(e))return;let n=r.get(Xj,[]).filter(i=>Date.now()-i.age<QSe).filter(i=>i.id!==e.id);n.push({id:e.id,age:Date.now(),info:t}),await r.update(Xj,n)}function XSe(r,e){var t;if(Wt(e))return(t=r.get(Xj,[]).find(n=>n.id===e.id))==null?void 0:t.info}p();var BA=class extends yi{constructor(e){super("kernelpromisetimeout",W.interruptingKernelFailed,e)}};p();function gre(r){return`r"${r}"`}var HA="e976ee50-99ed-4aba-9b6b-9dcd5634d07d:IPyWidgets:";function vP(r){let e=typeof r=="string"?r:"";return typeof r!="string"&&"content"in r&&"code"in r.content&&typeof r.content.code=="string"&&(e=r.content.code),!e.includes(HA)}function YA(r){var e,t,n,i;return r.status==="dead"||r.status==="terminating"&&!r.disposed&&!r.disposing||!r.disposed&&!r.disposing&&(((e=r.session)==null?void 0:e.status)=="unknown"||((n=(t=r.session)==null?void 0:t.kernel)==null?void 0:n.status)=="unknown")&&(((i=r.session.kernel)==null?void 0:i.isDisposed)||r.session.isDisposed)}function yre(r){var e,t;return r.status==="dead"||r.status==="terminating"&&!r.isDisposed||!r.isDisposed&&(r.status=="unknown"||((e=r.kernel)==null?void 0:e.status)=="unknown")&&(((t=r.kernel)==null?void 0:t.isDisposed)||r.isDisposed)}var qA=class{constructor(e,t,n,i,o,s,a,l,u,c,d){this.id=e;this.uri=t;this.resourceUri=n;this.kernelConnectionMetadata=i;this.sessionCreator=o;this.kernelSettings=s;this.startupCodeProviders=a;this._creator=l;this.workspaceMemento=u;this.kernelWorkingDirectory=c;this.rawKernelSupported=d;this.disposables=[];this._onIPyWidgetVersionResolved=new Lr.EventEmitter;this._onDidKernelSocketChange=new Lr.EventEmitter;this._onStatusChanged=new Lr.EventEmitter;this._onRestarted=new Lr.EventEmitter;this._onStarted=new Lr.EventEmitter;this._onPostInitialized=new Rg;this._onDisposed=new Lr.EventEmitter;this.hookedSessionForEvents=new WeakSet;this.hooks=new Map;this.startCancellation=new Lr.CancellationTokenSource;this.startupUI=new fr(!0);this.disposables.push(this._onStatusChanged),this.disposables.push(this._onRestarted),this.disposables.push(this._onStarted),this.disposables.push(this._onDisposed),this.disposables.push(this._onIPyWidgetVersionResolved),this.disposables.push(this._onDidKernelSocketChange),eP(this.resourceUri,{kernelConnection:this.kernelConnectionMetadata,actionSource:this.creator,disableUI:this.startupUI.disableUI}).catch(E),this.startupUI.onDidChangeDisableUI(()=>{this.startupUI.disableUI||eP(this.resourceUri,{disableUI:!1}).catch(E)},this.disposables)}get ipywidgetsVersion(){return this._ipywidgetsVersion}get onIPyWidgetVersionResolved(){return this._onIPyWidgetVersionResolved.event}get onStatusChanged(){return this._onStatusChanged.event}get onRestarted(){return this._onRestarted.event}get onStarted(){return this._onStarted.event}get onPostInitialized(){return this._onPostInitialized.event}get onDisposed(){return this._onDisposed.event}get creator(){return this._creator}get startedAtLeastOnce(){return this._startedAtLeastOnce}get userStartedKernel(){return!this.startupUI.disableUI}get info(){return this._info}get status(){var e,t;return this._jupyterSessionPromise&&!this._session?"starting":(t=(e=this._session)==null?void 0:e.status)!=null?t:this.isKernelDead?"dead":"unknown"}get disposed(){var e;return this._disposed===!0||((e=this._session)==null?void 0:e.isDisposed)===!0}get disposing(){return this._disposing===!0}get onDidKernelSocketChange(){return this._onDidKernelSocketChange.event}get session(){return this._session}get isPostInitializedInProgress(){return this._isPostInitializedInProgress===!0}get restarting(){return this._restartPromise||Promise.resolve()}addHook(e,t,n,i){let o=this.hooks.get(e)||new Set;this.hooks.set(e,o),t=n?t.bind(n):t,o.add(t);let s={dispose:()=>{o.delete(t)}};return i&&i.push(s),s}async start(e){this.startCancellation.token.isCancellationRequested&&(this.startCancellation.dispose(),this.startCancellation=new Lr.CancellationTokenSource);let t=await this.startJupyterSession(e);return e!=null&&e.ignoreTriggeringOnPostInitialized||await this.triggerOnDidStartKernel((e==null?void 0:e.disableUI)===!0,!1),t}async interrupt(){let e=Promise.all(Array.from(this.hooks.get("willInterrupt")||new Set).map(n=>n()));C.info(`Interrupt requested ${Ee(this.resourceUri||this.uri)}`);let t;try{let n=this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0;C.info("Interrupt kernel execution"),n?(t=this._interruptPromise?await this._interruptPromise:await(this._interruptPromise=this.interruptExecution(n,e)),this._interruptPromise=void 0):(C.info("No kernel session to interrupt"),this._interruptPromise=void 0,t="success")}finally{await Promise.all(Array.from(this.hooks.get("interruptCompleted")||new Set).map(n=>n())).catch(E)}if(C.info(`Interrupt requested & sent for ${Ee(this.uri)} in notebookEditor.`),t==="timeout"){let n=W.restartKernelAfterInterruptMessage(lt(this.kernelConnectionMetadata)),i=W.restartKernelMessageYes;await Lr.window.showInformationMessage(n,{modal:!0},i)===i&&await this.restart()}}async dispose(){if(C.info(`Dispose Kernel '${Ee(this.uri)}' associated with '${Ee(this.resourceUri)}'`),this._disposing=!0,this.disposingPromise)return this.disposingPromise;this._ignoreJupyterSessionDisposedErrors=!0,this.startCancellation.cancel();let e=async()=>{let t=[];t.push(Promise.all(Array.from(this.hooks.get("willCancel")||new Set).map(n=>n())).then(E).catch(E)),this._session=this._session?this._session:this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0,this._jupyterSessionPromise=void 0,this._postInitializedOnStartPromise=void 0,this._session&&(t.push(Lg(this._session,this.disposables)),this._session=void 0),this._disposed=!0,this._onDisposed.fire(),this._onStatusChanged.fire("dead");try{await Promise.all(t)}finally{this.startCancellation.dispose(),Ce(this.disposables)}};this.disposingPromise=e(),await this.disposingPromise}async restart(){try{let e=Al(this.resourceUri);C.info(`Restart requested ${Ee(this.uri)}`),await Promise.all(Array.from(this.hooks.get("willRestart")||new Set).map(n=>n(this._jupyterSessionPromise))),this.startCancellation.cancel(),this.startCancellation.dispose();let t=new bt;try{let n=this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0;n?(this._restartPromise||(this._restartPromise=n.restart(),this._restartPromise.finally(()=>this._restartPromise=void 0).catch(E)),await this._restartPromise,this.startCancellation=new Lr.CancellationTokenSource):await this.start(new fr(!1)),Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_RESTART",{duration:t.elapsedTime},{resourceType:e})}catch(n){C.error(`Restart failed ${Ee(this.uri)}`,n),this._ignoreJupyterSessionDisposedErrors=!0;let i=this._session;throw this._session=void 0,this._jupyterSessionPromise=void 0,this._postInitializedOnStartPromise=void 0,Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_RESTART",{duration:t.elapsedTime},void 0,n),i&&await Lg(i,this.disposables),this._ignoreJupyterSessionDisposedErrors=!1,n}await this.initializeAfterStart(this._session),this._onRestarted.fire(),await this.triggerOnDidStartKernel(!1,!0)}catch(e){throw C.error(`Failed to restart kernel ${Ee(this.uri)}`,e),e}finally{Promise.all(Array.from(this.hooks.get("restartCompleted")||new Set).map(e=>e())).catch(E)}}async startJupyterSession(e=new fr(!1)){if(this._startedAtLeastOnce=!0,e.disableUI||(this.startupUI.disableUI=!1),e.onDidChangeDisableUI(()=>{!e.disableUI&&this.startupUI.disableUI&&(this.startupUI.disableUI=!1)},this.disposables),this.startupUI.disableUI&&this.startupUI.onDidChangeDisableUI(()=>{this.disposing||this.disposed||this.startupUI.disableUI||Ll(this.resourceUri,this.kernelConnectionMetadata).catch(E)},this,this.disposables),this.disposing)throw new Lr.CancellationError;if(Kd.throwIfCanceled(this.startCancellation.token),!this._jupyterSessionPromise){let t=new bt;this._jupyterSessionPromise=this.createJupyterSession();try{let n=await this._jupyterSessionPromise;return Rr(this.resourceUri,"DS_INTERNAL.PERCEIVED_JUPYTER_STARTUP_NOTEBOOK",{duration:t.elapsedTime}),n}catch(n){throw C.ci(`Failed to create Jupyter Session in Kernel.startNotebook for ${Ee(this.uri)}`),this.startCancellation.cancel(),this._jupyterSessionPromise=void 0,n}}return this._jupyterSessionPromise}async triggerOnDidStartKernel(e,t=!1){e||((!this._postInitializedOnStartPromise||t)&&(this._isPostInitializedInProgress=!0,this._postInitializedOnStartPromise=this._onPostInitialized.fireAsync({},this.startCancellation.token),this._postInitializedOnStartPromise.finally(()=>this._isPostInitializedInProgress=!1)),await this._postInitializedOnStartPromise)}async interruptExecution(e,t){let n=Oe(),i=new bt,o=[],s=u=>{(u==="restarting"||u==="autorestarting")&&(C.warn("Kernel restarting during interrupt"),n.resolve(!0))},a=(u,c)=>s(c);return e.statusChanged.connect(a),o.push(new Lr.Disposable(()=>zs(()=>e.statusChanged.disconnect(a)))),e&&e.kernel&&(C.info(`Interrupting kernel: ${e.kernel.name}`),await Jv(this.kernelSettings.interruptTimeout,new BA(this.kernelConnectionMetadata),e.kernel.interrupt()).catch(u=>{C.warn(`Error during interrupt: ${u}`),n.resolve(!0)})),(async()=>{let u=Oe();this.status==="busy"&&(this.onDisposed(()=>u.resolve("dead"),this,o),this.onStatusChanged(()=>this.status==="dead"?u.resolve("dead"):void 0,this,o));try{return await Ui(this.kernelSettings.interruptTimeout,"timeout",t.then(()=>"success"),n.promise.then(()=>"restart"),u.promise)}catch(c){if(n.completed)return"restart";throw Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_INTERRUPT",{duration:i.elapsedTime},void 0,c),c}finally{Ce(o)}})().then(u=>(Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_INTERRUPT",{duration:i.elapsedTime},{result:u}),u))}async createJupyterSession(){var i;let e=Lr.workspace.notebookDocuments.find(o=>o.uri.toString()===this.uri.toString()),t=e?(i=Bc(e))==null?void 0:i.jupyterSessionTelemetry():void 0;if(await eP(this.resourceUri,{kernelConnection:this.kernelConnectionMetadata,actionSource:this.creator,userExecutedCell:!this.startupUI.disableUI}),t==null||t.stop(),this.disposing)throw new Lr.CancellationError;Kd.throwIfCanceled(this.startCancellation.token);let n=[];try{C.info(`Starting Kernel ${e_e(this,this.startupUI)}`),this.createProgressIndicator(n),this.isKernelDead=!1,this._onStatusChanged.fire("starting");let o=await this.sessionCreator.create({resource:this.resourceUri,ui:this.startupUI,kernelConnection:this.kernelConnectionMetadata,token:this.startCancellation.token,creator:this.creator});if(this.disposing)throw new Lr.CancellationError;if(Kd.throwIfCanceled(this.startCancellation.token),await this.initializeAfterStart(o),this.disposing)throw new Lr.CancellationError;return this.sendKernelStartedTelemetry(),this._session=o,this._onStarted.fire(),C.info("Kernel successfully started"),o}catch(o){if(this.startupUI.disableUI?C.trace(`failed to create IJupyterKernelConnectionSession in kernel, UI Disabled = ${this.startupUI.disableUI}`,o):!this.startCancellation.token&&!qn(o)&&C.error(`failed to create IJupyterKernelConnectionSession in kernel, UI Disabled = ${this.startupUI.disableUI}`,o),Kd.throwIfCanceled(this.startCancellation.token),o instanceof Rp)throw o;let s=W.sessionStartFailedWithKernel(lt(this.kernelConnectionMetadata));throw Ur.from(s+" "+("message"in o?o.message:o.toString()),o)}finally{Ce(n)}}sendKernelStartedTelemetry(){this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent&&this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent===this.startupUI.disableUI||this.startTelemetrySent&&!this.startupUI.disableUI||(this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent=this.startupUI.disableUI===!0,this.startTelemetrySent=!0,Rr(this.resourceUri,"DATASCIENCE.NOTEBOOK_START",void 0,{disableUI:this.startupUI.disableUI}))}createProgressIndicator(e){let t=Kt.createProgressReporter(this.resourceUri,W.connectingToKernel(lt(this.kernelConnectionMetadata)),this.startupUI.disableUI);e.push(t),this.startupUI.disableUI&&this.startupUI.onDidChangeDisableUI(()=>{this.disposing||this.disposed||this.startupUI.disableUI||t.show&&t.show()},this,e)}async initializeAfterStart(e){var o;let t=Lr.workspace.notebookDocuments.find(s=>s.uri.toString()===this.uri.toString()),n=Bc(t),i=t?n==null?void 0:n.postKernelStartup():void 0;try{if(await Promise.all(Array.from(this.hooks.get("didStart")||new Set).map(l=>l(e,this.startCancellation.token).catch(E))),C.trace(`Started running kernel initialization for ${Ee(this.uri)}`),!e){C.trace("Not running kernel initialization");return}if(!this.hookedSessionForEvents.has(e)){this.hookedSessionForEvents.add(e),e.onDidKernelSocketChange(u=>this._onDidKernelSocketChange.fire(u)),e.onDidDispose(()=>{if(C.ci(`Kernel got disposed as a result of session.onDisposed (1) ${Ee(this.resourceUri||this.uri)}`),!this._ignoreJupyterSessionDisposedErrors){C.info(`Kernel got disposed as a result of session.onDisposed ${Ee(this.resourceUri||this.uri)} & _ignoreJupyterSessionDisposedErrors = false.`);let u=this._session===e;this._jupyterSessionPromise=void 0,this._postInitializedOnStartPromise=void 0,this._session=void 0,u&&(this.isKernelDead=!0,this._onStatusChanged.fire("dead"))}});let l=(u,c)=>this._onStatusChanged.fire(c);e.statusChanged.connect(l),this.disposables.push(new Lr.Disposable(()=>zs(()=>e.statusChanged.disconnect(l))))}if((o=e.kernel)==null||o.registerCommTarget(nt.DefaultCommTarget,E),this.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel")this.determineVersionOfIPyWidgets(e).catch(l=>C.error("Failed to determine IPyWidget version",l)),this.gatherInternalStartupCode().then(l=>this.executeSilently(e,l,{traceErrors:!0,traceErrorsMessage:"Error executing jupyter extension internal startup code"})).catch(l=>C.error("Failed to execute internal startup code",l));else{await this.determineVersionOfIPyWidgets(e);let l=await this.gatherInternalStartupCode();await this.executeSilently(e,l,{traceErrors:!0,traceErrorsMessage:"Error executing jupyter extension internal startup code"}),await this.executeSilently(e,this.getUserStartupCommands(),{traceErrors:!1})}i==null||i.stop();let s=n==null?void 0:n.kernelInfo();try{C.debug("Requesting Kernel info"),this._info=await hre(e,this.kernelConnectionMetadata,this.workspaceMemento)}catch(l){C.warn("Failed to request KernelInfo",l)}s==null||s.stop();let a=n==null?void 0:n.kernelIdle();this.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&(C.trace("End running kernel initialization, now waiting for idle"),await e.waitForIdle(this.kernelSettings.launchTimeout,this.startCancellation.token),C.trace("End running kernel initialization, session is idle")),a==null||a.stop()}finally{i==null||i.stop()}}async determineVersionOfIPyWidgets(e){var n;if(!Qt(this.kernelConnectionMetadata)){this._ipywidgetsVersion=UE,this._onIPyWidgetVersionResolved.fire(UE);return}let t=async()=>{let i=vre.default`
        try:
            import ipywidgets as _VSCODE_ipywidgets
            print("${HA}" + _VSCODE_ipywidgets.__version__)
            del _VSCODE_ipywidgets
        except:
            pass
        `,o=await this.executeSilently(e,[i]).catch(s=>C.error("Failed to determine version of IPyWidgets",s));if(Array.isArray(o)){let s=o.some(u=>{var c;return(c=u.text||"")==null?void 0:c.toString().includes(`${HA}8.`)}),a=o.some(u=>{var c;return(c=u.text||"")==null?void 0:c.toString().includes(`${HA}7.`)}),l=this._ipywidgetsVersion=a?7:s?8:void 0;C.trace(`Determined IPyWidgets Version as ${l}`),this._ipywidgetsVersion=l,this._onIPyWidgetVersionResolved.fire(l)}else C.warn("Failed to determine IPyWidgets Version",JSON.stringify(o))};if(await t(),!this._ipywidgetsVersion&&((n=this.session)!=null&&n.kernel)){let i=(o,s)=>{var l;if(s.direction==="send")return;let a=s.msg;a.content&&"data"in a.content&&a.content.data&&(a.content.data[mo]||"target_name"in a.content&&a.content.target_name===nt.DefaultCommTarget)&&(this._ipywidgetsVersion||(t().catch(E),(l=this.session)!=null&&l.kernel&&this.session.kernel.anyMessage.disconnect(i,this)))};this.session.kernel.anyMessage.connect(i,this)}}async gatherInternalStartupCode(){var n;let e=[],t=await Promise.all(this.startupCodeProviders.sort((i,o)=>o.priority-i.priority).map(i=>i.getCode(this)));for(let i of t)e.push(...i);if(Qt(this.kernelConnectionMetadata)&&this.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"){let i=ut(this.resourceUri);if(i&&e.push(`__vsc_ipynb_file__ = "${i.replace(/\\/g,"\\\\")}"`),this.kernelSettings.enableExtendedPythonKernelCompletions||e.push(OE.DisableJedi),e.push(...ZSe(this.getMatplotLibInitializeCode(),"Failed to initialize matplotlib startup code. Matplotlib might be missing.")),jt(this.kernelConnectionMetadata)&&((n=this.rawKernelSupported)==null?void 0:n.isSupported)===!1&&this.kernelWorkingDirectory){let o=await this.kernelWorkingDirectory.computeWorkingDirectory(this.kernelConnectionMetadata,this.resourceUri,this.startCancellation.token),a=`
import os as _VSCODE_os
try:
    _VSCODE_os.chdir(${gre(o.fsPath)})
except:
    pass

del _VSCODE_os
`;e.push(a)}}return e}getMatplotLibInitializeCode(){let e=[];if(this.kernelSettings.themeMatplotlibPlots){C.ci(`Initialize config for plots for ${Ee(this.resourceUri||this.uri)}`);let t=OE.MatplotLibInit;C.trace(`Initialize matplotlib for ${Ee(this.resourceUri||this.uri)}`),e.push(...ct(t,{trim:!1}));let n=Lr.window.activeColorTheme.kind===Lr.ColorThemeKind.Dark;e.push(n?"matplotlib.style.use('dark_background')":`matplotlib.rcParams.update(${nt.MatplotLibDefaultParams})`)}return e}getUserStartupCommands(){let e=this.kernelSettings.runStartupCommands;if(Array.isArray(e)&&(e=e.join(`
`)),e){let t=e.replace(/\\n/g,`
`);return ct(t,{trim:!1})}return[]}async executeSilently(e,t,n){if(t.join("").trim().length!==0){if(!e.kernel){C.trace(`Not executing startup as there is no session, code: ${t}`);return}return Ai(e.kernel,t.join(`
`),n)}}},JA=class extends qA{get creator(){return"3rdPartyExtension"}constructor(e,t,n,i,o,s,a,l,u){super(`3rdPartyKernel_${Oi()}`,e,t,n,i,o,s,"3rdPartyExtension",a,l,u)}},GA=class extends qA{constructor(t,n,i,o,s,a,l,u,c,d){super(Oi(),n.uri,t,i,o,s,l,"jupyterExtension",u,c,d);this.notebook=n;this.controller=a}get creator(){return"jupyterExtension"}};function ZSe(r,e){return!r||r.length===0||(r=r.map(t=>`    ${t}`),r.unshift("try:"),r.push("except:",`    print('${e}')`)),r}function e_e(r,e){let t=r.kernelConnectionMetadata.interpreter,n=[];if(t){n.push(`Python Path: ${Ee(t.uri)}`),n.push(t?br(t):"");let i=Cc(t);i&&n.push(`${i.major}.${i.minor}.${i.micro}`)}else(r.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||r.kernelConnectionMetadata.kind==="startUsingRemoteKernelSpec")&&n.push(r.kernelConnectionMetadata.kernelSpec.display_name);return`(${n.filter(i=>i).join(", ")}) for '${Ee(r.uri)}' (disableUI=${e.disableUI})`}p();function Zj(r,e){return{get enableExtendedPythonKernelCompletions(){return r.getSettings(e).enableExtendedPythonKernelCompletions},get interruptTimeout(){return r.getSettings(e).jupyterInterruptTimeout},get launchTimeout(){return r.getSettings(e).jupyterLaunchTimeout},get runStartupCommands(){return r.getSettings(e).runStartupCommands},get themeMatplotlibPlots(){return r.getSettings(e).themeMatplotlibPlots}}}p();var tv=require("vscode");p();var t9=require("vscode");p();var e9=ae(nj()),Ir=require("vscode");p();var $A=ae(he()),bre=require("vscode");var on=class{static dispose(){Ce(on.disposables)}constructor(e){e.push({dispose:()=>{on.dispose()}})}activate(){bre.workspace.onDidChangeNotebookDocument(e=>{gr(e.notebook)&&e.cellChanges.filter(t=>{var n;return((n=t.outputs)==null?void 0:n.length)===0}).map(t=>{var i;let n=on.cellToDisplayIdMapping.get(t.cell);n&&(on.cellToDisplayIdMapping.delete(t.cell),(i=on.displayIdCellOutputMappingPerDocument.get(e.notebook))==null||i.delete(n))})})}static trackOutputByDisplayId(e,t,n,i){let o=on.displayIdCellOutputMappingPerDocument.get(e.notebook);o||(o=new Map,on.displayIdCellOutputMappingPerDocument.set(e.notebook,o)),o.set(t,{outputContainer:n,cell:e,outputItems:i}),on.cellToDisplayIdMapping.set(e,t)}static getMappedOutput(e,t){let n=on.displayIdCellOutputMappingPerDocument.get(e);if(!n)return;let i=n.get(t);return i!=null&&i.cell.document.isClosed?void 0:i}};on.displayIdCellOutputMappingPerDocument=new WeakMap,on.cellToDisplayIdMapping=new WeakMap,on.disposables=[],on=U([(0,$A.injectable)(),x(0,(0,$A.inject)(ve))],on);var zA=ae(GN());var xS=new WeakMap;function Gd(r){if(r.parent_header&&"msg_id"in r.parent_header)return r.parent_header.msg_id}var gu=class gu{constructor(e,t,n,i,o,s,a,l){this.cell=e;this.controller=t;this.context=n;this.formatters=i;this.kernel=o;this.request=s;this._onErrorHandlingIOPubMessage=new Ir.EventEmitter;this.onErrorHandlingExecuteRequestIOPubMessage=this._onErrorHandlingIOPubMessage.event;this.outputsAreSpecificToAWidget=[];this.commIdsMappedToParentWidgetModel=new Map;this.disposables=[];this.prompts=new Set;this.ownedCommIds=new Set;this.commIdsMappedToWidgetOutputModels=new Set;this.ownedRequestMsgIds=new Set;this._completed=Oe();this.gotIdleIOPubStatus=!1;this.gotShellReply=!1;this.streamsReAttachedToExecutingCell=!1;this._completed.promise.catch(E),this.executeRequestMessageId=l,this.ownedRequestMsgIds.add(l),Ir.workspace.onDidChangeNotebookDocument(u=>{var d;if(!gr(u.notebook))return;let c=u.cellChanges.find(({cell:f})=>f===this.cell);c&&((d=c.outputs)==null?void 0:d.length)===0&&(this.clearLastUsedStreamOutput(),this.cellHasErrorsInOutput=!1)},this,this.disposables),this.execution=a,this.kernel.anyMessage.connect(this.onKernelAnyMessage,this),this.kernel.iopubMessage.connect(this.onKernelIOPubMessage,this),s&&(s.onIOPub=()=>{this.cell.document.isClosed&&!this.completedExecution&&s.dispose()},s.onReply=u=>{if(this.cell.document.isClosed){s.dispose();return}this.handleReply(u)},s.onStdin=this.handleInputRequest.bind(this),s.done.finally(()=>{this.completedExecution=!0,this.endCellExecution()}).catch(E))}get hasErrorOutput(){return this.cellHasErrorsInOutput===!0}get completed(){return this._completed.promise}dispose(){this.disposed||(this.disposed=!0,it(this.cell,"Execution Message Handler disposed"),Ce(this.disposables),this.prompts.forEach(e=>e.dispose()),this.prompts.clear(),this.request&&this.clearLastUsedStreamOutput(),this.execution=void 0,this.kernel.anyMessage.disconnect(this.onKernelAnyMessage,this),this.kernel.iopubMessage.disconnect(this.onKernelIOPubMessage,this),this._onErrorHandlingIOPubMessage.dispose())}endCellExecution(){this.prompts.forEach(e=>e.dispose()),this.prompts.clear(),this.request&&this.clearLastUsedStreamOutput(),this.execution=void 0,this._completed.resolve()}onKernelAnyMessage(e,{direction:t,msg:n}){if(this.cell.document.isClosed)return this.endCellExecution();let i=Bn();if(!this.request&&t==="recv"){let o=Gd(n);i.KernelMessage.isStatusMsg(n)&&n.content.execution_state==="idle"&&o===this.executeRequestMessageId&&(this.gotIdleIOPubStatus=!0),n.channel==="shell"&&o===this.executeRequestMessageId&&(this.gotShellReply=!0);let s=i.KernelMessage.isStatusMsg(n)&&n.content.execution_state!=="idle"&&o!==this.executeRequestMessageId;typeof n.parent_header=="object"&&n.parent_header&&"msg_type"in n.parent_header&&n.parent_header.msg_type;let a=o?o!==this.executeRequestMessageId&&!s:!1,l=typeof n.parent_header=="object"&&n.parent_header&&"msg_type"in n.parent_header&&n.parent_header.msg_type==="interrupt_request",u=this.gotIdleIOPubStatus&&this.gotShellReply,c=["kernel_info_reply","execute_input","execute_reply"],d="msg_type"in n&&typeof n.msg_type=="string"&&c.includes(n.msg_type);if(!this.completedExecution&&u)return this.completedExecution=!0,this.endAbnormallyTimeout&&clearTimeout(this.endAbnormallyTimeout),this.endCellExecution();if(!this.completedExecution&&(d||a)){this.endAbnormallyTimeout&&clearTimeout(this.endAbnormallyTimeout),this.endAbnormallyTimeout=setTimeout(()=>(this.completedExecution=!0,this.endAbnormallyTimeout=void 0,this.endCellExecution()),l?1e3:100),this.disposables.push(new Ir.Disposable(()=>{clearTimeout(this.endAbnormallyTimeout),this.endAbnormallyTimeout=void 0}));return}}t!=="send"||!this.completedExecution||i.KernelMessage.isCommMsgMsg(n)&&this.ownedCommIds.has(n.content.comm_id)&&this.ownedRequestMsgIds.add(n.header.msg_id)}onKernelIOPubMessage(e,t){if(this.cell.document.isClosed)return this.endCellExecution();if(!(!t.parent_header||!("msg_id"in t.parent_header)||!this.ownedRequestMsgIds.has(t.parent_header.msg_id)||t.channel!=="iopub"))try{this.handleIOPub(t)}catch(n){C.error("Failed to handle iopub message as a result of some comm message",t,n),!this.completedExecution&&!this.cell.document.isClosed&&this._onErrorHandlingIOPubMessage.fire(n)}}clearLastUsedStreamOutput(){this.lastUsedStreamOutput=void 0}createTemporaryTask(e){var n,i;if(this.cell.document.isClosed)return;let t=xS.get(this.cell.notebook);return t&&(!e||e&&t.cell.index===this.cell.index)?t:(this.previousResultsToRestore={...this.cell.executionSummary||{}},this.temporaryExecution=so.getOrCreate(this.cell,this.controller),(n=this.temporaryExecution)==null||n.start(),(i=this.previousResultsToRestore)!=null&&i.executionOrder&&this.temporaryExecution&&(this.temporaryExecution.executionOrder=this.previousResultsToRestore.executionOrder),this.temporaryExecution)}endTemporaryTask(){var e,t,n;(e=this.previousResultsToRestore)!=null&&e.executionOrder&&this.execution&&(this.execution.executionOrder=this.previousResultsToRestore.executionOrder),this.previousResultsToRestore&&this.temporaryExecution?(this.previousResultsToRestore.executionOrder&&(this.temporaryExecution.executionOrder=this.previousResultsToRestore.executionOrder),this.temporaryExecution.end(this.previousResultsToRestore.success,(t=this.previousResultsToRestore.timing)==null?void 0:t.endTime)):(n=this.temporaryExecution)==null||n.end(void 0),this.previousResultsToRestore=void 0,this.temporaryExecution=void 0}handleIOPub(e){var n;this.startTime||(this.startTime=new Date().getTime(),(n=this.execution)==null||n.start(this.startTime),C.debug(`Kernel acknowledged execution of cell ${this.cell.index} @ ${this.startTime}`));let t=Bn();if(t.KernelMessage.isCommOpenMsg(e))this.handleCommOpen(e);else if(t.KernelMessage.isExecuteResultMsg(e))this.handleExecuteResult(e);else if(t.KernelMessage.isExecuteInputMsg(e))this.handleExecuteInput(e);else if(t.KernelMessage.isStatusMsg(e)){let i=e;this.handleStatusMessage(i)}else t.KernelMessage.isStreamMsg(e)?this.handleStreamMessage(e):t.KernelMessage.isDisplayDataMsg(e)?this.handleDisplayData(e):t.KernelMessage.isUpdateDisplayDataMsg(e)?this.handleUpdateDisplayDataMessage(e):t.KernelMessage.isClearOutputMsg(e)?this.handleClearOutput(e):t.KernelMessage.isErrorMsg(e)?this.handleError(e):t.KernelMessage.isCommOpenMsg(e)||(t.KernelMessage.isCommMsgMsg(e)?this.handleCommMsg(e):t.KernelMessage.isCommCloseMsg(e)||C.warn(`Unknown message ${e.header.msg_type} : hasData=${"data"in e.content}`));"execution_count"in e.content&&typeof e.content.execution_count=="number"&&this.execution&&(this.execution.executionOrder=e.content.execution_count)}handleCommOpen(e){var n;this.ownedCommIds.add(e.content.comm_id);let t=((n=e.content.data)==null?void 0:n.state)||void 0;e.content.target_name===nt.DefaultCommTarget&&t&&t._model_module==="@jupyter-widgets/output"&&this.commIdsMappedToWidgetOutputModels.add(e.content.comm_id)}handleCommMsg(e){let t=e.content.data;if(!(!t||t.method!=="update"||typeof t.state!="object")){if("msg_id"in t.state&&typeof t.state.msg_id=="string"){let n="msg_id"in e.parent_header?e.parent_header:void 0;(this.ownedRequestMsgIds.has(e.content.comm_id)||n&&this.ownedRequestMsgIds.has(n.msg_id))&&(t.state.msg_id?this.outputsAreSpecificToAWidget.push({handlingCommId:e.content.comm_id,msgIdsToSwallow:t.state.msg_id}):this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId===e.content.comm_id&&this.outputsAreSpecificToAWidget.pop())}else if("children"in t.state&&Array.isArray(t.state.children)&&this.ownedCommIds.has(e.content.comm_id)){let n="IPY_MODEL_";t.state.children.forEach(i=>{if(typeof i!="string")return C.warn("Came across a comm update message a child that isn't a string",i);if(!i.startsWith(n))return C.warn(`Came across a comm update message a child that start start with ${n}`,i);let o=i.substring(n.length);this.ownedCommIds.add(o),this.commIdsMappedToParentWidgetModel.set(o,e.content.comm_id)})}}}clearOutputIfNecessary(e){return this.clearOutputOnNextUpdateToOutput?(it(this.cell,"Clear cell output"),this.clearLastUsedStreamOutput(),e==null||e.clearOutput().then(E,E),this.clearOutputOnNextUpdateToOutput=!1,{previousValueOfClearOutputOnNextUpdateToOutput:!0}):{previousValueOfClearOutputOnNextUpdateToOutput:!1}}addToCellData(e,t){var l,u;if(e.data&&typeof e.data=="object"&&mo in e.data){let c=e.data[mo];if(c&&this.context.extensionMode===Ir.ExtensionMode.Test&&(c._vsc_test_cellIndex=this.cell.index),c&&"model_id"in c){let d=gu.modelIdsOwnedByCells.get(this.cell)||new Set;d.add(c.model_id),gu.modelIdsOwnedByCells.set(this.cell,d)}}let n=us(e),i="transient"in e&&typeof e.transient=="object"&&e.transient&&"display_id"in e.transient&&typeof((l=e.transient)==null?void 0:l.display_id)=="string"?(u=e.transient)==null?void 0:u.display_id:void 0;if(this.cell.document.isClosed)return;it(this.cell,()=>`Update output with mimes ${n.items.map(c=>c.mime).toString()}`);let o=this.getOrCreateExecutionTask(!0);this.clearOutputIfNecessary(o),i&&on.trackOutputByDisplayId(this.cell,i,n,n.items),this.clearLastUsedStreamOutput(),it(this.cell,"Append output in addToCellData");let s=!0,a=Gd(t);if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===a&&n.items.every(c=>this.canMimeTypeBeRenderedByWidgetManager(c)))s=!1;else if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===a){let c=this.updateJupyterOutputWidgetWithOutput({commId:this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId,outputToAppend:n},o);c!=null&&c.outputAdded&&(s=!1)}s&&(o==null||o.appendOutput([n]).then(E,E)),this.endTemporaryTask()}canMimeTypeBeRenderedByWidgetManager(e){let t=e.mime;if(t=="application/vnd.code.notebook.stderr"||t=="application/vnd.code.notebook.stdout"||t=="application/vnd.code.notebook.error")return!0;if(t===mo){let n=JSON.parse(new TextDecoder().decode(e.data));return typeof n.model_id=="string"&&this.commIdsMappedToWidgetOutputModels.has(n.model_id)?Ire():!0}return t.startsWith("application/vnd")?Ire():!0}updateJupyterOutputWidgetWithOutput(e,t){let n=this.outputsAreSpecificToAWidget.length?this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId:void 0,i="commId"in e?e.commId:n;if(!i)return;let o="outputToAppend"in e?e.outputToAppend:void 0,s=this.commIdsMappedToParentWidgetModel.get(i)||i,a=this.cell.notebook.getCells().find(v=>{var k;return(k=gu.modelIdsOwnedByCells.get(v))==null?void 0:k.has(s)});if(!a){C.warn(`Unable to find a cell that owns the model ${s}`);return}let l=a.outputs.find(v=>v.items.find(k=>{if(k.mime!==mo)return!1;try{return JSON.parse(new TextDecoder().decode(k.data)).model_id===s}catch(R){C.warn("Failed to deserialize the widget data",R)}return!1}));if(!l)return;let u=gu.outputsOwnedByWidgetModel.get(s)||new Set,d=("clearOutput"in e?e.clearOutput:!1)||(this.outputsAreSpecificToAWidget.length?this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput===!0:!1);this.outputsAreSpecificToAWidget.length&&(this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput=!1);let f=a.outputs.slice().filter(v=>d?!u.has(v.id):!0),m=f.slice(0,f.indexOf(l)+1),g=f.slice(f.indexOf(l)+1);gu.outputsOwnedByWidgetModel.set(s,u),o&&u.add(o.id);let b=o?m.concat(o).concat(g):m.concat(g);return g.length===0&&o?t==null||t.appendOutput(o,a).then(E,E):d&&!o&&g.length===0||t==null||t.replaceOutput(b,a).then(E,E),{outputAdded:!0}}async handleInputRequest(e){if(e.content&&"prompt"in e.content){let t=new Ir.CancellationTokenSource;this.prompts.add(t);let n=e.content.password!==null&&e.content.password;await Ir.window.showInputBox({prompt:e.content.prompt?e.content.prompt.toString():"",ignoreFocusOut:!0,password:n},t.token).then(i=>{this.kernel.sendInputReply({value:i||"",status:"ok"},e.header)},E),this.prompts.delete(t)}}handleExecuteResult(e){this.addToCellData({output_type:"execute_result",data:e.content.data,metadata:e.content.metadata,transient:e.content.transient,execution_count:e.content.execution_count},e)}handleExecuteReply(e){let t=e.content;t.payload&&t.payload.forEach(n=>{n.source&&n.source==="set_next_input"&&"text"in n&&"replace"in n&&this.handleSetNextInput(n),n.data&&n.data.hasOwnProperty("text/plain")&&this.addToCellData({output_type:"stream",text:n.data["text/plain"].toString(),name:"stdout",metadata:{},execution_count:t.execution_count},e)})}handleSetNextInput(e){let t=new Ir.WorkspaceEdit;if(e.replace)t.replace(this.cell.document.uri,new Ir.Range(this.cell.document.lineAt(0).range.start,this.cell.document.lineAt(this.cell.document.lineCount-1).range.end),e.text);else{it(this.cell,"Create new cell after current");let n=new Ir.NotebookCellData(Ir.NotebookCellKind.Code,e.text,this.cell.document.languageId);n.outputs=[],n.metadata={};let i=Ir.NotebookEdit.insertCells(this.cell.index+1,[n]);t.set(this.cell.notebook.uri,[i])}Ir.workspace.applyEdit(t).then(E,E)}handleExecuteInput(e){e.content.execution_count&&this.execution&&(this.execution.executionOrder=e.content.execution_count)}handleStatusMessage(e){it(this.cell,`Kernel switching to ${e.content.execution_state}`)}getOrCreateExecutionTask(e){var t;return!e&&this.execution?this.execution:((t=this.execution)==null?void 0:t.cell)===this.cell?this.execution:this.createTemporaryTask(e)}handleStreamMessage(e){var o;if(Gd(e)&&this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow==Gd(e)||e.parent_header.msg_type==="comm_msg"&&e.header.msg_type==="stream")return;it(this.cell,`Update streamed output, new output '${e.content.text.substring(0,100)}'`);let t=this.getOrCreateExecutionTask(!0),n=e.content.name==="stdout"?Ir.NotebookCellOutputItem.stdout("").mime:Ir.NotebookCellOutputItem.stderr("").mime;!this.request&&!this.streamsReAttachedToExecutingCell&&!this.lastUsedStreamOutput&&this.cell.outputs.length&&this.cell.outputs[this.cell.outputs.length-1].items.length>=1&&this.cell.outputs[this.cell.outputs.length-1].items.every(s=>s.mime===n)&&(this.lastUsedStreamOutput={output:this.cell.outputs[0],stream:e.content.name}),this.streamsReAttachedToExecutingCell=!0;let{previousValueOfClearOutputOnNextUpdateToOutput:i}=this.clearOutputIfNecessary(t);if(((o=this.lastUsedStreamOutput)==null?void 0:o.stream)===e.content.name){let s=us({output_type:"stream",name:e.content.name,text:e.content.text});it(this.cell,`Append output items '${e.content.text.substring(0,100)}`),t==null||t.appendOutputItems(s.items,this.lastUsedStreamOutput.output).then(E,E)}else if(i){let s=jc(e.content.text),a=us({output_type:"stream",name:e.content.name,text:s});this.lastUsedStreamOutput={output:a,stream:e.content.name},it(this.cell,`Replace output with '${s.substring(0,100)}'`),t==null||t.replaceOutput([a]).then(E,E)}else{let s=pQ(jc(e.content.text)),a=us({output_type:"stream",name:e.content.name,text:s});this.lastUsedStreamOutput={output:a,stream:e.content.name},it(this.cell,`Append new output '${s.substring(0,100)}'`),t==null||t.appendOutput([a]).then(E,E)}this.endTemporaryTask()}handleDisplayData(e){let t={output_type:"display_data",data:$x(e.content.data),metadata:e.content.metadata,transient:e.content.transient};this.addToCellData(t,e)}handleClearOutput(e){if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===Gd(e)){if(e.content.wait)this.outputsAreSpecificToAWidget.length&&(this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput=!0);else{let t=this.getOrCreateExecutionTask(!0);this.updateJupyterOutputWidgetWithOutput({clearOutput:!0},t),this.endTemporaryTask()}return}if(e.content.wait)this.clearOutputOnNextUpdateToOutput=!0;else{let t=this.getOrCreateExecutionTask(!0);this.clearLastUsedStreamOutput(),t==null||t.clearOutput().then(E,E),this.endTemporaryTask()}}handleError(e){let t=e.content.traceback;C.ci(`Traceback for error ${t}`),this.formatters.forEach(i=>{t=i.format(this.cell,t)}),C.ci(`Traceback for error after formatting ${t}`);let n={output_type:"error",ename:e.content.ename,evalue:e.content.evalue,traceback:t};if(this.cell.notebook.notebookType!=="interactive"){let i=so.get(this.cell);i&&e.content.ename!=="KeyboardInterrupt"&&(i.errorInfo={name:e.content.ename,message:e.content.evalue,location:pee(e.content.traceback,this.cell),uri:this.cell.document.uri,stack:e.content.traceback.join(`
`)})}this.addToCellData(n,e),this.cellHasErrorsInOutput=!0}handleReply(e){Bn().KernelMessage.isExecuteReplyMsg(e)&&(this.handleExecuteReply(e),"execution_count"in e.content&&typeof e.content.execution_count=="number"&&this.execution&&(this.execution.executionOrder=e.content.execution_count))}handleUpdateDisplayDataMessage(e){let t=e.content.transient.display_id;if(!t){C.warn("Update display data message received, but no display id",e.content);return}let n=on.getMappedOutput(this.cell.notebook,t);if(!n){C.trace("Update display data message received, but no output found to update",e.content);return}if(n.cell.document.isClosed){C.warn("Update display data message received, but output cell is closed",e.content);return}let i=lj(new Ir.NotebookCellOutput(n.outputItems,n.outputContainer.metadata)),o=us({...i,data:e.content.data,metadata:e.content.metadata});if(n.outputItems.length===0&&o.items.length===0){C.trace("Update display data message received, but no output to update",e.content);return}let s=!1;if(n.outputItems.length===o.items.length){let a=!0;if((0,e9.default)(n.outputContainer.metadata||{},o.metadata||{})||(s=!0,a=!1),a){for(let l=0;l<n.outputItems.length;l++)if(!(0,e9.default)(n.outputItems[l],o.items[l])){a=!1;break}}if(a){C.trace("Update display data message received, but no output to update (data is the same)",e.content);return}}if(it(this.cell,`Replace output items in display data ${o.items.length}`),s){let a=n.cell.outputs.map(u=>{let c=lj(u);return c.output_type==="display_data"&&"transient"in c&&c.transient&&typeof c.transient=="object"&&"display_id"in c.transient&&typeof c.transient.display_id=="string"&&c.transient.display_id===t?o:u}),l=this.getOrCreateExecutionTask(!1);l==null||l.replaceOutput(a,n.cell).then(E,E),on.trackOutputByDisplayId(n.cell,t,o,o.items)}else{let a=this.getOrCreateExecutionTask(!1);a==null||a.replaceOutputItems(o.items,n.outputContainer).then(E,E),on.trackOutputByDisplayId(n.cell,t,n.outputContainer,o.items)}this.endTemporaryTask()}};gu.modelIdsOwnedByCells=new WeakMap,gu.outputsOwnedByWidgetModel=new Map,U([yn()],gu.prototype,"handleReply",1);var yP=gu;function Ire(){let r=Ir.extensions.getExtension(hp);if(!r)return!1;let e=(0,zA.coerce)(r.packageJSON.version);return e?e.compare(new zA.SemVer("1.1.0"))>=0:!1}p();var Yd=class extends Error{constructor(e){super(e.evalue||e.ename),this.ename=e.ename,this.evalue=e.evalue,this.traceback=e.traceback}};var QA=class{constructor(e,t){this.controller=e;this.requestListener=t}create(e,t,n,i){return r9.fromCell(e,t,n,this.controller,this.requestListener,i)}},r9=class r{constructor(e,t,n,i,o,s){this.cell=e;this.codeOverride=t;this.kernelConnection=n;this.controller=i;this.requestListener=o;this.resumeExecution=s;this.type="cell";this._result=Oe();this.cancelHandled=!1;this.disposables=[];if(t9.workspace.onDidCloseTextDocument(a=>{var l;if(a===this.cell.document){C.info(`Disposing request as the cell (${this.cell.index}) was deleted ${Ee(this.cell.notebook.uri)}`);try{(l=this.request)==null||l.dispose()}catch(u){C.error(`Error during cell execution dispose: ${u}`)}this.started&&!this._completed&&this.completedDueToCancellation()}},this,this.disposables),this.canExecuteCell())this.execution=so.getOrCreate(e,this.controller,!(s!=null&&s.msg_id)),Hf.setCellState(e,2);else{let a=so.get(e);a&&(a.start(),a.end(void 0))}}get result(){return this._result.promise}get executionOrder(){return this._executionOrder}static fromCell(e,t,n,i,o,s){return new r(e,t,n,i,o,s)}async start(e){var t,n,i,o;if(this.session=e,(t=this.resumeExecution)!=null&&t.msg_id)return this.resume(e,this.resumeExecution);if(this.cancelHandled){it(this.cell,"Not starting as it was cancelled");return}if(it(this.cell,"Start execution"),C.ci(`Cell Exec contents ${this.cell.document.getText().substring(0,50)}...`),!this.canExecuteCell()){(n=this.execution)==null||n.end(void 0),this.execution=void 0,this._result.resolve();return}return e.kind==="remoteJupyter"&&e.status==="unknown"&&(!e.kernel||e.kernel.isDisposed||e.isDisposed)?((i=this.execution)==null||i.start(),(o=this.execution)==null||o.clearOutput().then(E,E),this.completedWithErrors(new Qr),this.result):this.started?(it(this.cell,"Cell has already been started yet CellExecution.Start invoked again"),C.error(`Cell has already been started yet CellExecution.Start invoked again ${this.cell.index}`),this.result):(this.started=!0,xS.set(this.cell.notebook,this.execution),Hf.setCellState(this.cell,3),this.execute(this.codeOverride||this.cell.document.getText().replace(/\r\n/g,`
`),e).catch(s=>this.completedWithErrors(s)).catch(E),this.result)}async resume(e,t){var n,i;if(this.cancelHandled){it(this.cell,"Not resuming as it was cancelled");return}if(!e.kernel)throw new Error("Kernel not available to resume execution");if(it(this.cell,"Start resuming execution"),C.ci(`Cell Exec (resuming) contents ${this.cell.document.getText().substring(0,50)}...`),!this.canExecuteCell()){(n=this.execution)==null||n.end(void 0),this.execution=void 0,this._result.resolve();return}return this.started?(C.error(`Cell has already been started yet CellExecution.resume invoked again ${this.cell.index}`),this.result):(this.started=!0,xS.set(this.cell.notebook,this.execution),(i=this.execution)==null||i.start(t.startTime),t.executionCount&&this.execution&&(this.execution.executionOrder=t.executionCount),Hf.setCellState(this.cell,3),this.cellExecutionHandler=this.requestListener.registerListenerForResumingExecution(this.cell,{kernel:e.kernel,cellExecution:this.execution,msg_id:t.msg_id}),this.cellExecutionHandler.onErrorHandlingExecuteRequestIOPubMessage(o=>{C.error(`Cell (index = ${this.cell.index}) execution completed with errors (2).`,o),this.completedWithErrors(o.error)},this,this.disposables),this.cellExecutionHandler.completed.finally(()=>this.completedSuccessfully()).catch(E),this.result)}async cancel(e=!1){var t;if(!this.cancelHandled){if(this.cancelRequested=!0,this.started&&!e&&((t=this.execution)!=null&&t.started)){it(this.cell,"Cell is already running, waiting for it to finish or kernel to start"),await this.result.catch(E);return}this.cancelHandled||this._completed||(it(this.cell,"Execution cancelled"),this.cancelHandled=!0,this.completedDueToCancellation(),this.dispose())}}dispose(){this.disposed||(this.disposed=!0,it(this.cell,"Execution disposed"),Ce(this.disposables))}completedWithErrors(e,t,n=!0){var i,o;if(!this.cancelHandled){if(!this.disposed&&!this.cancelRequested?C.warn("Cell completed with errors",e):C.warn(`Cell completed with errors (${this.disposed?"disposed":"cancelled"})`),it(this.cell,"Completed with errors"),n){let s,a;if(e&&!(e instanceof ot)&&((i=e.message)!=null&&i.includes("Canceled future for execute_request message before replies were done"))&&this.session&&yre(this.session)&&(e=new Qr),e)if(!(e instanceof ot))s=e.message||e.name||e.stack;else{let l=Wm(t9.workspace.workspaceFolders||[],e,lt(this.kernelConnection),x7(this.kernelConnection.interpreter));s=l==null?void 0:l.message}a=vy(s||""),a&&((o=this.execution)==null||o.appendOutput(a).then(E,E))}this.endCellTask("failed",t),it(this.cell,"Completed with errors, & resolving"),this._result.reject(e)}}get isEmptyCodeCell(){return this.cell.document.getText().trim().length===0}completedSuccessfully(e){it(this.cell,"Completed successfully");let t="success";this.endCellTask("success",e),it(this.cell,`Completed successfully & resolving with status = ${t}`),this._result.resolve()}endCellTask(e,t=new Date().getTime()){var n,i,o,s,a;if(!this._completed){if(this._completed=!0,this.isEmptyCodeCell)this.execution&&(this.execution.executionOrder=void 0),(n=this.execution)==null||n.end(void 0);else if(e==="success"||e==="failed")this.endTime=t,(i=this.execution)==null||i.end(e==="success",this.endTime);else{try{(o=this.request)==null||o.dispose()}catch(l){}(s=this.execution)==null||s.end(void 0)}xS.get(this.cell.notebook)===this.execution&&xS.set(this.cell.notebook,void 0),this._executionOrder=(a=this.execution)==null?void 0:a.executionOrder,Hf.setCellState(this.cell,1),this.execution=void 0}}completedDueToCancellation(){it(this.cell,"Completed due to cancellation"),this.endCellTask("cancelled"),it(this.cell,"Cell cancelled & resolving"),this._result.resolve()}canExecuteCell(){return this.cell.document.languageId==="raw"?!1:!this.cell.document.isClosed}async execute(e,t){var o,s,a,l;if(!t.kernel)throw new Error("No kernel available to execute code");if(it(this.cell,"Send code for execution"),e.trim().length===0||this.cell.document.isClosed)return e.trim().length===0&&((s=this.execution)==null||s.start((o=this.resumeExecution)==null?void 0:o.startTime),(l=(a=this.execution)==null?void 0:a.clearOutput())==null||l.then(E,E)),it(this.cell,"Empty cell execution"),this.completedSuccessfully();let n={cellId:this.cell.document.uri.toString(),...Nf(this.cell).metadata},i=t.kernel;try{Mr.changeCellState(this.cell,3),C.trace(`Cell Index:${this.cell.index} sent to kernel`),this.request=i.requestExecute({code:e,silent:!1,stop_on_error:!1,allow_stdin:!0,store_history:!0},!1,n),this.request.done.then(E,E)}catch(u){return C.error(`Cell execution failed without request, for cell Index ${this.cell.index}`,u),this.completedWithErrors(u)}this.cellExecutionHandler=this.requestListener.registerListenerForExecution(this.cell,{kernel:i,cellExecution:this.execution,request:this.request}),this.cellExecutionHandler.onErrorHandlingExecuteRequestIOPubMessage(u=>{C.error(`Cell (index = ${this.cell.index}) execution completed with errors (2).`,u),this.completedWithErrors(u.error)},this,this.disposables);try{it(this.cell,"Wait for jupyter execution");let u=await this.request.done,c=new Date().getTime();it(this.cell,"Jupyter execution completed"),u.content.status==="error"?this.completedWithErrors(new Yd(u.content),c,!1):this.completedSuccessfully(c),it(this.cell,"Executed successfully in executeCell")}catch(u){if(this.cancelHandled)return;!this.disposed&&!this.cancelRequested&&C.error("Error in waiting for cell to complete",u),it(this.cell,"Some other execution error"),u&&u instanceof Error&&qn(u,!0)?this.completedWithErrors({message:u.message}):this.completedWithErrors(u)}}};p();var Sre=require("vscode");var XA=class{constructor(e,t,n,i){this.controller=e;this.context=t;this.formatters=n;this.notebook=i;this.disposables=[];this.messageHandlers=new WeakMap;Sre.workspace.onDidChangeNotebookDocument(o=>{o.notebook===this.notebook&&o.contentChanges.forEach(s=>s.removedCells.forEach(a=>{var l;return(l=this.messageHandlers.get(a))==null?void 0:l.dispose()}))},this,this.disposables)}dispose(){Ce(this.disposables),this.notebook&&this.notebook.getCells().forEach(e=>{var t;return(t=this.messageHandlers.get(e))==null?void 0:t.dispose()})}registerListenerForExecution(e,t){var i;(i=this.messageHandlers.get(e))==null||i.dispose();let n=new yP(e,this.controller,this.context,this.formatters,t.kernel,t.request,t.cellExecution,t.request.msg.header.msg_id);return this.messageHandlers.set(e,n),n}registerListenerForResumingExecution(e,t){var i;(i=this.messageHandlers.get(e))==null||i.dispose();let n=new yP(e,this.controller,this.context,this.formatters,t.kernel,void 0,t.cellExecution,t.msg_id);return this.messageHandlers.set(e,n),n}};p();p();var ZA=require("vscode");function vu(r,e,t){r!==Ge&&C.trace(`Execution Id:${e}. ${t}.`)}var _re=new Map,PS=class r{constructor(e,t){this.code=e;this.extensionId=t;this.type="code";this._onDidEmitOutput=new ZA.EventEmitter;this.onDidEmitOutput=this._onDidEmitOutput.event;this._onRequestSent=new ZA.EventEmitter;this.onRequestSent=this._onRequestSent.event;this._onRequestAcknowledge=new ZA.EventEmitter;this.onRequestAcknowledged=this._onRequestAcknowledge.event;this._done=Oe();this.cancelHandled=!1;this.disposables=[];let n=_re.get(t)||0;n+=1,_re.set(t,n),this.executionId=`${t}-${n}`,this.disposables.push(this._onDidEmitOutput)}get done(){return this._done.promise}get result(){return this._done.promise}static fromCode(e,t){return new r(e,t)}async start(e){if(this.session=e,this.cancelHandled){vu(this.extensionId,this.executionId,"Not starting as it was cancelled");return}if(vu(this.extensionId,this.executionId,"Start Code execution"),C.ci(`Code Exec contents ${this.code.substring(0,50)}...`),!e.kernel||e.kernel.isDisposed||e.isDisposed){this._done.reject(new Qr);return}if(this.started)return vu(this.extensionId,this.executionId,"Code has already been started yet CodeExecution.Start invoked again"),C.error(`Code has already been started yet CodeExecution.Start invoked again ${this.executionId}`),this.done;await this.execute(this.code.replace(/\r\n/g,`
`),e).catch(E)}async cancel(){var e,t,n;if(!(this.cancelHandled||this._completed)){if(this.cancelRequested=!0,this.started){vu(this.extensionId,this.executionId,"Code is already running, interrupting and waiting for it to finish or kernel to start");let i=(e=this.session)==null?void 0:e.kernel;i&&this.extensionId!==Ge&&await i.interrupt().catch(E),(t=this.request)==null||t.dispose(),await((n=this.request)==null?void 0:n.done.catch(E))}this.cancelHandled||this._completed||(vu(this.extensionId,this.executionId,"Execution cancelled"),this.cancelHandled=!0,this._done.resolve(),this.dispose())}}dispose(){this.disposed||(this.disposed=!0,this._completed||vu(this.extensionId,this.executionId,"Execution disposed"),Ce(this.disposables))}async execute(e,t){if(!t.kernel){let i=new Error("No kernel available to execute code");throw this._done.resolve(),i}vu(this.extensionId,this.executionId,"Send code for execution");let n=t.kernel;try{this.started=!0,this._onRequestSent.fire(),vu(this.extensionId,this.executionId,"Execution Request Sent to Kernel"),this.request=iee(n,e,()=>this._onRequestAcknowledge.fire(),i=>this._onDidEmitOutput.fire(i)),this.request.done.then(E,E)}catch(i){C.error(`Code execution failed without request, for exec ${this.executionId}`,i),this._completed=!0,this._done.reject(i);return}try{let i=await this.request.done;this._completed=!0,i.content.status==="error"?(vu(this.extensionId,this.executionId,"Executed with errors"),this._done.reject(new Yd(i.content))):(vu(this.extensionId,this.executionId,"Executed successfully"),this._done.resolve())}catch(i){if(this._completed=!0,this.cancelHandled)return;!this.disposed&&!this.cancelRequested&&C.error(`Error in waiting for code ${this.executionId} to complete`,i),this._done.reject(i)}}};var eM=class{constructor(e,t,n,i){this.session=e;this.executionFactory=t;this.metadata=n;this.resourceUri=i;this.queueOfItemsToExecute=[];this.cancelledOrCompletedWithErrors=!1;this.startedRunningCells=!1;this.disposables=[]}get queueOfCellsToExecute(){return this.queueOfItemsToExecute.filter(e=>e.type==="cell").map(e=>e)}get isEmpty(){return this.queueOfItemsToExecute.length===0}get failed(){return this.cancelledOrCompletedWithErrors}get queue(){return this.queueOfCellsToExecute.map(e=>e.cell)}dispose(){var e;this.disposables.forEach(t=>t.dispose()),(e=this.lastCellExecution)==null||e.dispose()}queueCell(e,t){this.enqueue({cell:e,codeOverride:t})}queueCode(e,t,n){return this.enqueue({code:e,extensionId:t,token:n})}enqueue(e){let t;if("cell"in e){let{cell:n,codeOverride:i}=e,o=this.queueOfCellsToExecute.find(a=>a.cell===n);if(o)return it(n,"Use existing cell execution"),o;let s=this.executionFactory.create(n,i,this.metadata);t=s,this.disposables.push(s),this.queueOfItemsToExecute.push(s),it(n,"User queued cell for execution")}else{let{code:n,extensionId:i,token:o}=e,s=PS.fromCode(n,i);t=s,this.disposables.push(s),this.queueOfItemsToExecute.push(s),this.disposables.push(Ag(o.onCancellationRequested)(()=>s.cancel()))}return this.startExecutingCells(),t}resumeCell(e,t){if(this.queueOfCellsToExecute.find(o=>o.cell===e)){it(e,"Use existing cell execution");return}let i=this.executionFactory.create(e,"",this.metadata,t);this.disposables.push(i),this.queueOfItemsToExecute.push(i),it(e,"User queued cell for execution"),this.startExecutingCells()}async cancel(e){var t;this.cancelledOrCompletedWithErrors=!0,C.debug("Cancel pending cells"),await Promise.all(this.queueOfItemsToExecute.map(n=>n.cancel(e))),(t=this.lastCellExecution)==null||t.dispose(),this.queueOfItemsToExecute.splice(0,this.queueOfItemsToExecute.length)}async cancelQueuedCells(){var e,t;this.cancelledOrCompletedWithErrors=!0,C.debug("Cancel pending cells"),await Promise.all(this.queueOfCellsToExecute.map(n=>n.cancel())),((e=this.lastCellExecution)==null?void 0:e.type)==="cell"&&((t=this.lastCellExecution)==null||t.dispose()),this.queueOfItemsToExecute.push(...this.queueOfItemsToExecute.filter(n=>n.type==="code"))}async waitForCompletion(e){let t=e?this.queueOfCellsToExecute.filter(n=>e===n.cell):this.queueOfItemsToExecute;await Promise.all(t.map(n=>n.result))}startExecutingCells(){this.startedRunningCells||this.start().catch(E),this.startedRunningCells=!0}async start(){try{await this.executeQueuedCells()}catch(e){C.error("Failed to execute cells in CellExecutionQueue",e),this.cancelledOrCompletedWithErrors=!0,await this.cancelQueuedCells()}}async executeQueuedCells(){var n,i,o;let e,t=await this.session;for(this.queueOfItemsToExecute.forEach(s=>s.type==="cell"&&it(s.cell,"Ready to execute"));this.queueOfItemsToExecute.length;){(n=this.lastCellExecution)==null||n.dispose();let s=this.queueOfItemsToExecute[0];this.lastCellExecution=s,s.type==="cell"&&it(s.cell,"Before Execute individual cell");let a=!0;try{s.type==="cell"&&s.cell.notebook.isClosed?e=!0:s.type==="cell"&&this.cancelledOrCompletedWithErrors||(a=await s.start(t).then(()=>!0).catch(()=>!1))}finally{s.type==="cell"&&it(s.cell,`After Execute individual cell ${a}`);let u=this.queueOfItemsToExecute.indexOf(s);u>=0&&this.queueOfItemsToExecute.splice(u,1),s.type==="cell"&&Mr.changeCellState(s.cell,1,s.executionOrder)}let l=!1;if(s.type==="cell"&&((o=(i=Nf(s.cell).metadata)==null?void 0:i.tags)!=null&&o.includes("raises-exception"))&&(l=!0),e||this.cancelledOrCompletedWithErrors||!a&&!l){this.cancelledOrCompletedWithErrors=!0;let u=[];if(this.cancelledOrCompletedWithErrors&&u.push("cancellation or failure in execution"),e&&u.push("Notebook being closed"),typeof a=="number"&&!a&&u.push("failure in cell execution"),u.length===0&&u.push("an unknown reason"),this.queueOfCellsToExecute.length>0&&this.queueOfCellsToExecute.length===this.queueOfItemsToExecute.length){C.warn(`Cancel all remaining cells due to ${u.join(" or ")}`),await this.cancel();break}else if(this.queueOfCellsToExecute.length>0&&this.queueOfCellsToExecute.length!==this.queueOfItemsToExecute.length)C.warn(`Cancel all remaining cells due to ${u.join(" or ")}`),await this.cancelQueuedCells();else if(e){C.warn(`Cancel all remaining cells due to ${u.join(" or ")}`),await this.cancel();break}}if(t.status==="dead"||t.status==="terminating"){this.cancelledOrCompletedWithErrors=!0,C.warn("Cancel all remaining cells due to dead kernel"),await this.cancel();break}}}};var tM=class{constructor(e,t,n,i){this.kernel=e;this.notebook=i;this.disposables=[];this._visibleExecutionCount=0;this.documentExecutions=new WeakMap;this._onDidReceiveDisplayUpdate=new tv.EventEmitter;this.onDidReceiveDisplayUpdate=this._onDidReceiveDisplayUpdate.event;this.hookedSesions=new WeakSet;let o=new XA(e.controller,t,n,i);this.disposables.push(o),this.executionFactory=new QA(e.controller,o),Mr.onDidChangeNotebookCellExecutionState(s=>{var a;s.cell.notebook===e.notebook&&s.state===1&&((a=s.cell.executionSummary)!=null&&a.executionOrder)&&(this._visibleExecutionCount=Math.max(this._visibleExecutionCount,s.cell.executionSummary.executionOrder))}),e.onRestarted(()=>this._visibleExecutionCount=0,this,this.disposables),e.onStarted(()=>this._visibleExecutionCount=0,this,this.disposables),e.addHook("willInterrupt",this.onWillInterrupt,this,this.disposables),e.addHook("willCancel",this.onWillCancel,this,this.disposables),e.addHook("willRestart",s=>this.onWillRestart(s),this,this.disposables),e.onStatusChanged(this.hookupIOPubHandler,this,this.disposables),e.onRestarted(this.hookupIOPubHandler,this,this.disposables),this.hookupIOPubHandler()}get executionCount(){return this._visibleExecutionCount}hookupIOPubHandler(){let e=this.kernel.session;if(!e||this.hookedSesions.has(e))return;this.hookedSesions.add(e);let t=(n,i)=>{var l;if(i.header.msg_type!=="update_display_data"&&i.header.msg_type!=="display_data")return;let o=i,s=(l=o.content.transient)==null?void 0:l.display_id;if(!s||!fee(e,s))return;let a=us({output_type:"display_data",data:o.content.data,metadata:o.content.metadata,transient:o.content.transient});this._onDidReceiveDisplayUpdate.fire(a)};e.iopubMessage.connect(t),this.disposables.push({dispose:()=>{e==null||e.iopubMessage.disconnect(t)}})}get pendingCells(){var e;return((e=this.documentExecutions.get(this.notebook))==null?void 0:e.queue)||[]}async resumeCellExecution(e,t){if(it(e,`NotebookKernelExecution.resumeCellExecution (start), ${Ee(e.notebook.uri)}`),e.kind==tv.NotebookCellKind.Markup)return;Rr(this.kernel.resourceUri,"DATASCIENCE.RESUME_EXECUTE_CELL");let n=this.kernel.start(new fr(!1)),i=this.getOrCreateCellExecutionQueue(e.notebook,n);i.resumeCell(e,t);let o=await i.waitForCompletion(e).then(()=>!0).catch(()=>!1);it(e,`NotebookKernelExecution.resumeCellExecution (completed), ${Ee(e.notebook.uri)}`),C.trace(`Cell ${e.index} executed ${o?"successfully":"with an error"}`)}async executeCell(e,t){it(e,`NotebookKernelExecution.executeCell (1), ${Ee(e.notebook.uri)}`);let n=new bt;if(e.kind==tv.NotebookCellKind.Markup)return;it(e,`NotebookKernelExecution.executeCell (2), ${Ee(e.notebook.uri)}`);let i=this.kernel.restarting.then(()=>this.kernel.start(new fr(!1)));it(e,`NotebookKernelExecution.executeCell (3), ${Ee(e.notebook.uri)}`),await i;let o=this.getOrCreateCellExecutionQueue(e.notebook,i);o.queueCell(e,t);let s=!0;try{it(e,`NotebookKernelExecution.executeCell (4), ${Ee(e.notebook.uri)}`),await o.waitForCompletion(e)}catch(a){throw s=!1,a}finally{it(e,`NotebookKernelExecution.executeCell completed (5), ${Ee(e.notebook.uri)}`),C.trace(`Cell ${e.index} executed ${s?"successfully":"with an error"}`),Rr(this.kernel.resourceUri,"DATASCIENCE.EXECUTE_CELL",{duration:n.elapsedTime})}}async*executeCode(e,t,n,i){let o=new bt,s;if(t===Ge||t===fD){let f=this.kernel.restarting.then(()=>this.kernel.start(new fr(!0)));s=PS.fromCode(e,t),f.then(m=>s.start(m))}else{let f=this.kernel.restarting.then(()=>this.kernel.start(new EA(!1,this.kernel.isPostInitializedInProgress)));s=this.getOrCreateCellExecutionQueue(this.notebook,f).queueCode(e,t,i)}t!==Ge&&C.trace(`Queue code ${s.executionId} from ${t} after ${o.elapsedTime}ms:
${e}`);let a=!1,l=[];s.result.finally(()=>{a=!0,!i.isCancellationRequested&&C.debug(`Execution of code ${s.executionId} completed in ${o.elapsedTime}ms`),t!==Ge&&Rr(this.kernel.resourceUri,"DATASCIENCE.EXECUTE_CODE",{duration:o.elapsedTime},{extensionId:t}),Ce(l)}).catch(E);let u=Ka(s.result),c=[],d=Oe();for(l.push(s.onRequestSent(()=>n.started.fire())),l.push(s.onRequestAcknowledged(()=>n.executionAcknowledged.fire())),s.onDidEmitOutput(f=>{c.push(f),d.resolve(),d=Oe()},this,l),i.onCancellationRequested(()=>{a||C.debug(`Code execution cancelled by extension ${t}`)},this,l);;){await Promise.race([d.promise,u.promise]),a&&(d=Oe());let f=this.kernel.session;for(;c.length;){let m=c.shift();f&&ER(t,f,m),yield m}if(u.completed)break}}executeHidden(e){return this.kernel.start().then(n=>n.kernel?Ai(n.kernel,e):Promise.reject(new Qr))}async onWillInterrupt(){let e=this.documentExecutions.get(this.notebook);!e&&this.kernel.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"||(C.info("Interrupt kernel execution"),e&&(await e.cancel(),await e.waitForCompletion().catch(E)))}async onWillCancel(){let e=this.documentExecutions.get(this.notebook);e&&await e.cancel(!0)}async onWillRestart(e){let t=this.documentExecutions.get(this.notebook),n=e?await e.catch(()=>{}):void 0,i=t?t.cancel(!0).then(()=>t.waitForCompletion().catch(E)):Promise.resolve();n||(C.info("No kernel session to interrupt"),await i)}getOrCreateCellExecutionQueue(e,t){let n=this.documentExecutions.get(e);if(n&&!n.isEmpty&&!n.failed)return n;let i=new eM(t,this.executionFactory,this.kernel.kernelConnectionMetadata,this.kernel.resourceUri);return this.disposables.push(i),tv.workspace.onDidCloseNotebookDocument(async o=>{o===e&&(C.debug(`Cancel executions after closing notebook ${Ee(o.uri)}`),(!i.failed||!i.isEmpty)&&await i.cancel(!0))},this,this.disposables),this.documentExecutions.set(e,i),i}};var DS=class extends VA{constructor(t,n,i,o,s,a,l,u,c){super(t,n);this.sessionCreator=i;this.configService=o;this.context=s;this.formatters=l;this.startupCodeProviders=u;this.workspaceStorage=c;n.push(a.onDidRemove(this.handleServerRemoval.bind(this)))}getOrCreate(t,n){var u;let i=this.getInternal(t);if(i&&i.options.metadata.id===n.metadata.id)return i.kernel;i&&C.trace(`Kernel for ${Ee(t.uri)} with id ${i.options.metadata.id} is being replaced with ${n.metadata.id}`),this.disposeOldKernel(t,"createNewKernel");let o=(t==null?void 0:t.notebookType)===yr?n.resourceUri:t.uri,s=Zj(this.configService,o),a=t.uri.path.endsWith(".interactive")||(u=n.resourceUri)!=null&&u.path.endsWith(".interactive")?yr:St,l=new GA(o,t,n.metadata,this.sessionCreator,s,n.controller,this.startupCodeProviders.getProviders(a),this.workspaceStorage,void 0,void 0);return l.onRestarted(()=>this._onDidRestartKernel.fire(l),this,this.disposables),l.onPostInitialized(c=>c.waitUntil(this._onDidPostInitializeKernel.fireAsync({kernel:l},c.token)),this,this.disposables),l.onDisposed(()=>this._onDidDisposeKernel.fire(l),this,this.disposables),l.onStarted(()=>this._onDidStartKernel.fire(l),this,this.disposables),l.onStatusChanged(c=>this._onKernelStatusChanged.fire({kernel:l,status:c}),this,this.disposables),this.executions.set(l,new tM(l,this.context,this.formatters,t)),this.asyncDisposables.push(l),this.storeKernel(t,n,l),this.deleteMappingIfKernelIsDisposed(l),l}};DS=U([(0,gn.injectable)(),x(0,(0,gn.inject)(Vu)),x(1,(0,gn.inject)(ve)),x(2,(0,gn.inject)(Gx)),x(3,(0,gn.inject)(Ke)),x(4,(0,gn.inject)(st)),x(5,(0,gn.inject)(pr)),x(6,(0,gn.multiInject)(SI)),x(7,(0,gn.inject)(Md)),x(8,(0,gn.inject)(Et)),x(8,(0,gn.named)(Es))],DS);var TS=class extends jA{constructor(t,n,i,o,s,a){super(t,n);this.sessionCreator=i;this.configService=o;this.startupCodeProviders=s;this.workspaceStorage=a}getOrCreate(t,n){var u;let i=this.getInternal(t);if(i&&i.options.metadata.id===n.metadata.id)return i.kernel;this.disposeOldKernel(t);let o=t,s=Zj(this.configService,o),a=t.path.endsWith(".interactive")||(u=n.resourceUri)!=null&&u.path.endsWith(".interactive")?yr:St,l=new JA(t,o,n.metadata,this.sessionCreator,s,this.startupCodeProviders.getProviders(a),this.workspaceStorage,void 0,void 0);return l.onRestarted(()=>this._onDidRestartKernel.fire(l),this,this.disposables),l.onPostInitialized(c=>c.waitUntil(this._onDidPostInitializeKernel.fireAsync({kernel:l},c.token)),this,this.disposables),l.onDisposed(()=>this._onDidDisposeKernel.fire(l),this,this.disposables),l.onStarted(()=>this._onDidStartKernel.fire(l),this,this.disposables),l.onStatusChanged(c=>this._onKernelStatusChanged.fire({kernel:l,status:c}),this,this.disposables),this.asyncDisposables.push(l),this.storeKernel(t,n,l),this.deleteMappingIfKernelIsDisposed(t,l),l}};TS=U([(0,gn.injectable)(),x(0,(0,gn.inject)(Vu)),x(1,(0,gn.inject)(ve)),x(2,(0,gn.inject)(Gx)),x(3,(0,gn.inject)(Ke)),x(4,(0,gn.inject)(Md)),x(5,(0,gn.inject)(Et)),x(5,(0,gn.named)(Es))],TS);p();var rM=ae(he()),NS=require("vscode");var kS=class extends Pr{constructor(t){super();this._onDidChangeRegistrations=this._register(new NS.EventEmitter);this.onDidChangeRegistrations=this._onDidChangeRegistrations.event;this._finders=[];this.connectionFinderMapping=new Map;this._onDidChangeKernels=this._register(new NS.EventEmitter);this.onDidChangeKernels=this._onDidChangeKernels.event;this._status="idle";this._onDidChangeStatus=this._register(new NS.EventEmitter);t.push(this),this._register(this._onDidChangeStatus),this._register(this._onDidChangeRegistrations)}get status(){return this._status}set status(t){this._status!=t&&(this._status=t,this._onDidChangeStatus.fire())}get onDidChangeStatus(){return this._onDidChangeStatus.event}registerKernelFinder(t){this._finders.push(t);let n=()=>{this.status=this._finders.every(s=>s.status==="idle")?"idle":"discovering"};n();let i=this._register(new ln),o=()=>{let s=this._finders.findIndex(a=>a===t);s>=0&&this._finders.splice(s,1),i.dispose(),n(),this._onDidChangeKernels.fire(),this._onDidChangeRegistrations.fire({added:[],removed:[t]})};return i.add(t.onDidChangeStatus(n,this)),i.add(t.onDidChangeKernels(()=>this._onDidChangeKernels.fire())),i.add(t.onDidDispose(()=>o())),this._onDidChangeKernels.fire(),this._onDidChangeRegistrations.fire({added:[t],removed:[]}),new NS.Disposable(()=>o())}get kernels(){let t=[];this.connectionFinderMapping.clear();let n=new Set;this._finders.filter(o=>o.kind==="localPythonEnvironment").forEach(o=>{o.kernels.forEach(s=>{(s.kind==="startUsingLocalKernelSpec"||s.kind==="startUsingPythonInterpreter")&&s.kernelSpec.specFile&&n.add(s.kernelSpec.specFile),t.push(s),this.connectionFinderMapping.set(s.id,o)})}),this._finders.filter(o=>o.kind==="localKernelSpec").forEach(o=>{o.kernels.forEach(s=>{(s.kind==="startUsingLocalKernelSpec"||s.kind==="startUsingPythonInterpreter")&&s.kernelSpec.specFile&&n.has(s.kernelSpec.specFile)||(t.push(s),this.connectionFinderMapping.set(s.id,o))})});let i=this._finders.filter(o=>o.kind==="remote");for(let o of i){let s=o.kernels;s.forEach(a=>{this.connectionFinderMapping.set(a.id,o)}),t.push(...s)}return t}getFinderForConnection(t){return this.connectionFinderMapping.get(t.id)}get registered(){return this._finders}};kS=U([(0,rM.injectable)(),x(0,(0,rM.inject)(ve))],kS);p();var rv=ae(he());var n9="Active_Kernel_Id_List",t_e=100,js=class{constructor(e,t){this.globalMemento=e;this.crypto=t}async getPreferredRemoteKernelId(e){let t=this.globalMemento.get(n9,[]);if(t.length){let n=e.uri,i=await this.crypto.createHash(n.toString()),o=t.find(s=>s.fileHash===i);return C.trace(`Preferred Remote kernel for ${Ee(n)} is ${o==null?void 0:o.kernelId}`),o==null?void 0:o.kernelId}}async clearPreferredRemoteKernelId(e){await this.updatePreferredRemoteKernelIdInternal(e)}async storePreferredRemoteKernelId(e,t){await this.updatePreferredRemoteKernelIdInternal(e,t)}async updatePreferredRemoteKernelIdInternal(e,t){let n=!1,i=JSON.parse(JSON.stringify(this.globalMemento.get(n9,[]))),o=await this.crypto.createHash(e.toString()),s=i.findIndex(a=>a.fileHash===o);for(s>=0&&(n=!0,i.splice(s,1)),t&&(n=!0,i.push({fileHash:o,kernelId:t}),C.trace(`Storing Preferred remote kernel for ${Ee(e)} is ${t}`));i.length>t_e;)n=!0,i.shift();n&&await this.globalMemento.update(n9,i)}};js=U([(0,rv.injectable)(),x(0,(0,rv.inject)(Et)),x(0,(0,rv.named)(rr)),x(1,(0,rv.inject)(cy))],js);p();var Ki=Symbol("IJupyterVariables"),nM=Symbol("IKernelVariableRequester"),iM=Symbol("IJupyterVariablesProvider");p();var zd=ae(he()),Ere=require("vscode");var nv=class{constructor(e,t,n){this.kernelVariables=t;this.debuggerVariables=n;this.refreshEventEmitter=new Ere.EventEmitter;e.push(n.refreshRequired(this.fireRefresh.bind(this))),e.push(t.refreshRequired(this.fireRefresh.bind(this)))}get refreshRequired(){return this.refreshEventEmitter.event}getAllVariableDiscriptions(e,t,n,i){return this.variableHandler.getAllVariableDiscriptions(e,t,n,i)}async getVariables(e,t){return this.variableHandler.getVariables(e,t)}async getFullVariable(e,t){return this.variableHandler.getFullVariable(e,t)}async getMatchingVariable(e,t,n){return this.variableHandler.getMatchingVariable(e,t,n)}async getDataFrameInfo(e,t,n,i){return this.variableHandler.getDataFrameInfo(e,t,n,i)}async getVariableValueSummary(e,t,n){return this.variableHandler.getVariableValueSummary(e,t,n)}async getDataFrameRows(e,t,n,i,o){return this.variableHandler.getDataFrameRows(e,t,n,i,o)}get variableHandler(){return this.debuggerVariables.active?this.debuggerVariables:this.kernelVariables}fireRefresh(){this.refreshEventEmitter.fire()}};U([Nr("DS_INTERNAL.VARIABLE_EXPLORER_FETCH_TIME")],nv.prototype,"getVariables",1),nv=U([(0,zd.injectable)(),x(0,(0,zd.inject)(ve)),x(1,(0,zd.inject)(Ki)),x(1,(0,zd.named)(nt.KERNEL_VARIABLES)),x(2,(0,zd.inject)(Ki)),x(2,(0,zd.named)(nt.DEBUGGER_VARIABLES))],nv);p();var iv=ae(he()),Qd=require("vscode");var RS=class{constructor(e,t,n,i){this.disposableRegistry=e;this.kernelProvider=t;this.serverUriStorage=n;this.jupyterUriProviderRegistration=i;this.kernelsStartedSuccessfully=new WeakSet;this.kernelDisposables=new WeakMap;this.kernelConnectionToKernelMapping=new WeakMap;this.kernelsRestarting=new WeakSet;this.kernelReconnectProgress=new WeakMap;this.lastExecutedCellPerKernel=new WeakMap}activate(){this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposableRegistry),this.disposableRegistry.push(this.kernelProvider.onDidDisposeKernel(e=>{var t,n;(t=this.kernelDisposables.get(e))==null||t.dispose(),this.kernelDisposables.delete(e),(n=this.kernelReconnectProgress.get(e))==null||n.dispose(),this.kernelReconnectProgress.delete(e)},this)),this.disposableRegistry.push(this.kernelProvider.onDidRestartKernel(e=>{var t;(t=this.kernelReconnectProgress.get(e))==null||t.dispose(),this.kernelReconnectProgress.delete(e)},this)),this.disposableRegistry.push(Mr.onDidChangeNotebookCellExecutionState(e=>{if(!gr(e.cell.notebook)||e.state!==1)return;let t=this.kernelProvider.get(e.cell.notebook);!t||this.lastExecutedCellPerKernel.get(t)!==e.cell||this.lastExecutedCellPerKernel.delete(t)}))}getKernelSpecificDisposables(e){let t=this.kernelDisposables.get(e)||new ln;return this.disposableRegistry.push(t),this.kernelDisposables.set(e,t),t}onDidStartKernel(e){var n,i,o;if(this.kernelsStartedSuccessfully.has(e)||!((n=e.session)!=null&&n.kernel))return;let t=this.getKernelSpecificDisposables(e);t.add(Mr.onDidChangeNotebookCellExecutionState(s=>{s.cell.notebook===e.notebook&&this.kernelProvider.get(s.cell.notebook)===e&&s.state===3&&this.lastExecutedCellPerKernel.set(e,s.cell)},this)),this.kernelsStartedSuccessfully.add(e),this.kernelConnectionToKernelMapping.set(e.session.kernel,e),(o=(i=e.session)==null?void 0:i.kernel)==null||o.connectionStatusChanged.connect(this.onKernelStatusChanged,this),t.add(e.addHook("willRestart",async()=>{var s;(s=this.kernelReconnectProgress.get(e))==null||s.dispose(),this.kernelReconnectProgress.delete(e),this.kernelsRestarting.add(e)},this)),t.add(e.onRestarted(()=>this.kernelsRestarting.delete(e),this))}onKernelStatusChanged(e,t){var i,o,s,a;let n=this.kernelConnectionToKernelMapping.get(e);if(n&&!this.kernelsRestarting.has(n))switch(t){case"connected":{(i=this.kernelReconnectProgress.get(n))==null||i.dispose(),this.kernelReconnectProgress.delete(n);return}case"disconnected":{this.kernelReconnectProgress.has(n)&&((o=this.kernelReconnectProgress.get(n))==null||o.dispose(),this.kernelReconnectProgress.delete(n),(s=this.onKernelDisconnected(n))==null||s.catch(E));return}case"connecting":this.kernelReconnectProgress.has(n)||(a=this.onKernelConnecting(n))==null||a.catch(E);return;default:return}}async onKernelConnecting(e){let t=this.getKernelSpecificDisposables(e),n=Oe(),i=new Qd.Disposable(()=>n.resolve());if(this.kernelReconnectProgress.set(e,i),Wt(e.kernelConnectionMetadata)&&await this.handleRemoteServerShutdown(e,e.kernelConnectionMetadata))return;let o=W.automaticallyReconnectingToAKernelProgressMessage(lt(e.kernelConnectionMetadata));Qd.window.withProgress({location:Qd.ProgressLocation.Notification,title:o},async()=>n.promise).then(E,E),t.add(i)}async onKernelDisconnected(e){var n;if(e.disposed||e.disposing||(Rr(e.resourceUri,"DATASCIENCE.KERNEL_CRASH"),Wt(e.kernelConnectionMetadata)&&await this.handleRemoteServerShutdown(e,e.kernelConnectionMetadata)))return;let t=jt(e.kernelConnectionMetadata)?W.kernelDisconnected(lt(e.kernelConnectionMetadata)):W.remoteJupyterConnectionFailedWithServer(e.kernelConnectionMetadata.baseUrl);Qd.window.showErrorMessage(t).then(E,E);try{let i=this.lastExecutedCellPerKernel.get(e);if(!i||i.document.isClosed||i.notebook.isClosed||((n=i.executionSummary)==null?void 0:n.success)===!1)return;await Ld(i,e.controller,t,!1)}finally{await e.dispose()}}async handleRemoteServerShutdown(e,t){var o;let n=this.jupyterUriProviderRegistration.jupyterCollections.find(s=>s.extensionId===t.serverProviderHandle.extensionId&&s.id===t.serverProviderHandle.id);if(!n)return!1;let i=new Qd.CancellationTokenSource;try{return(await Promise.resolve(n.serverProvider.provideJupyterServers(i.token))||[]).map(l=>l.id).includes(t.serverProviderHandle.handle)?!1:(await this.serverUriStorage.remove(t.serverProviderHandle),(o=this.kernelReconnectProgress.get(e))==null||o.dispose(),this.kernelReconnectProgress.delete(e),!0)}catch(s){return!1}finally{i.dispose()}}};RS=U([(0,iv.injectable)(),x(0,(0,iv.inject)(ve)),x(1,(0,iv.inject)(qe)),x(2,(0,iv.inject)(pr)),x(3,(0,iv.inject)(sr))],RS);p();var Cre=ae(he());var AS=class{isTrusted(e){return!0}};AS=U([(0,Cre.injectable)()],AS);p();var MS=Symbol("ITrustedKernelPaths");p();var bP=ae(he());var i9=require("vscode");var IP=Symbol("IKernelStatusProvider"),OS=class{constructor(e,t){this.kernelProvider=e;this.disposables=[];this.restartProgressToHide=new WeakMap;this.restartProgress=new WeakMap;this.interruptProgress=new WeakMap;t.push(this)}dispose(){Ce(this.disposables)}activate(){this.kernelProvider.onDidCreateKernel(this.onDidCreateKernel,this,this.disposables),this.kernelProvider.onDidDisposeKernel(e=>{var t,n;(t=this.restartProgress.get(e))==null||t.dispose(),(n=this.interruptProgress.get(e))==null||n.dispose()},this,this.disposables)}hideRestartProgress(e){if(!this.restartProgressToHide.has(e)){let t=new i9.Disposable(()=>{this.restartProgressToHide.delete(e)});this.restartProgressToHide.set(e,t)}return this.restartProgressToHide.get(e)}onDidCreateKernel(e){e.addHook("willRestart",async()=>{var n;if(this.restartProgressToHide.has(e))return;(n=this.restartProgress.get(e))==null||n.dispose();let t=Kt.createProgressReporter(e.resourceUri,W.restartingKernelStatus(`: ${lt(e.kernelConnectionMetadata)}`));this.restartProgress.set(e,t)},this,this.disposables),e.addHook("restartCompleted",async()=>{var t,n,i;if(this.restartProgressToHide.has(e)){(t=this.restartProgressToHide.get(e))==null||t.dispose(),this.restartProgressToHide.delete(e);return}(n=this.restartProgress.get(e))==null||n.dispose(),(i=this.interruptProgress.get(e))==null||i.dispose()},this,this.disposables),e.addHook("willInterrupt",async()=>{let t=new ln,n=setTimeout(()=>{t.isDisposed||t.add(Kt.createProgressReporter(e.resourceUri,W.interruptKernelStatus(lt(e.kernelConnectionMetadata))))},1e3);t.add(new i9.Disposable(()=>clearTimeout(n))),this.interruptProgress.set(e,t)},this,this.disposables),e.addHook("interruptCompleted",async()=>{var t;return(t=this.interruptProgress.get(e))==null?void 0:t.dispose()},this,this.disposables)}};OS=U([(0,bP.injectable)(),x(0,(0,bP.inject)(qe)),x(1,(0,bP.inject)(ve))],OS);p();var SP=ae(he()),o9=require("vscode");var LS=class{constructor(e,t){this.kernelFinder=t;this.disposables=[];e.push(this)}dispose(){Ce(this.disposables)}activate(){this.startRefresh()}startRefresh(){if(!this.refreshedOnceBefore){if(this.kernelFinder.status==="discovering")return this.displayProgressIndicator();this.kernelFinder.onDidChangeStatus(()=>{this.kernelFinder.status==="discovering"&&this.displayProgressIndicator()},this,this.disposables)}}displayProgressIndicator(){let e=Date.now().toString();C.debug(`Start refreshing Kernel Picker (${e})`);let t=o9.notebooks.createNotebookControllerDetectionTask(St),n=o9.notebooks.createNotebookControllerDetectionTask(yr);this.disposables.push(t),this.disposables.push(n),this.kernelFinder.onDidChangeStatus(()=>{this.kernelFinder.status==="idle"&&(C.debug(`End refreshing Kernel Picker (${e})`),t.dispose(),n.dispose())},this,this.disposables)}};LS=U([(0,SP.injectable)(),x(0,(0,SP.inject)(ve)),x(1,(0,SP.inject)(ri))],LS);p();var FS=ae(he());var r_e=1e3,KS=class{constructor(e,t,n){this.serverStorage=e;this.kernelProvider=t;this.disposables=[];this.timeouts=new Set;this.kernelSpecificUpdates=new WeakMap;n.push(this)}dispose(){Ce(this.disposables),Ce(Array.from(this.timeouts.values()))}activate(){this.disposables.push(Mr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this))}onDidChangeNotebookCellExecutionState(e){let t=this.kernelProvider.get(e.cell.notebook);if(!t)return;let n=t.kernelConnectionMetadata;if(!Wt(n))return;let i=this.kernelSpecificUpdates.get(t)||new rc(r_e);this.kernelSpecificUpdates.set(t,i),i.trigger(()=>{t.disposed||t.disposing||this.serverStorage.update(n.serverProviderHandle).catch(E)})}};KS=U([(0,FS.injectable)(),x(0,(0,FS.inject)(pr)),x(1,(0,FS.inject)(qe)),x(2,(0,FS.inject)(ve))],KS);p();var wre=ae(he());var US=class{async installMissingDependencies(e){return 1}async areDependenciesInstalled(e,t,n){return!1}};US=U([(0,wre.injectable)()],US);p();var xre=ae(he());var WS=class{constructor(){this.providers=new Map}getProviders(e){return(this.providers.get(e)||[]).slice()}register(e,t){this.providers.set(t,this.providers.get(t)||[]),this.providers.get(t).push(e)}};WS=U([(0,xre.injectable)()],WS);p();var ov=ae(he());var Dre=require("vscode");var Pre=1e3*60*60*24*2,Vl=class extends Pr{constructor(t,n,i,o){super();this.serverStorage=n;this.context=i;this.fs=o;this.executedCells=new WeakMap;this.chainedPromises=Promise.resolve();i.globalStorageUri,t.push(this),this.storageFile=Dre.Uri.joinPath(this.context.globalStorageUri,"lastExecutedRemoteCell.json")}activate(){this._register(this.serverStorage.onDidRemove(this.onDidRemoveServers,this))}async getLastTrackedCellExecution(t,n){var s;if(t.isUntitled||!Wt(n.kernelConnectionMetadata)||!((s=n.session)!=null&&s.id))return;if(this.staleState&&this.staleState[t.uri.toString()])return this.staleState[t.uri.toString()];let i=await this.getStorageFile(),o={};try{let a=await this.fs.readFile(i);o=JSON.parse(a.toString()),this.staleState=o}catch(a){return}return o[t.uri.toString()]}trackCellExecution(t,n){if(!Wt(n.kernelConnectionMetadata)||t.document.isUntitled)return;this.executedCells.delete(t);let i=[],o=(a,l)=>{var u,c;if(l.direction==="send"){let d=l.msg;if(d.header.msg_type==="execute_request"&&d.metadata&&typeof d.metadata=="object"&&d.metadata&&"cellId"in d.metadata&&typeof d.metadata.cellId=="string"&&d.metadata.cellId===t.document.uri.toString()){let f=d.header.msg_id;this.executedCells.set(t,{msg_id:f,kernelId:((c=(u=n.session)==null?void 0:u.kernel)==null?void 0:c.id)||"",cellIndex:t.index})}}else if(l.direction==="recv"){let d=l.msg,f=this.executedCells.get(t);if(f!=null&&f.msg_id&&Gd(d)===f.msg_id){if(!f.startTime){f.startTime=new Date().getTime();try{f.startTime=new Date(d.header.date).getTime()}catch(m){}this.executedCells.set(t,f)}"execution_count"in d.content&&typeof d.content.execution_count=="number"&&!f.executionCount&&f.executionCount!==d.content.execution_count&&(f.executionCount=d.content.execution_count,this.executedCells.set(t,f),this.trackLastExecution(t,n,f),Ce(i))}}},s=()=>{let a=n.session;a&&(a.anyMessage.connect(o),i.push({dispose:()=>zs(()=>{var l;return(l=a.anyMessage)==null?void 0:l.disconnect(o)})}))};n.onStarted(()=>s(),i),n.session&&s()}deleteTrackedCellExecution(t,n){var i;t.notebook.isUntitled||!Wt(n.kernelConnectionMetadata)||!((i=n.session)!=null&&i.id)||(this.chainedPromises=this.chainedPromises.finally(async()=>{let o={};try{let a=await this.getStorageFile().then(()=>this.fs.readFile(this.storageFile));o=JSON.parse(a.toString())}catch(a){return}let s=t.notebook.uri.toString();o[s].cellIndex===t.index&&(delete o[s],this.staleState=o,await this.fs.writeFile(this.storageFile,JSON.stringify(o)))}))}getStorageFile(){return this.ensureStorageExistsPromise=this.ensureStorageExistsPromise||(async()=>(await this.fs.createDirectory(this.context.globalStorageUri),this.storageFile))(),this.ensureStorageExistsPromise}trackLastExecution(t,n,i){var s,a,l,u;if(!i.executionCount||!i.msg_id||!i.startTime||!Wt(n.kernelConnectionMetadata)||!((s=n.session)!=null&&s.id))return;let o={cellIndex:t.index,executionCount:i.executionCount,kernelId:((l=(a=n.session)==null?void 0:a.kernel)==null?void 0:l.id)||"",msg_id:i.msg_id,serverId:Vt(n.kernelConnectionMetadata.serverProviderHandle),sessionId:(u=n.session)==null?void 0:u.id,startTime:i.startTime};this.chainedPromises=this.chainedPromises.finally(async()=>{let c={};try{let f=await this.getStorageFile().then(()=>this.fs.readFile(this.storageFile));c=JSON.parse(f.toString())}catch(f){}let d=t.notebook.uri.toString();c[d]=o,this.removeOldItems(c),this.staleState=c,await this.fs.writeFile(this.storageFile,JSON.stringify(c))})}onDidRemoveServers(t){t.length!==0&&(this.chainedPromises=this.chainedPromises.finally(async()=>{await this.getStorageFile();let n={};try{let s=await this.fs.readFile(this.storageFile);n=JSON.parse(s.toString())}catch(s){}let i=!1,o=new Set(t.map(s=>Vt(s)));Object.keys(n).forEach(s=>{let a=n[s];(o.has(a.serverId)||Date.now()-a.startTime>Pre)&&(delete n[s],i=!0)}),i&&(this.removeOldItems(n),this.staleState=n,await this.fs.writeFile(this.storageFile,JSON.stringify(n)))}))}removeOldItems(t){Object.keys(t).forEach(n=>{let i=t[n];i&&Date.now()-i.startTime>Pre&&delete t[n]})}};Vl=U([(0,ov.injectable)(),x(0,(0,ov.inject)(ve)),x(1,(0,ov.inject)(pr)),x(2,(0,ov.inject)(st)),x(3,(0,ov.inject)(Pt))],Vl);p();var jS=ae(he());var _P=require("vscode");var VS=class{constructor(e,t,n){this.serverUriStorage=e;this.registrations=t;this.disposables=n}activate(){this.disposables.push(_P.commands.registerCommand(de.ClearSavedJupyterUris,async()=>{await this.serverUriStorage.clear().catch(E),await Promise.all(this.registrations.jupyterCollections.filter(e=>e.id.startsWith("_builtin")||e.extensionId===Ge).map(async e=>{if(!e.serverProvider||!e.serverProvider.removeJupyterServer)return;let t=new _P.CancellationTokenSource,n=await Promise.resolve(e.serverProvider.provideJupyterServers(t.token));await Promise.all((n||[]).map(i=>e.serverProvider.removeJupyterServer(i).catch(E)))})).catch(E),await _P.commands.executeCommand("dataScience.ClearUserProviderJupyterServerCache").then(E,E)},this))}};VS=U([(0,jS.injectable)(),x(0,(0,jS.inject)(pr)),x(1,(0,jS.inject)(sr)),x(2,(0,jS.inject)(ve))],VS);p();var oM=ae(he());var BS=class{constructor(e){this.registry=e;this.priority=0}activate(){this.registry.register(this,St),this.registry.register(this,yr)}async getCode(e){return Qt(e.kernelConnectionMetadata)?[JZ]:[]}};BS=U([(0,oM.injectable)(),x(0,(0,oM.inject)(Md))],BS);var EP=class{constructor(){this.isSupported=!1}};EP=U([(0,Tre.injectable)()],EP);function kre(r,e){r.addSingleton(Hd,EP),Gb("isInsiderExtension",Vv()?"true":"false");let t=r.get(bo);Gb("isPythonExtensionInstalled",t.isPythonExtensionInstalled?"true":"false");let n=r.get(Hd);Gb("rawKernelSupported",n.isSupported?"true":"false"),r.addSingleton(Md,WS),r.addSingleton(Ki,nv,nt.ALL_VARIABLES),r.addSingleton(Ve,zg),r.addSingleton(Ve,LS),r.addSingleton(IP,OS),r.addBinding(IP,Ve),r.addSingleton(Ve,RS),r.addSingleton(Ve,KS),r.addSingleton(qe,DS),r.addSingleton(MS,AS),r.addSingleton(jg,TS),r.addSingleton(js,js),r.addSingleton(ri,kS),r.addSingleton(II,US),r.addSingleton(Ve,VS),r.addSingleton(Vl,Vl),r.addBinding(Vl,Ve),fre(r,e),r.addSingleton(Ve,on),r.addSingleton(Ve,BS)}p();p();var HS=ae(he()),av=require("vscode");var sv=class{constructor(e,t,n){this.disposables=e;this.controllerRegistration=t;this.preferredRemoteKernelIdProvider=n}activate(){av.workspace.onDidOpenNotebookDocument(this.onDidOpenNotebook,this,this.disposables),av.workspace.notebookDocuments.forEach(e=>this.onDidOpenNotebook(e))}async onDidOpenNotebook(e){if(!gr(e))return;let t=await this.preferredRemoteKernelIdProvider.getPreferredRemoteKernelId(e);if(!t)return;let n=()=>{let o=this.controllerRegistration.getSelected(e),s=this.controllerRegistration.registered.find(a=>a.id===t);return s&&(o==null?void 0:o.id)!==s.id?(this.switchKernel(e,s.connection).catch(E),!0):!1};if(n())return;let i=this.controllerRegistration.onDidChange(o=>{o.added.length&&n()&&i.dispose()},this,this.disposables);this.controllerRegistration.onControllerSelected(o=>{o.notebook===e&&i.dispose()},this,this.disposables)}async switchKernel(e,t){C.debug(`Using notebook.selectKernel to force remote kernel for ${Ee(e.uri)} to ${t.id}`),await av.commands.executeCommand("notebook.selectKernel",{id:t.id,extension:Ge}),await gD(async()=>{var i;if(((i=av.window.activeNotebookEditor)==null?void 0:i.notebook)===e){let o=this.controllerRegistration.getSelected(e);if((o==null?void 0:o.connection.id)===t.id)return o.restoreConnection(e).catch(E),!0}return!1},2e3,100)?C.debug(`Successfully switched remote kernel for ${Ee(e.uri)} to ${t.id}`):C.warn(`Failed to switch remote kernel for ${Ee(e.uri)} to ${t.id}`)}};U([yn()],sv.prototype,"onDidOpenNotebook",1),sv=U([(0,HS.injectable)(),x(0,(0,HS.inject)(ve)),x(1,(0,HS.inject)(Nt)),x(2,(0,HS.inject)(js))],sv);p();var qS=ae(he()),lm=require("vscode");p();var Nre=Symbol("IServiceManager"),Ar=Symbol("IServiceContainer");p();var gs=require("vscode");p();function yu(r){if(typeof r!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof r}\``);var e=Are();let t=e;return t.default&&(t=t.default),r.replace(t(),"")}p();p();var wP=ae(he()),c9=require("vscode");p();var l9=require("vscode");p();function s9(r){if(!r||!Array.isArray(r)||r.length===0)return;let e=[];for(let t=0;t<r.length;t+=1){let n=r[t];if("buffer"in n&&"byteOffset"in n){let i=Array.apply(null,new Uint8Array(n.buffer));e.push({...n,byteLength:n.byteLength,byteOffset:n.byteOffset,buffer:i})}else e.push([...new Uint8Array(n)])}return e}function a9(r){if(!Array.isArray(r)||r.length===0)return r;let e=[];for(let t=0;t<r.length;t+=1){let n=r[t];if("buffer"in n&&"byteOffset"in n){let i=new Uint8Array(n.buffer).buffer,o=new DataView(i,n.byteOffset,n.byteLength);e.push(o)}else{let i=new Uint8Array(n).buffer;e.push(i)}}return e}var CP=new WeakMap;function Mre(r,e){let t=CP.get(r);t&&(t.targets.add(e),t.registerCommTarget(e))}function Ore(r,e){var t,n,i;(i=(n=(t=CP.get(r))==null?void 0:t.targets)==null?void 0:n.delete)==null||i.call(n,e)}var sM=class{constructor(e,t){this.kernelProvider=e;this.document=t;this.commTargetsRegistered=new Set;this.pendingTargetNames=new Set;this._postMessageEmitter=new l9.EventEmitter;this._onDisplayMessage=new l9.EventEmitter;this.onDisplayMessage=this._onDisplayMessage.event;this.messageHooks=new Map;this.pendingHookRemovals=new Map;this.messageHookRequests=new Map;this.disposables=[];this.disposed=!1;this.pendingMessages=[];this.subscribedToKernelSocket=!1;this.waitingMessageIds=new Map;this.outputWidgetIds=new Set;this.isUsingIPyWidgets=!1;this.kernelSocketHandlers=new WeakMap;this.pendingTargetNames.add("jupyter.widget"),e.onDidStartKernel(i=>{i.notebook===t&&this.initialize()},this,this.disposables),this.mirrorSend=this.mirrorSend.bind(this),this.onKernelSocketMessage=this.onKernelSocketMessage.bind(this);let n=nV();this.deserialize=n.deserialize}get postMessage(){return this._postMessageEmitter.event}dispose(){for(this.disposed=!0;this.disposables.length;){let e=this.disposables.shift();e==null||e.dispose()}}receiveMessage(e){switch(e.message){case"IPyWidgets_logMessage":{let t=e.payload;t.category==="error"?C.error(`Widget Error: ${t.message}`):C.trace(`Widget Message: ${t.message}`);break}case"IPyWidgets_Ready":this.sendKernelOptions(),this.initialize();break;case"IPyWidgets_msg":this.sendRawPayloadToKernelSocket(e.payload);break;case"IPyWidgets_binary_msg":this.sendRawPayloadToKernelSocket(a9(e.payload)[0]);break;case"IPyWidgets_msg_received":this.onKernelSocketResponse(e.payload);break;case"IPyWidgets_registerCommTarget":this.registerCommTarget(e.payload);break;case"IPyWidgets_RegisterMessageHook":this.registerMessageHook(e.payload);break;case"IPyWidgets_RemoveMessageHook":this.possiblyRemoveMessageHook(e.payload);break;case"IPyWidgets_MessageHookResult":this.handleMessageHookResponse(e.payload);break;case"IPyWidgets_iopub_msg_handled":this.iopubMessageHandled(e.payload);break;default:break}}sendRawPayloadToKernelSocket(e){this.pendingMessages.push(e),this.sendPendingMessages()}registerCommTarget(e){this.pendingTargetNames.add(e),this.initialize()}initialize(){this.jupyterLab||(this.jupyterLab=Bn());let e=this.getKernel();e&&(this.subscribeToKernelSocket(e),this.registerCommTargets(e))}raisePostMessage(e,t){this._postMessageEmitter.fire({message:e,payload:t})}subscribeToKernelSocket(e){var n;if(this.subscribedToKernelSocket||!e.session)return;this.subscribedToKernelSocket=!0,this.subscribeToKernelSocketImpl(e);let t=(n=e.session.kernel)==null?void 0:n.id;e.session.onDidKernelSocketChange(()=>{var i,o;this.subscribeToKernelSocketImpl(e,t),t=((o=(i=e.session)==null?void 0:i.kernel)==null?void 0:o.id)||""})}subscribeToKernelSocketImpl(e,t){var l,u,c,d,f;let n=t?Ko.get(t):void 0,i=n?this.kernelSocketHandlers.get(n):void 0;if(i!=null&&i.receiveHook&&(n==null||n.removeReceiveHook(i.receiveHook)),i!=null&&i.sendHook&&(n==null||n.removeSendHook(i.sendHook)),this.kernelWasConnectedAtLeastOnce){for(;this.pendingMessages.length;)this.pendingMessages.shift();this.waitingMessageIds.forEach(m=>m.resultPromise.resolve()),this.waitingMessageIds.clear(),this.messageHookRequests.forEach(m=>m.resolve(!1)),this.messageHookRequests.clear(),this.messageHooks.clear(),this.sendRestartKernel()}if(!((u=(l=e.session)==null?void 0:l.kernel)!=null&&u.id)||!Ko.get((d=(c=e.session)==null?void 0:c.kernel)==null?void 0:d.id))return;CP.has(e.session.kernel)||CP.set(e.session.kernel,{targets:new Set,registerCommTarget:m=>{this.raisePostMessage("IPyWidgets_registerCommTarget",m)}}),this.kernelWasConnectedAtLeastOnce=!0;let o=(f=e.session.kernel)==null?void 0:f.id,s=o?Ko.get(o):void 0,a=(s==null?void 0:s.protocol)||"";if(s){let m=this.onKernelSocketMessage.bind(this,a),g=this.mirrorSend.bind(this,a);s.addReceiveHook(m),s.addSendHook(g),this.kernelSocketHandlers.set(s,{receiveHook:m,sendHook:g})}this.sendKernelOptions(a),this.registerCommTargets(e),this.sendPendingMessages(a)}sendKernelOptions(e=""){var n,i,o;let t=(i=(n=this.kernel)==null?void 0:n.session)==null?void 0:i.kernel;t&&(e||(e=((o=Ko.get(t.id))==null?void 0:o.protocol)||""),this.raisePostMessage("IPyWidgets_kernelOptions",{id:t.id,clientId:t.clientId||"",userName:t.username||"",model:t.model||{id:"",name:""},protocol:e}))}async mirrorSend(e,t,n){if(typeof t=="string"&&t.includes("shell")&&t.includes("execute_request")){let i=typeof t=="string"?JSON.parse(t):this.deserialize(t);if(i.channel==="shell"&&i.header.msg_type==="execute_request"){if(!vP(i))return;let o=this.mirrorExecuteRequest(i);this.isUsingIPyWidgets&&await o}}else if(typeof t!="string")try{let i=this.deserialize(t,e);if(i.channel==="shell"&&i.header.msg_type==="execute_request"){if(!vP(i))return;let o=this.mirrorExecuteRequest(i);this.isUsingIPyWidgets&&await o}}catch(i){C.error("Failed to mirror message to kernel",i)}}sendRestartKernel(){this.raisePostMessage("IPyWidgets_onRestartKernel",void 0)}mirrorExecuteRequest(e){let t=Oe();return this.waitingMessageIds.set(e.header.msg_id,{startTime:Date.now(),resultPromise:t}),this.raisePostMessage("IPyWidgets_mirror_execute",{id:e.header.msg_id,msg:e}),t.promise}messageNeedsFullHandle(e){var t,n,i,o;return e.channel==="iopub"&&((t=e.header)==null?void 0:t.msg_type)==="comm_msg"&&((i=(n=e.content)==null?void 0:n.data)==null?void 0:i.method)==="update"&&this.outputWidgetIds.has((o=e.content)==null?void 0:o.comm_id)}iopubMessageHandled(e){let t=e.id;this.fullHandleMessage&&this.fullHandleMessage.id===t&&(this.fullHandleMessage.promise.resolve(),this.fullHandleMessage=void 0)}async onKernelSocketMessage(e,t){var a,l,u,c,d,f,m,g,b;let n=Oi(),i=Oe();this.waitingMessageIds.set(n,{startTime:Date.now(),resultPromise:i});let o;if(typeof t=="string")vP(t)&&(this.raisePostMessage("IPyWidgets_msg",{id:n,data:t}),t.includes("display_data")&&(o=this.deserialize(t,e),Bn().KernelMessage.isDisplayDataMsg(o)&&this._onDisplayMessage.fire(o)));else{let v=s9([t]),k=a9(v);console.error(v,k),this.raisePostMessage("IPyWidgets_binary_msg",{id:n,data:s9([t])})}if(typeof t!="string"||t.includes(mo)||t.includes(nt.DefaultCommTarget)||t.includes("comm_open")||t.includes("comm_close")||t.includes("comm_msg")){let v=o||this.deserialize(t,e);if(!vP(v))return;v&&v.content&&v.content.data&&(v.content.data[mo]||v.content.target_name===nt.DefaultCommTarget)&&(this.isUsingIPyWidgets=!0);let k=((a=v.header)==null?void 0:a.msg_type)==="comm_open"&&((c=(u=(l=v.content)==null?void 0:l.data)==null?void 0:u.state)==null?void 0:c._model_module)==="@jupyter-widgets/output"&&((m=(f=(d=v.content)==null?void 0:d.data)==null?void 0:f.state)==null?void 0:m._model_name)==="OutputModel",R=((g=v.header)==null?void 0:g.msg_type)==="comm_close"&&this.outputWidgetIds.has((b=v.content)==null?void 0:b.comm_id);k?this.outputWidgetIds.add(v.content.comm_id):R?this.outputWidgetIds.delete(v.content.comm_id):this.messageNeedsFullHandle(v)&&(this.fullHandleMessage={id:v.header.msg_id,promise:Oe()},await i.promise,await this.fullHandleMessage.promise.promise,this.fullHandleMessage=void 0)}}onKernelSocketResponse(e){let t=this.waitingMessageIds.get(e.id);t&&(this.waitingMessageIds.delete(e.id),t.resultPromise.resolve())}sendPendingMessages(e=""){var t,n,i,o;if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel)for(e||(e=((i=Ko.get(this.kernel.session.kernel.id))==null?void 0:i.protocol)||"");this.pendingMessages.length;)try{let s=this.pendingMessages[0],a=typeof s=="string"?JSON.parse(s):this.deserialize(s,e);(o=a.buffers)!=null&&o.length&&(a.buffers=a.buffers.map(l=>l instanceof DataView?l.buffer:l)),a.channel==="control"?this.kernel.session.kernel.sendControlMessage(a):this.kernel.session.kernel.sendShellMessage(a),this.pendingMessages.shift()}catch(s){C.error("Failed to send message to Kernel",s);return}}registerCommTargets(e){var t,n,i;for(;this.pendingTargetNames.size>0;){let s=Array.from([...this.pendingTargetNames.values()]).shift();if(s){if(this.commTargetsRegistered.has(s))return;C.trace(`Registering commtarget ${s}`),this.commTargetsRegistered.add(s),this.pendingTargetNames.delete(s),(t=e.session)!=null&&t.kernel&&s!==nt.DefaultCommTarget&&!((i=(n=CP.get(e.session.kernel))==null?void 0:n.targets)!=null&&i.has(s))&&e.session.kernel.registerCommTarget(s,E)}}}getKernel(){var e,t;return this.document&&!((e=this.kernel)!=null&&e.session)&&(this.kernel=this.kernelProvider.get(this.document),(t=this.kernel)==null||t.onDisposed(()=>this.kernel=void 0)),this.kernel&&!this.kernelRestartHandlerAttached&&(this.kernelRestartHandlerAttached=!0,this.disposables.push(this.kernel.onRestarted(this.handleKernelRestarts,this))),this.kernel}async handleKernelRestarts(){var e;this.disposed||this.commTargetsRegistered.size===0||!((e=this.kernel)!=null&&e.session)||(Array.from(this.commTargetsRegistered.keys()).forEach(t=>{this.commTargetsRegistered.delete(t),this.pendingTargetNames.add(t)}),this.subscribeToKernelSocket(this.kernel),this.registerCommTargets(this.kernel))}registerMessageHook(e){var t,n;try{if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel&&!this.messageHooks.has(e)){let i=this.messageHookCallback.bind(this);this.messageHooks.set(e,i),this.kernel.session.kernel.registerMessageHook(e,i)}}finally{this.raisePostMessage("IPyWidgets_ExtensionOperationHandled",{id:e,type:"IPyWidgets_RegisterMessageHook"})}}possiblyRemoveMessageHook(e){try{e.lastHookedMsgId?this.pendingHookRemovals.set(e.lastHookedMsgId,e.hookMsgId):this.removeMessageHook(e.hookMsgId)}finally{this.raisePostMessage("IPyWidgets_ExtensionOperationHandled",{id:e.hookMsgId,type:"IPyWidgets_RemoveMessageHook"})}}removeMessageHook(e){var t,n;if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel&&this.messageHooks.has(e)){let i=this.messageHooks.get(e);this.messageHooks.delete(e),this.kernel.session.kernel.removeMessageHook(e,i)}}async messageHookCallback(e){let t=Oe(),n=Oi(),i=e.parent_header.msg_id;if(this.messageHooks.has(i)?(this.messageHookRequests.set(n,t),this.raisePostMessage("IPyWidgets_MessageHookCall",{requestId:n,parentId:i,msg:e})):t.resolve(!0),this.pendingHookRemovals.has(e.header.msg_id)){let o=this.pendingHookRemovals.get(e.header.msg_id);this.pendingHookRemovals.delete(e.header.msg_id),this.removeMessageHook(o)}return t.promise}handleMessageHookResponse(e){let t=this.messageHookRequests.get(e.requestId);t&&(this.messageHookRequests.delete(e.requestId),t.resolve(e.msgType.includes("comm")?!0:e.result))}};var u9=class{constructor(e,t){this.baseMulticaster=e;this.oldMessages=t;this._postMessageEmitter=new c9.EventEmitter;this._onDisplayMessage=new c9.EventEmitter;this.onDisplayMessage=this._onDisplayMessage.event;this.disposables=[];e.postMessage(this.raisePostMessage,this,this.disposables),e.onDisplayMessage(n=>{this._onDisplayMessage.fire(n)},this,this.disposables)}get postMessage(){return this._postMessageEmitter.event}dispose(){for(;this.disposables.length;){let e=this.disposables.shift();e==null||e.dispose()}}initialize(){return this.baseMulticaster.initialize()}receiveMessage(e){this.baseMulticaster.receiveMessage(e)}raisePostMessage(e){this.oldMessages.forEach(t=>{this._postMessageEmitter.fire(t)}),this.oldMessages=[],this._postMessageEmitter.fire(e)}},jl=class{constructor(e,t){this.kernelProvider=t;this.messageDispatchers=new WeakMap;this.messagesPerNotebook=new WeakMap;this.disposed=!1;this.disposables=[];e.push(this),t.onDidDisposeKernel(this.trackDisposingOfKernels,this,e)}dispose(){var e;for(this.disposed=!0;this.disposables.length;)(e=this.disposables.shift())==null||e.dispose()}create(e){let t=this.messageDispatchers.get(e);t||(t=new sM(this.kernelProvider,e),this.messageDispatchers.set(e,t),this.disposables.push(t.postMessage(o=>this.onMessage(o,e),this)));let n=[];e&&this.messagesPerNotebook.get(e)&&(n=this.messagesPerNotebook.get(e)||[]);let i=new u9(t,n);return this.disposables.push(i),i}trackDisposingOfKernels(e){if(this.disposed)return;let t=e.notebook,n=this.messageDispatchers.get(t);this.messageDispatchers.delete(t),n==null||n.dispose()}onMessage(e,t){t&&(this.messagesPerNotebook.set(t,this.messagesPerNotebook.get(t)||[]),(e.message==="IPyWidgets_kernelOptions"||e.message==="IPyWidgets_registerCommTarget")&&this.messagesPerNotebook.get(t).push(e))}};jl=U([(0,wP.injectable)(),x(0,(0,wP.inject)(ve)),x(1,(0,wP.inject)(qe))],jl);p();var Vre=require("vscode");p();var Lre=require("vscode");var lv=class lv extends Pr{constructor(t,n,i,o,s,a){super();this.kernel=t;this.localResourceUriConverter=n;this.configurationSettings=i;this.sourceProviderFactory=o;this.isWebViewOnline=s;this.cdnScriptProvider=a;this.id="all";this.scriptProviders=this.sourceProviderFactory.getProviders(this.kernel,this.localResourceUriConverter),this.scriptProviders.forEach(l=>this._register(l)),this.monitorKernel()}get configuredScriptSources(){return this.configurationSettings.getSettings(void 0).widgetScriptSources}async getBaseUrl(){let t=this.scriptProviders.find(n=>n.getBaseUrl);if(t)return t.getBaseUrl()}async getWidgetScriptSources(){let t=[];return await Promise.all(this.scriptProviders.map(async n=>{n.getWidgetScriptSources&&t.push(...await n.getWidgetScriptSources())})),t}async getWidgetScriptSource(t,n){let i=await this.isWebViewOnline,o=this.scriptProviders.slice(),s={moduleName:t};for(;o.length;){let a=o.shift();if(!a)continue;let l=await a.getWidgetScriptSource(t,n,i);if(l.scriptUri){s=l;break}else C.warn(`Widget Script Source not found for ${t}@${n} from ${a.id}`)}return this.sendTelemetryForWidgetModule(t,n,"",s.source).catch(E),s.scriptUri?C.trace(`Script source for Widget ${t}@${n} was found from source ${s.source} and ${s.scriptUri}`):C.error(`Script source for Widget ${t}@${n} not found in ${this.scriptProviders.map(a=>a.id).join(", ")}`),s}async sendTelemetryForWidgetModule(t,n,i,o){let s=`${t}.${t}@${n}`;if(lv.trackedWidgetModuleNames.has(s))return;lv.trackedWidgetModuleNames.add(s);let a=t.toLowerCase().startsWith("@jupyter-widgets"),l=o==="cdn"||a||await this.cdnScriptProvider.isOnCDN(t),u=l?t.replace(/\//g,"_").replace(/\\/g,"_").replace(/@/g,"_at_"):void 0,c=l?i.replace(/\//g,"_").replace(/\\/g,"_").replace(/@/g,"_at_"):void 0;ne("DS_INTERNAL.IPYWIDGET_USED_BY_USER",void 0,{hashedName:await Rt(t),moduleName:u,modelName:c,source:o,moduleVersion:l?n:void 0,cdnSearched:this.configuredScriptSources.length>0})}monitorKernel(){this.hookKernelEvents(),this._register(this.kernel.onStarted(this.hookKernelEvents,this)),this._register(this.kernel.onRestarted(this.hookKernelEvents,this)),this._register(this.kernel.onDidKernelSocketChange(()=>this.hookKernelEvents(),this))}hookKernelEvents(){var n;let t=(n=this.kernel.session)==null?void 0:n.kernel;t&&(t.anyMessage.connect(this.onAnyMessage,this),this._register(new Lre.Disposable(()=>t.anyMessage.disconnect(this.onAnyMessage,this))))}onAnyMessage(t,n){var i,o,s,a;if(n.direction==="recv"&&n.msg.header.msg_type==="comm_open"){let u=n.msg.content.data;(i=u.state)!=null&&i._model_module&&u.state._model_name&&this.sendTelemetryForWidgetModule((o=u.state)==null?void 0:o._model_module,((s=u.state)==null?void 0:s._model_module_version)||"",(a=u.state)==null?void 0:a._model_name).catch(E)}}};lv.trackedWidgetModuleNames=new Set,U([yn()],lv.prototype,"sendTelemetryForWidgetModule",1),U([yn()],lv.prototype,"onAnyMessage",1);var lM=lv;p();var cM=class{constructor(e,t){this.isWebExtension=e;this.converter=t}async asWebviewUri(e){return this.isWebExtension?e:this.converter(e)}};p();var d9=class{constructor(e,t){this.uri=e;this.value=t}};function i_e(r){return Array.isArray(r)}var Fre,cv=class cv{constructor(e,t){this[Fre]="ResourceMap";if(e instanceof cv)this.map=new Map(e.map),this.toKey=t!=null?t:cv.defaultToKey;else if(i_e(e)){this.map=new Map,this.toKey=t!=null?t:cv.defaultToKey;for(let[n,i]of e)this.set(n,i)}else this.map=new Map,this.toKey=e!=null?e:cv.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new d9(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))==null?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t!="undefined"&&(e=e.bind(t));for(let[,n]of this.map)e(n.value,n.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[(Fre=Symbol.toStringTag,Symbol.iterator)](){for(let[,e]of this.map)yield[e.uri,e.value]}};cv.defaultToKey=e=>e.toString();var bu=cv,Ure,uM=class{constructor(e,t){this[Ure]="ResourceSet";!e||typeof e=="function"?this._map=new bu(e):(this._map=new bu(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,i)=>e.call(t,i,i,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(Ure=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}};var Wre,Kre=class{constructor(){this[Wre]="LinkedMap";this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let i=this._map.get(e);if(i)i.value=t,n!==0&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.key,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.value,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:[n.key,n.value],done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}[(Wre=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}};var dM=class{constructor(e,t,n,i,o,s){this.document=e;this.kernelProvider=t;this.configurationSettings=i;this.sourceProviderFactory=o;this.cdnScriptProvider=s;this.postEmitter=new Vre.EventEmitter;this.disposables=[];this.isWebViewOnline=Oe();this.widgetSources=new Map;this.pendingModuleRequests=new Map;this.uriTranslationRequests=new bu;this.uriConverter=new cM(zr(),a=>(this.uriTranslationRequests.has(a)||this.uriTranslationRequests.set(a,Oe()),this.postEmitter.fire({message:"ConvertUriForUseInWebViewRequest",payload:a}),this.uriTranslationRequests.get(a).promise)),this.isWebViewOnline.promise.catch(E),n.push(this),this.kernelProvider.onDidStartKernel(a=>{a.notebook===this.document&&this.initialize()},this,this.disposables)}get postMessage(){return this.postEmitter.event}dispose(){var e;for(;this.disposables.length;)(e=this.disposables.shift())==null||e.dispose()}onMessage(e,t){if(e==="ConvertUriForUseInWebViewResponse"){let n=t;n&&this.uriTranslationRequests.has(n.request)&&this.uriTranslationRequests.get(n.request).resolve(n.response)}else if(e==="IPyWidgets_Ready")this.sendBaseUrl(),this.sendWidgetScriptSources().catch(E);else if(e==="IPyWidgets_IsOnline"){let n=t.isOnline;this.isWebViewOnline.resolve(n)}else e==="IPyWidgets_WidgetScriptSourceRequest"&&t&&this.onRequestWidgetScript(t).catch(E)}initialize(){var e;this.jupyterLab||(this.jupyterLab=Bn()),this.kernel||(this.kernel=this.kernelProvider.get(this.document)),(e=this.kernel)!=null&&e.session&&(this.scriptProvider&&!this.scriptProvider.isDisposed||(this.scriptProvider=new lM(this.kernel,this.uriConverter,this.configurationSettings,this.sourceProviderFactory,this.isWebViewOnline.promise,this.cdnScriptProvider),this.kernel.onDisposed(()=>this.dispose()),this.handlePendingRequests(),this.sendBaseUrl(),C.trace("IPyWidgetScriptSource.initialize")))}sendBaseUrl(){this.scriptProvider&&this.scriptProvider.getBaseUrl().then(e=>{e&&this.postEmitter.fire({message:"IPyWidgets_BaseUrl_Response",payload:e.toString()})}).catch(e=>C.error("Failed to get baseUrl",e))}async sendWidgetScriptSources(){if(this.scriptProvider&&!this.allWidgetScriptsSent)try{(await this.scriptProvider.getWidgetScriptSources()).forEach(t=>{var n;((n=this.widgetSources.get(t.moduleName))==null?void 0:n.source)!=="cdn"&&this.widgetSources.set(t.moduleName,t),this.postEmitter.fire({message:"IPyWidgets_WidgetScriptSource_Response",payload:t})})}catch(e){C.warn("Failed to fetch script sources",e)}finally{this.allWidgetScriptsSent=!0}}async onRequestWidgetScript(e){let{moduleName:t,moduleVersion:n,requestId:i}=e;if(C.trace(`\x1B[32mFetch Script for ${JSON.stringify(e)}`),await this.sendWidgetSource(t,n,i).catch(o=>C.error("Failed to send widget sources upon ready",o)),this.scriptProvider&&!this.allWidgetScriptsSent)try{await this.sendWidgetScriptSources()}finally{this.sendWidgetSource(t,n,i).catch(o=>C.error("Failed to send widget sources upon ready",o))}}async sendWidgetSource(e,t="*",n){var o;if(!e||e.startsWith("@jupyter"))return;if(!this.kernel||!this.scriptProvider){this.pendingModuleRequests.set(e,{moduleVersion:t,requestId:n});return}let i={moduleName:e,requestId:n};try{C.trace(`\x1B[32mFetch Script for ${e}`),i=await this.scriptProvider.getWidgetScriptSource(e,t),((o=this.widgetSources.get(i.moduleName))==null?void 0:o.source)!=="cdn"&&this.widgetSources.set(i.moduleName,i)}catch(s){C.error("Failed to get widget source due to an error",s),ne("DS_INTERNAL.IPYWIDGET_DISCOVERY_ERRORED")}finally{C.trace(`\x1B[32mScript for ${e}, is ${i.scriptUri} from ${i.source}`),this.postEmitter.fire({message:"IPyWidgets_WidgetScriptSource_Response",payload:i})}}handlePendingRequests(){let e=Array.from(this.pendingModuleRequests.keys());for(;e.length;){let t=e.shift();if(t){let{moduleVersion:n,requestId:i}=this.pendingModuleRequests.get(t);this.pendingModuleRequests.delete(t),this.sendWidgetSource(t,n,i).catch(o=>C.error(`Failed to send WidgetScript for ${t}`,o))}}}};p();var fM=Symbol("IWidgetScriptSourceProviderFactory"),jre=Symbol("INbExtensionsPathProvider"),mM=Symbol("IIPyWidgetScriptManagerFactory"),hIt=Symbol("IIPyWidgetScriptManager");p();var uv=ae(he()),hs=require("vscode");var qre="https://unpkg.com/",f9="https://cdn.jsdelivr.net/npm/",hM="IPYWidgetCDNConfigured",Bre="IPYWidgetNotFoundOnCDN",Hre="IPYWidgetNoNetWorkAccess";function o_e(r,e,t){let n=e,i="index",o=e.indexOf("/");return o!==-1&&e[0]==="@"&&(o=e.indexOf("/",o+1)),o!==-1&&(i=e.substr(o+1),n=e.substr(0,o)),r===f9&&(t.startsWith("^")&&(t=t.slice(1)),i.endsWith(".js")||(i=i.concat(".js"))),`${r}${n}@${t}/dist/${i}`}function s_e(r){switch(r){case"unpkg.com":return qre;case"jsdelivr.com":return f9;default:break}}var Bl=class{constructor(e,t){this.globalMemento=e;this.configurationSettings=t;this.id="cdn";this.cache=new Map;this.isOnCDNCache=new Map;this.notifiedUserAboutWidgetScriptNotFound=new Set}get cdnProviders(){return this.configurationSettings.getSettings(void 0).widgetScriptSources}dispose(){this.cache.clear()}async isOnCDN(e){let t=`MODULE_VERSION_ON_CDN_${e}`;if(this.isOnCDNCache.has(t))return this.isOnCDNCache.get(t);if(this.globalMemento.get(t,!1))return!0;let n=(async()=>{let i=new fu,o=Ka(i.exists(`${qre}${e}`)),s=Ka(i.exists(`${f9}${e}`));return await Promise.race([o.promise,s.promise]),o.value||s.value?!0:(await Promise.all([o.promise,s.promise]),!!(o.value||s.value))})();return n.then(i=>{if(i)return this.globalMemento.update(t,!0)}).then(E,E),this.isOnCDNCache.set(t,n),n}async getWidgetScriptSource(e,t,n){if(n===!1)return C.ci(`Webview is offline, cannot use CDN for ${e}`),this.warnIfNoAccessToInternetFromWebView(e).catch(E),{moduleName:e};if(this.cdnProviders.length===0&&this.globalMemento.get(hM,!1))return C.ci("No CDN providers and user configured CDN"),{moduleName:e};let i=this.getModuleKey(e,t);return this.cache.get(i)||this.cache.set(i,this.getWidgetScriptSourceImplementation(e,t)),this.cache.get(i)}async generateDownloadUri(e,t,n){let i=s_e(n);if(i)return o_e(i,e,t)}getModuleKey(e,t){return`${e}${t}`}async getWidgetScriptSourceImplementation(e,t){if(C.trace(`\x1B[32mSearching for Widget Script ${e}#${t} using cdns ${this.cdnProviders.join(" ")}`),await this.configureWidgets(),this.cdnProviders.length===0)return{moduleName:e};let i=(await Promise.all(this.cdnProviders.map(o=>this.getValidUri(e,t,o)))).find(o=>o);return i?(C.trace(`\x1B[32mWidget Script ${e}#${t} found at URI: ${i}`),{moduleName:e,scriptUri:i,source:"cdn"}):(C.error(`Widget Script ${e}#${t} was not found on on any cdn`),this.handleWidgetSourceNotFound(e,t).catch(E),{moduleName:e})}async getValidUri(e,t,n){try{let i=await this.generateDownloadUri(e,t,n),o=new fu;if(i&&await o.exists(i))return i}catch(i){C.trace(`Failed downloading ${e}:${t} from ${n}`);return}}async warnIfNoAccessToInternetFromWebView(e){if(this.globalMemento.get(Hre,!1)||this.notifiedUserAboutWidgetScriptNotFound.has(e)||this.cdnProviders.length===0)return;switch(this.notifiedUserAboutWidgetScriptNotFound.add(e),await hs.window.showWarningMessage(W.cdnWidgetScriptNotAccessibleWarningMessage(e,JSON.stringify(this.cdnProviders)),Ue.ok,Ue.doNotShowAgain,Ue.moreInfo)){case Ue.doNotShowAgain:return this.globalMemento.update(Hre,!0);case Ue.moreInfo:return hs.env.openExternal(hs.Uri.parse("https://aka.ms/PVSCIPyWidgets"));default:}}async configureWidgets(){if(this.cdnProviders.length!==0||this.globalMemento.get(hM,!1))return;if(this.configurationPromise)return this.configurationPromise.promise;this.configurationPromise=Oe(),ne("DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN");let e=await hs.window.showInformationMessage(W.useCDNForWidgetsNoInformation,{modal:!0},Ue.ok,Ue.doNotShowAgain,Ue.moreInfo),t="dismissed";switch(e){case Ue.ok:{t="ok",await Promise.all([this.updateScriptSources(["jsdelivr.com","unpkg.com"]),this.globalMemento.update(hM,!0)]);break}case Ue.doNotShowAgain:{t="doNotShowAgain",await Promise.all([this.updateScriptSources([]),this.globalMemento.update(hM,!0)]);break}case Ue.moreInfo:{hs.env.openExternal(hs.Uri.parse("https://aka.ms/PVSCIPyWidgets"));break}default:t=e===Ue.cancel?"cancel":"dismissed";break}ne("DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN_SELECTION",void 0,{selection:t}),this.configurationPromise.resolve()}async updateScriptSources(e){await this.configurationSettings.updateSetting("widgetScriptSources",e,void 0,hs.ConfigurationTarget.Global)}async handleWidgetSourceNotFound(e,t){if(this.globalMemento.get(Bre,!1)||this.notifiedUserAboutWidgetScriptNotFound.has(e)||this.cdnProviders.length===0)return;switch(this.notifiedUserAboutWidgetScriptNotFound.add(e),await hs.window.showWarningMessage(W.widgetScriptNotFoundOnCDNWidgetMightNotWork(e,t,JSON.stringify(this.cdnProviders)),Ue.ok,Ue.doNotShowAgain,Ue.reportThisIssue)){case Ue.doNotShowAgain:return this.globalMemento.update(Bre,!0);case Ue.reportThisIssue:return hs.env.openExternal(hs.Uri.parse("https://aka.ms/CreatePVSCDataScienceIssue"));default:}}};Bl=U([(0,uv.injectable)(),x(0,(0,uv.inject)(Et)),x(0,(0,uv.named)(rr)),x(1,(0,uv.inject)(Ke))],Bl);var xP=class{constructor(e,t){this.document=e;this.serviceContainer=t;this.cachedMessages=[];this.postEmitter=new gs.EventEmitter;this.attachedWebviews=new WeakSet;this.modulesForWhichWeHaveDisplayedWidgetErrorMessage=new Set;this.queuedMessages=[];this.disposables=this.serviceContainer.get(ve),this.jupyterOutput=this.serviceContainer.get(Um,Hv),this.configService=this.serviceContainer.get(Ke),this.initialize()}get postMessage(){return this.listeningToPostMessageEvent=!0,this.postEmitter.event}dispose(){var e,t;this.cachedMessages=[],(e=this.ipyWidgetMessageDispatcher)==null||e.dispose(),(t=this.ipyWidgetScriptSource)==null||t.dispose()}attach(e){if(this.attachedWebviews.has(e))return;this.attachedWebviews.add(e),this.postMessage(i=>{if(C.ci(`\x1B[32mWidget Coordinator sent ${i.message}`),i.message==="ConvertUriForUseInWebViewRequest")this.onMessage(e,"ConvertUriForUseInWebViewResponse",{request:i.payload,response:e.asWebviewUri(i.payload)});else{if(!this.readyMessageReceived){this.queuedMessages.push({type:i.message,payload:i.payload});return}this.sendPendingWebViewMessages(e),e.postMessage({type:i.message,payload:i.payload}).then(E,E)}},this,this.disposables);let t=Oe(),n=async()=>{let i=new bt;if(!t.completed){let s=[],a=this.serviceContainer.get(qe),l=Oe();a.get(this.document)?l.resolve(a.get(this.document)):a.onDidCreateKernel(c=>{c.notebook===this.document&&l.resolve(c)},this,s);let u=await l.promise;u&&(Qt(u.kernelConnectionMetadata)?u.ipywidgetsVersion?t.completed||t.resolve(u.ipywidgetsVersion):u.onIPyWidgetVersionResolved(()=>{u.ipywidgetsVersion&&(t.completed||t.resolve(u.ipywidgetsVersion),Ce(s))},this,s):t.completed||t.resolve(UE)),s.length&&this.disposables.push(...s)}let o=await t.promise;C.trace(`Version of IPyWidgets ${o} determined after ${i.elapsedTime/1e3}s`),e.postMessage({type:"IPyWidgets_Reply_Widget_Version",payload:o}).then(E,E)};e.onDidReceiveMessage(async i=>{C.ci(`\x1B[32mWidget Coordinator received ${i.type}`),this.onMessage(e,i.type,i.payload),i.type==="IPyWidgets_Request_Widget_Version"&&await n(),i.type==="IPyWidgets_Window_Alert"&&gs.window.showInformationMessage(i.message),i.type==="IPyWidgets_Window_Open"&&gs.env.openExternal(gs.Uri.parse(i.url)),i.type==="IPyWidgets_Ready"&&(C.trace("Web view is ready to receive widget messages"),this.readyMessageReceived=!0,this.sendPendingWebViewMessages(e))},this,this.disposables),e.postMessage({type:"IPyWidgets_IsReadyRequest",payload:void 0}).then(E,E),n().catch(E)}onMessage(e,t,n){t==="ipywidget_load_success"?this.sendLoadSucceededTelemetry(n).catch(E):t==="ipywidget_load_failure"?this.handleWidgetLoadFailure(e,n).catch(E):t==="ipywidget_widget_version_not_supported"?this.sendUnsupportedWidgetVersionFailureTelemetry(n).catch(E):t==="ipywidget_render_failure"?this.sendRenderFailureTelemetry(n):t==="ipywidget_unhandled_kernel_message"&&this.handleUnhandledMessage(n),this.getIPyWidgetMessageDispatcher().receiveMessage({message:t,payload:n}),this.getIPyWidgetScriptSource().onMessage(t,n)}sendPendingWebViewMessages(e){if(this.readyMessageReceived)for(;this.queuedMessages.length;)e.postMessage(this.queuedMessages.shift()).then(E,E)}initialize(){this.getIPyWidgetScriptSource().initialize(),this.getIPyWidgetMessageDispatcher().initialize()}async sendLoadSucceededTelemetry(e){try{ne("DS_INTERNAL.IPYWIDGET_LOAD_SUCCESS",0,{moduleHash:await Rt(e.moduleName),moduleVersion:e.moduleVersion})}catch(t){}}async handleWidgetLoadFailure(e,t){try{let n=t.error.toString(),i=this.configService.getSettings(void 0).widgetScriptSources,o=i.length>0,s=`${t.moduleName}:${t.moduleVersion}`;if(!t.isOnline)n=W.loadClassFailedWithNoInternet(t.moduleName,t.moduleVersion),gs.window.showErrorMessage(n).then(E,E);else if(!o&&!this.modulesForWhichWeHaveDisplayedWidgetErrorMessage.has(s)){this.modulesForWhichWeHaveDisplayedWidgetErrorMessage.add(s);let a=Ue.moreInfo,l=W.enableCDNForWidgetsButton;n=W.enableCDNForWidgetsSetting(t.moduleName,t.moduleVersion),gs.window.showErrorMessage(n,{modal:!0},l,a).then(u=>{switch(u){case a:gs.env.openExternal(gs.Uri.parse("https://aka.ms/PVSCIPyWidgets"));break;case l:this.enableCDNForWidgets(e).catch(E);break;default:break}},E)}C.error(`Widget load failure ${n}`,i,t),ne("DS_INTERNAL.IPYWIDGET_LOAD_FAILURE",0,{isOnline:t.isOnline,moduleHash:await Rt(t.moduleName),moduleVersion:t.moduleVersion,timedout:t.timedout})}catch(n){}}async enableCDNForWidgets(e){await gs.commands.executeCommand(de.EnableLoadingWidgetsFrom3rdPartySource),await e.postMessage({type:"IPyWidgets_AttemptToDownloadFailedWidgetsAgain"})}async sendUnsupportedWidgetVersionFailureTelemetry(e){try{ne("DS_INTERNAL.IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED_LOAD_FAILURE",0,{moduleHash:await Rt(e.moduleName),moduleVersion:e.moduleVersion})}catch(t){}}sendRenderFailureTelemetry(e){try{C.error("Error rendering a widget: ",e),ne("DS_INTERNAL.IPYWIDGET_RENDER_FAILURE")}catch(t){}}handleUnhandledMessage(e){if(e.header.msg_type!=="status")try{if(e.header.msg_type==="error"){let t=e;t.content.traceback=t.content.traceback.map(yu)}C.trace(`Unhandled widget kernel message: ${e.header.msg_type} ${e.content}`),this.jupyterOutput.appendLine(W.unhandledMessage(e.header.msg_type,JSON.stringify(e.content))),ne("DS_INTERNAL.IPYWIDGET_UNHANDLED_MESSAGE",void 0,{msg_type:e.header.msg_type})}catch(t){}}getIPyWidgetMessageDispatcher(){return this.ipyWidgetMessageDispatcher||(this.ipyWidgetMessageDispatcher=this.serviceContainer.get(jl).create(this.document),this.disposables.push(this.ipyWidgetMessageDispatcher.postMessage(this.cacheOrSend,this))),this.ipyWidgetMessageDispatcher}getIPyWidgetScriptSource(){return this.ipyWidgetScriptSource||(this.ipyWidgetScriptSource=new dM(this.document,this.serviceContainer.get(qe),this.serviceContainer.get(ve),this.serviceContainer.get(Ke),this.serviceContainer.get(fM),this.serviceContainer.get(Bl)),this.disposables.push(this.ipyWidgetScriptSource.postMessage(this.cacheOrSend,this))),this.ipyWidgetScriptSource}cacheOrSend(e){if(!this.listeningToPostMessageEvent){C.ci("\x1B[32mQueuing messages (no listeners)"),this.cachedMessages.push(e);return}this.cachedMessages.forEach(t=>this.postEmitter.fire(t)),this.cachedMessages=[],this.postEmitter.fire(e)}};U([yn()],xP.prototype,"enableCDNForWidgets",1);var m9=class{constructor(e,t){this.editor=e;this.pendingMessages=[];this.disposables=[];this._onDidReceiveMessage=new lm.EventEmitter;this.changeController(t)}get controller(){if(!this._controller)throw new Error("No controller defined");return this._controller.controller}changeController(e){var t,n;((t=this._controller)==null?void 0:t.id)!==e.id&&((n=this.controllerMessageHandler)==null||n.dispose(),this._controller=e,this.controllerMessageHandler=e.onDidReceiveMessage(i=>{var o;i.editor===this.editor&&((o=this.controller)==null?void 0:o.id)===e.id&&(this.eventHandlerListening?(this.sendPendingMessages(),this._onDidReceiveMessage.fire(i.message)):this.pendingMessages.push(i.message))},this,this.disposables))}dispose(){Ce(this.disposables)}get onDidReceiveMessage(){return this.eventHandlerListening=!0,setTimeout(()=>this.sendPendingMessages(),0),this._onDidReceiveMessage.event}postMessage(e){return this.controller.postMessage(e,this.editor)}asWebviewUri(e){return this.controller.asWebviewUri(e)}sendPendingMessages(){if(this.pendingMessages.length){let e=this.pendingMessages.shift();for(;e;)this._onDidReceiveMessage.fire(e),e=this.pendingMessages.shift()}}},am=class{constructor(e,t,n){this.serviceContainer=e;this.disposableRegistry=t;this.controllerManager=n;this.messageCoordinators=new WeakMap;this.notebookDisposables=new WeakMap;this.notebookCommunications=new WeakMap;this.notebookEditors=new WeakMap}activate(){lm.window.onDidChangeVisibleNotebookEditors(this.onDidChangeVisibleNotebookEditors,this,this.disposableRegistry),lm.workspace.onDidCloseNotebookDocument(this.onDidCloseNotebookDocument,this,this.disposableRegistry),this.controllerManager.onControllerSelected(this.onDidSelectController,this,this.disposableRegistry)}onDidSelectController(e){let t=this.messageCoordinators.get(e.notebook);t&&(this.messageCoordinators.delete(e.notebook),lm.window.visibleNotebookEditors.filter(n=>n.notebook===e.notebook).forEach(n=>{let i=this.notebookCommunications.get(n);this.notebookCommunications.delete(n),i&&i.controller!==e.controller.controller&&(this.notebookCommunications.delete(n),i&&i.dispose())}),t==null||t.dispose()),lm.window.visibleNotebookEditors.filter(n=>n.notebook===e.notebook).forEach(n=>this.initializeNotebookCommunication(n,e.controller))}initializeNotebookCommunication(e,t){if(e.notebook.isClosed||!gr(e.notebook))return;let n=e.notebook;if(!t||this.notebookCommunications.has(e))return;let i=new m9(e,t);this.addNotebookDisposables(n,[i]),this.notebookCommunications.set(e,i);let o=this.messageCoordinators.get(n);o||(o=new xP(n,this.serviceContainer),this.messageCoordinators.set(n,o)),o.attach(i)}addNotebookDisposables(e,t){let n=this.notebookDisposables.get(e)||[];n.push(...t),this.notebookDisposables.set(e,n)}async onDidChangeVisibleNotebookEditors(e){e.forEach(t=>{let n=this.controllerManager.getSelected(t.notebook);this.initializeNotebookCommunication(t,n)})}onDidCloseNotebookDocument(e){var n;let t=this.notebookEditors.get(e)||[];Ce(this.notebookDisposables.get(e)||[]),t.forEach(i=>{var o;return(o=this.notebookCommunications.get(i))==null?void 0:o.dispose()}),(n=this.messageCoordinators.get(e))==null||n.dispose(),this.messageCoordinators.delete(e)}};am=U([(0,qS.injectable)(),x(0,(0,qS.inject)(Ar)),x(1,(0,qS.inject)(ve)),x(2,(0,qS.inject)(Nt))],am);p();var cm=ae(he());var JS=class{constructor(e,t,n,i,o){this.disposables=e;this.kernelProvider=t;this.controllers=n;this.liveKernelTracker=i;this.preferredRemoteKernelIdProvider=o}activate(){this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposables),this.controllers.onControllerSelectionChanged(this.onNotebookControllerSelectionChanged,this,this.disposables)}onNotebookControllerSelectionChanged({selected:e,notebook:t,controller:n}){t.isClosed||(n.connection.kind==="connectToLiveRemoteKernel"&&n.connection.kernelModel.id&&(e?this.liveKernelTracker.trackKernelIdAsUsed(t.uri,n.connection.serverProviderHandle,n.connection.kernelModel.id):this.liveKernelTracker.trackKernelIdAsNotUsed(t.uri,n.connection.serverProviderHandle,n.connection.kernelModel.id)),jt(n.connection)&&this.preferredRemoteKernelIdProvider.clearPreferredRemoteKernelId(t.uri).catch(E))}onDidStartKernel(e){if(!e.resourceUri)return;let t=e.resourceUri;if(e.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")return;let n=e.kernelConnectionMetadata.serverProviderHandle,i=()=>{var s,a;let o=(a=(s=e.session)==null?void 0:s.kernel)==null?void 0:a.id;!e.disposed&&!e.disposing&&o&&(C.debug(`Updating preferred kernel for remote notebook ${o}`),this.preferredRemoteKernelIdProvider.storePreferredRemoteKernelId(t,o).catch(E),this.liveKernelTracker.trackKernelIdAsUsed(t,n,o))};i(),e.onDidKernelSocketChange(i,this,this.disposables)}};JS=U([(0,cm.injectable)(),x(0,(0,cm.inject)(ve)),x(1,(0,cm.inject)(qe)),x(2,(0,cm.inject)(Nt)),x(3,(0,cm.inject)(Gg)),x(4,(0,cm.inject)(js))],JS);p();var pv=ae(he());var Jre=require("vscode");var dv=class{constructor(e,t,n,i){this.disposables=e;this.uriStorage=t;this.controllers=n;this.serverProviderRegistry=i;this.handledServerProviderChanges=new WeakSet}activate(){this.serverProviderRegistry.jupyterCollections.forEach(e=>this.checkExpiredServersInJupyterCollection(e)),this.serverProviderRegistry.onDidChangeCollections(({added:e,removed:t})=>{e.forEach(n=>this.checkExpiredServersInJupyterCollection(n)),t.forEach(n=>this.removeControllersBelongingToDisposedProvider(n.extensionId,n.id))},this,this.disposables)}async checkExpiredServersInJupyterCollection(e){!this.handledServerProviderChanges.has(e.serverProvider)&&e.serverProvider.onDidChangeServers&&(this.handledServerProviderChanges.add(e.serverProvider),e.serverProvider.onDidChangeServers(()=>this.checkExpiredServersInJupyterCollection(e).catch(E),this,this.disposables));let t=new Jre.CancellationTokenSource;this.disposables.push(t);try{let n=await Promise.resolve(e.serverProvider.provideJupyterServers(t.token));await this.removeControllersAndUriStorageBelongingToInvalidServers(e.extensionId,e.id,(n||[]).map(i=>i.id))}finally{t.dispose()}}async removeControllersAndUriStorageBelongingToInvalidServers(e,t,n){let i=this.uriStorage.all;await Promise.all(i.filter(o=>o.provider.extensionId===e&&o.provider.id===t).map(async o=>{n.includes(o.provider.handle)||await this.uriStorage.remove(o.provider)})),this.controllers.registered.forEach(o=>{let s=o.connection;jt(s)||s.serverProviderHandle.extensionId!==e||s.serverProviderHandle.id!==t||n.includes(s.serverProviderHandle.handle)||(C.warn(`Deleting controller ${o.id} as it is associated with a server Id that has been removed`),o.dispose())})}removeControllersBelongingToDisposedProvider(e,t){this.controllers.registered.forEach(n=>{let i=n.connection;jt(i)||i.serverProviderHandle.extensionId!==e||i.serverProviderHandle.id!==t||(C.warn(`Deleting controller ${n.id} as it is associated with a Provider Id that has been removed`),n.dispose())})}};U([yn("Failed to check what servers were shutdown in Controller Watcher")],dv.prototype,"checkExpiredServersInJupyterCollection",1),dv=U([(0,pv.injectable)(),x(0,(0,pv.inject)(ve)),x(1,(0,pv.inject)(pr)),x(2,(0,pv.inject)(Nt)),x(3,(0,pv.inject)(sr))],dv);p();p();var YS=ae(he());p();var Gre=require("vscode");var gM=class{constructor(e,t,n,i,o,s){this.label=e;this._description=t;this.detail=n;this.category=i;this.serverDisplayName=o;this.getDescription=s;this._onDidChange=new Gre.EventEmitter;this.onDidChange=this._onDidChange.event}get description(){var e;return((e=this.getDescription)==null?void 0:e.call(this))||this._description}set description(e){this._description=e}dispose(){this._onDidChange.dispose()}triggerChange(){this._onDidChange.fire(this)}};function Yre(r){switch(r.kind){case"connectToLiveRemoteKernel":return W.kernelCategoryForJupyterSession;case"startUsingRemoteKernelSpec":return W.kernelCategoryForRemoteJupyterKernel;default:return h9(r)}}function h9(r){switch(r.kind){case"startUsingLocalKernelSpec":return W.kernelCategoryForJupyterKernel;case"startUsingPythonInterpreter":{if(Bg(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec")return W.kernelCategoryForJupyterKernel;switch(br(r.interpreter)){case"Conda":return Pp(r.interpreter)?W.kernelCategoryForCondaWithoutPython:W.kernelCategoryForConda;case"PipEnv":return W.kernelCategoryForPipEnv;case"Poetry":return W.kernelCategoryForPoetry;case"Pyenv":return W.kernelCategoryForPyEnv;case"Venv":case"VirtualEnv":case"VirtualEnvWrapper":return W.kernelCategoryForVirtual;default:return W.kernelCategoryForGlobal}}default:return""}}var GS=class{constructor(e,t,n){this.platform=e;this.jupyterUriProviderRegistration=t;this.disposables=n;this.details=new Map}getDisplayData(e){if(!this.details.get(e.id)){let i=lt(e),o=XZ(e,this.platform);e.kind==="connectToLiveRemoteKernel"&&(o=sj(e));let s=e.kind==="connectToLiveRemoteKernel"?()=>sj(e):void 0,a=h9(e),l=new gM(i,o,"",a,void 0,s);this.disposables.push(l),this.details.set(e.id,l)}let t=this.details.get(e.id);if(this.details.set(e.id,t),e.kind==="connectToLiveRemoteKernel"||e.kind==="startUsingRemoteKernelSpec"){let i=fS(e.serverProviderHandle,this.jupyterUriProviderRegistration,W.kernelDefaultRemoteDisplayName);t.serverDisplayName!==i&&(t.serverDisplayName=i,t.triggerChange())}let n=Yre(e);return t.category!==n&&(t.category=n,t.triggerChange()),t}};GS=U([(0,YS.injectable)(),x(0,(0,YS.inject)(fs)),x(1,(0,YS.inject)(sr)),x(2,(0,YS.inject)(ve))],GS);p();var Xd=ae(he()),zS=require("vscode");p();var um=ae(he()),Qre=require("vscode");p();var $re=require("vscode");function vM(r){var e;try{return tee(_a(r))||((e=r.getCells().find(n=>n.kind===$re.NotebookCellKind.Code))==null?void 0:e.document.languageId)}catch(t){C.warn("Failed to determine language of first cell",t)}}var zre="DATASCIENCE.LAST_SAVED_CELL_LANGUAGE",Bs=class{constructor(e,t,n){this.disposables=e;this.globalMemento=t;this.pythonExtensionChecker=n}getPreferredLanguage(e){var i,o;let t=((i=e==null?void 0:e.language_info)==null?void 0:i.name)||((o=e==null?void 0:e.kernelspec)==null?void 0:o.language)||this.lastSavedNotebookCellLanguage,n=this.pythonExtensionChecker.isPythonExtensionInstalled?$e:"plaintext";return Vc(t||n)}activate(){Qre.workspace.onDidSaveNotebookDocument(this.onDidSaveNotebookDocument,this,this.disposables)}getSupportedLanguages(e){if(Qt(e))return hB;{let t=Vc(ru(e)||"");return t&&vB.includes(t.toLowerCase())?[t,"raw"]:[]}}get lastSavedNotebookCellLanguage(){return this.globalMemento.get(zre)}async onDidSaveNotebookDocument(e){if(!gr(e))return;let t=vM(e);t&&t!==this.lastSavedNotebookCellLanguage&&await this.globalMemento.update(zre,t)}};U([yn("Saving last saved cell language")],Bs.prototype,"onDidSaveNotebookDocument",1),Bs=U([(0,um.injectable)(),x(0,(0,um.inject)(ve)),x(1,(0,um.inject)(Et)),x(1,(0,um.named)(rr)),x(2,(0,um.inject)(bo))],Bs);p();function Xre(r){let e={kernelSpecCount:0,localKernelSpecCount:0,remoteKernelSpecCount:0,kernelInterpreterCount:0,kernelLiveCount:0};r.forEach(t=>{switch(t.kind){case"connectToLiveRemoteKernel":e.kernelLiveCount+=1;break;case"startUsingRemoteKernelSpec":e.localKernelSpecCount+=1,e.kernelSpecCount+=1;break;case"startUsingLocalKernelSpec":e.remoteKernelSpecCount+=1,e.kernelSpecCount+=1;break;case"startUsingPythonInterpreter":{e.kernelInterpreterCount+=1;break}default:break}}),ne("DS_INTERNAL.KERNEL_COUNT",{...e})}p();var Xt=require("vscode");p();var Iu=require("vscode");p();var Zre=require("vscode");async function ene(r,e){let t=e==null?void 0:e.findNotebookEditor(r);return t?Zre.commands.executeCommand("notebook.selectKernel",{notebookEditor:t}):(C.error("Unable to select kernel as the Notebook document could not be identified"),!1)}p();var tne=require("vscode");var yM=class extends iu{constructor(e){super(W.failedToStartAnUntrustedKernelSpec(lt(e),e.kernelSpec.specFile?Ee(tne.Uri.file(e.kernelSpec.specFile)):""),void 0,e)}};var Jr=class Jr{static async switchController(e,t){let i=t.get(Oo).findNotebookEditor(e),o=t.get(Nt),s,a=Oe(),l=o.onControllerSelected(c=>a.resolve(c.controller));return await ene(e,t.get(Oo))&&i&&(s=await a.promise),l.dispose(),s?{controller:s.controller,metadata:s.connection}:void 0}static async notifyAndRestartDeadKernel(e){let t=await Iu.window.showErrorMessage(W.cannotRunCellKernelIsDead(lt(e.kernelConnectionMetadata)),{modal:!0},W.showJupyterLogs,W.restartKernel),n=!1;switch(t){case W.restartKernel:{await e.restart(),n=!0;break}case W.showJupyterLogs:Iu.commands.executeCommand(de.ViewJupyterOutput).then(E,E)}return n}static async handleKernelError(e,t,n,i,o,s,a,l){let u=e.get(Et,rr),c=e.get(mn);a.interpreter&&n==="start"&&$te(u,19,a.interpreter).catch(E);let d=await c.handleKernelError(t,n,a,i,l),f=jt(a),m=e.tryGet(Hd);switch((m==null?void 0:m.isSupported)&&f&&n==="start"&&Rr(i,"DS_INTERNAL.RAWKERNEL_SESSION_NO_IPYKERNEL",{reason:d}),o.dispose().catch(E),d){case 1:case 2:throw t;case 3:{let b=await Jr.switchController(i,e);if(!b)throw t;s=b.controller,a=b.metadata;break}}return{controller:s,metadata:a}}static convertContextToFunction(e,t){switch(e){case"start":case"execution":return n=>n.start(t);case"interrupt":return n=>n.interrupt();case"restart":return n=>n.restart()}}static async verifyKernelState(e,t,n,i,o,s,a,l){let u=await i,{kernel:c,deadKernelAction:d}=u;if(YA(c)){if(this.deleteKernelInfo(t,i),d==="deadKernelWasNoRestarted")throw new Wl(c.kernelConnectionMetadata);if(d==="deadKernelWasRestarted")throw new Wl(c.kernelConnectionMetadata);if((l==null?void 0:l.kernelWasRestartedDueToDeadKernel.value)===!0)throw new Wl(c.kernelConnectionMetadata);u.deadKernelAction="deadKernelWasRestarted";let f=Oe();return f.resolve(!0),l=l||{kernelWasRestartedDueToDeadKernel:f},Jr.wrapKernelMethod(c.kernelConnectionMetadata,"start",o,e,t,n,a,s,l)}return c}static async wrapKernelMethod(e,t,n,i,o,s,a,l=()=>void 0,u){var m,g,b,v;let c=this.getKernelInfo(o);if(!s.disableUI&&(c!=null&&c.options.disableUI)&&(c.options.disableUI=!1),!s.disableUI&&(c!=null&&c.kernel.resolved)&&((g=(m=c==null?void 0:c.kernel.value)==null?void 0:m.kernel)!=null&&g.disposed||(v=(b=c==null?void 0:c.kernel.value)==null?void 0:b.kernel)!=null&&v.disposing)&&(this.deleteKernelInfo(o),c=void 0),c&&t!=="restart"&&t!=="interrupt")return Jr.verifyKernelState(i,o,s,c.kernel.promise,n,l,a);C.debug(`${t} the kernel, options.disableUI=${s.disableUI} for ${Ee("notebook"in o?o.notebook.uri:o.resource)}`),u=u||{kernelWasRestartedDueToDeadKernel:Oe()};let d=Jr.wrapKernelMethodImpl(e,t,i,o,s,n,l,u);u!=null&&u.kernelWasRestartedDueToDeadKernel.resolved&&u.kernelWasRestartedDueToDeadKernel.resolve(!0);let f=Ka(d);return f.promise.catch(E),d.then(k=>{k.kernel.onDisposed(()=>{this.deleteKernelInfo(o,f.promise)},void 0,a)}).catch(()=>{this.deleteKernelInfo(o,f.promise)}),this.setKernelInfo(o,f,s),Jr.verifyKernelState(i,o,s,f.promise,n,l,a,u)}static getKernelInfo(e){return"notebook"in e?Jr.connectionsByNotebook.get(e.notebook):Jr.connectionsByUri.get(e.resource.toString())}static setKernelInfo(e,t,n){"notebook"in e?Jr.connectionsByNotebook.set(e.notebook,{kernel:t,options:n}):Jr.connectionsByUri.set(e.resource.toString(),{kernel:t,options:n})}static deleteKernelInfo(e,t){var n,i;if(!t){"notebook"in e?Jr.connectionsByNotebook.delete(e.notebook):Jr.connectionsByUri.delete(e.resource.toString());return}"notebook"in e&&((n=Jr.connectionsByNotebook.get(e.notebook))==null?void 0:n.kernel.promise)===t?Jr.connectionsByNotebook.delete(e.notebook):e.resource&&((i=Jr.connectionsByUri.get(e.resource.toString()))==null?void 0:i.kernel.promise)===t&&Jr.connectionsByUri.delete(e.resource.toString())}static verifyWeCanStartKernel(e,t){if(!jt(e)||!e.kernelSpec.specFile)return;if(!t.get(MS).isTrusted(Iu.Uri.file(e.kernelSpec.specFile)))throw new yM(e)}static async wrapKernelMethodImpl(e,t,n,i,o,s,a,l){let u=n.get(qe),c=n.get(jg),d,f=Jr.convertContextToFunction(t,o),m=t,g="controller"in i?i.controller:void 0;for(t==="start"&&Jr.verifyWeCanStartKernel(e,n);d===void 0;){if("notebook"in i&&i.notebook.isClosed)throw new Iu.CancellationError;d="notebook"in i?u.getOrCreate(i.notebook,{metadata:e,controller:g||i.controller,resourceUri:i.resource}):c.getOrCreate(i.resource,{metadata:e,resourceUri:i.resource});let b=!1;try{if(t!=="restart"&&YA(d)&&!o.disableUI){b=!0;let v=await Jr.notifyAndRestartDeadKernel(d);return v&&l&&l.kernelWasRestartedDueToDeadKernel.resolve(!0),{kernel:d,deadKernelAction:v?"deadKernelNeedsToBeRestarted":"deadKernelWasNoRestarted"}}else{if(a(m,d),await f(d),"notebook"in i&&i.notebook.isClosed)throw new Iu.CancellationError;YA(d)&&!o.disableUI&&m!=="interrupt"&&await Jr.notifyAndRestartDeadKernel(d)}}catch(v){if(b&&l&&l.kernelWasRestartedDueToDeadKernel.resolve(!0),qn(v)||C.warn(`Error occurred while trying to ${m} the kernel, options.disableUI=${o.disableUI}`,v),o.disableUI)throw v;if("notebook"in i&&i.notebook.isClosed)throw new Iu.CancellationError;let k=await Jr.handleKernelError(n,v,m,i.resource,d,g,e,s);if(g=k.controller,e=k.metadata,f=R=>R.start(o),m="start",s==="3rdPartyExtension")throw v;d=void 0}}return{kernel:d}}static async connectToNotebookKernel(e,t,n,i,o,s="jupyterExtension",a=()=>void 0){return Jr.wrapKernelMethod(e,"start",s,t,n,i,o,a)}static async connectToKernel(e,t,n,i,o,s="jupyterExtension",a=()=>void 0){return Jr.wrapKernelMethod(e,"start",s,t,n,i,o,a)}};Jr.connectionsByNotebook=new WeakMap,Jr.connectionsByUri=new Map;var Ta=Jr;p();var fv=class{constructor(e){this.controller=e}get id(){return this.controller.id}createNotebookCellExecution(e){return this.controller.createNotebookCellExecution(e)}};p();var IM=require("vscode");var bM=class extends Pr{constructor(t,n,i){super();this.kernel=t;this.controller=n;this.notebook=i}initialize(){let t=this.kernel,n=this.controller,i=this.notebook;if(t.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"||t.status!=="busy"&&t.status!=="unknown"||!n.createNotebookExecution)return;this._register(IM.workspace.onDidCloseNotebookDocument(s=>{s===i&&this.dispose()},this)),this._register(n.onDidChangeSelectedNotebooks(s=>{s.notebook===i&&s.selected===!1&&this.dispose()},this)),this._register(t.onStatusChanged(s=>{s!=="busy"&&s!=="unknown"&&this.dispose()},this));let o=n.createNotebookExecution(i);o.start(),this._register(new IM.Disposable(()=>o.end()))}};var SM=class r{constructor(e,t,n,i,o,s,a,l,u,c,d){this.kernelConnection=e;this._viewType=n;this.kernelProvider=i;this.context=o;this.languageService=a;this.configuration=l;this.extensionChecker=u;this.serviceContainer=c;this.displayDataProvider=d;this._onNotebookControllerSelectionChanged=new Xt.EventEmitter;this._onConnecting=new Xt.EventEmitter;this.pendingCellAdditions=new WeakMap;this._onDidDispose=new Xt.EventEmitter;this.disposables=[];this.notebookKernels=new WeakMap;this.isDisposed=!1;this.runningCellExecutions=new WeakMap;this.associatedDocuments=new WeakMap;this.restoredConnections=new WeakSet;this.cellQueue=new WeakMap;var f;EQ(e.id,(f=e.interpreter)==null?void 0:f.id),s.push(this),this.displayData=this.displayDataProvider.getDisplayData(this.connection),this.controller=Xt.notebooks.createNotebookController(t,n,this.displayData.label,this.handleExecution.bind(this),this.getRendererScripts()),this.displayData.onDidChange(this.updateDisplayData,this,this.disposables),this.updateDisplayData(),this.controller.interruptHandler=this.handleInterrupt.bind(this),this.controller.supportsExecutionOrder=!0,this.controller.supportedLanguages=this.languageService.getSupportedLanguages(e),this.controller.onDidChangeSelectedNotebooks(this.onDidChangeSelectedNotebooks,this,this.disposables),Xt.workspace.onDidCloseNotebookDocument(m=>{this.associatedDocuments.delete(m)},this,this.disposables)}get id(){return this.controller.id}get label(){return this.controller.label}get connection(){return this.kernelConnection}get viewType(){return this._viewType}get onNotebookControllerSelectionChanged(){return this._onNotebookControllerSelectionChanged.event}get onConnecting(){return this._onConnecting.event}get onDidReceiveMessage(){return this.controller.onDidReceiveMessage}get onDidDispose(){return this._onDidDispose.event}isAssociatedWithDocument(e){return this.associatedDocuments.has(e)}static create(e,t,n,i,o,s,a,l,u,c,d,f){let m=new r(e,t,n,i,o,s,a,l,u,c,d);try{m.controller.variableProvider=f}catch(g){C.warn("Failed to attach variable provider",g)}return m}async restoreConnection(e){var c;if(this.restoredConnections.has(e))return;this.restoredConnections.add(e);let t=await this.connectToKernel(e,new fr(!0));if(this.kernelConnection.kind==="connectToLiveRemoteKernel"){let d=new bM(t,this.controller,e);this.disposables.push(d),d.initialize()}let n=this.kernelProvider.getKernelExecution(t),o=await this.serviceContainer.get(Vl).getLastTrackedCellExecution(e,t);if(!((c=t.session)!=null&&c.kernel)||n.pendingCells.length||!o||e.cellCount<o.cellIndex||e.cellAt(o.cellIndex).kind!==Xt.NotebookCellKind.Code)return;Ll(t.resourceUri,t.kernelConnectionMetadata);let s=!1,a=[],l,u=(d,f)=>{if(!(f.direction==="send"||s)&&Gd(f.msg)===o.msg_id){if("msg_type"in f.msg&&f.msg.msg_type==="status"&&"execution_state"in f.msg.content&&f.msg.content.execution_state==="idle")return;s=!0,n.resumeCellExecution(e.cellAt(o.cellIndex),{msg_id:o.msg_id,startTime:o.startTime,executionCount:o.executionCount}).catch(E),Ce(a)}};t.session.kernel.anyMessage.connect(u),l=new Xt.Disposable(()=>{zs(()=>{var d,f;return(f=(d=t.session)==null?void 0:d.kernel)==null?void 0:f.anyMessage.disconnect(u)})}),a.push(l),this.disposables.push(l)}updateConnection(e){e.kind!=="connectToLiveRemoteKernel"&&(this.controller.label=lt(e))}asWebviewUri(e){return this.controller.asWebviewUri(e)}postMessage(e,t){let n=e&&"message"in e?e.message:"";return C.ci(`\x1B[32mPosting message to Notebook UI ${n}`),this.controller.postMessage(e,t)}setPendingCellAddition(e,t){if(this.viewType!==yr)throw new Error("setPendingCellAddition only applies to the Interactive Window");this.pendingCellAdditions.set(e,t)}dispose(){if(this.isDisposed)return;let e=Xt.workspace.notebookDocuments.filter(t=>this.associatedDocuments.has(t)).map(t=>t.uri.toString());C.debug(`Disposing controller ${this.id} associated with connection ${this.connection.id} ${e.length?"and documents "+e.join(", "):""}`),C.ci(`Disposing controller ${this.id} associated with connection ${this.connection.id} ${e.length?"and documents "+e.join(", "):""} called from ${new Error("").stack}`),this.isDisposed=!0,this._onNotebookControllerSelectionChanged.dispose(),this._onConnecting.dispose(),this.controller.dispose(),this._onDidDispose.fire(),this._onDidDispose.dispose(),Ce(this.disposables)}updateDisplayData(){this.controller.label=this.displayData.label;let e=this.connection.kind==="connectToLiveRemoteKernel"?"":this.displayData.description;this.controller.description=e,this.displayData.serverDisplayName&&(this.controller.description=e?`${e} (${this.displayData.serverDisplayName})`:this.displayData.serverDisplayName)}async handleExecution(e,t){if(e.length<1)return;let n=Bc(t);n==null||n.cellExecutionCount(e.length);let i=n==null?void 0:n.preExecuteCellTelemetry();if(this.pendingCellAdditions.has(t)&&await this.pendingCellAdditions.get(t),e=e.filter(s=>s.index<0?(C.warn(`Attempting to run a cell with index ${s.index}, kind ${s.kind}, text = ${s.document.getText()}`),!1):!0),!Xt.workspace.isTrusted)return;C.debug(`Handle Execution of Cells ${e.map(s=>s.index)} for ${Ee(t.uri)}`),await Ll(t.uri,this.connection),i==null||i.stop();let o=this.cellQueue.get(t)||[];this.cellQueue.set(t,o.concat(e)),await this.executeQueuedCells(t)}async onDidChangeSelectedNotebooks(e){var n,i;if(C.ci(`NotebookController selection event called for notebook ${e.notebook.uri.toString()} & controller ${this.connection.kind}:${this.id}. Selected ${e.selected} `),this.associatedDocuments.has(e.notebook)&&e.selected)return;if(!e.selected){let o=this.kernelProvider.get(e.notebook);(o==null?void 0:o.kernelConnectionMetadata.id)===this.kernelConnection.id&&(C.info(`Disposing kernel ${this.kernelConnection.id} for notebook ${Ee(e.notebook.uri)} due to selection of another kernel or closing of the notebook`),o.dispose().catch(E)),this.associatedDocuments.delete(e.notebook),this._onNotebookControllerSelectionChanged.fire({controller:this,notebook:e.notebook,selected:e.selected});return}if(!gr(e.notebook)&&e.notebook.notebookType!==yr||!Xt.workspace.isTrusted)return;(i=Bc(e.notebook))==null||i.kernelSelected(this.kernelConnection.id,(n=this.kernelConnection.interpreter)==null?void 0:n.id),a_e(this.kernelConnection);let t=Oe();C.ci(`Controller ${this.connection.kind}:${this.id} associated with nb ${Ee(e.notebook.uri)}`),this.associatedDocuments.set(e.notebook,t.promise),await this.onDidSelectController(e.notebook),await this.updateCellLanguages(e.notebook),this._onNotebookControllerSelectionChanged.fire({controller:this,notebook:e.notebook,selected:e.selected}),C.debug("Controller selection change completed"),t.resolve()}async updateCellLanguages(e){let t=this.controller.supportedLanguages;if(!t||(t==null?void 0:t.length)===0)return;let i=Qt(this.kernelConnection)?$e:t[0];await Promise.all(e.getCells().filter(o=>o.kind===Xt.NotebookCellKind.Code).map(async o=>{t.includes(o.document.languageId)||await Xt.languages.setTextDocumentLanguage(o.document,i).then(E,E)}))}getRendererScripts(){return this.context.extensionMode===Xt.ExtensionMode.Development||this.context.extensionMode===Xt.ExtensionMode.Test?[new Xt.NotebookRendererScript(Xt.Uri.joinPath(this.context.extensionUri,"dist","webviews","webview-side","widgetTester","widgetTester.js"))]:[]}handleInterrupt(e){C.debug(`VS Code interrupted kernel for ${Ee(e.uri)}`),e.getCells().forEach(t=>it(t,"Cell cancellation requested")),Xt.commands.executeCommand(de.InterruptKernel,{notebookEditor:{notebookUri:e.uri}}).then(E,t=>C.error("Failed to interrupt",t))}createCellExecutionIfNecessary(e,t){let n=this.runningCellExecutions.get(e.notebook);if(!n||n.cell===e){n==null||n.end(void 0,void 0),n=so.getOrCreate(e,t,!0),this.runningCellExecutions.set(e.notebook,n);let i=n.end.bind(n);n.end=(o,s)=>{this.runningCellExecutions.delete(e.notebook),i(o,s)}}return n}async executeQueuedCells(e){if(!this.cellQueue.has(e))return;let t=(this.cellQueue.get(e)||[]).map(c=>{let d=this.createCellExecutionIfNecessary(c,new fv(this.controller));return{cell:c,exec:d}});this.cellQueue.delete(e);let n=t.length?t[0].cell:void 0;if(!n)return;C.trace(`Execute Notebook ${Ee(e.uri)}. Step 1`);let i="start",o=new fv(this.controller),s=this.serviceContainer.get(Vl),a;try{if(C.trace(`Connect to Kernel ${Ee(e.uri)}. Step 2`),a=await this.startKernel(e),C.trace(`Connected to Kernel ${Ee(e.uri)}. Step 3`),a.disposing)throw new Xt.CancellationError;a&&a.controller.id!==o.id&&(o=a.controller,t.forEach(c=>c.exec=this.createCellExecutionIfNecessary(c.cell,o))),i="execution",a.controller.id===this.id&&this.updateKernelInfoInNotebookWhenAvailable(a,e)}catch(c){if(c instanceof Yd)return;qn(c)||C.error("Error in notebook cell execution",c),t.forEach(({cell:m,exec:g})=>{g.start(),g.clearOutput(m).then(E,E)});let d=this.serviceContainer.get(mn);c=Ur.unwrap(c);let f=qn(c)||c instanceof Wl;await Ld(n,o,await d.getErrorMessageForDisplayInCellOutput(c,i,e.uri),f)}if(!a)return;let l=this.kernelProvider.getKernelExecution(a),u=new ln;await Promise.all(t.map(async({cell:c})=>{var d;try{let f=(d=Bc(e))==null?void 0:d.executeCell();f&&u.add(new Xt.Disposable(()=>f.stop())),s.trackCellExecution(c,a),C.trace(`executeCell ${c.index}. Step 4`),await l.executeCell(c),AE.isExiting||s.deleteTrackedCellExecution(c,a)}catch(f){if(f instanceof Yd)return;qn(f)||C.error("Error in cell execution",f);let m=this.serviceContainer.get(mn);f=Ur.unwrap(f);let g=qn(f)||f instanceof Wl;await Ld(c,o,await m.getErrorMessageForDisplayInCellOutput(f,i,e.uri),g)}})).catch(E)}async startKernel(e){return this.connectToKernel(e,new fr(!1))}async connectToKernel(e,t){var i;let n=(i=Bc(e))==null?void 0:i.startKernel();return this._onConnecting.fire(),Ta.connectToNotebookKernel(this.kernelConnection,this.serviceContainer,{resource:e.uri,notebook:e,controller:this.controller},t,this.disposables).finally(()=>n==null?void 0:n.stop())}updateKernelInfoInNotebookWhenAvailable(e,t){if(this.notebookKernels.get(t)===e)return;this.notebookKernels.set(t,e);let n=[];Xt.workspace.onDidCloseNotebookDocument(s=>{s===t&&Ce(n)},this,n);let i=e.onDisposed(()=>Ce(n)),o=e.onStatusChanged(async()=>{e.disposed||!e.info||this.associatedDocuments.has(t)&&(await rne(t,e.kernelConnectionMetadata,e.info),e.info.status==="ok"&&Ce(n))});n.push({dispose:()=>o.dispose()}),n.push({dispose:()=>i==null?void 0:i.dispose()})}async onDidSelectController(e){let t=this.connection,n=this.kernelProvider.get(e);if(n&&nee(n.kernelConnectionMetadata,t)){C.info("Switch kernel did not change kernel.");return}if(Rr(e.uri,"DS_INTERNAL.SWITCH_KERNEL"),n&&Xt.window.visibleNotebookEditors.filter(s=>s.notebook===e).forEach(s=>this.postMessage({message:"IPyWidgets_onKernelChanged",payload:void 0},s)),await rne(e,t),e.notebookType===yr)return;let i=this.kernelProvider.getOrCreate(e,{metadata:t,controller:this.controller,resourceUri:e.uri});if(C.debug(`KernelProvider switched kernel to id = ${i.kernelConnectionMetadata.id}`),Qt(this.kernelConnection)&&!this.extensionChecker.isPythonExtensionInstalled)return;let o=this.serviceContainer.get(MS);!this.configuration.getSettings(void 0).disableJupyterAutoStart&&jt(this.kernelConnection)&&this.kernelConnection.kernelSpec.specFile&&o.isTrusted(Xt.Uri.file(this.kernelConnection.kernelSpec.specFile))&&this.connectToKernel(e,new fr(!0))}};async function rne(r,e,t){let n=_a(r)||{},{changed:i}=await dee(n,e,t);i&&await dQ(r,n)}var g9=[3,9];async function a_e(r){let e=await Dp(r.interpreter,!0);if(!e)return;let t=(e==null?void 0:e.major)||0,n=(e==null?void 0:e.minor)||0;t<=0||n<=-1||(t<g9[0]||t===g9[0]&&n<=g9[1])&&Xt.window.showWarningMessage(W.warnWhenSelectingKernelWithUnSupportedPythonVersion,Ue.learnMore).then(i=>{if(i===Ue.learnMore)return jI("https://aka.ms/jupyterUnSupportedPythonKernelVersions")},E)}var $S=class{constructor(e,t,n,i,o,s){this.disposables=e;this.pythonEnvFilter=t;this.extensionChecker=n;this.serviceContainer=i;this.serverUriStorage=o;this.kernelFinder=s;this.registeredControllers=new Map;this.changeEmitter=new zS.EventEmitter;this.registeredMetadatas=new Map;this.selectedEmitter=new zS.EventEmitter;this.selectionChangedEmitter=new zS.EventEmitter;this.selectedControllers=new WeakMap;this._activeInterpreterControllerIds=new Set}get onDidChange(){return this.changeEmitter.event}get registered(){return[...this.registeredControllers.values()]}get all(){return this.metadatas}get metadatas(){return[...this.registeredMetadatas.values()]}get onControllerSelected(){return this.selectedEmitter.event}get onControllerSelectionChanged(){return this.selectionChangedEmitter.event}activate(){this.kernelFinder.onDidChangeKernels(()=>this.loadControllers(),this,this.disposables),this.kernelFinder.registered.forEach(e=>this.monitorDeletionOfConnections(e)),this.kernelFinder.onDidChangeRegistrations(e=>e.added.forEach(t=>this.monitorDeletionOfConnections(t)),this,this.disposables),this.pythonEnvFilter.onDidChange(this.onDidChangeFilter,this,this.disposables),this.serverUriStorage.onDidChange(this.onDidChangeFilter,this,this.disposables),this.serverUriStorage.onDidChange(this.onDidChangeUri,this,this.disposables),this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables),this.loadControllers(),Xre(this.registered.map(e=>e.connection)),C.ci(`Providing notebook controllers with length ${this.registered.length}.`)}loadControllers(){let e=this.kernelFinder.kernels;this.createNotebookControllers(e),Array.from(this.registered).filter(n=>{let i=e.some(o=>o.id===n.connection.id)||li&&this._activeInterpreterControllerIds.has(n.id);return!i&&n.connection.kind==="connectToLiveRemoteKernel"?!0:this.canControllerBeDisposed(n)?(i||C.debug(`Controller ${n.connection.kind}:'${n.id}' for view = '${n.viewType}' is no longer a valid`),!i):!1}).forEach(n=>{C.warn(`Disposing old controller ${n.connection.kind}:'${n.id}' for view = '${n.viewType}'`),n.dispose()})}createNotebookControllers(e){if(e.length!==0)try{this.batchAdd(e,[St,yr])}catch(t){if(!qn(t,!0))throw t}}async monitorDeletionOfConnections(e){let t=e.onDidChangeKernels(({removed:n})=>{let i=new Set((n||[]).map(o=>o.id));this.registered.filter(o=>i.has(o.connection.id)).forEach(o=>{C.warn(`Deleting controller ${o.id} as it is associated with a connection that has been deleted ${o.connection.kind}:${o.id}`),o.dispose()})},this,this.disposables);this.kernelFinder.onDidChangeRegistrations(n=>{n.removed.includes(e)&&t.dispose()})}onDidChangeUri(){this.onDidChangeFilter()}async onDidRemoveServers(e){e.forEach(t=>{this.registered.forEach(n=>{Wt(n.connection)&&n.connection.serverProviderHandle.id===t.id&&n.connection.serverProviderHandle.handle===t.handle&&(C.warn(`Deleting controller ${n.id} as it is associated with a connection that has been removed`),n.dispose())})}),this.onDidChangeFilter()}onDidChangeFilter(){this.all.forEach(t=>this.addOrUpdate(t,[St,yr]))}batchAdd(e,t){let n=[];e.forEach(i=>{let{added:o}=this.addImpl(i,t,!1);n.push(...o)}),n.length&&this.changeEmitter.fire({added:n,removed:[]})}trackActiveInterpreterControllers(e){e.forEach(t=>this._activeInterpreterControllerIds.add(t.id))}canControllerBeDisposed(e){return!this._activeInterpreterControllerIds.has(e.id)&&!this.isControllerAttachedToADocument(e)}getSelected(e){return this.selectedControllers.get(e)}addOrUpdate(e,t){let{added:n,existing:i}=this.addImpl(e,t,!0);return n.concat(i)}addImpl(e,t,n){let i=[],o=[];C.ci(`Create Controller for ${e.kind} and id '${e.id}' for view ${t.join(", ")}`);try{t.map(s=>{let a=this.getControllerId(e,s);return this.registeredMetadatas.set(e.id,e),[a,s]}).filter(([s])=>{let a=this.registeredControllers.get(s);return a?(a.updateConnection(e),o.push(a),C.ci(`Found existing controller '${a.id}', not creating a new one just updating it`),!1):(C.ci(`Existing controller not found for '${s}', hence creating a new one`),!0)}).forEach(([s,a])=>{let l=SM.create(e,s,a,this.serviceContainer.get(qe),this.serviceContainer.get(st),this.disposables,this.serviceContainer.get(Bs),this.serviceContainer.get(Ke),this.extensionChecker,this.serviceContainer,this.serviceContainer.get(PI),this.serviceContainer.get(iM)),u=[];l.onDidDispose(()=>{C.trace(`Deleting controller '${l.id}' associated with view ${a} from registration as it was disposed`),this.registeredControllers.delete(l.id),u.forEach(c=>c.dispose())},this,this.disposables),this.disposables.push(l),this.registeredControllers.set(l.id,l),i.push(l),l.onNotebookControllerSelectionChanged(c=>{var d;c.selected&&(C.ci(`Controller ${(d=c.controller)==null?void 0:d.id} selected for ${c.notebook.uri.toString()}`),this.selectedControllers.set(c.notebook,c.controller),this.selectedEmitter.fire(c))},this,u),l.onNotebookControllerSelectionChanged(c=>this.selectionChangedEmitter.fire({...c,controller:l}),this,u)}),n&&i.length&&this.changeEmitter.fire({added:i,removed:[]})}catch(s){if(qn(s,!0))return C.warn(`Cancel creation of notebook controller for ${e.id}`,s),{added:i,existing:o};C.error(`Failed to create notebook controller for ${e.id}`,s)}return{added:i,existing:o}}get(e,t){let n=this.getControllerId(e,t);return this.registeredControllers.get(n)}getControllerId(e,t){return t===St?e.id:`${e.id}${See}`}isControllerAttachedToADocument(e){return zS.workspace.notebookDocuments.some(t=>e.isAssociatedWithDocument(t))}};$S=U([(0,Xd.injectable)(),x(0,(0,Xd.inject)(ve)),x(1,(0,Xd.inject)(jd)),x(2,(0,Xd.inject)(bo)),x(3,(0,Xd.inject)(Ar)),x(4,(0,Xd.inject)(pr)),x(5,(0,Xd.inject)(ri))],$S);p();p();var dm=ae(he());p();var nne=require("vscode"),PP=class{constructor(e,t){this.id="remote";if(e.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&e.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")throw new Error("Invalid usage of this class, can only be used with remtoe kernels");this.kernelConnection=e.kernelConnectionMetadata,this.scriptManager=t.getOrCreate(e)}dispose(){}async getBaseUrl(){return nne.Uri.parse(this.kernelConnection.baseUrl)}async getWidgetScriptSource(e){let n=(await this.getWidgetScriptSources()).find(i=>i.moduleName.toLowerCase()===e.toLowerCase());if(!n&&e.includes("/")){let i=await this.getBaseUrl();return{moduleName:e,scriptUri:`${i.toString()}${e}`,source:"remote"}}return n||{moduleName:e}}async getWidgetScriptSources(){let e=await this.scriptManager.getWidgetModuleMappings();return e&&Object.keys(e).length?await Promise.all(Object.keys(e).map(async n=>({moduleName:n,scriptUri:e[n].toString(),source:"remote"}))):[]}};PP.validUrls=new Map;var QS=class{constructor(e,t,n){this.configurationSettings=e;this.globalMemento=t;this.widgetScriptManagerFactory=n}getProviders(e,t){let n=[];switch(n.push(new Bl(this.globalMemento,this.configurationSettings)),e.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":case"startUsingRemoteKernelSpec":n.push(new PP(e,this.widgetScriptManagerFactory));break}return n}};QS=U([(0,dm.injectable)(),x(0,(0,dm.inject)(Ke)),x(1,(0,dm.inject)(Et)),x(1,(0,dm.named)(rr)),x(2,(0,dm.inject)(mM))],QS);p();var hv=ae(he());p();var mv=require("vscode");p();var b9=require("vscode");var gne=ae(mne());var hne=["require.config({","requirejs?.config({","window.requirejs?.config({","requirejs.config({",'["require"].config({',"['require'].config({",'["requirejs"].config({',"['requirejs'].config({",'["require"]["config"]({',"['require']['config']({",'["requirejs"]["config"]({',"['requirejs']['config']({"];async function d_e(r,e,t){let n=[...hne],i=await Rt(e),o=0,s;for(;o<=0&&n.length&&(s=n.pop(),!!s);)o=t.indexOf(s);if(o<0){let f=[...hne].map(m=>m.substring(0,m.length-2));for(;o<=0&&f.length&&(s=f.pop(),!!s);)o=t.indexOf(s)}if(o<0){ne("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"couldNotLocateRequireConfigStart"});return}let a=t.indexOf(")",o);if(a<=0||!s){ne("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"couldNotLocateRequireConfigEnd"});return}let l=t.indexOf("{",o),u=t.substring(l,a);u=(0,gne.default)(u,{language:"javascript"}),u=ct(u,{trim:!0,removeEmptyEntries:!0}).join("");let c=u.split("{")[u.split("{").length-1].split("}")[0].split(",").map(f=>f.trim()).filter(f=>f.length&&f.includes(":")),d={};if(c.forEach(f=>{let m=f.split(":"),g=WE(m[0].replace(/\\r/g,"").replace(/\\n/g,"").trim()).trim(),b=WE(f.substring(f.indexOf(":")+1).replace(/\\r/g,"").replace(/\\n/g,"").trim()).trim();d[g]=b.startsWith("http")?b9.Uri.parse(b):b9.Uri.joinPath(r,b)}),!d||!Object.keys(d).length){ne("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"noRequireConfigEntries"});return}return ne("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",{requireEntryPointCount:Object.keys(d).length},{widgetFolderNameHash:i,patternUsedToRegisterRequireConfig:s}),d}var wM=class{constructor(e){this.kernel=e;this.disposables=[];e.onRestarted(this.onKernelRestarted,this,this.disposables)}dispose(){Ce(this.disposables)}async getWidgetModuleMappings(){return this.widgetModuleMappings||(this.widgetModuleMappings=this.getWidgetModuleMappingsImpl()),this.widgetModuleMappings}onKernelRestarted(){this.widgetModuleMappings=void 0}async getConfigFromWidget(e,t,n){let i=await this.getWidgetScriptSource(t);try{let o=await d_e(e,n,i);if(!o){let s=`Failed to extract require.config from widget for ${n} from ${Ee(t)}`;li&&(s+=`with contents ${i}`),C.warn(s)}return o}catch(o){C.error(`Failed to extract require.config entry for ${n} from ${Ee(t)}`,o)}}async getWidgetModuleMappingsImpl(){let e=new bt,[t,n]=await Promise.all([this.getWidgetEntryPoints(),this.getNbExtensionsParentPath()]);if(!n)return;let o=(await Promise.all(t.map(s=>this.getConfigFromWidget(n,s.uri,s.widgetFolderName)))).reduce((s,a)=>Object.assign(s||{},a),{});return o&&Object.keys(o).length&&(delete o["jupyter-js-widgets"],delete o["@jupyter-widgets/base"],delete o["@jupyter-widgets/controls"],delete o["@jupyter-widgets/output"]),ne("DS_INTERNAL.IPYWIDGET_DISCOVER_WIDGETS_NB_EXTENSIONS",{duration:e.elapsedTime},{type:jt(this.kernel.kernelConnectionMetadata)?"local":"remote"}),o&&Object.keys(o).length?o:void 0}};var xM=class extends wM{constructor(t,n,i,o){super(t);this.context=n;this.fs=i;this.connection=o;if(t.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&t.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")throw new Error("Invalid usage, can only be used for remote kernels");this.kernelConnection=t.kernelConnectionMetadata,this.getWidgetEntryPoints().catch(E)}getBaseUrl(){return this.getNbExtensionsParentPath()}async getNbExtensionsParentPath(){return mv.Uri.parse(this.kernelConnection.baseUrl)}onKernelRestarted(){this.widgetEntryPointsPromise=void 0,super.onKernelRestarted()}async getWidgetEntryPoints(){return this.widgetEntryPointsPromise||(this.widgetEntryPointsPromise=this.getWidgetEntryPointsImpl()),this.widgetEntryPointsPromise}getCodeToExecute(){return this.code||(this.code=this.fs.readFile(mv.Uri.joinPath(this.context.extensionUri,"pythonFiles","printJupyWidgetEntryPoints.py"))),this.code}async getWidgetEntryPointsImpl(){var s;if(!Qt(this.kernelConnection))return[];let t=await this.getCodeToExecute();if(!((s=this.kernel.session)!=null&&s.kernel))return C.ci("No Kernel session to get list of widget entry points"),[];let n=[];n.push(Ai(this.kernel.session.kernel,t,{traceErrors:!0,traceErrorsMessage:"Failed to get widget entry points from remote kernel"})),!li&&this.context.extensionMode===mv.ExtensionMode.Production&&n.push(nc(1e4).then(()=>[])),n.forEach(a=>a.catch(E));let i=await Promise.race(n);if(i.length===0)return C.ci("Unable to get widget entry points, no outputs after running the code"),[];let o=i[0];if(o.output_type!=="stream"||o.name!=="stdout")return C.ci("Unable to get widget entry points, no stream/stdout outputs after running the code"),[];try{return C.trace(`Widget Outputs include, ${o.text}`),o.text.trim().substring(1).slice(0,-1).split(",").map(l=>WE(l.trim()).replace(/\\\\/g,"/").replace(/\\/g,"/")).map(l=>({uri:mv.Uri.joinPath(mv.Uri.parse(this.kernelConnection.baseUrl),"nbextensions",l),widgetFolderName:Ei(l)}))}catch(a){return C.error(`Failed to parse output to get list of IPyWidgets, output is ${o.text}`,a),[]}}async getWidgetScriptSource(t){let n=this.getWidgetScriptSourceUsingHttpClient(t),i=this.getWidgetScriptSourceUsingFetch(t),o=n.catch(()=>i);return i.catch(s=>C.warn(`Failed to download widget script source from (fetch) ${t.toString(!0)}`,s)),n.catch(s=>C.error(`Failed to download widget script source from (httpclient) ${t.toString(!0)}`,s)),o.catch(E),o}async getWidgetScriptSourceUsingHttpClient(t){let n=t.toString(!0),o=await new fu().downloadFile(n);if(o.status===200)return o.text();throw new Error(`Error downloading from ${n}: ${o.statusText}`)}async getWidgetScriptSourceUsingFetch(t){let n=await this.connection.createConnectionInfo(this.kernelConnection.serverProviderHandle),i=t.toString(!0),s=await new fu(n.settings.fetch).downloadFile(i);if(s.status===200)return s.text();throw new Error(`Error downloading from ${i} using custom fetch: ${s.statusText}`)}};var XS=class{constructor(e,t,n,i){this.context=e;this.fs=t;this.disposables=n;this.connection=i;this.managers=new WeakMap}getOrCreate(e){if(!this.managers.has(e))if(e.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"||e.kernelConnectionMetadata.kind==="startUsingRemoteKernelSpec"){let t=new xM(e,this.context,this.fs,this.connection);this.managers.set(e,t),e.onDisposed(()=>t.dispose(),this,this.disposables)}else throw new Error("Cannot enumerate Widget Scripts using local kernels on the Web");return this.managers.get(e)}};XS=U([(0,hv.injectable)(),x(0,(0,hv.inject)(st)),x(1,(0,hv.inject)(Pt)),x(2,(0,hv.inject)(ve)),x(3,(0,hv.inject)(hn))],XS);p();var vne=ae(he()),yne=require("vscode");var ZS=class{async getNbExtensionsParentPath(e){switch(e.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":case"startUsingRemoteKernelSpec":return yne.Uri.parse(e.kernelConnectionMetadata.baseUrl);default:return}}};ZS=U([(0,vne.injectable)()],ZS);p();var PM=ae(he()),Hl=require("vscode");var ka=class{constructor(e){this.disposables=[];e.push(this)}dispose(){Ce(this.disposables)}activate(){let e=new rc(1e3);this.disposables.push(e),Hl.workspace.onDidChangeNotebookDocument(t=>{e.trigger(()=>this.onDidChangeNotebookDocument(t))},this,this.disposables)}onDidChangeNotebookDocument(e){gr(e.notebook)&&e.cellChanges.some(t=>t.outputs&&t.outputs.some(n=>n.items&&n.items.some(i=>i.mime===mo)))&&this.checkRendererExtensionVersion()}checkRendererExtensionVersion(){if(!Hl.workspace.isTrusted)return;let e=Hl.extensions.getExtension(hp);if(!e){this.displayNotInstalledMessage();return}let t=e.packageJSON.version;if(!t){this.displayUpdateMessage();return}let n=t.split("."),i=parseInt(n[0],10),o=parseInt(n[1],10),s=parseInt(n[2],10);(i<1||i===1&&o===0&&s<15)&&this.displayUpdateMessage()}displayNotInstalledMessage(){ka.messageDisplayed||(ka.messageDisplayed=!0,Hl.window.showInformationMessage(W.rendererExtensionRequired,{modal:!0},Ue.bannerLabelYes).then(e=>{e===Ue.bannerLabelYes&&Hl.commands.executeCommand("extension.open",hp).then(E,E)}).then(E,E))}displayUpdateMessage(){ka.messageDisplayed||(ka.messageDisplayed=!0,Hl.window.showInformationMessage(W.rendererExtension1015Required,{modal:!0},Ue.bannerLabelYes).then(e=>{e===Ue.bannerLabelYes&&Hl.commands.executeCommand("extension.open",hp).then(E,E)}).then(E,E))}};ka.messageDisplayed=!1,ka=U([(0,PM.injectable)(),x(0,(0,PM.inject)(ve))],ka);function bne(r,e){r.addSingleton(jl,jl),r.addSingleton(fM,QS),r.addSingleton(mM,XS),r.addSingleton(jre,ZS),r.addSingleton(Bl,Bl),r.addSingleton(Ve,ka)}p();var fm=ae(he()),Gr=require("vscode");var e_=class{constructor(e,t,n,i,o){this.controllerRegistration=e;this.kernelFinder=t;this.notebookEditorProvider=n;this.kernelDependency=i;this.localDisposables=[];this.providerMappings=new Map;this.kernelSpecsSourceRegistered=!1;o.push(this)}dispose(){Ce(this.localDisposables)}activate(){if(!zr()){this.localDisposables.push(Gr.notebooks.registerKernelSourceActionProvider(St,{provideNotebookKernelSourceActions:()=>[{label:W.localPythonEnvironments,documentation:Gr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerPythonEnv"),command:"jupyter.kernel.selectLocalPythonEnvironment"}]})),this.localDisposables.push(Gr.notebooks.registerKernelSourceActionProvider(yr,{provideNotebookKernelSourceActions:()=>[{label:W.localPythonEnvironments,documentation:Gr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerPythonEnv"),command:"jupyter.kernel.selectLocalPythonEnvironment"}]}));let t=[],n=new Gr.EventEmitter;this.localDisposables.push(Gr.notebooks.registerKernelSourceActionProvider(St,{onDidChangeNotebookKernelSourceActions:n.event,provideNotebookKernelSourceActions:()=>t})),this.localDisposables.push(Gr.notebooks.registerKernelSourceActionProvider(yr,{onDidChangeNotebookKernelSourceActions:n.event,provideNotebookKernelSourceActions:()=>t}));let i=()=>{this.kernelSpecsSourceRegistered||this.kernelFinder.kernels.some(o=>eee(o))&&(this.kernelSpecsSourceRegistered=!0,t=[{label:W.localKernelSpecs,documentation:Gr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerJupyterKernels"),command:"jupyter.kernel.selectLocalKernelSpec"}],n.fire())};i(),this.kernelFinder.onDidChangeKernels(()=>i(),this,this.localDisposables),this.localDisposables.push(Gr.commands.registerCommand("jupyter.kernel.selectLocalKernelSpec",this.onSelectLocalKernel.bind(this,"localKernelSpec"),this)),this.localDisposables.push(Gr.commands.registerCommand("jupyter.kernel.selectLocalPythonEnvironment",this.onSelectLocalKernel.bind(this,"localPythonEnvironment"),this))}this.localDisposables.push(Gr.commands.registerCommand("jupyter.kernel.selectJupyterServerKernel",this.onSelectRemoteKernel,this)),et.instance.get(sr).onDidChangeCollections(this.registerUriCommands,this,this.localDisposables),this.registerUriCommands()}registerUriCommands(){let e=et.instance.get(sr),t=new Set;e.jupyterCollections.map(n=>{let i=`${n.extensionId}:${n.id}`;if(n.id===lD||(t.add(i),this.providerMappings.has(i)))return;let o=Gr.notebooks.registerKernelSourceActionProvider(St,{provideNotebookKernelSourceActions:()=>[{get label(){return n.label},get documentation(){return n.documentation},command:{command:"jupyter.kernel.selectJupyterServerKernel",arguments:[n.extensionId,n.id],title:n.label}}]}),s=Gr.notebooks.registerKernelSourceActionProvider(yr,{provideNotebookKernelSourceActions:()=>[{get label(){return n.label},get documentation(){return n.documentation},command:{command:"jupyter.kernel.selectJupyterServerKernel",arguments:[n.extensionId,n.id],title:n.label}}]});this.localDisposables.push(o),this.localDisposables.push(s),this.providerMappings.set(i,{disposables:[o,s],provider:n})}),this.providerMappings.forEach(({disposables:n},i)=>{t.has(i)||(Ce(n),this.providerMappings.delete(i))})}async onSelectLocalKernel(e,t){var n;if(t=t||((n=Gr.window.activeNotebookEditor)==null?void 0:n.notebook),!!t)if(e==="localPythonEnvironment"){let o=await et.instance.get(DR).selectLocalKernel(t);return this.getSelectedController(t,o)}else{let o=await et.instance.get(_ee).selectLocalKernel(t);return this.getSelectedController(t,o)}}async onSelectRemoteKernel(e,t,n){var l,u,c;if(n=n||((l=Gr.window.activeNotebookEditor)==null?void 0:l.notebook),!n&&Gr.window.activeTextEditor&&(n=(u=this.notebookEditorProvider.findNotebookEditor(Gr.window.activeTextEditor.document.uri))==null?void 0:u.notebook),!n)return;let i=`${e}:${t}`,o=(c=this.providerMappings.get(i))==null?void 0:c.provider;if(!o)return;let a=await et.instance.get(PR).selectRemoteKernel(n,o);return this.getSelectedController(n,a)}async getSelectedController(e,t){var o;if(!t)return;let n=this.controllerRegistration.addOrUpdate(t,[e.notebookType]);if(!Array.isArray(n)||n.length===0){C.warn(`No controller created for selected kernel connection ${t.kind}:${t.id}`);return}Ll(e.uri,t).finally(()=>Rr(e.uri,"DS_INTERNAL.SWITCH_KERNEL",void 0,{newKernelPicker:!0})).catch(E),(o=n.find(s=>s.viewType===e.notebookType))==null||o.controller.updateNotebookAffinity(e,Gr.NotebookControllerAffinity.Preferred);let i=n[0];return await this.onControllerSelected(e,i),i.controller.id}async onControllerSelected(e,t){if(IQ(e),jt(t.connection)&&Qt(t.connection)&&Pp(t.connection.interpreter)&&!zr()){let n=[];try{let i=new Gr.CancellationTokenSource;n.push(i);let o=new fr(!1);n.push(o),await this.kernelDependency.installMissingDependencies({resource:e.uri,kernelConnection:t.connection,token:i.token,ui:o,cannotChangeKernels:!0,ignoreCache:!0,installWithoutPrompting:!0})}catch(i){C.error(`Failed to install missing dependencies for Conda kernel ${t.connection.id}`,i)}finally{Ce(n)}}}};e_=U([(0,fm.injectable)(),x(0,(0,fm.inject)(Nt)),x(1,(0,fm.inject)(ri)),x(2,(0,fm.inject)(Oo)),x(3,(0,fm.inject)(II)),x(4,(0,fm.inject)(ve))],e_);p();var Su=ae(he()),ii=require("vscode");p();var Fo=require("vscode");var S9=class{constructor(e){this.label=e}},DM=class extends S9{constructor(t,n){super(t);this.sortKey=n;this.kind=Fo.QuickPickItemKind.Separator}},TM=class extends Pr{constructor(t,n,i,o,s,a){super();this.provider=t;this.createQuickPickItem=n;this.getCategory=i;this.options=o;this.createErrorQuickPickItem=s;this._title=a;this.categories=new Map;this.quickPickItems=[];this.previouslyEnteredValue="";this.commands=[];this._placeholder="";this.quickPickItemMap=new WeakSet;this.errorQuickPickItemMap=new WeakSet}set recommended(t){var i;let n=((i=this._recommended)==null?void 0:i.id)!==(t==null?void 0:t.id);this._recommended=t,n&&this.quickPick&&this.rebuildQuickPickItems(this.quickPick)}get recommended(){return this._recommended}set placeholder(t){this.quickPick&&(this.quickPick.placeholder=t),this._placeholder=t}get placeholder(){return this._placeholder}set selected(t){let n=this._selected!==t;this._selected=t,n&&this.quickPick&&this.rebuildQuickPickItems(this.quickPick)}get selected(){return this._selected}createQuickPick(){let t=[],n={iconPath:new Fo.ThemeIcon("refresh"),tooltip:Ue.refresh},i=this.quickPick=Fo.window.createQuickPick();return t.push(i),this.quickPickItems=[],i.placeholder=this.placeholder,i.matchOnDescription=!0,i.buttons=this.options.supportsBack?[Fo.QuickInputButtons.Back,n]:[n],i.ignoreFocusOut=!0,i.busy=!0,i.value=this.previouslyEnteredValue,i.onDidChangeValue(o=>this.previouslyEnteredValue=o,this,t),i.onDidHide(()=>Ce(t),this,t),i.title=this._title||W.kernelPickerSelectKernelFromRemoteTitleWithoutName,this.provider.then(o=>{this.resolvedProvider=o,this._title||(i.title=W.kernelPickerSelectKernelFromRemoteTitle(o.title)),i.busy=o.status==="discovering",o.onDidChange(()=>this.updateQuickPickItems(i,o),this,t),i.onDidTriggerButton(async a=>{a===n&&(i.busy=!0,await o.refresh().catch(E),this.updateQuickPickItems(i,o),i.busy=!1)},this,t);let s;o.onDidChangeStatus(()=>{switch(s&&clearTimeout(s),o.status){case"discovering":i.busy=!0;break;case"idle":s=setTimeout(()=>i.busy=!1,500),t.push(new Fo.Disposable(()=>s&&clearTimeout(s)));break}},this,t),Ine(o.items.map(a=>this.toQuickPickItem(a)),(a,l)=>I9(this.getCategory(a.item,this),this.getCategory(l.item,this))).forEach(a=>{let l=this.connectionToCategory(a[0].item);this.quickPickItems.push(l),a.sort((u,c)=>u.label.localeCompare(c.label)),this.quickPickItems.push(...a),this.categories.set(l,new Set(a))}),this.updateQuickPickItems(i,o)}).catch(o=>C.error(`Failed to get quick pick items for ${i.title}`,o)),t.forEach(o=>this._register(o)),{quickPick:i,disposables:t}}isCommandQuickPickItem(t){return this.commands.indexOf(t)>=0}addCommand(t,n,i){let o;i&&(o={execute:()=>Promise.resolve(void 0),label:W.recommendedItemCategoryInQuickPick,kind:Fo.QuickPickItemKind.Separator},this.commands.push(o));let s=t;return s.execute=n,this.commands.push(s),this.quickPick&&this.rebuildQuickPickItems(this.quickPick),{dispose:()=>{if(o){let l=this.commands.indexOf(o);l>=0&&this.commands.splice(l,1)}let a=this.commands.indexOf(s);a>=0&&this.commands.splice(a,1)}}}async selectItem(t){for(;!t.isCancellationRequested;){let{quickPick:n,disposables:i}=this.createQuickPick();n.show();try{this.previouslySelectedItem=void 0;let o=await new Promise((s,a)=>{n.onDidChangeSelection(l=>{if(l.length){let u=l[0];this.isSelectorQuickPickItem(u)?s(u.item):this.isCommandQuickPickItem(u)?s(u):this.isErrorQuickPickItem(u)}}),n.onDidTriggerButton(l=>l===Fo.QuickInputButtons.Back?s(ze.back):void 0,this,i),n.onDidHide(()=>s(void 0),this,i)});if(t.isCancellationRequested||!o)return;if(o instanceof ze)return o===ze.back?ze.back:void 0;if(o&&"label"in o&&this.isCommandQuickPickItem(o)){this.previouslySelectedItem=o;let s=await o.execute();if(!s||s===ze.back)continue;return s instanceof ze,s}return o||void 0}finally{Ce(i)}}}updateQuickPickItems(t,n){let i=new Map(t.items.filter(a=>this.isSelectorQuickPickItem(a)).map(a=>a).map(a=>[a.item.id,a.item])),o=new Map(n.items.map(a=>[a.id,a]));this.quickPickItems=this.quickPickItems.map(a=>{if(this.isSelectorQuickPickItem(a)){let l=i.get(a.item.id);if(l&&l!==a.item)return this.toQuickPickItem(l);let u=o.get(a.item.id);if(u){let c=this.toQuickPickItem(u);if(JSON.stringify({...a,item:""})!==JSON.stringify({...c,item:""}))return this.toQuickPickItem(u)}}return a});let s=n.items.filter(a=>!i.has(a.id)).map(a=>this.toQuickPickItem(a));this.removeOutdatedQuickPickItems(t,n),Ine(s,(a,l)=>I9(this.getCategory(a.item,this),this.getCategory(l.item,this))).forEach(a=>{a.sort((c,d)=>c.label.localeCompare(d.label));let l=this.connectionToCategory(a[0].item),u=this.quickPickItems.find(c=>c.kind===Fo.QuickPickItemKind.Separator&&c.label===l.label);if(u){let c=this.quickPickItems.indexOf(u),d=this.categories.get(u),f=new Map(Array.from(d).map(b=>[b.item.id,b])),m=d.size;a.forEach(b=>{let v=f.get(b.item.id);v&&d.delete(v),d.add(b)});let g=Array.from(d);g.sort((b,v)=>b.label.localeCompare(v.label)),this.quickPickItems.splice(c+1,m,...g)}else{a.sort((f,m)=>f.label.localeCompare(m.label)),this.categories.set(l,new Set(a));let c=this.quickPickItems.filter(f=>f instanceof DM).map((f,m)=>[f,m]);c.push([l,-1]),c.sort((f,m)=>I9(f[0],m[0]));let d=c.findIndex(f=>f[1]===-1);if(d===0){this.quickPickItems.splice(0,0,l,...a);return}else if(d===c.length-1)this.quickPickItems.push(l,...a);else{let f=this.quickPickItems.findIndex(m=>m.kind===-1&&m.label===c[d+1][0].label);f=f>=0?f:0,this.quickPickItems.splice(f,0,l,...a)}}}),this.rebuildQuickPickItems(t)}rebuildQuickPickItems(t){var m;let n=this.recommended?this.toQuickPickItem(this.recommended):void 0,i=[];n&&i.push({label:W.recommendedItemCategoryInQuickPick,kind:Fo.QuickPickItemKind.Separator},n);let o=this.commands.findIndex(g=>g.kind===Fo.QuickPickItemKind.Separator&&g.label===W.recommendedItemCategoryInQuickPick),s=o>=0&&o+1<this.commands.length?this.commands[o+1]:void 0,a=n||s;a=this.selected?this.quickPickItems.filter(g=>this.isSelectorQuickPickItem(g)).map(g=>g).find(g=>{var b;return g.item.id===((b=this.selected)==null?void 0:b.id)}):a;let l=this.quickPickItems.filter(g=>{var b;return!this.isSelectorQuickPickItem(g)||g.item.id!==((b=n==null?void 0:n.item)==null?void 0:b.id)}),u=t.activeItems.length?t.activeItems[0]:void 0;a&&u&&(this.isSelectorQuickPickItem(u)?!s&&a&&"item"in a&&u.item.id!==a.item.id&&(a=void 0):s&&(s==null?void 0:s.label)===u.label||(a=void 0));let c=(m=this.resolvedProvider)!=null&&m.lastError?this.toErrorQuickPickItem(this.resolvedProvider.lastError):void 0,d=[].concat(Array.from(this.commands)).concat(i).concat(l).concat(c?[c]:[]),f=a?[a]:t.activeItems.length?[t.activeItems[0]]:[];if(f.length&&!d.includes(f[0])){let g=f[0],b=this.isSelectorQuickPickItem(g)&&d.find(v=>this.isSelectorQuickPickItem(v)&&v.item.id===g.item.id);b?f[0]=b:f.length=0}t.items=d,t.activeItems=f,!t.activeItems.length&&this.previouslySelectedItem&&d.includes(this.previouslySelectedItem)&&(t.activeItems=[this.previouslySelectedItem])}isErrorQuickPickItem(t){return this.errorQuickPickItemMap.has(t)}toErrorQuickPickItem(t){if(!this.createErrorQuickPickItem)return;let n=this.createErrorQuickPickItem(t,this);return this.errorQuickPickItemMap.add(n),n}isSelectorQuickPickItem(t){return this.quickPickItemMap.has(t)}toQuickPickItem(t){let n=this.createQuickPickItem(t,this);return n.item=t,this.quickPickItemMap.add(n),n}removeOutdatedQuickPickItems(t,n){let i=t.items.filter(a=>this.isSelectorQuickPickItem(a)).map(a=>a).map(a=>a.item.id),o=new Map(n.items.map(a=>[a.id,a])),s=i.filter(a=>!o.has(a));if(s.length){let a=[];this.categories.forEach((l,u)=>{l.forEach(c=>{s.includes(c.item.id)&&(l.delete(c),a.push(c))}),l.size||(a.push(u),this.categories.delete(u))}),this.quickPickItems=this.quickPickItems.filter(l=>!a.includes(l)),this.rebuildQuickPickItems(t)}}connectionToCategory(t){let n=this.getCategory(t,this);return new DM(n.label,n.sortKey||n.label)}};function Ine(r,e){let t=[],n;for(let i of r.slice(0).sort(e))!n||e(n[0],i)!==0?(n=[i],t.push(n)):n.push(i);return t}function I9(r,e){return(r.sortKey||r.label).localeCompare(e.sortKey||e.label,void 0,{sensitivity:"accent"})}p();var TP=require("vscode");var t_=class{constructor(e){this.jupyterConnection=e;this.disposables=[]}dispose(){Ce(this.disposables)}async findPreferredRemoteKernelConnection(e,t,n){return this.findPreferredRemoteKernelConnectionImpl(e,t,n,!1)}async findPreferredRemoteKernelConnectionImpl(e,t,n,i){var l;let o=await et.instance.get(js).getPreferredRemoteKernelId(e),s=async()=>{let u=t.kernels.find(d=>d.kind==="connectToLiveRemoteKernel"&&d.id===o);if(u)return u;if(t.status==="idle")return;let c=await new Promise(d=>t.onDidChangeKernels(()=>{let f=t.kernels.find(m=>m.kind==="connectToLiveRemoteKernel"&&m.id===o);f&&d(f),(t.status==="idle"||n.isCancellationRequested)&&d(void 0)},this,this.disposables));if(c)return c};if(o){let u=await s();if(u||i)return u}let a=(l=t.kernels.find(u=>Wt(u)))==null?void 0:l.serverProviderHandle;if(a){let u=await this.jupyterConnection.createConnectionInfo(a),c=(e.uri,void 0),d=c&&t.kernels.find(f=>Wt(f)&&f.kind==="connectToLiveRemoteKernel"&&f.kernelModel.model&&f.kernelModel.model.path===c.path&&f.kernelModel.model.name===c.name);if(d)return d}return this.findPreferredKernelSpecConnection(e,t,n,i)}async findPreferredLocalKernelSpecConnection(e,t,n){return this.findPreferredKernelSpecConnection(e,t,n,!1)}async findPreferredKernelSpecConnection(e,t,n,i){var c;let o=_a(e),s=(c=o==null?void 0:o.kernelspec)==null?void 0:c.name,a=()=>{let d=s?t.kernels.filter(m=>(m.kind==="startUsingLocalKernelSpec"||m.kind==="startUsingRemoteKernelSpec")&&m.kernelSpec.name===s):[];if(d.length||i)return d;let f=vM(e);if(f)return t.kernels.filter(m=>(m.kind==="startUsingLocalKernelSpec"||m.kind==="startUsingRemoteKernelSpec")&&m.kernelSpec.language&&(m.kernelSpec.language===f||Vc(m.kernelSpec.language)===Vc(f)))},l=a();if(Array.isArray(l)&&l.length)return i&&l.length>1?void 0:l[0];if(t.status==="idle")return;let u=[];return new Promise(d=>t.onDidChangeKernels(()=>{if(n.isCancellationRequested)return d(void 0);let f=a();if(Array.isArray(f)&&f.length)return i&&f.length>1?d(void 0):d(f[0]);t.status==="idle"&&d(void 0)},this,this.disposables)).finally(()=>Ce(u))}async findPreferredPythonKernelConnection(e,t,n){return this.findPreferredPythonKernelConnectionImpl(e,t,n)}async findPreferredPythonKernelConnectionImpl(e,t,n){t=t||et.instance.get(ri).registered.find(u=>u.kind==="localPythonEnvironment");let i=et.instance.get(im),o=_9(e,t);if(o)return o;let s=await i.getActiveInterpreter(e.uri);if(!s){let u=TP.workspace.getConfiguration("python").get("defaultInterpreterPath");if(s=u?await i.getInterpreterDetails(u,n):void 0,!s)return}let a=()=>{if(!n.isCancellationRequested)return t.kernels.filter(u=>u.kind==="startUsingPythonInterpreter").map(u=>u).find(u=>u.interpreter.id===s.id)},l=a();if(l)return l;if(t.status==="discovering")return await new Promise(u=>{t.onDidChangeStatus(()=>t.status==="idle"&&u(),this,this.disposables),t.onDidChangeKernels(()=>(_9(e,t)||a())&&u(),this,this.disposables)}),_9(e,t)||a()}};function _9(r,e){var i,o;let t=((i=TP.workspace.getWorkspaceFolder(r.uri))==null?void 0:i.uri)||(((o=TP.workspace.workspaceFolders)==null?void 0:o.length)===1?TP.workspace.workspaceFolders[0].uri:void 0),n=Sne(Am(r.uri),e);if(n)return n;if(t)return Sne(t,e)}function Sne(r,e){let n=e.kernels.filter(a=>a.kind==="startUsingPythonInterpreter").map(a=>a).filter(a=>{var l,u,c;return t1(((c=(u=(l=Ji(a.interpreter))==null?void 0:l.environment)==null?void 0:u.folderUri)==null?void 0:c.fsPath)||a.interpreter.uri.fsPath,r.fsPath)}),i=n.find(a=>{var l;return br(a.interpreter)==="Venv"&&((l=_s(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});if(i)return i;let o=n.find(a=>{var l;return br(a.interpreter)==="Conda"&&((l=_s(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});if(o)return o;let s=n.find(a=>{var l;return((l=_s(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});return s||(n.length?n[0]:void 0)}function kM(r){return r===Ge||r===Bv}var r_=class{constructor(e,t,n,i,o,s,a){this.kernelFinder=e;this.serverUriStorage=t;this.serverSelector=n;this.jupyterConnection=i;this.displayDataProvider=o;this.kernelFinderController=s;this.jupyterServerRegistry=a;this.localDisposables=[]}async selectRemoteKernel(e,t){var o,s,a,l;if(e.notebookType!==St&&e.notebookType!==yr)return;this.localDisposables.forEach(u=>u.dispose()),this.localDisposables=[],(o=this.cancellationTokenSource)==null||o.cancel(),(s=this.cancellationTokenSource)==null||s.dispose(),this.cancellationTokenSource=new ii.CancellationTokenSource;let n=new oP,i={disposables:[],notebook:e};try{if(await n.run(this.getRemoteServersFromProvider.bind(this,t,this.cancellationTokenSource.token),i)===ze.cancel||((a=i.selection)==null?void 0:a.type)==="userPerformedSomeOtherAction")throw new ii.CancellationError;if(this.cancellationTokenSource.token.isCancellationRequested){Ce(i.disposables);return}if(((l=i.selection)==null?void 0:l.type)==="connection")return i.selection.connection}finally{Ce(i.disposables)}}async getRemoteServersFromProvider(e,t,n,i){var P;let o=this.kernelFinder.registered.filter(D=>D.kind==="remote"),s=[],a=[],l=[],u=(P=this.jupyterServerRegistry.jupyterCollections.find(D=>D.extensionId===e.extensionId&&D.id===e.id))==null?void 0:P.serverProvider,c=u!=null&&u.provideJupyterServers?Promise.resolve(u.provideJupyterServers.bind(u)(t)).then(D=>D||[]):Promise.resolve([]),d=new Set,f=await c,m=new Set(f.map(D=>D.id));if(o.filter(D=>D.serverProviderHandle.id===e.id).filter(D=>m.has(D.serverProviderHandle.id)).map(D=>{let K=this.serverUriStorage.all.find(L=>Vt(L.provider)===Vt(D.serverProviderHandle));d.add(Vt(D.serverProviderHandle)),l.push({server:D,time:K==null?void 0:K.time})}),l.sort((D,K)=>!D.time&&!K.time?D.server.displayName.localeCompare(K.server.displayName):!D.time&&K.time?1:D.time&&!K.time||(D.time||0)>(K.time||0)?-1:1),l.filter(({time:D})=>(D||0)>0).forEach(({server:D,time:K})=>{s.push({type:"finder",kernelFinderInfo:D,idAndHandle:D.serverProviderHandle,label:D.displayName,description:K?W.jupyterServerLastConnectionForQuickPickDescription(new Date(K)):void 0,buttons:u!=null&&u.removeJupyterServer&&kM(e.extensionId)?[{iconPath:new ii.ThemeIcon("close"),tooltip:W.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),l.filter(({time:D})=>!D).forEach(({server:D})=>{s.push({type:"finder",kernelFinderInfo:D,idAndHandle:D.serverProviderHandle,label:D.displayName,buttons:u!=null&&u.removeJupyterServer&&kM(e.extensionId)?[{iconPath:new ii.ThemeIcon("close"),tooltip:W.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),f.sort((D,K)=>D.label.localeCompare(K.label)).forEach(D=>{let K=Vt({extensionId:e.extensionId,id:e.id,handle:D.id});d.has(K)||s.push({type:"jupyterServer",label:D.label,idAndHandle:{extensionId:e.extensionId,id:e.id,handle:D.id},server:D,buttons:u!=null&&u.removeJupyterServer&&kM(e.extensionId)?[{iconPath:new ii.ThemeIcon("close"),tooltip:W.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),e.commandProvider){let D=(await Promise.resolve(e.commandProvider.provideCommands(void 0,t))||[]).map(K=>({...K,provider:e,type:"uriProviderQuickPick",command:K}));s.length>0&&D.length&&a.push({label:"",kind:ii.QuickPickItemKind.Separator}),a.push(...D)}let g=s.concat(a),b=new ii.EventEmitter,v=g.length===1&&"command"in g[0]&&g[0].command.canBeAutoSelected?g[0]:void 0;if(u){let D=g.filter(K=>"type"in K);D.length===1&&D.every(K=>K.type!=="uriProviderQuickPick")?v=D[0]:D.every(K=>K.type==="uriProviderQuickPick")&&D.filter(K=>K.picked).length===1&&(v=g.filter(K=>K.picked)[0])}let k,R;if(v)R=v;else{let{quickPick:D,selection:K}=n.showLazyLoadQuickPick({items:g,placeholder:e.extensionId===Ge||e.extensionId===Bv?W.enterOrSelectRemoteJupyterPlaceholder:W.selectRemoteJupyterPlaceholder,title:W.quickPickTitleForSelectionOfJupyterServer,supportBackInFirstStep:!0,onDidTriggerItemButton:async L=>{if("type"in L.item&&(L.item.type==="finder"||L.item.type==="jupyterServer")){let B=L.item.idAndHandle.handle,N=f.find(O=>O.id===B);u!=null&&u.removeJupyterServer&&N&&kM(e.extensionId)&&(D.busy=!0,this.serverUriStorage.remove({extensionId:e.extensionId,id:e.id,handle:B}).catch(E),await u.removeJupyterServer(N),D.busy=!1,g.splice(g.indexOf(L.item),1),b.fire(g.concat([])))}},onDidChangeItems:b.event});D.onDidChangeValue(async L=>{var h;if(!((h=e.commandProvider)!=null&&h.provideCommands))return;let B=[];s.length>0&&B.push({label:"",kind:ii.QuickPickItemKind.Separator});let O=(await Promise.resolve(e.commandProvider.provideCommands(L,t))||[]).map(y=>({...y,provider:e,type:"uriProviderQuickPick",command:y}));D.items=s.concat(B).concat(O)},this),k=D,R=await K}if(!t.isCancellationRequested&&R&&"type"in R)switch(R.type){case"finder":{let D=await this.selectRemoteKernelFromPicker(i.notebook,Promise.resolve(R.kernelFinderInfo),t).catch(K=>C.error("Failed to select a kernel",K));if(D&&D===ze.back){if(R===v)throw ze.back;return this.getRemoteServersFromProvider(e,t,n,i)}if(!D||D instanceof ze)throw new ii.CancellationError;i.selection={type:"connection",connection:D};return}case"jupyterServer":{let D=(async()=>{let L={id:e.id,handle:R.server.id,extensionId:e.extensionId};return e.extensionId.toLowerCase()===tc.toLowerCase()&&await ps(t,this.serverSelector.addJupyterServer(L)),this.kernelFinderController.getOrCreateRemoteKernelFinder(L,R.server.label)})(),K=await this.selectRemoteKernelFromPicker(i.notebook,D,t).catch(L=>C.error("Failed to select a kernel",L));if(K&&K===ze.back){if(R===v)throw ze.back;return this.getRemoteServersFromProvider(e,t,n,i)}if(!K||K instanceof ze)throw new ii.CancellationError;i.selection={type:"connection",connection:K};return}case"uriProviderQuickPick":{let D=ii.notebooks.createNotebookControllerDetectionTask(St);try{k&&(k.busy=!0);let K=await this.selectRemoteServerFromRemoteKernelFinder(R,i,t);return k&&(k.busy=!1),K}catch(K){if(K===ze.back&&!v)return this.getRemoteServersFromProvider(e,t,n,i);throw K}finally{D.dispose()}}default:break}}async selectRemoteServerFromRemoteKernelFinder(e,t,n){var a;if(!((a=e.provider.commandProvider)!=null&&a.handleCommand)||n.isCancellationRequested)return;let i=await Promise.resolve(e.provider.commandProvider.handleCommand(e.command,n));if(!i)throw ze.back;if(n.isCancellationRequested)throw new ii.CancellationError;let o=(async()=>{let l={id:e.provider.id,handle:i.id,extensionId:e.provider.extensionId};return l.extensionId.toLowerCase()===tc.toLowerCase()&&await ps(n,this.serverSelector.addJupyterServer(l)),this.kernelFinderController.getOrCreateRemoteKernelFinder(l,i.label)})(),s=await this.selectRemoteKernelFromPicker(t.notebook,o,n).catch(l=>C.error("Failed to select a kernel",l));if(s&&s===ze.back)throw ze.back;if(!s||s instanceof ze)throw new ii.CancellationError;t.selection={type:"connection",connection:s}}async selectRemoteKernelFromPicker(e,t,n){let i,o=c=>{let d=this.displayDataProvider.getDisplayData(c);return{label:`${c===i?"$(star-full) ":""}${d.label}`,description:d.description,detail:d.detail}},s=c=>({label:this.displayDataProvider.getDisplayData(c).category||"Other"}),a=c=>({label:W.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickLabel,detail:W.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickDetail}),l=new TM(t,o,s,{supportsBack:!0},a),u=new t_(this.jupyterConnection);return t.then(c=>u.findPreferredRemoteKernelConnection(e,c,n)).then(c=>{i=c,(c==null?void 0:c.kind)==="startUsingRemoteKernelSpec"&&(l.recommended=c),l.selected=c}).catch(c=>C.error("Failed to determine preferred remote kernel",c)),l.selectItem(n)}};r_=U([(0,Su.injectable)(),x(0,(0,Su.inject)(ri)),x(1,(0,Su.inject)(pr)),x(2,(0,Su.inject)(Kl)),x(3,(0,Su.inject)(hn)),x(4,(0,Su.inject)(PI)),x(5,(0,Su.inject)(gP)),x(6,(0,Su.inject)(sr))],r_);function _ne(r,e){r.addSingleton(Nt,$S),r.addBinding(Nt,Ve),r.addSingleton(PI,GS),r.addSingleton(PR,r_),r.addSingleton(Ve,e_),bne(r,e)}p();var kP=ae(he()),gv=require("vscode");p();var n_=Symbol("IJupyterDebugService"),mm=Symbol("INotebookDebuggingManager");var NM=Symbol("IDebugLocationTrackerFactory"),RM=Symbol("IDebugLocationTracker");var i_=class{constructor(e,t){this.debuggingManager=e;this.disposables=t}activate(){this.disposables.push(gv.commands.registerCommand(de.RunByLine,this.runByLine,this)),this.disposables.push(gv.commands.registerCommand(de.RunByLineNext,this.runByLineNext,this)),this.disposables.push(gv.commands.registerCommand(de.RunByLineStop,this.runByLineStop,this)),this.disposables.push(gv.commands.registerCommand(de.RunAndDebugCell,this.runAndDebugCell,this))}async runByLine(e){ne("DATASCIENCE.DEBUGGING.CLICKED_RUNBYLINE"),e!=null||(e=this.getCellFromActiveEditor()),e&&await this.debuggingManager.tryToStartDebugging(0,e)}async runByLineNext(e){e!=null||(e=this.getCellFromActiveEditor()),e&&this.debuggingManager.runByLineNext(e)}async runByLineStop(e){e!=null||(e=this.getCellFromActiveEditor()),e&&this.debuggingManager.runByLineStop(e)}async runAndDebugCell(e){ne("DATASCIENCE.DEBUGGING.CLICKED_RUN_AND_DEBUG_CELL"),e!=null||(e=this.getCellFromActiveEditor()),e&&await this.debuggingManager.tryToStartDebugging(1,e)}getCellFromActiveEditor(){let e=gv.window.activeNotebookEditor;if(e){let t=e.selections[0];if(t)return e.notebook.cellAt(t.start)}}dispose(){this.disposables.forEach(e=>e.dispose())}};i_=U([(0,kP.injectable)(),x(0,(0,kP.inject)(mm)),x(1,(0,kP.inject)(ve))],i_);p();var ql=ae(he());var NP=require("vscode");p();var E9=new Set(["DataFrame","list","dict","ndarray","Series","Tensor","EagerTensor","DataArray"]);function MM(r){var e;return{name:(e=r.evaluateName)!=null?e:r.name,type:r.type,count:0,shape:"",size:0,supportsDataExplorer:E9.has(r.type||""),value:r.value,truncated:!0,frameId:r.variablesReference}}function OM(r){let e=r.index,t=r.columns;return{data:r.data.map((o,s)=>{let a={index:e[s]};return t.forEach((l,u)=>{a[l]=o[u]}),a})}}p();var C9=require("vscode"),o_=class{constructor(e){this._sessionId=e;this.topMostFrameId=0;this.sequenceNumbersOfRequestsPendingResponses=new Set;this.waitingForStackTrace=!1;this.debugLocationUpdatedEvent=new C9.EventEmitter;this.sessionEndedEmitter=new C9.EventEmitter;this.DebugLocation=void 0}get sessionId(){return this._sessionId}get sessionEnded(){return this.sessionEndedEmitter.event}get debugLocationUpdated(){return this.debugLocationUpdatedEvent.event}get debugLocation(){return this._debugLocation}onDidSendMessage(e){var t,n;if(this.isResponseForRequestToFetchAllFrames(e)){let i=(t=e.body)==null?void 0:t.stackFrames[0];this.topMostFrameId=i==null?void 0:i.id,this.sequenceNumbersOfRequestsPendingResponses.delete(e.request_seq),this.waitingForStackTrace&&(this.DebugLocation={lineNumber:i==null?void 0:i.line,fileName:this.normalizeFilePath((n=i==null?void 0:i.source)==null?void 0:n.path),column:i.column},this.waitingForStackTrace=!1)}this.isStopEvent(e)&&(this.waitingForStackTrace=!0),this.isContinueEvent(e)&&(this.DebugLocation=void 0,this.waitingForStackTrace=!1)}onWillStopSession(){this.sessionEndedEmitter.fire(this)}onWillReceiveMessage(e){this.isRequestToFetchAllFrames(e)&&this.sequenceNumbersOfRequestsPendingResponses.add(e.seq)}set DebugLocation(e){let t=this._debugLocation;this._debugLocation=e,this._debugLocation!==t&&this.debugLocationUpdatedEvent.fire()}normalizeFilePath(e){return process.platform!=="win32"?e.replace(/\\/g,"/"):e}isStopEvent(e){return e.type==="event"&&e.event==="stopped"}isContinueEvent(e){if(e.type==="event"){if(e.event==="continue")return!0}else if(e.type==="response"&&e.command==="continue")return!0;return!1}isResponseForRequestToFetchAllFrames(e){var t;return e.type==="response"&&e.command==="stackTrace"&&((t=e.body)==null?void 0:t.stackFrames[0])&&this.sequenceNumbersOfRequestsPendingResponses.has(e.request_seq)}isRequestToFetchAllFrames(e){return e.type==="request"&&e.command==="stackTrace"&&(e.arguments.startFrame===0||e.arguments.startFrame===void 0)}};var p_e=new Set(["In","Out","exit","quit"]),LM=100,s_=class extends o_{constructor(t,n,i,o,s,a){super(void 0);this.debugService=t;this.debuggingManager=n;this.configService=i;this.varScriptGenerator=o;this.dfScriptGenerator=s;this.kernelProvider=a;this.refreshEventEmitter=new NP.EventEmitter;this.lastKnownVariables=[];this.importedGetVariableInfoScriptsIntoKernel=new Set;this.watchedNotebooks=new Map;this.debuggingStarted=!1;this.currentVariablesReference=0;this.currentSeqNumsForVariables=new Set;this.debuggingManager.onDoneDebugging(()=>this.refreshEventEmitter.fire(),this)}get refreshRequired(){return this.refreshEventEmitter.event}get active(){return(this.debugService.activeDebugSession!==void 0||this.activeNotebookIsDebugging())&&this.debuggingStarted}getAllVariableDiscriptions(){throw new Error("Method not implemented.")}async getVariables(t,n){n&&this.watchKernel(n);let i=n&&this.kernelProvider.getKernelExecution(n),o={executionCount:i?i.executionCount:t.executionCount,pageStartIndex:0,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};if(this.active){let s=t.sortColumn,a=(c,d)=>{let f=c[s]?c[s]:"",m=d[s]?d[s]:"";return t.sortAscending?f.localeCompare(m,void 0,{sensitivity:"base"}):m.localeCompare(f,void 0,{sensitivity:"base"})};this.lastKnownVariables.sort(a);let l=t.startIndex?t.startIndex:0,u=t.pageSize?t.pageSize:LM;o.pageStartIndex=l;for(let c=l;c<l+u&&c<this.lastKnownVariables.length;c+=1){let d=this.lastKnownVariables[c].truncated?await this.getFullVariable(this.lastKnownVariables[c]):this.lastKnownVariables[c];this.lastKnownVariables[c]=d,o.pageResponse.push(d)}o.totalCount=this.lastKnownVariables.length}return o}async getMatchingVariable(t,n){if(this.active){let i=this.lastKnownVariables.find(o=>o.name===t);return i&&(n!=null&&n.resourceUri)&&Xv(n==null?void 0:n.resourceUri).toLowerCase()===".ipynb"&&ne("DATASCIENCE.RUN_BY_LINE_VARIABLE_HOVER"),i}}async getVariableValueSummary(t){}async getDataFrameInfo(t,n,i,o){var m;if(!this.active)return t;o&&(t=await this.getFullVariable(t)),n&&this.watchKernel(n);let s=t.name;i&&(s=`${t.name}${i}`);let{cleanupCode:a,initializeCode:l,code:u}=await this.dfScriptGenerator.generateCodeToGetDataFrameInfo({isDebugging:!0,variableName:s}),c=await this.evaluate({code:u,cleanupCode:a,initializeCode:l,frameId:t.frameId}),d=n==null?void 0:n.notebook,f=d?Ht(d.uri.path):"";return!f&&((m=this.debugLocation)!=null&&m.fileName)&&(f=Ht(this.debugLocation.fileName)),c?{...t,...JSON.parse(c.result),maximumRowChunkSize:LM,fileName:f}:t}async getDataFrameRows(t,n,i,o,s){if(i-n>LM)throw new Error(`Debugger cannot provide more than ${LM} rows at once`);if(!this.debugService.activeDebugSession||t.columns===void 0)return{data:[]};o&&this.watchKernel(o);let a=t.name;s&&(a=`${t.name}${s}`);let{cleanupCode:l,initializeCode:u,code:c}=await this.dfScriptGenerator.generateCodeToGetDataFrameRows({isDebugging:!0,variableName:a,startIndex:n,endIndex:i}),d=await this.evaluate({code:c,cleanupCode:l,initializeCode:u,frameId:t.frameId});return OM(JSON.parse(d.result))}onWillReceiveMessage(t){super.onWillReceiveMessage(t),t.type==="request"&&t.command==="variables"&&t.arguments&&this.currentVariablesReference===t.arguments.variablesReference&&this.currentSeqNumsForVariables.add(t.seq)}onDidSendMessage(t){var n;if(super.onDidSendMessage(t),t.type==="response"&&t.command==="initialize")this.debuggingStarted=!0;else if(t.type==="event"&&t.event==="stopped"&&this.activeNotebookIsDebugging())this.handleNotebookVariables(t).catch(E);else if(t.type==="response"&&t.command==="scopes"&&t.body&&t.body.scopes){let o=t.body.scopes[0].variablesReference;o!==this.currentVariablesReference&&(this.currentVariablesReference=o,this.currentSeqNumsForVariables.clear())}else if(t.type==="response"&&t.command==="variables"&&t.body)this.currentSeqNumsForVariables.has(t.request_seq)&&this.updateVariables(void 0,t),this.monkeyPatchDataViewableVariables(t);else if(t.type==="event"&&t.event==="terminated"){this.lastKnownVariables=[],this.topMostFrameId=0,this.debuggingStarted=!1,this.refreshEventEmitter.fire();let i=(n=this.debugService.activeDebugSession)==null?void 0:n.id;i&&this.importedGetVariableInfoScriptsIntoKernel.delete(i)}}watchKernel(t){var i;let n=(i=t.notebook)==null?void 0:i.uri.toString();if(n&&!this.watchedNotebooks.has(n)){let o=[];o.push(t.onRestarted(this.resetImport.bind(this,n))),o.push(t.onDisposed(()=>{this.resetImport(n),o.forEach(s=>s.dispose()),this.watchedNotebooks.delete(n)})),this.watchedNotebooks.set(n,o)}}resetImport(t){this.importedGetVariableInfoScriptsIntoKernel.delete(t)}async evaluate({code:t,cleanupCode:n,frameId:i,initializeCode:o}){if(this.debugService.activeDebugSession){i=this.topMostFrameId||i;let s={frameId:i,context:"repl",format:{rawString:!0}};C.debug(`Evaluating in debugger : ${this.debugService.activeDebugSession.id}: ${t}`);try{o&&await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:o});let a=await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:t});if(a&&a.result!=="None")return a;C.error(`Cannot evaluate ${t}`);return}finally{n&&await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:n})}}throw Error("Debugger is not active, cannot evaluate.")}async getFullVariable(t){let{initializeCode:n,code:i,cleanupCode:o}=await this.varScriptGenerator.generateCodeToGetVariableInfo({isDebugging:!0,variableName:t.name}),s=await this.evaluate({code:i,initializeCode:n,cleanupCode:o,frameId:t.frameId});return s&&s.result?{...t,truncated:!1,...JSON.parse(s.result)}:t}monkeyPatchDataViewableVariables(t){t.body.variables.forEach(n=>{n.type&&E9.has(n.type)&&n.evaluateName&&(n.__vscodeVariableMenuContext="viewableInDataViewer")})}updateVariables(t,n){var s;let i=this.configService.getSettings(t).variableExplorerExclude?(s=this.configService.getSettings().variableExplorerExclude)==null?void 0:s.split(";"):[],o=n.body.variables.filter(a=>!(!a.name||!a.type||!a.value||i&&i.includes(a.type)||a.name.startsWith("_")||p_e.has(a.name)||a.type==="NoneType"));this.lastKnownVariables=o.map(a=>MM(a)),this.refreshEventEmitter.fire()}activeNotebookIsDebugging(){let t=NP.window.activeNotebookEditor;return!!t&&this.debuggingManager.isDebugging(t.notebook)}async handleNotebookVariables(t){var o;let n=(o=NP.window.activeNotebookEditor)==null?void 0:o.notebook,i=t.body.threadId;if(n){let s=this.debuggingManager.getDebugSession(n);if(s){let a=await s.customRequest("stackTrace",{threadId:i,startFrame:0,levels:1});if(a&&a.stackFrames[0]){let l=a.stackFrames[0],u=this.debuggingManager.getDebugMode(n),c;if(u===0){let d=this.debuggingManager.getDebugCell(n);l.source&&d&&l.source.path===d.document.uri.toString()&&(c=await s.customRequest("scopes",{frameId:l.id}))}else{let d=Ht(n.uri.toString());l.source&&l.source.path&&l.source.path.includes(d)&&(c=await s.customRequest("scopes",{frameId:l.id}))}c&&(c.scopes.forEach(d=>{s.customRequest("variables",{variablesReference:d.variablesReference}).then(E,E)}),this.refreshEventEmitter.fire())}}}}};s_=U([(0,ql.injectable)(),x(0,(0,ql.inject)(n_)),x(0,(0,ql.named)(nt.MULTIPLEXING_DEBUGSERVICE)),x(1,(0,ql.inject)(mm)),x(2,(0,ql.inject)(Ke)),x(3,(0,ql.inject)(dy)),x(4,(0,ql.inject)(py)),x(5,(0,ql.inject)(qe))],s_);p();var Zd=ae(he()),hm=require("vscode");p();var Ene=require("vscode"),mr=class{constructor(e){this.name=e}get value(){return this.lastValue}async set(e){this.lastValue!==e&&(this.lastValue=e,await Ene.commands.executeCommand("setContext",this.name,this.lastValue))}};p();var Tne=require("vscode");p();var RP=(o=>(o[o.Unknown=0]="Unknown",o[o.Ok=1]="Ok",o[o.Outdated=2]="Outdated",o[o.NotInstalled=3]="NotInstalled",o[o.ControllerNotSelected=4]="ControllerNotSelected",o))(RP||{});async function Cne(r){var o,s;let e="5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d",t=`import builtins
import ipykernel
builtins.print("${e}" + ipykernel.__version__ + "${e}")`,n=await r.executeHidden(t),i=/^(\d+)\.\d+\.\d+$/;for(let a of n){if(a.output_type!=="stream")continue;let l=(s=(o=a.text)==null?void 0:o.toString().trim())!=null?s:"";if(!l.includes(e))continue;let u=l.split(e)[1].trim().match(i);if(u){let c=u[1];return Number(c)>=6?1:2}}return 0}function AP(r){let e=r;if(typeof e.__notebookUri=="undefined"||typeof e.__mode=="undefined"||(e.__mode===1||e.__mode===2||e.__mode===0)&&typeof e.__cellIndex=="undefined")throw new Error("Invalid launch configuration")}function wne(r){if(AP(r),r.__mode!==2)throw new Error("Invalid launch configuration")}function KM(r,e){switch(r.type){case"event":let t=r;switch(t.event){case"output":e(t.body);break;case"loadedSource":e(t.body);break;case"breakpoint":e(t.body.breakpoint);break;default:break}break;case"request":let n=r;switch(n.command){case"setBreakpoints":let o=n.arguments,s=o.breakpoints;if(s&&s.length){let a=s[0].line;s.forEach(u=>{e(u,{...o.source})});let l={source:o.source,line:a};e(l),o.source=l.source}break;case"breakpointLocations":e(n.arguments);break;case"source":e(n.arguments);break;case"gotoTargets":e(n.arguments);break;default:break}break;case"response":let i=r;if(i.success&&i.body)switch(i.command){case"stackTrace":i.body.stackFrames.forEach(o=>{e(o)});break;case"loadedSources":i.body.sources.forEach(o=>{let s={source:o};e(s),o.path=s.source.path});break;case"scopes":i.body.scopes.forEach(o=>{e(o)});break;case"setFunctionBreakpoints":i.body.breakpoints.forEach(o=>{e(o)});break;case"setBreakpoints":i.body.breakpoints.forEach(o=>{e(o)});break;default:break}break}}function xne(r){return/~\d+\\/.test(r)}function Pne(r,e){return new RegExp(r.replace(/\\/g,"\\\\").replace(/~\d+\\\\/g,"[^\\\\]+\\\\"),"i").test(e)}async function vv(r,e){await r.executeHidden(`import debugpy
debugpy.debug_this_thread()`),await e.dumpAllCells()}function Dne(r){return!!r.header&&r.header.msg_type==="debug_event"}function MP(r){return r.includes("Frame skipped from debugging during step-in")}function w9(r){return r.event==="debugpyAttach"}var FM=class{constructor(e,t,n){this.debugAdapter=e;this.debugCell=t;this.execution=n;ne("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL")}trace(e,t){C.debug(`[Debug-Cell] ${e}: ${t}`)}async willSendEvent(e){return w9(e)?(this.trace("intercept","debugpyAttach request for subprocess, not supported"),!0):e.event==="output"&&MP(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){e.command==="configurationDone"&&(await vv(this.execution,this.debugAdapter),Tne.commands.executeCommand("notebook.cell.execute",{ranges:[{start:this.debugCell.index,end:this.debugCell.index+1}],document:this.debugCell.notebook.uri}).then(E,E))}};p();var OP=class{constructor(e,t,n,i){this.mode=e;this.debugAdapter=t;this.debugCell=n;this.serviceContainer=i;this.debuggingManager=this.serviceContainer.get(mm)}trace(e,t){C.debug(`[Debug-Restart] ${e}: ${t}`)}error(e,t){C.error(`[Debug-Restart] ${e}: ${t}`)}async willSendResponse(e){e.command==="initialize"&&e.body&&(e.body.supportsRestartRequest=!0)}async willSendRequest(e){if(e.command==="restart")return this.trace("restart","Handling restart request"),setTimeout(()=>{this.debugAdapter.disconnect().then(()=>(this.trace("restart","doRestart"),this.debuggingManager.tryToStartDebugging(this.mode,this.debugCell,!0))).catch(t=>{this.error("restart",`Error restarting: ${t}`)})},0),{command:e.command,request_seq:e.seq,seq:e.seq,success:!0,type:"response"}}};p();var LP=require("vscode");var UM=class{constructor(e,t,n,i){this.debugAdapter=e;this.debugCell=t;this.execution=n;this.settings=i;ne("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUNBYLINE")}continue(){if(typeof this.lastPausedThreadId!="number"){C.debug("No paused thread, can't do RBL"),this.stop();return}this.debugAdapter.stepIn(this.lastPausedThreadId).then(E,E)}stop(){C.ci("RunbylineController::stop()"),this.execution.executeHidden("pass").then(E,E),this.debugAdapter.disconnect().then(E,E)}getMode(){return this.debugAdapter.getConfiguration().__mode}async willSendEvent(e){return e.event==="stopped"&&(this.lastPausedThreadId=e.body.threadId,await this.handleStoppedEvent(this.lastPausedThreadId))?(this.trace("intercepted","handled stop event"),!0):e.event==="output"&&MP(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){C.ci(`willSendRequest: ${e.command}`),e.command==="configurationDone"&&await this.initializeExecute()}async handleStoppedEvent(e){return await this.shouldStepIn(e)?(this.debugAdapter.stepIn(e).then(E,E),!0):!1}async shouldStepIn(e){var n;let t=await this.debugAdapter.stackTrace({threadId:e,startFrame:0,levels:1});if(t&&t.stackFrames[0]){let i=t.stackFrames[0],o=new LP.Position(i.line,i.column);return(n=this.lastPausePosition)!=null&&n.isEqual(o)?(this.trace("intercept","working around duplicate stop event"),!0):(this.lastPausePosition=o,!!i.source&&i.source.path!==this.debugCell.document.uri.toString())}return!1}trace(e,t){C.debug(`[Debug-RBL] ${e}: ${t}`)}async initializeExecute(){await vv(this.execution,this.debugAdapter);let e=ct(this.debugCell.document.getText(),{trim:!1,removeEmptyEntries:!1}),t=[];if(Og(e,()=>void 0,(n,i)=>{n.trim().length!==0&&t.push(i)}),t.sort(),t.length!==0){let n={line:t[0]+1};await this.debugAdapter.setBreakpoints({source:{name:Ht(this.debugCell.notebook.uri.path),path:this.debugCell.document.uri.toString()},breakpoints:[n],sourceModified:!1}),this.settings.getSettings(this.debugCell.notebook.uri).showVariableViewWhenDebugging&&LP.commands.executeCommand(de.OpenVariableView).then(E,E)}LP.commands.executeCommand("notebook.cell.execute",{ranges:[{start:this.debugCell.index,end:this.debugCell.index+1}],document:this.debugCell.notebook.uri}).then(E,E)}};p();var a_=class{constructor(e,t,n){this.document=e;this.config=t;this.session=n}};p();var oi=require("vscode");var l_=class{constructor(e,t,n){this.kernelProvider=e;this.controllerRegistration=t;this.serviceContainer=n;this.notebookToDebugger=new Map;this.notebookToDebugAdapter=new Map;this.notebookInProgress=new Set;this.disposables=[];this._doneDebugging=new oi.EventEmitter}activate(){this.disposables.push(oi.debug.onDidTerminateDebugSession(this.endSession.bind(this)),oi.workspace.onDidCloseNotebookDocument(async e=>{let t=this.notebookToDebugger.get(e);t&&(await oi.debug.stopDebugging(t.session),this.onDidStopDebugging(e))}))}getDebugCell(e){var t;return(t=this.notebookToDebugAdapter.get(e))==null?void 0:t.debugCell}get onDoneDebugging(){return this._doneDebugging.event}dispose(){this.disposables.forEach(e=>e.dispose())}isDebugging(e){return this.notebookToDebugger.has(e)}getDebugSession(e){let t=this.notebookToDebugger.get(e);if(t)return t.session}getDebugAdapter(e){return this.notebookToDebugAdapter.get(e)}onDidStopDebugging(e){}async startDebuggingConfig(e,t){C.ci(`Attempting to start debugging with config ${JSON.stringify(e)}`);try{await oi.debug.startDebugging(void 0,e,t)}catch(n){C.error(`Can't start debugging (${n})`),oi.window.showErrorMessage(W.cantStartDebugging).then(E,E)}}trackDebugAdapter(e,t){this.notebookToDebugAdapter.set(e,t),this.disposables.push(t.onDidEndSession(this.endSession.bind(this)))}async endSession(e){C.info(`Ending debug session ${e.id}`),this._doneDebugging.fire();for(let[t,n]of this.notebookToDebugger.entries())if(n&&e.id===n.session.id){this.notebookToDebugger.delete(t),this.notebookToDebugAdapter.delete(t),this.onDidStopDebugging(t);break}}getDebuggerByUri(e){for(let[t,n]of this.notebookToDebugger.entries())if(e===t)return n}async ensureKernelIsRunning(e){let t=this.controllerRegistration.getSelected(e),n=this.kernelProvider.get(e);return t&&(!n||n&&n.status==="unknown")&&(n=await Ta.connectToNotebookKernel(t.connection,this.serviceContainer,{notebook:e,controller:t.controller,resource:e.uri},new fr(!1),this.disposables,"jupyterExtension")),n}findEditorForCell(e){let t=e.notebook.uri.toString();return oi.window.visibleNotebookEditors.find(n=>n.notebook.uri.toString()===t)}async checkIpykernelAndPrompt(e,t=!0){let n=this.findEditorForCell(e);if(!n)return oi.window.showErrorMessage(W.noNotebookToDebug).then(E,E),0;let i=await this.checkForIpykernel6(n.notebook);switch(i){case 3:break;case 2:case 0:{this.promptInstallIpykernel6().then(E,E);break}case 4:if(t)return await oi.commands.executeCommand("notebook.selectKernel",{notebookEditor:n}),await this.checkIpykernelAndPrompt(e,!1)}return i}async checkForIpykernel6(e){var t,n;try{let i=this.kernelProvider.get(e);if(!i){let l=this.controllerRegistration.getSelected(e);if(!l)return 4;i=this.kernelProvider.getOrCreate(e,{metadata:l.connection,controller:l==null?void 0:l.controller,resourceUri:e.uri})}let o=i.kernelConnectionMetadata;if(Wt(o)){if(o.kind==="startUsingRemoteKernelSpec"&&((t=o.kernelSpec.metadata)!=null&&t.debugger))return 1;if(o.kind==="connectToLiveRemoteKernel"&&((n=o.kernelModel.metadata)!=null&&n.debugger))return 1}let s=this.kernelProvider.getKernelExecution(i),a=await Cne(s);return ne("DATASCIENCE.DEBUGGING.IPYKERNEL6_STATUS",void 0,{status:a===1?"installed":"notInstalled"}),a}catch(i){C.error("Debugging: Could not check for ipykernel 6",i)}return 0}async promptInstallIpykernel6(){await oi.window.showInformationMessage(W.needIpykernel6,{modal:!0},W.setup)===W.setup?(ne("DATASCIENCE.DEBUGGING.CLICKED_ON_SETUP"),oi.env.openExternal(oi.Uri.parse("https://github.com/microsoft/vscode-jupyter/wiki/Setting-Up-Run-by-Line-and-Debugging-for-Notebooks"))):ne("DATASCIENCE.DEBUGGING.CLOSED_MODAL")}};p();p();var Jl=require("vscode");p();var WM=class{constructor(e){this.debugAdapter=e}trace(e,t){C.debug(`[Debug-Reset] ${e}: ${t}`)}async willSendRequest(e){e.command==="attach"&&(this.trace("attach","Continuing paused kernel threads if needed"),(await this.debugAdapter.debugInfo()).stoppedThreads.forEach(n=>this.debugAdapter.continueDirect(n)))}};var c_=class{constructor(e,t,n,i,o,s){this.session=e;this.notebookDocument=t;this.jupyterSession=n;this.kernel=i;this.platformService=o;this.debugService=s;this.fileToCell=new Map;this.sendMessage=new Jl.EventEmitter;this.endSession=new Jl.EventEmitter;this.disposables=[];this.delegates=[];this.onDidSendMessage=this.sendMessage.event;this.onDidEndSession=this.endSession.event;this.disconnected=!1;var l;C.ci("Creating kernel debug adapter for debugging notebooks");let a=this.session.configuration;AP(a),this.configuration=a,this.debugCell=t.cellAt(a.__cellIndex),this.addDebuggingDelegates([new WM(this)]),(l=this.jupyterSession.kernel)==null||l.iopubMessage.connect(this.onIOPubMessage,this),this.disposables.push(new Jl.Disposable(()=>{var u;return(u=this.jupyterSession.kernel)==null?void 0:u.iopubMessage.disconnect(this.onIOPubMessage,this)})),this.kernel&&(this.kernel.addHook("willRestart",()=>this.disconnect(),this,this.disposables),this.kernel.addHook("interruptCompleted",()=>this.disconnect(),this,this.disposables),this.disposables.push(this.kernel.onDisposed(()=>{this.disconnected||(Jl.debug.stopDebugging(this.session).then(E,E),this.disconnect().catch(E),ne("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"onKernelDisposed"}))}))),this.disposables.push(Mr.onDidChangeNotebookCellExecutionState(u=>{this.configuration.__cellIndex===u.cell.index&&u.state===1&&!this.disconnected&&(ne("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"normally"}),this.disconnect().catch(E))},this,this.disposables)),this.disposables.push(Jl.workspace.onDidChangeNotebookDocument(u=>{u.contentChanges.forEach(c=>{c.removedCells.forEach(d=>{d===this.debugCell&&this.disconnect().catch(E)})})},this,this.disposables)),this.disposables.push(this.debugService.onDidTerminateDebugSession(u=>{(u===this.session||u===this.session)&&this.disconnect().catch(E)}))}addDebuggingDelegates(e){this.delegates.push(...e)}trace(e,t){C.debug(`[Debug] ${e}: ${t}`)}async onIOPubMessage(e,t){var n,i;if(C.ci(`Debug IO Pub message: ${JSON.stringify(t)}`),Dne(t)){this.trace("event",JSON.stringify(t));for(let o of(n=this.delegates)!=null?n:[])if(await((i=o==null?void 0:o.willSendEvent)==null?void 0:i.call(o,t.content)))return;this.sendMessage.fire(t.content)}}handleMessage(e){this.handleClientMessageAsync(e).catch(E)}async handleClientMessageAsync(e){var t,n;try{if(C.ci(`KernelDebugAdapter::handleMessage ${JSON.stringify(e,void 0," ")}`),e.type==="request"&&e.command==="setBreakpoints"){let i=e.arguments;if(i.source&&i.source.path&&i.source.path.indexOf("vscode-notebook-cell:")===0){let o=this.notebookDocument.getCells().find(s=>s.document.uri.toString()===i.source.path);o&&await this.dumpCell(o.index)}}if(e.type==="request")for(let i of(t=this.delegates)!=null?t:[]){let o=await((n=i==null?void 0:i.willSendRequest)==null?void 0:n.call(i,e));if(o){this.trace("response",JSON.stringify(o)),this.sendMessage.fire(o);return}}await this.sendMessageToJupyterSession(e)}catch(i){C.error(`KernelDebugAdapter::handleMessage failure: ${i}`)}}getConfiguration(){return this.configuration}stepIn(e){return this.session.customRequest("stepIn",{threadId:e})}async debugInfo(){return await this.session.customRequest("debugInfo")}continueDirect(e){if(!this.jupyterSession.kernel)throw new Qr;this.jupyterSession.kernel.requestDebug({seq:0,type:"request",command:"continue",arguments:{threadId:e}})}async disconnect(){var e;if(!this.disconnected){if(this.disconnected=!0,this.debugService.activeDebugSession===this.session||((e=this.debugService.activeDebugSession)==null?void 0:e.id)===this.session.id)try{await Promise.all([this.deleteDumpedFiles().catch(t=>C.warn("Error deleting temporary debug files.",t)),this.session.customRequest("disconnect",{restart:!1})])}catch(t){C.error("Failed to disconnect debug session",t)}this.endSession.fire(this.session)}}dispose(){this.disposables.forEach(e=>e.dispose())}stackTrace(e){return this.session.customRequest("stackTrace",e)}setBreakpoints(e){return this.session.customRequest("setBreakpoints",e)}async dumpAllCells(){await Promise.all(this.notebookDocument.getCells().map(async e=>{e.kind===Jl.NotebookCellKind.Code&&await this.dumpCell(e.index)}))}lookupCellByLongName(e){if(this.platformService.isWindows){e=Ss(e);for(let[t,n]of this.fileToCell.entries())if(xne(t)&&Pne(t,e))return n}}async sendMessageToJupyterSession(e){if(this.jupyterSession.isDisposed||this.jupyterSession.status==="dead"||!this.jupyterSession.kernel){C.info(`Skipping sending message ${e.type} because session is disposed`);return}if(this.trace("to kernel",JSON.stringify(e)),e.type==="request"){let t=await this.sendRequestToJupyterSession(e);t&&this.sendMessage.fire(t)}else if(e.type==="response"){KM(e,this.translateRealLocationToDebuggerLocation.bind(this));let t=e;return this.jupyterSession.kernel.requestDebug({seq:t.seq,type:"request",command:t.command},!0).done}else C.error(`Unknown message type to send ${e.type}`)}async sendRequestToJupyterSession(e){var s,a;if(KM(e,this.translateRealLocationToDebuggerLocation.bind(this)),!this.jupyterSession.kernel)throw new Qr;this.trace("to kernel, mapped",JSON.stringify(e));let t=e,o=(await this.jupyterSession.kernel.requestDebug({seq:t.seq,type:"request",command:t.command,arguments:t.arguments},!0).done).content;KM(o,this.translateDebuggerLocationToRealLocation.bind(this));for(let l of(s=this.delegates)!=null?s:[])await((a=l==null?void 0:l.willSendResponse)==null?void 0:a.call(l,o));return this.trace("response",JSON.stringify(o)),o}translateDebuggerLocationToRealLocation(e,t){var n,i;if(t=(n=e==null?void 0:e.source)!=null?n:t,t&&t.path){let o=(i=this.fileToCell.get(t.path))!=null?i:this.lookupCellByLongName(t.path);o&&(t.name=Ht(o.path),t.path=o.toString())}}async deleteDumpedFiles(){let e=this.getDumpFilesForDeletion();if(this.jupyterSession.kernel&&e.length){let n=`import os as _VSCODE_os
_VSCODE_fileList = [${e.map(i=>'"'+i.replace(/\\/g,"\\\\")+'"').join(",")}]
for file in _VSCODE_fileList:
    try:
        _VSCODE_os.remove(file)
    except:
        pass
del _VSCODE_fileList
del _VSCODE_os`;await Ai(this.jupyterSession.kernel,n,{traceErrors:!0,traceErrorsMessage:"Error deleting temporary debugging files"})}}};var VM=class extends c_{constructor(){super(...arguments);this.cellToFile=new Map;this.lineOffsets=new WeakMap}async dumpCell(t){let n=this.notebookDocument.cellAt(t);try{let i=await this.session.customRequest("dumpCell",{code:n.document.getText().replace(/\r\n/g,`
`)}),o=Ss(i.sourcePath);this.fileToCell.set(o,n.document.uri),this.cellToFile.set(n.document.uri.toString(),o),this.lineOffsets.set(n,f_e(n))}catch(i){C.error(i)}}translateDebuggerLocationToRealLocation(t,n){var a,l,u;if(n=(a=t==null?void 0:t.source)!=null?a:n,!(n!=null&&n.path)||!this.fileToCell.size)return;let i=(l=this.fileToCell.get(n.path))!=null?l:this.lookupCellByLongName(n.path);if(!i)return;let o=this.notebookDocument.getCells().find(c=>c.document.uri.toString()===i.toString()),s=o&&(u=this.lineOffsets.get(o))!=null?u:0;n.name=Ht(i.path),n.path=i.toString(),s&&typeof(t==null?void 0:t.endLine)=="number"&&(t.endLine=t.endLine+s),s&&typeof(t==null?void 0:t.line)=="number"&&(t.line=t.line+s)}translateRealLocationToDebuggerLocation(t,n){var a,l;if(n=(a=t==null?void 0:t.source)!=null?a:n,!(n!=null&&n.path)||!this.cellToFile.size)return;let i=this.cellToFile.get(n.path);if(!i)return;let o=this.notebookDocument.getCells().find(u=>u.document.uri.toString()===n.path),s=o&&(l=this.lineOffsets.get(o))!=null?l:0;n.path=i,s&&typeof t.line=="number"&&(t.line<s?t.line=s:t.line>s&&(t.line-=s)),s&&typeof t.endLine=="number"&&(t.endLine<s?t.endLine=s:t.endLine>s&&(t.endLine-=s))}getDumpFilesForDeletion(){return Array.from(this.cellToFile.values())}};function f_e(r){for(let e=0;e<r.document.lineCount;e+=1)if(r.document.lineAt(e).text.trim().length>0)return e;return 0}var u_=class extends l_{constructor(t,n,i,o,s,a){super(t,n,a);this.configurationService=i;this.platform=o;this.debugService=s;this.notebookToRunByLineController=new Map;this.runByLineCells=new mr(vr.RunByLineCells),this.runByLineDocuments=new mr(vr.RunByLineDocuments),this.debugDocuments=new mr(vr.DebugDocuments)}activate(){super.activate(),this.disposables.push(hm.debug.registerDebugAdapterDescriptorFactory(hK,{createDebugAdapterDescriptor:async t=>this.createDebugAdapterDescriptor(t)}))}getDebugMode(t){let n=this.notebookToRunByLineController.get(t);return n==null?void 0:n.getMode()}onDidStopDebugging(t){super.onDidStopDebugging(t),this.notebookToRunByLineController.delete(t),this.updateRunByLineContextKeys(),this.updateDebugContextKey()}updateRunByLineContextKeys(){let t=[],n=[];this.notebookToRunByLineController.forEach(i=>{t.push(i.debugCell.document.uri),n.push(i.debugCell.notebook.uri)}),this.runByLineCells.set(t).catch(E),this.runByLineDocuments.set(n).catch(E)}updateDebugContextKey(){let t=new uM;this.notebookToDebugAdapter.forEach((n,i)=>t.add(i.uri)),this.notebookInProgress.forEach(n=>t.add(n.uri)),this.debugDocuments.set(Array.from(t.values())).catch(E)}async tryToStartDebugging(t,n,i=!1){if(C.info(`Starting debugging with mode ${t}`),!i){let o=await this.checkIpykernelAndPrompt(n);if(o!==1){C.info(`Ipykernel check failed: ${RP[o]}`);return}}(t===0||t===1)&&await this.startDebuggingCell(t,n)}runByLineNext(t){let n=this.notebookToRunByLineController.get(t.notebook);n&&n.debugCell.document.uri.toString()===t.document.uri.toString()&&n.continue()}runByLineStop(t){let n=this.notebookToRunByLineController.get(t.notebook);n&&(ne("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"withKeybinding"}),n.stop())}async startDebuggingCell(t,n){let i=n.notebook,o=this.configurationService.getSettings(i.uri),s={type:hK,name:Ht(i.uri.toString()),request:"attach",justMyCode:t===1?o.debugJustMyCode:!0,__mode:t,__cellIndex:n.index,__notebookUri:i.uri.toString()},a=t===0?{suppressDebugStatusbar:!0,suppressDebugToolbar:!0,suppressDebugView:!0,suppressSaveBeforeStart:!0}:{suppressSaveBeforeStart:!0};return this.startDebuggingConfig(s,a)}async createDebugAdapterDescriptor(t){let n=t.configuration;AP(n);let i=n.__notebookUri,o=hm.workspace.notebookDocuments.find(s=>s.uri.toString()===i);if(!o){C.info(`Cannot start debugging. Notebook ${i} not found.`);return}if(this.notebookInProgress.has(o)){C.info("Cannot start debugging. Already debugging this notebook");return}if(this.isDebugging(o)){C.info("Cannot start debugging. Already debugging this notebook document.");return}this.notebookToDebugger.set(o,new a_(o,n,t));try{return this.notebookInProgress.add(o),this.updateDebugContextKey(),await this.doCreateDebugAdapterDescriptor(n,t,o)}finally{this.notebookInProgress.delete(o),this.updateDebugContextKey()}}async doCreateDebugAdapterDescriptor(t,n,i){let o=await this.ensureKernelIsRunning(i);if(o!=null&&o.session){let s=new VM(n,i,o.session,o,this.platform,this.debugService);if(t.__mode===0&&typeof t.__cellIndex=="number"){let a=i.cellAt(t.__cellIndex),l=new UM(s,a,this.kernelProvider.getKernelExecution(o),this.configurationService);s.addDebuggingDelegates([l,new OP(0,s,a,this.serviceContainer)]),this.notebookToRunByLineController.set(i,l),this.updateRunByLineContextKeys()}else if(t.__mode===1&&typeof t.__cellIndex=="number"){let a=i.cellAt(t.__cellIndex),l=new FM(s,a,this.kernelProvider.getKernelExecution(o));s.addDebuggingDelegates([l,new OP(1,s,a,this.serviceContainer)])}return this.trackDebugAdapter(i,s),this.updateDebugContextKey(),new hm.DebugAdapterInlineImplementation(s)}else hm.window.showInformationMessage(W.kernelWasNotStarted).then(E,E)}};u_=U([(0,Zd.injectable)(),x(0,(0,Zd.inject)(qe)),x(1,(0,Zd.inject)(Nt)),x(2,(0,Zd.inject)(Ke)),x(3,(0,Zd.inject)(fs)),x(4,(0,Zd.inject)(lo)),x(5,(0,Zd.inject)(Ar))],u_);p();var KP=ae(he()),kne=require("vscode");var d_=class{constructor(e,t){this.disposableRegistry=t;this.activeTrackers=new WeakMap;this.activeTrackersById=new Map;this.updatedEmitter=new kne.EventEmitter;t.push(e.registerDebugAdapterTrackerFactory("python",this))}createDebugAdapterTracker(e){let t=new o_(e.id);return this.activeTrackers.set(e,t),this.activeTrackersById.set(e.id,t),t.sessionEnded(()=>{this.activeTrackers.delete(e),this.activeTrackersById.delete(e.id)},this,this.disposableRegistry),t.debugLocationUpdated(this.onLocationUpdated,this,this.disposableRegistry),this.onLocationUpdated(),t}get updated(){return this.updatedEmitter.event}getLocation(e){let t=this.activeTrackers.get(e)||this.activeTrackersById.get(e.id);if(t)return t.debugLocation}onLocationUpdated(){this.updatedEmitter.fire()}};d_=U([(0,KP.injectable)(),x(0,(0,KP.inject)(lo)),x(1,(0,KP.inject)(ve))],d_);p();var _u=ae(he()),yv=require("vscode");var p_=class{constructor(e,t,n){this.vscodeDebugService=t;this.jupyterDebugService=n;this.sessionChangedEvent=new yv.EventEmitter;this.sessionStartedEvent=new yv.EventEmitter;this.sessionTerminatedEvent=new yv.EventEmitter;this.sessionCustomEvent=new yv.EventEmitter;e.push(t.onDidTerminateDebugSession(this.endedDebugSession.bind(this))),e.push(t.onDidStartDebugSession(this.startedDebugSession.bind(this))),e.push(t.onDidChangeActiveDebugSession(this.changedDebugSession.bind(this))),e.push(t.onDidReceiveDebugSessionCustomEvent(this.gotCustomEvent.bind(this))),n&&(e.push(n.onDidTerminateDebugSession(this.endedDebugSession.bind(this))),e.push(n.onDidStartDebugSession(this.startedDebugSession.bind(this))),e.push(n.onDidChangeActiveDebugSession(this.changedDebugSession.bind(this))),e.push(n.onDidReceiveDebugSessionCustomEvent(this.gotCustomEvent.bind(this))))}get activeDebugSession(){return this.activeService.activeDebugSession}get activeDebugConsole(){return this.activeService.activeDebugConsole}get breakpoints(){return this.activeService.breakpoints}get onDidChangeActiveDebugSession(){return this.sessionChangedEvent.event}get onDidStartDebugSession(){return this.sessionStartedEvent.event}get onDidReceiveDebugSessionCustomEvent(){return this.sessionCustomEvent.event}get onDidTerminateDebugSession(){return this.sessionTerminatedEvent.event}get onDidChangeBreakpoints(){return this.activeService.onDidChangeBreakpoints}get onBreakpointHit(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");return this.jupyterDebugService.onBreakpointHit}startRunByLine(e){if(this.lastStartedService=this.jupyterDebugService,!this.jupyterDebugService)throw new Error("No jupyter debugger service");return this.jupyterDebugService.startRunByLine(e)}registerDebugConfigurationProvider(e,t){let n=this.vscodeDebugService.registerDebugConfigurationProvider(e,t);if(this.jupyterDebugService){let i=this.jupyterDebugService.registerDebugConfigurationProvider(e,t);return this.combineDisposables(n,i)}return n}registerDebugAdapterTrackerFactory(e,t){let n=this.vscodeDebugService.registerDebugAdapterTrackerFactory(e,t);if(this.jupyterDebugService){let i=this.jupyterDebugService.registerDebugAdapterTrackerFactory(e,t);return this.combineDisposables(n,i)}return n}startDebugging(e,t,n){return this.lastStartedService=this.vscodeDebugService,this.vscodeDebugService.startDebugging(e,t,n)}addBreakpoints(e){return this.activeService.addBreakpoints(e)}removeBreakpoints(e){return this.activeService.removeBreakpoints(e)}getStack(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.getStack();throw new Error("Requesting jupyter specific stack when not debugging.")}step(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.step();throw new Error("Requesting jupyter specific step when not debugging.")}continue(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.continue();throw new Error("Requesting jupyter specific step when not debugging.")}requestVariables(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.requestVariables();throw new Error("Requesting jupyter specific variables when not debugging.")}stop(){this.jupyterDebugService&&this.lastStartedService===this.jupyterDebugService?this.jupyterDebugService.stop():yv.commands.executeCommand("workbench.action.debug.stop").then(E,E)}get activeService(){return this.lastStartedService?this.lastStartedService:this.vscodeDebugService}combineDisposables(e,t){return{dispose:()=>{e.dispose(),t.dispose()}}}endedDebugSession(e){this.sessionTerminatedEvent.fire(e),this.lastStartedService=void 0}startedDebugSession(e){this.sessionStartedEvent.fire(e)}changedDebugSession(e){this.sessionChangedEvent.fire(e)}gotCustomEvent(e){this.sessionCustomEvent.fire(e)}};p_=U([(0,_u.injectable)(),x(0,(0,_u.inject)(ve)),x(1,(0,_u.inject)(lo)),x(2,(0,_u.optional)()),x(2,(0,_u.inject)(n_)),x(2,(0,_u.named)(nt.RUN_BY_LINE_DEBUGSERVICE))],p_);p();var Iv=ae(he());p();var f_=Symbol("IFileConverter"),gm=Symbol("IExportBase"),T0t=Symbol("IExport"),vm=Symbol("IExportUtil");function m_e(){return`${jf}${Oi()}`}function h_e(r){let e=`${m_e()}${Oi()}.ipynb`;return r?`${di(r,".ipynb")}${e}`:`${W.defaultNotebookName}${e}`}var bv=class{constructor(e,t,n,i){this.kernelProvider=e;this.fs=t;this.jupyterConnection=n;this.exportUtil=i}async export(e,t,n,i){}async executeCommand(e,t,n,i,o){var R;let s=this.kernelProvider.get(e);if(!s||(s.session||await s.start(new fr(!1)),!((R=s.session)!=null&&R.kernel)))return;let a=s.kernelConnectionMetadata,l=s.resourceUri;if(!Wt(a)||l)return;let u=s.session.kernel,d=(await this.jupyterConnection.createConnectionInfo(a.serverProviderHandle)).settings,f=Bn(),m=new f.ContentsManager({serverSettings:d}),g=await this.exportUtil.getContent(e),b="";switch(n){case"html":b=".html";break;case"pdf":b=".pdf";break;case"python":b=".py";break}let v=await this.createBackingFile(l,m);if(!v)return;await m.save(v.filePath,{content:JSON.parse(g),type:"notebook"}).catch(E);let k;try{let P=await this.getCWD(s);k=(await m.newUntitled({type:"file",ext:b})).path;let K=`${P}/${v.filePath}`,L=await Ai(u,`!jupyter nbconvert ${K} --to ${n} --output ${Ht(k)}`),B=this.parseStreamOutput(L);if(this.isExportFailed(B))throw new Error(B||`Failed to export to ${n}`);if(B&&C.debug(B),n==="pdf"){let N=await m.get(k,{type:"file",format:"base64",content:!0}),h=await this.b64toBlob(N.content,"application/pdf").arrayBuffer();await this.fs.writeFile(t,new Uint8Array(h))}else{let N=await m.get(k,{type:"file",format:"text",content:!0});await this.fs.writeFile(t,N.content)}}finally{k&&await m.delete(k),await v.dispose(),await m.delete(v.filePath).catch(E),m.dispose()}}async createBackingFile(e,t){let n,i={type:"notebook"},o=h_e(e);try{n=await t.newUntitled(i);let s=Ei(n.path);n=await t.rename(n.path,s.length&&s!=="."?`${s}/${o}`:o)}catch(s){C.error(`Backing file not supported: ${s}`)}if(n){let s=n.path;return{filePath:s,dispose:()=>t.delete(s)}}}async getContents(e,t,n){return await n.get(e,{type:"file",format:t,content:!0})}b64toBlob(e,t){t=t||"";let n=512;e=e.replace(/^[^,]+,/,""),e=e.replace(/\s/g,"");let i=atob(e),o=[];for(let a=0;a<i.length;a+=n){let l=i.slice(a,a+n),u=new Array(l.length);for(let d=0;d<l.length;d++)u[d]=l.charCodeAt(d);let c=new Uint8Array(u);o.push(c)}return new Blob(o,{type:t})}isExportFailed(e){return e?/Traceback \(most recent call last\)/g.exec(e):!0}parseStreamOutput(e){if(e.length===0)return;let t=e[0];return t.name!=="stdout"&&t.output_type!=="stream"?void 0:jc(t.text).trim()}async getCWD(e){var i;if(!((i=e.session)!=null&&i.kernel))throw new Qr;let t=await Ai(e.session.kernel,"import os;os.getcwd();");if(t.length===0)return;let n=t[0];if(n.output_type==="execute_result")return n.data["text/plain"]}};U([Nte("PerformingExport")],bv.prototype,"executeCommand",1),bv=U([(0,Iv.injectable)(),x(0,(0,Iv.inject)(qe)),x(1,(0,Iv.inject)(Pt)),x(2,(0,Iv.inject)(hn)),x(3,(0,Iv.inject)(vm))],bv);p();var Nne=ae(he());p();var m_=require("vscode");p();var FP=require("vscode");var g_e={PDF:["pdf"]},v_e={HTML:["html","htm"]},y_e={Python:["py"]},ym=class{async showDialog(e,t,n){let i={},o;switch(e){case"python":i=y_e,o=".py";break;case"pdf":o=".pdf",i=g_e;break;case"html":o=".html",i=v_e;break;case"ipynb":o=".ipynb";let l=W.exportDialogFilter;i[l]=["ipynb"];break;default:return}let s=n||!t?n||"":`${Ht(t.path,Sp(t.path))}${o}`,a={defaultUri:await this.getDefaultUri(t,s),saveLabel:W.exportButtonTitle,filters:i};return FP.window.showSaveDialog(a)}async getDefaultUri(e,t){if(e&&e.scheme==="untitled"&&zr())return;if(!e||e.scheme==="file"||e.scheme==="untitled"||e.scheme==="vscode-interactive"){let i=et.instance.get(UR);return FP.Uri.file(BE(await i.computeWorkingDirectory(e),t))}let n=BE(Ei(e.path),t);return FP.Uri.parse(`${e.scheme}://${n}`).with({authority:e.authority})}};var jM=class{async getContent(e){let t=m_.extensions.getExtension("vscode.ipynb");if(!t)throw new Error("Unable to export notebook as the built-in vscode.ipynb extension is currently unavailable.");t.isActive||await t.activate();let i=e.getCells().map(s=>{let a=new m_.NotebookCellData(s.kind,s.document.getText(),s.document.languageId);return a.metadata=s.metadata,a.mime=s.mime,a.outputs=[...s.outputs],a}),o=new m_.NotebookData(i);return o.metadata=JSON.parse(JSON.stringify(e.metadata)),t.exports.exportNotebook(o)}async getTargetFile(e,t,n){return await new ym().showDialog(e,t,n)}};var h_=class extends jM{};h_=U([(0,Nne.injectable)()],h_);p();var y_=ae(he());p();var YM=ae(he()),$M=require("vscode");p();var tp=require("vscode");var BM=class{constructor(){this.fs=et.instance.get(Pt)}async openFile(e,t,n=!1){if(e==="python")await this.openPythonFile(t,n),ne("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,successful:!0,opened:!0});else{let i=await this.askOpenFile(t,n);ne("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,successful:!0,opened:i})}}async openPythonFile(e,t){let n;if(t)n=await tp.window.showTextDocument(e);else{let i=await this.fs.readFile(e);await this.fs.delete(e);let o=await tp.workspace.openTextDocument({language:$e,content:i});n=await tp.window.showTextDocument(o)}await n.edit(i=>{i.insert(new tp.Position(n.document.lineCount,0),`
`)})}async askOpenFile(e,t){let n=W.openExportFileYes,i=W.openExportFileNo,o=[n,i];return await tp.window.showInformationMessage(W.openExportedFileMessage,...o).then(a=>a)===n?(t?tp.window.showTextDocument(e).then(E,E):jI(e.toString()),!0):!1}};p();var HM=class{async export(e,t,n,i){await et.instance.get(gm).executeCommand(e,t,"python",n,i)}};p();var qM=class{async export(e,t,n,i){await et.instance.get(gm).executeCommand(e,t,"pdf",n,i)}};p();var JM=class{async export(e,t,n,i){await et.instance.get(gm).executeCommand(e,t,"html",n,i)}};p();var x9=require("vscode");var GM=class{constructor(){this.fs=et.instance.get(Pt),this.configuration=et.instance.get(Ke),this.platform=et.instance.get(fs)}async writeFile(e,t){await this.fs.writeFile(e,t)}getEOL(){return this.platform.isWindows?`\r
`:`
`}async export(e,t,n){if(n.isCancellationRequested)return;let i=this.exportDocument(e);await this.writeFile(t,i)}exportDocument(e){return e.getCells().filter(t=>{var n;return!((n=t.metadata)!=null&&n.isInteractiveWindowMessageCell)}).reduce((t,n)=>t+this.exportCell(n),"")}exportCell(e){if(e.document.lineCount){let t=this.cellMarker(e),n=this.getEOL();switch(e.kind){case x9.NotebookCellKind.Code:return`${t}${n}${this.exportCodeCell(e)}${n}${n}`;case x9.NotebookCellKind.Markup:return`${t} [markdown]${n}${this.exportMarkdownCell(e)}${n}${n}`}}return""}exportCodeCell(e){let t=ct(e.document.getText(),{trim:!1,removeEmptyEntries:!1}),n=this.configuration.getSettings(e.notebook.uri).pythonExportMethod==="commentMagics";return sI(t,this.getEOL(),n?b_e:void 0).join("")}exportMarkdownCell(e){let t=ct(e.document.getText(),{trim:!1,removeEmptyEntries:!1});return sI(t,this.getEOL(),I_e).join("")}cellMarker(e){var n;let t=this.configuration.getSettings(e.notebook.uri);return(n=e.metadata.interactiveWindowCellMarker)!=null?n:t.defaultCellMarker}};function b_e(r){return/^\s*!/.test(r)||/^\s*%/.test(r)?`# ${r}`:r}function I_e(r){return`# ${r}`}var g_=class{constructor(e,t,n){this.exportUtil=e;this.progressReporter=t;this.configuration=n}async importIpynb(e){let t=this.progressReporter.createProgressIndicator(W.importingIpynb,!0);try{let n=await $M.workspace.openNotebookDocument(e);await this.exportImpl("python",n,void 0,t.token)}finally{t.dispose()}}async export(e,t,n,i){let o=this.progressReporter.createProgressIndicator(W.exportingToFormat(e.toString()),!0);try{await this.exportImpl(e,t,n,o.token,i)}finally{o.dispose()}if(o.token.isCancellationRequested){ne("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,cancelled:!0});return}}async exportImpl(e,t,n,i,o){try{let s=await this.exportUtil.getTargetFile(e,t.uri,n);if(!s)return;await this.performExport(e,t,s,i,o)}catch(s){C.error("Export failed",s),ne("DATASCIENCE.EXPORT_NOTEBOOK_AS_FAILED",void 0,{format:e}),e==="pdf"&&C.error(W.exportToPDFDependencyMessage),this.showExportFailed(W.exportFailedGeneralMessage)}}async performExport(e,t,n,i,o){e==="python"&&this.configuration.getSettings(t.uri).pythonExportMethod!=="nbconvert"?await this.performPlainExport(e,t,n,i):await this.performNbConvertExport(t,e,n,o,i),n&&this.openExportedFile(e,n).catch(E)}async openExportedFile(e,t){await new BM().openFile(e,t,!0).catch(E)}async performPlainExport(e,t,n,i){if(n)switch(e){case"python":await new GM().export(t,n,i);break}return n}async performNbConvertExport(e,t,n,i,o){try{return await this.exportToFormat(e,n,t,i,o)}finally{}}async exportToFormat(e,t,n,i,o){switch(n){case"python":return new HM().export(e,t,i,o);case"pdf":return new qM().export(e,t,i,o);case"html":return new JM().export(e,t,i,o);default:break}}showExportFailed(e){$M.window.showErrorMessage(`${W.failedExportMessage} ${e}`)}};g_=U([x(0,(0,YM.inject)(vm)),x(1,(0,YM.inject)(Fl)),x(2,(0,YM.inject)(Ke))],g_);var v_=class extends g_{constructor(t,n,i){super(t,n,i);this.exportUtil=t}};v_=U([(0,y_.injectable)(),x(0,(0,y_.inject)(vm)),x(1,(0,y_.inject)(Fl)),x(2,(0,y_.inject)(Ke))],v_);p();var WP=ae(he()),Sv=require("vscode");p();var UP=require("vscode");var P9=new WeakMap;async function Eu(r,e){let t=r;if(r.isClosed)return!0;let n=P9.has(t)?P9.get(t):Promise.resolve(),i=Oe(),o=n.finally(async()=>{let s=new UP.WorkspaceEdit,a=e(s);Gv(a)&&await a,await UP.workspace.applyEdit(s).then(l=>i.resolve(l),l=>i.reject(l))}).catch(E);return P9.set(t,o),i.promise}var b_=class{constructor(e,t){this.disposables=e;this.controllerRegistration=t}activate(){this.controllerRegistration.onControllerSelected(this.onDidChangeNotebookController,this,this.disposables)}async onDidChangeNotebookController(e){let t=e.notebook,n=e.controller.connection;if(!gr(t))return;let i=Sv.window.visibleNotebookEditors.find(c=>c.notebook===t);if(!i)return;let o=t.getCells().filter(c=>c.kind===Sv.NotebookCellKind.Code&&c.document.getText().trim().length===0),s=t.getCells().filter(c=>c.kind===Sv.NotebookCellKind.Code).length;if(o.length===0||o.length!==s)return;let a,l=n.kind;switch(n.kind){case"connectToLiveRemoteKernel":{a=n.kernelModel.language;break}case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":{a=n.kernelSpec.language;break}case"startUsingPythonInterpreter":{a=$e;break}default:{C.error(`Unsupported kernel kind encountered ${l}`);return}}if(!a)return;let u=Vc(a);Eu(i.notebook,async()=>{await o.map(async c=>{if(u.toLowerCase()!==c.document.languageId)return Sv.languages.setTextDocumentLanguage(c.document,u).then(E,E)})}).then(E,E)}};b_=U([(0,WP.injectable)(),x(0,(0,WP.inject)(ve)),x(1,(0,WP.inject)(Nt))],b_);p();var Na=ae(he()),ar=require("vscode");var D9=Symbol("INotebookCommandHandler"),I_=class{constructor(e,t,n,i,o,s,a,l,u){this.disposableRegistry=e;this.languageService=t;this.configurationService=n;this.kernelProvider=i;this.controllerRegistration=o;this.errorHandler=s;this.notebookEditorProvider=a;this.serviceContainer=l;this.kernelStatusProvider=u;this.kernelInterruptedDontAskToRestart=!1;this.pendingRestartInterrupt=new WeakMap}activate(){this.register()}register(){this.disposableRegistry.push(ar.commands.registerCommand(de.NotebookEditorRemoveAllCells,()=>this.removeAllCells())),this.disposableRegistry.push(ar.commands.registerCommand(de.NotebookEditorRunAllCells,()=>this.runAllCells())),this.disposableRegistry.push(ar.commands.registerCommand(de.NotebookEditorAddCellBelow,()=>this.addCellBelow())),this.disposableRegistry.push(ar.commands.registerCommand(de.RestartKernelAndRunUpToSelectedCell,()=>this.restartKernelAndRunUpToSelectedCell())),this.disposableRegistry.push(ar.commands.registerCommand(de.RestartKernel,e=>{var t;return e&&"notebookEditor"in e?this.restartKernelImpl((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri).catch(E):this.restartKernelImpl(e).catch(E)})),this.disposableRegistry.push(ar.commands.registerCommand(de.InterruptKernel,e=>{var t;return this.interruptKernel((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)})),this.disposableRegistry.push(ar.commands.registerCommand(de.RestartKernelAndRunAllCells,e=>{var t;e&&"notebookEditor"in e?this.restartKernelAndRunAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri).catch(E):this.restartKernelAndRunAllCells(e).catch(E)}))}runAllCells(){ar.window.activeNotebookEditor&&ar.commands.executeCommand("notebook.execute").then(E,E)}addCellBelow(){ar.window.activeNotebookEditor&&ar.commands.executeCommand("notebook.cell.insertCodeCellBelow").then(E,E)}removeAllCells(){var n;let e=(n=ar.window.activeNotebookEditor)==null?void 0:n.notebook;if(!e)return;let t=this.languageService.getPreferredLanguage(_a(e));Eu(e,i=>{let o=ar.NotebookEdit.replaceCells(new ar.NotebookRange(0,e.cellCount),[new ar.NotebookCellData(ar.NotebookCellKind.Code,"",t)]);i.set(e.uri,[o])}).then(E,E)}async interruptKernel(e){var o;let t=e!=null?e:(o=this.notebookEditorProvider.activeNotebookEditor)==null?void 0:o.notebook.uri,n=ar.workspace.notebookDocuments.find(s=>s.uri.toString()===(t==null?void 0:t.toString()));if(n===void 0)return;C.debug(`Command interrupted kernel for ${Ee(n.uri)}`);let i=this.kernelProvider.get(n);if(!i){C.info("Interrupt requested & no kernel.");return}await this.wrapKernelMethod("interrupt",i)}async restartKernelAndRunAllCells(e){await this.restartKernelImpl(e),this.runAllCells()}async restartKernelAndRunUpToSelectedCell(){let e=this.notebookEditorProvider.activeNotebookEditor;e&&(await this.restartKernelImpl(e.notebook.uri),ar.commands.executeCommand("notebook.cell.execute",{ranges:[{start:0,end:e.selection.end}],document:e.notebook.uri}).then(E,E))}async restartKernelImpl(e){var o;let t=e!=null?e:(o=this.notebookEditorProvider.activeNotebookEditor)==null?void 0:o.notebook.uri,n=ar.workspace.notebookDocuments.find(s=>s.uri.toString()===(t==null?void 0:t.toString()));if(n===void 0)return;let i=this.kernelProvider.get(n);if(i)if(C.debug(`Restart kernel command handler for ${Ee(n.uri)}`),await this.shouldAskForRestart(n.uri)){let s=W.restartKernelMessage,a=W.restartKernelMessageYes,l=W.restartKernelMessageDontAskAgain,u=await ar.window.showInformationMessage(s,{modal:!0},a,l);u===l?(await this.disableAskForRestart(n.uri),this.wrapKernelMethod("restart",i).catch(E)):u===a&&this.wrapKernelMethod("restart",i).catch(E)}else this.wrapKernelMethod("restart",i).catch(E)}async restartKernel(e,t=!1){var s;let n=e!=null?e:(s=this.notebookEditorProvider.activeNotebookEditor)==null?void 0:s.notebook.uri,i=ar.workspace.notebookDocuments.find(a=>a.uri.toString()===(n==null?void 0:n.toString())),o=i?this.kernelProvider.get(i):void 0;if(o)return this.wrapKernelMethod("restart",o,t)}async wrapKernelMethod(e,t,n=!1){let i=t.notebook,o=this.pendingRestartInterrupt.get(t);if(o)return o;let s=(async()=>{let a=this.kernelProvider.getKernelExecution(t).pendingCells[0],l=this.controllerRegistration.getSelected(i),u=n&&e==="restart"?this.kernelStatusProvider.hideRestartProgress(t):new ar.Disposable(E);try{if(!l)throw new Error("No kernel associated with the notebook");await Ta.wrapKernelMethod(l.connection,e,t.creator,this.serviceContainer,{resource:t.resourceUri,notebook:i,controller:l.controller},new fr(n),this.disposableRegistry)}catch(c){a?await Ld(a,t.controller,await this.errorHandler.getErrorMessageForDisplayInCellOutput(c,e,t.resourceUri),!1):ar.window.showErrorMessage(c.toString()).then(E,E)}finally{u.dispose()}})();return s.finally(()=>{this.pendingRestartInterrupt.get(t)===s&&this.pendingRestartInterrupt.delete(t)}).catch(E),this.pendingRestartInterrupt.set(t,s),s}async shouldAskForRestart(e){if(this.kernelInterruptedDontAskToRestart)return!1;let t=this.configurationService.getSettings(e);return t&&t.askForKernelRestart===!0}async disableAskForRestart(e){this.configurationService.getSettings(e)&&this.configurationService.updateSetting("askForKernelRestart",!1,void 0,ar.ConfigurationTarget.Global).catch(E)}};I_=U([(0,Na.injectable)(),x(0,(0,Na.inject)(ve)),x(1,(0,Na.inject)(Bs)),x(2,(0,Na.inject)(Ke)),x(3,(0,Na.inject)(qe)),x(4,(0,Na.inject)(Nt)),x(5,(0,Na.inject)(mn)),x(6,(0,Na.inject)(Oo)),x(7,(0,Na.inject)(Ar)),x(8,(0,Na.inject)(IP))],I_);p();var Rne=ae(he()),bm=require("vscode");var S_=class{constructor(){this.providers=new Set}registerEmbedNotebookProvider(e){this.providers.add(e)}findNotebookEditor(e){var o;let t=e?Wa(e,!0):"false",n=Al(e)==="notebook"?bm.workspace.notebookDocuments.find(s=>Wa(s.uri,!0)===t):void 0,i=n&&((o=bm.window.activeNotebookEditor)==null?void 0:o.notebook)===n?bm.window.activeNotebookEditor:void 0;if(i)return i;for(let s of this.providers){let a=s.findNotebookEditor(e);if(a)return a}}get activeNotebookEditor(){var e,t;return this.findNotebookEditor((e=bm.window.activeNotebookEditor)==null?void 0:e.notebook.uri)||this.findNotebookEditor((t=bm.window.activeTextEditor)==null?void 0:t.document.uri)}findAssociatedNotebookDocument(e){let t=wi()==="Windows",n=bm.workspace.notebookDocuments.find(i=>t?i.uri.path.toLowerCase()===e.path.toLowerCase():i.uri.path===e.path);if(n)return n;for(let i of this.providers){let o=i.findAssociatedNotebookDocument(e);if(o)return o}}};S_=U([(0,Rne.injectable)()],S_);p();var Ane=ae(he()),Mne=require("vscode");var __=class extends Pr{constructor(){super(...arguments);this._onDidChangeEnvironment=this._register(new Mne.EventEmitter);this.onDidChangeEnvironment=this._onDidChangeEnvironment.event}getPythonEnvironment(t){}};__=U([(0,Ane.injectable)()],__);p();var zM=ae(he()),C_=require("vscode");var E_=class{constructor(e){this.sentMimeTypes=new Set;this.disposables=[];e.push(this)}activate(){this.isTelemetryDisabled=MN(),C_.workspace.onDidOpenNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),C_.workspace.onDidCloseNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),C_.workspace.onDidSaveNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),Mr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,this.disposables),this.disposables.push(ON(e=>this.isTelemetryDisabled=e))}dispose(){Ce(this.disposables)}async onDidChangeNotebookCellExecutionState(e){!gr(e.cell.notebook)||this.isTelemetryDisabled||e.state!==1||this.checkCell(e.cell,"onExecution")}onDidOpenCloseDocument(e){!gr(e)||this.isTelemetryDisabled||e.getCells().forEach(t=>this.checkCell(t,"onOpenCloseOrSave"))}checkCell(e,t){if(e.kind===C_.NotebookCellKind.Markup||e.document.languageId==="raw")return;let n=e.notebook.notebookType===St?"notebook":"interactive";e.outputs.map(i=>i.items.map(o=>o.mime)).flat().map(i=>this.sendTelemetry(i,t,n))}sendTelemetry(e,t,n){let i=`${e}-${t}`;this.sentMimeTypes.has(i)||(this.sentMimeTypes.add(i),e=e.replace(/\//g,"_").replace(/\\/g,"_"),ne("DS_INTERNAL.CELL_OUTPUT_MIME_TYPE",void 0,{mimeType:e,when:t,resourceType:n}))}};E_=U([(0,zM.injectable)(),x(0,(0,zM.inject)(ve))],E_);p();var QM=ae(he());var S_e=/(;32m[ ->]*?)(\d+)(.*)/g,w_=class{constructor(e){this.configurationService=e}format(e,t){return e.notebook.notebookType!==St?t:t.map(n=>this.modifyTracebackFrameIPython(e,n))}modifyTracebackFrameIPython(e,t){var o;let n=this.configurationService.getSettings(e.document.uri);return((o=n==null?void 0:n.formatStackTraces)!=null?o:!1)&&/^[Cell|Input|File].*?\n.*/.test(t)?this.modifyTracebackFrameIPython8(e,t):t}modifyTracebackFrameIPython8(e,t){t=t.replace(/\u001b\[4\dm/g,""),t=t.replace(/\u001b\[38;.*?\d+m/g,"\x1B[39m"),t=t.replace(/(;32m[ ->]*?)(\d+)(.*)\n/g,(s,a,l,u)=>(u=u.replace(/\u001b\[3\d+m/g,"\x1B[39m"),`${a}${l}${u}
`)),C.ci(`Trace frame to match: ${t}`);let n=(s,a)=>{let l=s.replace(S_e,(c,d,f,m)=>{let g=parseInt(f,10);return`${d}<a href='${e.document.uri.toString()}?line=${g-1}'>${g}</a>${m}`}),u=W.cellAtFormat(ut(e.document.uri),e.index+1);return l.replace(/.*?\n/,`\x1B[1;32m${u}\x1B[0m line \x1B[0;36m${a}
`)},i=/^Input.*?\[.*32mIn\s+\[(\d+).*?0;36m(.*?)\n.*/.exec(t);if(i&&i.length>1)return n(t,i[2]);let o=/Cell.*?\[.*32mIn\s*\[(\d+)\]\,\s+line\s+([(\d+)])(.*?)\n.*/gm.exec(t);return o&&o.length>1?n(t,o[2]):t}};w_=U([(0,QM.injectable)(),x(0,(0,QM.inject)(Ke))],w_);function One(r,e){_ne(r,e),r.addSingleton(Ve,sv),r.addSingleton(Oo,S_),r.addSingleton(Ve,dv),r.addSingleton(SI,w_),r.addSingleton(am,am),r.addBinding(am,Ve),r.addSingleton(Ve,JS),r.addSingleton(D9,I_),r.addBinding(D9,Ve),r.addSingleton(Bs,Bs),r.addBinding(Bs,Ve),r.addSingleton(Ve,b_),r.addSingleton(mm,u_,void 0,[Ve]),r.addSingleton(n_,p_,nt.MULTIPLEXING_DEBUGSERVICE),r.addSingleton(RM,d_,void 0,[NM]),r.addSingleton(Ki,s_,nt.DEBUGGER_VARIABLES),r.addSingleton(Ve,i_),r.addSingleton(Ve,E_),r.addSingleton(gm,bv),r.addSingleton(f_,v_),r.addSingleton(vm,h_),r.addSingleton(FR,__)}p();p();var si=ae(he()),rt=require("vscode");p();var Im=Symbol("IDataScienceCodeLensProvider"),XM=Symbol("ICodeWatcher"),ZM=Symbol("ICodeLensFactory"),Sm=Symbol("ICellRangeCache"),vAt=Symbol("IGeneratedCodeStore"),Ra=Symbol("IGeneratedCodeStorageFactory"),x_=Symbol("ICodeGeneratorFactory");p();var Lne=Symbol("IInteractiveWindowDebugger"),uo=Symbol("IInteractiveWindowProvider"),eO=Symbol("IInteractiveControllerHelper"),tO=Symbol("IInteractiveWindowDebuggingManager");p();var rO=require("vscode");async function nO(r){let e=await rO.workspace.openNotebookDocument(r);await rO.window.showNotebookDocument(e)}p();var Aa=require("vscode");p();var vs=class{constructor(e){this.codeMatchRegEx=this.createRegExp(e?e.codeRegularExpression:void 0,LE.PythonCellMarker),this.markdownMatchRegEx=this.createRegExp(e?e.markdownRegularExpression:void 0,LE.PythonMarkdownCellMarker),this.codeExecRegEx=new RegExp(`${this.codeMatchRegEx.source}(.*)`),this.markdownExecRegEx=new RegExp(`${this.markdownMatchRegEx.source}(.*)`),this.defaultCellMarker=e!=null&&e.defaultCellMarker?e.defaultCellMarker:"# %%"}isCell(e){return this.isCode(e)||this.isMarkdown(e)}isMarkdown(e){return this.markdownMatchRegEx.test(e.trim())}isCode(e){return this.codeMatchRegEx.test(e.trim())||e.trim()===this.defaultCellMarker}getCellType(e){return this.isMarkdown(e)?"markdown":"code"}isEmptyCell(e){return this.stripFirstMarker(e).trim().length===0}stripFirstMarker(e){let t=ct(e,{trim:!1,removeEmptyEntries:!1});return t.length>0&&(this.isCode(t[0])||this.isMarkdown(t[0]))?t.slice(1).join(`
`):e}stripFirstMarkerNoConcat(e){return e.length>0&&(this.isCode(e[0])||this.isMarkdown(e[0]))?e.slice(1):e}getFirstMarker(e){let t=ct(e,{trim:!1,removeEmptyEntries:!1});if(t.length>0&&(this.isCode(t[0])||this.isMarkdown(t[0])))return t[0]}createRegExp(e,t){try{if(e)return new RegExp(e)}catch(n){}return t}};p();var Hs=require("vscode");function Kne(r,e){let t=lt(r);return t?e==1?W.restartingKernelCustomHeader(t):W.startingNewKernelCustomHeader(t):e==1?W.restartingKernelHeader:W.startingNewKernelHeader}function Fne(r,e){let t=lt(r);return e==1?W.restartedKernelHeader(t||""):W.connectedKernelHeader(t||"")}function VP(r){var e;return r.kind===Hs.NotebookCellKind.Markup&&((e=r.metadata)==null?void 0:e.isInteractiveWindowMessageCell)===!0}var iO=class{constructor(e,t,n){this.interactiveWindow=e;this.notebookDocument=t;this.isDeleted=!1;this.sysInfoCellPromise=this.getOrUpdate(n)}async resolveCell(){return await this.sysInfoCellPromise}async getOrUpdate(e){let t=await this.interactiveWindow.getAppendIndex()-1;if(t>=0){let n=this.notebookDocument.cellAt(t);if(VP(n))return this.updateMessage(e)}return this.sysInfoCellPromise=this.createCell(e)}async createCell(e){let t;return await Eu(this.notebookDocument,async n=>{let i=new Hs.NotebookCellData(Hs.NotebookCellKind.Markup,e,KE);i.metadata={isInteractiveWindowMessageCell:!0},t=await this.interactiveWindow.getAppendIndex();let o=Hs.NotebookEdit.insertCells(t,[i]);n.set(this.notebookDocument.uri,[o])}),this.notebookDocument.cellAt(t)}async updateMessage(e){let t=await this.sysInfoCellPromise;return await Eu(this.notebookDocument,n=>{if(t.index>=0&&!this.isDeleted&&VP(t)){n.replace(t.document.uri,new Hs.Range(0,0,t.document.lineCount,0),e),n.set(this.notebookDocument.uri,[Hs.NotebookEdit.updateCellMetadata(t.index,{isInteractiveWindowMessageCell:!0})]);return}}),t}async deleteCell(){this.isDeleted=!0;let e=await this.sysInfoCellPromise;await Eu(this.notebookDocument,t=>{if(e.index>=0&&VP(e)){let n=Hs.NotebookEdit.deleteCells(new Hs.NotebookRange(e.index,e.index+1));t.set(this.notebookDocument.uri,[n]);return}})}};function oO(r){return/^#\s*!/.test(r)?/^#\s*!\s*%%?/.test(r)?r.replace(/^#\s*!\s*/,""):r.replace(/^#\s*/,""):r}function Une(r,e){let t=e.isCell(r[0])&&r.length>1?r.slice(1):r;return new Aa.NotebookCellData(Aa.NotebookCellKind.Code,t.join(`
`),"python")}function Wne(r){return new Aa.NotebookCellData(Aa.NotebookCellKind.Markup,QN(r).join(`
`),"markdown")}function E_e(r,e,t){let n=ct(e,{trim:!1}),i=n[0],o=new vs(r);if(o.isMarkdown(i)){let s=-1;return Og(n,(a,l)=>void 0,(a,l)=>{a&&a.length>0&&s===-1&&(s=t?l:-1)}),s>=0?[Wne(n.slice(0,s)),Une(n.slice(s),o)]:[Wne(n)]}else return[Une(n,o)]}function T9(r,e){let t=new vs(e),n=[];for(let i=0;i<r.lineCount;i+=1){let o=r.lineAt(i);if(t.isCell(o.text)){if(n.length>0){let s=n[n.length-1];s.range=new Aa.Range(s.range.start,r.lineAt(i-1).range.end)}n.push({range:o.range,cell_type:t.getCellType(o.text)})}}if(n.length>=1){let i=r.lineAt(r.lineCount-1),o=n[n.length-1];o.range=new Aa.Range(o.range.start,i.range.end)}return n}function Vne(r,e){let t=T9(r,e);return Array.prototype.concat(...t.map(n=>{let i=r.getText(n.range);return E_e(e,i,!1)}))}function jne(r){return r.getCells().filter(e=>!VP(e)).map(e=>{let t=new Aa.NotebookCellData(e.kind,e.document.getText(),e.kind===Aa.NotebookCellKind.Code?e.document.languageId:"markdown");return e.kind===Aa.NotebookCellKind.Code&&(t.outputs=[...e.outputs]),t.metadata=Nf(e),t})}p();var jP=require("vscode");var k9=class{constructor(e,t,n){this.disposed=!1;this.dispose=()=>{this.disposed||(this.disposed=!0,this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.disposeCallback(),this.deferred.completed||this.deferred.resolve())};this.promise=()=>this.deferred.promise;this.reject=()=>{this.deferred.reject(),this.dispose()};this.deferred=Oe(),this.disposeCallback=t,n&&(this.timeout=setTimeout(this.dispose,n))}},sO=class{constructor(){this.statusCount=0;this.incrementCount=()=>{this.statusCount+=1};this.decrementCount=()=>{let e=this.statusCount-1;this.statusCount=Math.max(e,0)}}set(e,t,n){this.incrementCount();let i=new k9(e,()=>this.decrementCount(),t),o={location:n?jP.ProgressLocation.Notification:jP.ProgressLocation.Window,title:e,cancellable:n!==void 0};return jP.window.withProgress(o,(s,a)=>(a&&n&&a.onCancellationRequested(()=>{n(),i.reject()}),i.promise())).then(E,E),i}async waitWithStatus(e,t,n,i){let o=this.set(t,n,i),s;try{s=await e()}finally{o.dispose()}return s}};var qs=class{constructor(e,t,n,i,o,s,a,l,u,c,d,f){this.disposables=e;this.jupyterExporter=t;this.fileSystem=n;this.configuration=i;this.dataScienceCodeLensProvider=o;this.debugService=s;this.configService=a;this.interactiveWindowProvider=l;this.kernelProvider=u;this.dataScienceErrorHandler=c;this.ipynbProvider=d;this.fileConverter=f;this.statusProvider=new sO,rt.workspace.isTrusted||rt.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted(),this.registerCommand(de.InsertCellBelowPosition,this.insertCellBelowPosition),this.registerCommand(de.InsertCellBelow,this.insertCellBelow),this.registerCommand(de.InsertCellAbove,this.insertCellAbove),this.registerCommand(de.DeleteCells,this.deleteCells),this.registerCommand(de.SelectCell,this.selectCell),this.registerCommand(de.SelectCellContents,this.selectCellContents),this.registerCommand(de.ExtendSelectionByCellAbove,this.extendSelectionByCellAbove),this.registerCommand(de.ExtendSelectionByCellBelow,this.extendSelectionByCellBelow),this.registerCommand(de.MoveCellsUp,this.moveCellsUp),this.registerCommand(de.MoveCellsDown,this.moveCellsDown),this.registerCommand(de.ChangeCellToMarkdown,this.changeCellToMarkdown),this.registerCommand(de.ChangeCellToCode,this.changeCellToCode),this.registerCommand(de.GotoNextCellInFile,this.gotoNextCellInFile),this.registerCommand(de.GotoPrevCellInFile,this.gotoPrevCellInFile),this.registerCommand(de.AddCellBelow,this.addCellBelow),this.registerCommand(de.CreateNewNotebook,this.createNewNotebook),this.registerCommand(de.LatestExtension,this.openPythonExtensionPage),this.registerCommand(de.EnableLoadingWidgetsFrom3rdPartySource,this.enableLoadingWidgetScriptsFromThirdParty),this.registerCommand(de.CreateNewInteractive,e=>this.createNewInteractiveWindow(e)),this.registerCommand(de.ImportNotebookFile,(e,t="commandpalette")=>this.listenForErrors(()=>e?this.importNotebookOnFile(e):this.importNotebook())),rt.commands.registerCommand(de.ExportFileAsNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>{if(e)return this.exportFile(e);{let n=rt.window.activeTextEditor;if(n&&n.document.languageId===$e)return this.exportFile(n.document.uri)}return Promise.resolve()})),this.registerCommand(de.ExpandAllCells,async e=>{var t;return this.expandAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(de.CollapseAllCells,async e=>{var t;return this.collapseAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(de.InteractiveExportAsNotebook,async e=>{var t;return await this.export((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(de.InteractiveExportAs,e=>{var t;return this.exportAs((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(de.ScrollToCell,(e,t)=>this.scrollToCell(e,t)),this.registerCommand(de.InteractiveClearAll,this.clearAllCellsInInteractiveWindow),this.registerCommand(de.InteractiveGoToCode,this.goToCodeInInteractiveWindow),this.registerCommand(de.InteractiveCopyCell,this.copyCellInInteractiveWindow)}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommandsIfTrusted(){rt.workspace.isTrusted&&(this.registerCommand(de.RunAllCells,this.runAllCells),this.registerCommand(de.RunCell,this.runCell),this.registerCommand(de.RunCurrentCell,this.runCurrentCell),this.registerCommand(de.RunCurrentCellAdvance,this.runCurrentCellAndAdvance),this.registerCommand(de.ExecSelectionInInteractiveWindow,e=>{this.runSelectionOrLine(e).catch(E)}),this.registerCommand(de.RunAllCellsAbove,this.runAllCellsAbove),this.registerCommand(de.RunCellAndAllBelow,this.runCellAndAllBelow),this.registerCommand(de.RunAllCellsAbovePalette,this.runAllCellsAboveFromCursor),this.registerCommand(de.RunCellAndAllBelowPalette,this.runCellAndAllBelowFromCursor),this.registerCommand(de.RunCurrentCellAndAddBelow,this.runCurrentCellAndAddBelow),this.registerCommand(de.DebugCell,this.debugCell),this.registerCommand(de.DebugStepOver,this.debugStepOver),this.registerCommand(de.DebugContinue,this.debugContinue),this.registerCommand(de.DebugStop,this.debugStop),this.registerCommand(de.DebugCurrentCellPalette,this.debugCurrentCellFromCursor),this.registerCommand(de.OpenVariableView,this.openVariableView),this.registerCommand(de.OpenOutlineView,this.openOutlineView),this.registerCommand(de.RunToLine,this.runToLine),this.registerCommand(de.RunFromLine,this.runFromLine),this.registerCommand(de.RunFileInInteractiveWindows,this.runFileInteractive),this.registerCommand(de.DebugFileInInteractiveWindows,this.debugFileInteractive))}registerCommand(e,t){let n=rt.commands.registerCommand(e,t,this);this.disposables.push(n)}getCodeWatcher(e){if(e&&this.dataScienceCodeLensProvider){let t=rt.workspace.textDocuments.filter(n=>Xs(n.uri,e));if(t&&t.length===1)return this.dataScienceCodeLensProvider.getCodeWatcher(t[0]);if(t&&t.length>1)throw new Error(W.documentMismatch(ut(e)))}}async enableLoadingWidgetScriptsFromThirdParty(){this.configService.getSettings(void 0).widgetScriptSources.length>0||await this.configService.updateSetting("widgetScriptSources",["jsdelivr.com","unpkg.com"],void 0,rt.ConfigurationTarget.Global).catch(E)}async runAllCells(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.runAllCells()}async runFileInteractive(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.runFileInteractive()}async debugFileInteractive(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.debugFileInteractive()}async runCell(e,t,n,i,o){let s=this.getCodeWatcher(e);if(s)return s.runCell(new rt.Range(t,n,i,o))}async runAllCellsAbove(e,t,n){if(e){let i=this.getCodeWatcher(e);if(i)return i.runAllCellsAbove(t,n)}}async runCellAndAllBelow(e,t,n){if(e){let i=this.getCodeWatcher(e);if(i)return i.runCellAndAllBelow(t,n)}}async runToLine(){let e=this.getCurrentCodeWatcher(),t=rt.window.activeTextEditor;if(e&&t&&t.selection)return e.runToLine(t.selection.start.line)}async runFromLine(){let e=this.getCurrentCodeWatcher(),t=rt.window.activeTextEditor;if(e&&t&&t.selection)return e.runFromLine(t.selection.start.line)}async runCurrentCell(){let e=this.getCurrentCodeWatcher();if(e)return e.runCurrentCell()}async runCurrentCellAndAdvance(){let e=this.getCurrentCodeWatcher();if(e)return e.runCurrentCellAndAdvance()}async runSelectionOrLine(e){let t=this.getCurrentCodeWatcher();if(t)return t.runSelectionOrLine(rt.window.activeTextEditor,ci(e)?void 0:e)}async debugCell(e,t,n,i,o){if(e){let s=this.getCodeWatcher(e);if(s)return s.debugCell(new rt.Range(t,n,i,o))}}async debugStepOver(){var e;(e=this.debugService)!=null&&e.activeDebugSession&&rt.commands.executeCommand("workbench.action.debug.stepOver").then(E,E)}async debugStop(e){var t;if((t=this.debugService)!=null&&t.activeDebugSession&&this.interactiveWindowProvider){let n=this.interactiveWindowProvider.get(e);if(n&&n.notebookDocument){let i=this.kernelProvider.get(n.notebookDocument);i&&(C.debug(`Interrupt kernel due to debug stop of IW ${e.toString()}`),await i.interrupt())}rt.commands.executeCommand("workbench.action.debug.stop").then(E,E)}}async debugContinue(){var e;(e=this.debugService)!=null&&e.activeDebugSession&&rt.commands.executeCommand("workbench.action.debug.continue").then(E,E)}async addCellBelow(){var e;await((e=this.getCurrentCodeWatcher())==null?void 0:e.addEmptyCellToBottom())}async runCurrentCellAndAddBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.runCurrentCellAndAddBelow()}async insertCellBelowPosition(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellBelowPosition()}async insertCellBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellBelow()}async insertCellAbove(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellAbove()}async deleteCells(){var e;(e=this.getCurrentCodeWatcher())==null||e.deleteCells()}async selectCell(){var e;(e=this.getCurrentCodeWatcher())==null||e.selectCell()}async selectCellContents(){var e;(e=this.getCurrentCodeWatcher())==null||e.selectCellContents()}async extendSelectionByCellAbove(){var e;(e=this.getCurrentCodeWatcher())==null||e.extendSelectionByCellAbove()}async extendSelectionByCellBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.extendSelectionByCellBelow()}async moveCellsUp(){var e;(e=this.getCurrentCodeWatcher())==null||e.moveCellsUp()}async moveCellsDown(){var e;(e=this.getCurrentCodeWatcher())==null||e.moveCellsDown()}async changeCellToMarkdown(){var e;(e=this.getCurrentCodeWatcher())==null||e.changeCellToMarkdown()}async changeCellToCode(){var e;(e=this.getCurrentCodeWatcher())==null||e.changeCellToCode()}async gotoNextCellInFile(){var e;(e=this.getCurrentCodeWatcher())==null||e.gotoNextCell()}async gotoPrevCellInFile(){var e;(e=this.getCurrentCodeWatcher())==null||e.gotoPreviousCell()}async runAllCellsAboveFromCursor(){let e=this.getCurrentCodeLens();if(e){let t=this.getCurrentCodeWatcher();if(t)return t.runAllCellsAbove(e.range.start.line,e.range.start.character)}else return}async runCellAndAllBelowFromCursor(){let e=this.getCurrentCodeLens();if(e){let t=this.getCurrentCodeWatcher();if(t)return t.runCellAndAllBelow(e.range.start.line,e.range.start.character)}else return}async debugCurrentCellFromCursor(){if(this.getCurrentCodeLens()){let t=this.getCurrentCodeWatcher();if(t)return t.debugCurrentCell()}else return}async createNewNotebook(){rt.window.showInformationMessage('This command has been deprecated and will eventually be removed, please use ["Create: New Jupyter Notebook"](command:workbench.action.openGlobalKeybindings?%5B%22@command:ipynb.newUntitledIpynb%22%5D) instead.').then(E,E),await rt.commands.executeCommand("ipynb.newUntitledIpynb")}getCurrentCodeLens(){let e=rt.window.activeTextEditor,t=this.getCurrentCodeWatcher();if(e&&t)return t.getCodeLenses().find(n=>n.range.end.line>=e.selection.anchor.line&&n.range.start.line<=e.selection.anchor.line)}getCurrentCodeWatcher(){let e=rt.window.activeTextEditor;if(!(!e||!e.document||!this.dataScienceCodeLensProvider))return this.dataScienceCodeLensProvider.getCodeWatcher(e.document)}openPythonExtensionPage(){rt.env.openExternal(rt.Uri.parse("https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter")).then(E,E)}async openVariableView(){return rt.commands.executeCommand("jupyterViewVariables.focus")}async openOutlineView(){return rt.commands.executeCommand("outline.focus")}async listenForErrors(e){let t;try{return t=await e(),t}catch(n){C.error("listenForErrors",n),this.dataScienceErrorHandler.handleError(n).then(E,E)}return t}async exportFile(e){let t=ut(e);if(t&&t.length>0&&this.jupyterExporter){let n=rt.window.activeTextEditor;if(n&&this.fileSystem.arePathsSame(n.document.uri,e)){let i=Vne(n.document,this.configuration.getSettings(n.document.uri));if(i){let o=await new ym().showDialog("ipynb",e);if(await this.waitForStatus(async()=>{var s;if(o){let a=await((s=this.jupyterExporter)==null?void 0:s.serialize(i));await this.fileSystem.writeFile(o,a||"")}},W.exportingFormat,Ee(e)),o&&t){let s=W.exportOpenQuestion1;await rt.window.showInformationMessage(W.exportDialogComplete(Ee(e)),s)===s&&await nO(o)}}}}}async expandAllCells(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);C.info(`Expanding all cells in interactive window with uri ${t==null?void 0:t.notebookUri}`),t&&await t.expandAllCells()}async collapseAllCells(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);C.info(`Collapsing all cells in interactive window with uri ${t==null?void 0:t.notebookUri}`),t&&await t.collapseAllCells()}exportAs(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);t&&t.exportAs()}export(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);t&&t.export()}async createNewInteractiveWindow(e){var t;await((t=this.interactiveWindowProvider)==null?void 0:t.getOrCreate(void 0,e))}waitForStatus(e,t,n,i){let o=t(n||"");return this.statusProvider.waitWithStatus(e,o,void 0,i)}async importNotebook(){let e=W.importDialogFilter,t={};t[e]=["ipynb"];let n=await rt.window.showOpenDialog({openLabel:W.importDialogTitle,filters:t});n&&n.length>0&&await this.waitForStatus(async()=>{await this.fileConverter.importIpynb(n[0])},W.importingFormat,Ee(n[0]))}async importNotebookOnFile(e){let t=ut(e);t&&t.length>0&&await this.waitForStatus(async()=>{await this.fileConverter.importIpynb(e)},W.importingFormat,Ee(e))}async scrollToCell(e,t){if(t&&e){let n=this.interactiveWindowProvider.getInteractiveWindowsWithSubmitter(e);for(let i=0;i<n.length;i+=1)if(await n[i].hasCell(t)){n[i].scrollToCell(t);break}}}async clearAllCellsInInteractiveWindow(e){var s,a;let t=(a=this.interactiveWindowProvider.getInteractiveWindowWithNotebook((s=e==null?void 0:e.notebookEditor)==null?void 0:s.notebookUri))==null?void 0:a.notebookUri;if(!t)return;let n=rt.workspace.notebookDocuments.find(l=>l.uri.toString()===t.toString());if(!n)return;let i=new rt.WorkspaceEdit,o=rt.NotebookEdit.deleteCells(new rt.NotebookRange(0,n.cellCount));i.set(n.uri,[o]),await rt.workspace.applyEdit(i)}async goToCodeInInteractiveWindow(e){var t;if(e&&((t=e.metadata)!=null&&t.interactive)){let n=rt.Uri.parse(e.metadata.interactive.uristring),i=e.metadata.interactive.lineIndex,o=await rt.window.showTextDocument(n,{viewColumn:rt.ViewColumn.One});o&&(o.revealRange(new rt.Range(i,0,i,0)),o.selection=new rt.Selection(new rt.Position(i,0),new rt.Position(i,0)))}}async copyCellInInteractiveWindow(e){var t;if(e){let n=this.configuration.getSettings(e.notebook.uri),i=[(t=e.metadata.interactiveWindowCellMarker)!=null?t:n.defaultCellMarker,e.document.getText()].join(`
`);await rt.env.clipboard.writeText(i)}}};U([Vn("DATASCIENCE.DEBUG_STEP_OVER")],qs.prototype,"debugStepOver",1),U([Vn("DATASCIENCE.DEBUG_STOP")],qs.prototype,"debugStop",1),U([Vn("DATASCIENCE.DEBUG_CONTINUE")],qs.prototype,"debugContinue",1),U([Nr("DATASCIENCE.ADD_CELL_BELOW")],qs.prototype,"addCellBelow",1),U([Vn("DATASCIENCE.EXPORT_PYTHON_FILE")],qs.prototype,"exportFile",1),U([Vn("DATASCIENCE.IMPORT_NOTEBOOK",{scope:"command"})],qs.prototype,"importNotebook",1),U([Vn("DATASCIENCE.IMPORT_NOTEBOOK",{scope:"file"})],qs.prototype,"importNotebookOnFile",1),qs=U([(0,si.injectable)(),x(0,(0,si.inject)(ve)),x(1,(0,si.inject)(TI)),x(1,(0,si.optional)()),x(2,(0,si.inject)(Pt)),x(3,(0,si.inject)(Ke)),x(4,(0,si.inject)(Im)),x(4,(0,si.optional)()),x(5,(0,si.inject)(lo)),x(5,(0,si.optional)()),x(6,(0,si.inject)(Ke)),x(7,(0,si.inject)(uo)),x(8,(0,si.inject)(qe)),x(9,(0,si.inject)(mn)),x(10,(0,si.inject)(Oo)),x(11,(0,si.inject)(f_))],qs);p();var rp=ae(he()),_m=require("vscode");p();function Gl(r){if(r.metadata.interactive!==void 0)return r.metadata}function Bne(r,e,t){let n=ct(r,{trim:!1,removeEmptyEntries:!1}),i=t.stripFirstMarkerNoConcat(n),o=fQ(i),s=sI(o,`
`,e.magicCommandsAsComments?oO:void 0);return zv(s.join(""))}p();var Cu=Symbol("IReplNotebookTrackerService");var C_e=W.runCurrentCellAndAddBelow,w_e=W.addCellBelowCommandTitle,x_e=W.debugCellCommandTitle,P_e=W.debugCellCommandTitle,D_e=W.debugStepOverCommandTitle,T_e=W.debugContinueCommandTitle,k_e=W.debugStopCommandTitle,N_e=W.runCellLensCommandTitle,R_e=W.runAllCellsLensCommandTitle,A_e=W.runAllCellsAboveLensCommandTitle,Hne=W.runCellAndAllBelowLensCommandTitle,M_e=W.scrollToCellTitleFormatMessage,P_=class{constructor(e,t,n,i,o,s){this.configService=e;this.generatedCodeStorageFactory=n;this.replTracker=o;this.cellRangeCache=s;this.updateEvent=new _m.EventEmitter;this.notebookData=new Map;this.codeLensCache=new Map;this.totalCodeLensUpdateTimeInMs=0;this.codeLensUpdateCount=0;this.maxCellCount=0;_m.workspace.onDidCloseTextDocument(this.onClosedDocument,this,t),_m.workspace.onDidGrantWorkspaceTrust(()=>this.codeLensCache.clear(),this,t),this.configService.getSettings(void 0).onDidChange(this.onChangedSettings,this,t),Mr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,t),i.onDidDisposeKernel(a=>{this.notebookData.delete(a.notebook.uri.toString())},this,t)}getPerfMeasures(){return{totalCodeLensUpdateTimeInMs:this.totalCodeLensUpdateTimeInMs,codeLensUpdateCount:this.codeLensUpdateCount,maxCellCount:this.maxCellCount}}get updateRequired(){return this.updateEvent.event}createCodeLenses(e){let t=this.getCodeLensCacheData(e);return[...t.documentLenses,...t.gotoCellLens]}getCellRanges(e){return this.getCodeLensCacheData(e).cellRanges}getCodeLensCacheData(e){var l;let t=new bt,n=!1,i=e.uri.toString(),o=this.codeLensCache.get(i),s=!1;o||(o={cachedDocumentVersion:void 0,cachedExecutionCounts:new Set,documentLenses:[],cellRanges:[],gotoCellLens:[]},s=!0,this.codeLensCache.set(i,o)),o.cachedDocumentVersion!==e.version&&(o.cellRanges=this.cellRangeCache.getCellRanges(e),o.documentLenses=[],o.gotoCellLens=[],o.cachedDocumentVersion=e.version,s=!0);let a=this.getDocumentExecutionCounts(i);if((a.length!==o.cachedExecutionCounts.size||a.find(u=>!(o!=null&&o.cachedExecutionCounts.has(u))))&&(o.gotoCellLens=[],o.cachedExecutionCounts=new Set(a),s=!0),o.documentLenses.length===0&&s&&o.cellRanges.length){n=!0;let u=this.enumerateCommands(e.uri);C.debug(`CodeLensFactory: Generating new code lenses for version ${e.version} of document ${e.uri} for commands ${u.join(", ")}`);let c=!0;o.cellRanges.forEach(d=>{u.forEach(f=>{let m=this.createCodeLens(e,d,f,c);m&&o.documentLenses.push(m)}),c=!1})}else C.ci(`NOT Generating new code lenses for version ${e.version} of document ${e.uri} - needUpdate: ${s}, cellRanges.length: ${o.cellRanges.length}`);if(s&&o.gotoCellLens.length===0&&o.cellRanges.length&&this.configService.getSettings(e.uri).addGotoCodeLenses){let u=this.generatedCodeStorageFactory.get({fileUri:e.uri}),c=u?(l=u.all.find(d=>d.uri.toString()===e.uri.toString()))==null?void 0:l.generatedCodes:void 0;c&&c.length&&o.cellRanges.forEach(d=>{let f=this.createExecutionLens(e,d.range,c);f&&(o==null||o.gotoCellLens.push(f))})}return n&&(this.totalCodeLensUpdateTimeInMs+=t.elapsedTime,this.codeLensUpdateCount+=1,this.maxCellCount=Math.max(this.maxCellCount,o.cellRanges.length)),o}getDocumentExecutionCounts(e){return[...this.notebookData.values()].map(t=>t.documentExecutionCounts.get(e)).filter(t=>t!==void 0)}onDidChangeNotebookCellExecutionState(e){var i;if(this.replTracker.isForReplEditor(e.cell.notebook)||e.state!==1||!((i=e.cell.executionSummary)!=null&&i.executionOrder))return;let t=Gl(e.cell),n=this.notebookData.get(e.cell.notebook.uri.toString());n||(n={cellExecutionCounts:new Map,documentExecutionCounts:new Map},this.notebookData.set(e.cell.notebook.uri.toString(),n)),n!==void 0&&t!==void 0&&(n.cellExecutionCounts.set(t.id,e.cell.executionSummary.executionOrder),n.documentExecutionCounts.set(t.interactive.uristring,e.cell.executionSummary.executionOrder),this.updateEvent.fire())}onClosedDocument(e){this.codeLensCache.delete(e.uri.toString())}onChangedSettings(){this.codeLensCache.clear(),this.cellRangeCache.clear(),this.updateEvent.fire()}enumerateCommands(e){let t,n=this.configService.getSettings(e).codeLenses;n?t=n.split(",").map(s=>s.trim()):t=Ou.DefaultDesignLenses;let i=this.configService.getSettings(e).debugCodeLenses;i?t=t.concat(i.split(",").map(s=>s.trim())):t=t.concat(Ou.DefaultDebuggingLenses);let o=[];return _m.workspace.isTrusted||(o=[...Ou.DebuggerCommands,...Ou.DebuggerCommands,de.RunAllCells,de.RunAllCellsAbove,de.RunAllCellsAbovePalette,de.RunCellAndAllBelowPalette,de.RunCurrentCell,de.RunCurrentCellAdvance,de.RunCurrentCellAndAddBelow,de.RunFileInInteractiveWindows,de.InterruptKernel,de.RunToLine,de.RunCell,de.DebugCell,de.DebugContinue,de.DebugStepOver,de.DebugStop,de.RunCellAndAllBelowPalette]),o&&(t=t.filter(s=>!o.includes(s))),t}createCodeLens(e,t,n,i){let{range:o,cell_type:s}=t;switch(n){case de.RunCurrentCellAndAddBelow:return this.generateCodeLens(o,de.RunCurrentCellAndAddBelow,C_e);case de.AddCellBelow:return this.generateCodeLens(o,de.AddCellBelow,w_e,[e.uri,o.start.line]);case de.DebugCurrentCellPalette:return this.generateCodeLens(o,de.DebugCurrentCellPalette,x_e);case de.DebugCell:if(s!=="code")break;return this.generateCodeLens(o,de.DebugCell,P_e,[e.uri,o.start.line,o.start.character,o.end.line,o.end.character]);case de.DebugStepOver:if(s!=="code")break;return this.generateCodeLens(o,de.DebugStepOver,D_e,[e.uri]);case de.DebugContinue:if(s!=="code")break;return this.generateCodeLens(o,de.DebugContinue,T_e,[e.uri]);case de.DebugStop:if(s!=="code")break;return this.generateCodeLens(o,de.DebugStop,k_e,[e.uri]);case de.RunCurrentCell:case de.RunCell:return this.generateCodeLens(o,de.RunCell,N_e,[e.uri,o.start.line,o.start.character,o.end.line,o.end.character]);case de.RunAllCells:return this.generateCodeLens(o,de.RunAllCells,R_e,[e.uri,o.start.line,o.start.character]);case de.RunAllCellsAbovePalette:case de.RunAllCellsAbove:return i?this.generateCodeLens(o,de.RunCellAndAllBelow,Hne,[e.uri,o.start.line,o.start.character]):this.generateCodeLens(o,de.RunAllCellsAbove,A_e,[e.uri,o.start.line,o.start.character]);case de.RunCellAndAllBelowPalette:case de.RunCellAndAllBelow:return this.generateCodeLens(o,de.RunCellAndAllBelow,Hne,[e.uri,o.start.line,o.start.character]);default:C.warn(`Invalid command for code lens ${n}`);break}}findMatchingCellExecutionCount(e){let t=[...this.notebookData.values()].find(n=>n.cellExecutionCounts.get(e));return t==null?void 0:t.cellExecutionCounts.get(e)}createExecutionLens(e,t,n){if(n){let i=n.filter(o=>o.line-2===t.start.line).sort((o,s)=>o.timestamp-s.timestamp);if(i&&i.length){let o=i[i.length-1],s=this.findMatchingCellExecutionCount(o.id);if(s!==void 0)return this.generateCodeLens(t,de.ScrollToCell,M_e(s),[e.uri,o.id])}}}generateCodeLens(e,t,n,i){return new _m.CodeLens(e,O_e(t,n,i))}};P_=U([(0,rp.injectable)(),x(0,(0,rp.inject)(Ke)),x(1,(0,rp.inject)(ve)),x(2,(0,rp.inject)(Ra)),x(3,(0,rp.inject)(qe)),x(4,(0,rp.inject)(Cu)),x(5,(0,rp.inject)(Sm))],P_);function O_e(r,e,t){return{arguments:t,title:e,command:r}}p();var wu=ae(he()),Yl=ae(require("vscode"));var D_=class{constructor(e,t,n,i,o){this.serviceContainer=e;this.debugLocationTracker=t;this.configuration=n;this.debugService=o;this.totalExecutionTimeInMs=0;this.totalGetCodeLensCalls=0;this.activeCodeWatchers=[];this.didChangeCodeLenses=new Yl.EventEmitter;i.push(this),i.push(Yl.workspace.onDidGrantWorkspaceTrust(()=>{this.activeCodeWatchers=Ce(this.activeCodeWatchers),this.didChangeCodeLenses.fire()})),i.push(this.debugService.onDidChangeActiveDebugSession(this.onChangeDebugSession.bind(this))),i.push(Yl.workspace.onDidCloseTextDocument(this.onDidCloseTextDocument.bind(this))),this.debugLocationTracker&&i.push(this.debugLocationTracker.updated(this.onDebugLocationUpdated.bind(this)))}dispose(){this.totalGetCodeLensCalls>0&&ne("DS_INTERNAL.CODE_LENS_ACQ_TIME",{duration:this.totalExecutionTimeInMs/this.totalGetCodeLensCalls}),Ce(this.activeCodeWatchers)}get onDidChangeCodeLenses(){return this.didChangeCodeLenses.event}provideCodeLenses(e,t){return[ec,jv].includes(e.uri.scheme)?[]:this.getCodeLensTimed(e)}getCodeWatcher(e){return this.matchWatcher(e.uri)}onDebugLocationUpdated(){this.didChangeCodeLenses.fire()}onChangeDebugSession(e){this.didChangeCodeLenses.fire()}onDidCloseTextDocument(e){let t=this.activeCodeWatchers.findIndex(n=>n.uri&&n.uri.toString()===e.uri.toString());t>=0&&this.activeCodeWatchers.splice(t,1)[0].dispose()}getCodeLensTimed(e){let t=new bt,n=this.getCodeLens(e);return this.totalExecutionTimeInMs+=t.elapsedTime,this.totalGetCodeLensCalls+=1,this.configuration.getSettings(e.uri).enableCellCodeLens?this.adjustDebuggingLenses(e,n):[]}adjustDebuggingLenses(e,t){let n=Ou.DebuggerCommands;if(this.debugLocationTracker&&this.debugService.activeDebugSession){let i=this.debugLocationTracker.getLocation(this.debugService.activeDebugSession),o;try{o=i?Yl.Uri.parse(i.fileName):void 0}catch(s){}if(i&&(Xs(Yl.Uri.file(i.fileName),e.uri,!0)||o&&Xs(o,e.uri,!0)))return t.filter(a=>{let l=new Yl.Position(i.lineNumber-1,i.column-1);return a.range.contains(l)}).filter(a=>a.command?n.includes(a.command.command):!1);C.ci(`Detected debugging context because activeDebugSession is name:"${this.debugService.activeDebugSession.name}", type: "${this.debugService.activeDebugSession.type}", but fell through with debugLocation: ${JSON.stringify(i)}, and document.uri: ${e.uri.toString()}`)}else return t.filter(i=>i.command?!n.includes(i.command.command):!1);return[]}getCodeLens(e){let t=this.matchWatcher(e.uri);return t?t.getCodeLenses():(C.debug(`Creating a new watcher for document ${e.uri}`),this.createNewCodeWatcher(e).getCodeLenses())}matchWatcher(e){let t=this.activeCodeWatchers.findIndex(i=>i.uri&&i.uri.toString()==e.toString());if(t>=0)return this.activeCodeWatchers[t];let n=Yl.workspace.textDocuments.filter(i=>i.uri.toString()===e.toString());if(n&&n.length>0)return C.debug(`creating new code watcher with matching document ${e}`),this.createNewCodeWatcher(n[0])}createNewCodeWatcher(e){let t=this.serviceContainer.get(XM);return t.setDocument(e),t.codeLensUpdated(this.onWatcherUpdated.bind(this)),this.activeCodeWatchers.push(t),t}onWatcherUpdated(){this.didChangeCodeLenses.fire()}};D_=U([(0,wu.injectable)(),x(0,(0,wu.inject)(Ar)),x(1,(0,wu.inject)(RM)),x(1,(0,wu.optional)()),x(2,(0,wu.inject)(Ke)),x(3,(0,wu.inject)(ve)),x(4,(0,wu.inject)(lo))],D_);p();var np=ae(he()),ke=require("vscode");p();var aO=Symbol("ICodeExecutionHelper");p();var _v=class extends Error{constructor(t){super("Cell failed to execute");this.cell=t}};function L_e(r,e){if(e<=0)throw new RangeError(`Length must be > 0 not ${e}`);return r<0&&(r+=e),r<0?0:r>=e?e-1:r}var tr=class{constructor(e,t,n,i,o,s){this.interactiveWindowProvider=e;this.configService=t;this.executionHelper=n;this.dataScienceErrorHandler=i;this.codeLensFactory=o;this.replTracker=s;this.version=-1;this.codeLenses=[];this.cells=[];this.codeLensUpdatedEvent=new ke.EventEmitter;this.disposables=[this.codeLensUpdatedEvent]}setDocument(e){this.document=e,this.version=e.version,this.codeLenses=this.codeLensFactory.createCodeLenses(e),this.cells=this.codeLensFactory.getCellRanges(e),this.disposables.push(this.codeLensFactory.updateRequired(this.onCodeLensFactoryUpdated.bind(this))),this.disposables.push(ke.workspace.onDidCloseTextDocument(this.onDocumentClosed.bind(this))),this.disposables.push(ke.workspace.onDidCloseNotebookDocument(this.ondidCloseNotebook.bind(this)))}get codeLensUpdated(){return this.codeLensUpdatedEvent.event}get uri(){var e;return(e=this.document)==null?void 0:e.uri}getVersion(){return this.version}getCodeLenses(){let e=this.document;return e&&e.version!=this.version&&(this.codeLenses=this.codeLensFactory.createCodeLenses(e),this.cells=this.codeLensFactory.getCellRanges(e),this.version=e.version),this.codeLenses}async debugCurrentCell(){if(!(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document))return this.runMatchingCell(ke.window.activeTextEditor.selection,!1,!0)}dispose(){let e=this.codeLensFactory.getPerfMeasures();e&&e.codeLensUpdateCount>0&&ne("DS_INTERNAL.DOCUMENT_WITH_CODE_CELLS",{codeLensUpdateTime:e.totalCodeLensUpdateTimeInMs/e.codeLensUpdateCount,maxCellCount:e.maxCellCount}),Ce(this.disposables)}async runAllCells(e){let t=await this.getActiveInteractiveWindow(),n=this.codeLenses.filter(s=>s.command&&s.command.command===de.RunCell&&s.command.arguments&&s.command.arguments.length>=5),i=n.length,o=Promise.resolve(!0);for(let s of n){let a=new ke.Range(s.command.arguments[1],s.command.arguments[2],s.command.arguments[3],s.command.arguments[4]);if(this.document){i===n.length&&(a=new ke.Range(new ke.Position(0,0),a.end));let l=this.document.getText(a);i-=1,o=this.addCode(t,l,this.document.uri,a.start.line,e)}}if(await o,n.length===0)return this.runFileAsOneCell(e!=null?e:!1)}async runFileInteractive(){var e;if(this.document&&this.configService.getSettings((e=this.document)==null?void 0:e.uri).splitRunFileIntoCells)return this.runAllCells();if(this.document)return this.runFileAsOneCell(!1)}async debugFileInteractive(){var e;if(this.document&&this.configService.getSettings((e=this.document)==null?void 0:e.uri).splitRunFileIntoCells)return this.runAllCells(!0);if(this.document)return this.runFileAsOneCell(!0)}async runAllCellsAbove(e,t){let n=await this.getActiveInteractiveWindow(),i=this.codeLenses.filter(l=>l.command&&l.command.command===de.RunCell),o=i.findIndex(l=>l.range.start.line>=e&&l.range.start.character>=t);o<0&&(o=i.length);let s=o,a=Promise.resolve(!0);for(let l of i)if(o>0&&this.document){let u=new ke.Range(l.range.start,l.range.end);o===s&&(u=new ke.Range(new ke.Position(0,0),u.end)),o-=1;let c=this.document.getText(u);a=this.addCode(n,c,this.document.uri,l.range.start.line)}else break;await a}async runCellAndAllBelow(e,t){let n=await this.getActiveInteractiveWindow(),i=this.codeLenses.filter(l=>l.command&&l.command.command===de.RunCell),o=i.findIndex(l=>l.range.start.line>=e&&l.range.start.character>=t),s=o>0?i.length-o:i.length,a=Promise.resolve(!0);for(let l=o;l>=0&&l<i.length;l+=1)if(s>0&&this.document){let u=i[l];s-=1;let c=this.document.getText(u.range);a=this.addCode(n,c,this.document.uri,u.range.start.line)}await a}async runSelectionOrLine(e,t){if(this.document&&e&&Xs(e.document.uri,this.document.uri)){let n=await this.getActiveInteractiveWindow(),i;if(t===void 0||ci(t)?i=this.executionHelper.getSelectedTextToExecute(e):i=t,!i)return;await this.addCode(n,i,this.document.uri,e.selection.start.line)}}async runToLine(e){if(this.document&&e>0){let t=await this.getActiveInteractiveWindow(),n=this.document.lineAt(e-1),i=this.document.getText(new ke.Range(0,0,n.range.end.line,n.range.end.character));i&&i.trim().length&&await this.addCode(t,i,this.document.uri,0)}}async runFromLine(e){if(this.document&&e<this.document.lineCount){let t=await this.getActiveInteractiveWindow(),n=this.document.lineAt(this.document.lineCount-1),i=this.document.getText(new ke.Range(e,0,n.range.end.line,n.range.end.character));i&&i.trim().length&&await this.addCode(t,i,this.document.uri,e)}}async runCell(e){if(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document)return;let t=e.contains(ke.window.activeTextEditor.selection.start)&&this.configService.getSettings(ke.window.activeTextEditor.document.uri).enableAutoMoveToNextCell;return this.runMatchingCell(e,t)}async debugCell(e){if(!(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document))return this.runMatchingCell(e,!1,!0)}async runCurrentCell(){if(!(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document))return this.runMatchingCell(ke.window.activeTextEditor.selection,!1)}async runCurrentCellAndAdvance(){if(!(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document))return this.runMatchingCell(ke.window.activeTextEditor.selection,!0)}async addEmptyCellToBottom(){let e=ke.window.activeTextEditor;e&&this.insertCell(e,e.document.lineCount+1)}async runCurrentCellAndAddBelow(){if(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document)return;let e=ke.window.activeTextEditor,t=new vs(this.configService.getSettings(e.document.uri)),n=0,i=this.getDefaultCellMarker(e.document.uri);e&&e.edit(s=>{let a=!0;for(let l=e.selection.end.line+1;l<e.document.lineCount;l+=1)if(t.isCell(e.document.lineAt(l).text)){a=!1,n=l,s.insert(new ke.Position(l,0),`${i}

`);break}a&&(n=e.document.lineCount,s.insert(new ke.Position(e.document.lineCount,0),`
${i}
`))}).then(E,E);let o=new ke.Position(n+1,0);return this.runMatchingCell(e.selection,!1).then(()=>this.advanceToRange(new ke.Range(o,o)))}insertCellBelowPosition(){let e=ke.window.activeTextEditor;e&&e.selection&&this.insertCell(e,e.selection.end.line+1)}insertCellBelow(){let e=ke.window.activeTextEditor;if(e&&e.selection){let t=this.getCellFromPosition(e.selection.end);t?this.insertCell(e,t.range.end.line+1):this.insertCell(e,e.selection.end.line+1)}}insertCellAbove(){let e=ke.window.activeTextEditor;if(e&&e.selection){let t=this.getCellFromPosition(e.selection.start);t?this.insertCell(e,t.range.start.line):this.insertCell(e,e.selection.start.line)}}deleteCells(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=this.getStartEndCells(e.selection);if(!t)return;let n=t[0],i=t[1],o=0,s=0,a=i.range.end.line+1,l=0;n.range.start.line>0&&(o=n.range.start.line-1,s=e.document.lineAt(o).range.end.character,a=i.range.end.line,l=i.range.end.character);let u=new ke.Range(new ke.Position(o,s),new ke.Position(a,l));e.edit(c=>{c.replace(u,""),this.codeLensUpdatedEvent.fire()}).then(E,E)}selectCell(){let e=ke.window.activeTextEditor;if(e&&e.selection){let t=this.getStartEndCells(e.selection);if(t){let n=t[0],i=t[1];e.selection.anchor.isBeforeOrEqual(e.selection.active)?e.selection=new ke.Selection(n.range.start,i.range.end):e.selection=new ke.Selection(i.range.end,n.range.start)}}}selectCellContents(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=this.getStartEndCellIndex(e.selection);if(!t)return;let n=t[0],i=t[1],o=e.selection.anchor.isBeforeOrEqual(e.selection.active),s=this.cells,a=[];for(let l=n;l<=i;l+=1){let u=s[l],c=u.range.start.line+1,d=0,f=u.range.end.line,m=u.range.end.character;u.range.start.line===u.range.end.line&&(c=u.range.start.line,d=e.document.lineAt(c).range.end.character,f=c,m=d),o?a.push(new ke.Selection(c,d,f,m)):a.push(new ke.Selection(f,m,c,d))}e.selections=a}extendSelectionByCellAbove(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getStartEndCellIndex(e.selection);if(!n)return;let i=e.selection.anchor.isBefore(e.selection.active),o=this.cells,s=n[0],a=n[1],l=o[s],u=o[a];if(!l.range.start.isEqual(t.start)||!u.range.end.isEqual(t.end)){let c;i?s<a?c=new ke.Selection(l.range.start,o[a-1].range.end):c=new ke.Selection(l.range.end,l.range.start):c=new ke.Selection(u.range.end,l.range.start),e.selection=c}else{let c;i&&s<a?(c=o[a-1],e.selection=new ke.Selection(l.range.start,c.range.end)):s>0&&(c=o[s-1],e.selection=new ke.Selection(u.range.end,c.range.start)),c&&e.revealRange(c.range,ke.TextEditorRevealType.Default)}}extendSelectionByCellBelow(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getStartEndCellIndex(e.selection);if(!n)return;let i=e.selection.anchor.isBeforeOrEqual(e.selection.active),o=this.cells,s=n[0],a=n[1],l=o[s],u=o[a];if(!l.range.start.isEqual(t.start)||!u.range.end.isEqual(t.end)){let c;i?c=new ke.Selection(l.range.start,u.range.end):s<a?c=new ke.Selection(o[s+1].range.start,u.range.end):c=new ke.Selection(u.range.start,u.range.end),e.selection=c}else{let c;i||s===a?a<o.length-1&&(c=o[a+1],e.selection=new ke.Selection(l.range.start,c.range.end)):s<a&&(c=o[s+1],e.selection=new ke.Selection(u.range.end,c.range.start)),c&&e.revealRange(c.range,ke.TextEditorRevealType.Default)}}async moveCellsUp(){await this.moveCellsDirection(!0)}async moveCellsDown(){await this.moveCellsDirection(!1)}changeCellToMarkdown(){this.applyToCells((e,t,n)=>this.changeCellTo(e,t,"markdown"))}changeCellToCode(){this.applyToCells((e,t,n)=>this.changeCellTo(e,t,"code"))}gotoNextCell(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getCurrentCellLens(t.start),i=this.getNextCellLens(t.start);n&&i&&this.advanceToRange(i.range)}gotoPreviousCell(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getCurrentCellLens(t.start),i=this.getPreviousCellLens(t.start);n&&i&&this.advanceToRange(i.range)}applyToCells(e){let t=ke.window.activeTextEditor,n=this.getStartEndCellIndex(t==null?void 0:t.selection);if(!t||!n)return;let i=this.cells,o=n[0],s=n[1];for(let a=o;a<=s;a+=1)e(t,i[a],a)}changeCellTo(e,t,n){if(n==="raw")throw Error("Cell Type raw not implemented");if(t.cell_type===n)return;let i=new vs(this.configService.getSettings(e.document.uri)),o=e.document.lineAt(t.range.start.line),s=e.document.getText(o.range),a=this.getDefaultCellMarker(e.document.uri),l=n==="markdown"?i.codeExecRegEx.exec(s):i.markdownExecRegEx.exec(s);if(!l)return;let u=l[l.length-1],c=n==="markdown"?`${a} [markdown]${u}`:`${a}${u}`;e.edit(async d=>{d.replace(o.range,c),t.cell_type=n,t.range.start.line<t.range.end.line&&(e.selection=new ke.Selection(t.range.start.line+1,0,t.range.end.line,t.range.end.character),ke.commands.executeCommand("editor.action.removeCommentLine").then(E,E),n==="markdown"&&ke.commands.executeCommand("editor.action.addCommentLine").then(E,E))}).then(E,E)}async moveCellsDirection(e){let t=ke.window.activeTextEditor;if(!t||!t.selection)return!1;let n=this.getStartEndCellIndex(t.selection);if(!n)return!1;let i=n[0],o=n[1],s=this.cells,a=s[i],l=s[o];if(!a||!l)return!1;let u=new ke.Range(a.range.start,l.range.end),c=new ke.Range(t.selection.start.line-u.start.line,t.selection.start.character,t.selection.end.line-u.start.line,t.selection.end.character),d=t.selection.active.isBefore(t.selection.anchor),f;if(e){if(i===0)return!1;{let m=s[i-1];f=this.exchangeTextLines(t,m.range,u).then(b=>(b&&(t.selection=new ke.Selection(m.range.start.line+c.start.line,c.start.character,m.range.start.line+c.end.line,c.end.character)),b))}}else{if(o===s.length-1)return!1;{let m=s[o+1],g=this.exchangeTextLines(t,u,m.range),b=m.range.end.line-m.range.start.line,v=u.end.line-u.start.line,k=b-v;f=g.then(R=>(R&&(t.selection=new ke.Selection(m.range.start.line+k+c.start.line,c.start.character,m.range.start.line+k+c.end.line,c.end.character)),R))}}return f.then(m=>(m&&d&&(t.selection=new ke.Selection(t.selection.active,t.selection.anchor)),!0))}exchangeTextLines(e,t,n){let i=t.start.line,o=t.end.line,s=n.start.line,a=n.end.line;if(o>=s)throw RangeError(`Above lines must be fully above not ${o} <= ${s}`);let l=new ke.Range(i,0,o,e.document.lineAt(o).range.end.character),u=e.document.getText(l),c=new ke.Range(s,0,a,e.document.lineAt(a).range.end.character),d=e.document.getText(c),f="";if(o+1<s){let b=o+1,v=s-1,k=new ke.Range(b,0,v,e.document.lineAt(v).range.end.character);f=`${e.document.getText(k)}
`}let m=`${d}
${f}${u}`,g=new ke.Range(l.start,c.end);return e.edit(b=>{b.replace(g,m),this.codeLensUpdatedEvent.fire()})}getStartEndCells(e){let t=this.getStartEndCellIndex(e);if(t){let n=this.getCellFromIndex(t[0]),i=this.getCellFromIndex(t[1]);return[n,i]}}getStartEndCellIndex(e){if(!e)return;let t=this.getCellIndex(e.start),n=t;if(e.start.line!==e.end.line&&(n=this.getCellIndex(e.end)),t===-1){if(n===-1)return;{t=0;let i=this.getCellFromIndex(0);if(e.start.line>i.range.start.line)throw RangeError(`Should not be able to pick a range with an end in a cell and start after a cell. ${e.start.line} > ${i.range.end.line}`)}}if(t>=0&&n>=0)return[t,n]}insertCell(e,t){let n=this.getDefaultCellMarker(e.document.uri),i=t>=e.document.lineCount?`
${n}
`:`${n}

`,o=new ke.Position(t,0),s=new ke.Position(t+1,0);e.edit(a=>{a.insert(o,i),this.codeLensUpdatedEvent.fire()}).then(E,E),e.selection=new ke.Selection(s,s)}getDefaultCellMarker(e){return this.configService.getSettings(e).defaultCellMarker||nt.DefaultCodeCellMarker}onCodeLensFactoryUpdated(){this.document&&(this.codeLenses=this.codeLensFactory.createCodeLenses(this.document),this.cells=this.codeLensFactory.getCellRanges(this.document)),this.codeLensUpdatedEvent.fire()}onDocumentClosed(e){this.document&&Xs(e.uri,this.document.uri)&&Ce(this.disposables)}ondidCloseNotebook(e){var t;this.replTracker.isForReplEditor(e)&&this.configService.getSettings((t=this.document)==null?void 0:t.uri).addGotoCodeLenses&&this.onCodeLensFactoryUpdated()}getActiveInteractiveWindow(){var e;return this.interactiveWindowProvider.getOrCreate((e=this.document)==null?void 0:e.uri)}async addCode(e,t,n,i,o){let s=!1;try{o?s=await e.debugCode(t,n,i):s=await e.addCode(t,n,i)}catch(a){a instanceof _v||await this.dataScienceErrorHandler.handleError(a)}return s}async runMatchingCell(e,t,n){let i=this.getCurrentCellLens(e.start),o=this.getNextCellLens(e.start);if(i&&this.document){let s=zv(this.document.getText(i.range));if(t){let l=ke.window.activeTextEditor,{newCellOnRunLast:u}=this.configService.getSettings(this.document.uri),c=new vs(this.configService.getSettings(this.document.uri));o?this.advanceToRange(o.range):u&&l&&!c.isEmptyCell(s)&&this.insertCell(l,i.range.end.line+1)}let a=await this.getActiveInteractiveWindow();await this.addCode(a,s,this.document.uri,i.range.start.line,n)}}getCellIndex(e){return this.cells.findIndex(t=>e&&t.range.contains(e))}getCellFromIndex(e){let t=this.cells,n=L_e(e,t.length);return t[n]}getCellFromPosition(e){if(!e){let t=ke.window.activeTextEditor;t&&t.selection&&(e=t.selection.active)}if(e){let t=this.getCellIndex(e);if(t>=0)return this.cells[t]}}getCurrentCellLens(e){return this.codeLenses.find(t=>t.range.contains(e)&&t.command!==void 0&&t.command.command===de.RunCell)}getNextCellLens(e){let t=this.codeLenses.findIndex(n=>n.range.contains(e)&&n.command!==void 0&&n.command.command===de.RunCell);if(t>=0)return this.codeLenses.find((n,i)=>n.command!==void 0&&n.command.command===de.RunCell&&i>t)}getPreviousCellLens(e){let t=this.codeLenses.findIndex(n=>n.range.contains(e)&&n.command!==void 0&&n.command.command===de.RunCell);if(t>=1)return this.codeLenses.find((n,i)=>n.command!==void 0&&i<t&&i+1===t)}async runFileAsOneCell(e){if(this.document){let t=await this.getActiveInteractiveWindow(),n=this.document.getText();await this.addCode(t,n,this.document.uri,0,e)}}advanceToRange(e){let t=ke.window.activeTextEditor,n=new ke.Selection(e.start,e.start);t&&(t.selection=n,t.revealRange(e,ke.TextEditorRevealType.Default))}};U([Vn("DATASCIENCE.DEBUG_CURRENT_CELL")],tr.prototype,"debugCurrentCell",1),U([Vn("DATASCIENCE.RUN_ALL_CELLS")],tr.prototype,"runAllCells",1),U([Vn("DATASCIENCE.RUN_FILE_INTERACTIVE")],tr.prototype,"runFileInteractive",1),U([Vn("DATASCIENCE.DEBUG_FILE_INTERACTIVE")],tr.prototype,"debugFileInteractive",1),U([Vn("DATASCIENCE.RUN_ALL_CELLS_ABOVE")],tr.prototype,"runAllCellsAbove",1),U([Vn("DATASCIENCE.RUN_CELL_AND_ALL_BELOW")],tr.prototype,"runCellAndAllBelow",1),U([Vn("DATASCIENCE.RUN_SELECTION_OR_LINE")],tr.prototype,"runSelectionOrLine",1),U([Vn("DATASCIENCE.RUN_TO_LINE")],tr.prototype,"runToLine",1),U([Vn("DATASCIENCE.RUN_FROM_LINE")],tr.prototype,"runFromLine",1),U([B7("CodeWatcher::runCell",4)],tr.prototype,"runCell",1),U([Vn("DATASCIENCE.DEBUG_CURRENT_CELL")],tr.prototype,"debugCell",1),U([Vn("DATASCIENCE.RUN_CURRENT_CELL")],tr.prototype,"runCurrentCell",1),U([Vn("DATASCIENCE.RUN_CURRENT_CELL_AND_ADVANCE")],tr.prototype,"runCurrentCellAndAdvance",1),U([Nr("DATASCIENCE.RUN_CURRENT_CELL_AND_ADD_BELOW")],tr.prototype,"runCurrentCellAndAddBelow",1),U([Nr("DATASCIENCE.RUN_INSERT_CELL_BELOW_POSITION")],tr.prototype,"insertCellBelowPosition",1),U([Nr("DATASCIENCE.RUN_INSERT_CELL_BELOW")],tr.prototype,"insertCellBelow",1),U([Nr("DATASCIENCE.RUN_INSERT_CELL_ABOVE")],tr.prototype,"insertCellAbove",1),U([Nr("DATASCIENCE.RUN_DELETE_CELLS")],tr.prototype,"deleteCells",1),U([Nr("DATASCIENCE.RUN_SELECT_CELL")],tr.prototype,"selectCell",1),U([Nr("DATASCIENCE.RUN_SELECT_CELL_CONTENTS")],tr.prototype,"selectCellContents",1),U([Nr("DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_ABOVE")],tr.prototype,"extendSelectionByCellAbove",1),U([Nr("DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_BELOW")],tr.prototype,"extendSelectionByCellBelow",1),U([Nr("DATASCIENCE.RUN_MOVE_CELLS_UP")],tr.prototype,"moveCellsUp",1),U([Nr("DATASCIENCE.RUN_MOVE_CELLS_DOWN")],tr.prototype,"moveCellsDown",1),U([Nr("DATASCIENCE.RUN_CHANGE_CELL_TO_MARKDOWN")],tr.prototype,"changeCellToMarkdown",1),U([Nr("DATASCIENCE.RUN_CHANGE_CELL_TO_CODE")],tr.prototype,"changeCellToCode",1),U([Nr("DATASCIENCE.GOTO_NEXT_CELL_IN_FILE")],tr.prototype,"gotoNextCell",1),U([Nr("DATASCIENCE.GOTO_PREV_CELL_IN_FILE")],tr.prototype,"gotoPreviousCell",1),tr=U([(0,np.injectable)(),x(0,(0,np.inject)(uo)),x(1,(0,np.inject)(Ke)),x(2,(0,np.inject)(aO)),x(3,(0,np.inject)(mn)),x(4,(0,np.inject)(ZM)),x(5,(0,np.inject)(Cu))],tr);p();var Ev=ae(he()),Si=ae(require("vscode"));var Em=require("vscode");var T_=class{constructor(e,t,n,i){this.configuration=t;this.extensionChecker=n;this.cellRangeCache=i;this.computeDecorations(),e.push(this),e.push(this.configuration.getSettings(void 0).onDidChange(this.settingsChanged,this)),e.push(Si.window.onDidChangeActiveTextEditor(this.changedEditor,this)),e.push(Si.window.onDidChangeTextEditorSelection(this.changedSelection,this)),e.push(Si.workspace.onDidChangeTextDocument(this.changedDocument,this)),this.settingsChanged()}activate(){}dispose(){this.timer&&clearTimeout(this.timer)}settingsChanged(){Si.window.activeTextEditor&&this.triggerUpdate(Si.window.activeTextEditor)}changedEditor(){this.triggerUpdate(void 0)}changedDocument(e){Si.window.activeTextEditor&&e.document===Si.window.activeTextEditor.document&&this.triggerUpdate(Em.window.activeTextEditor)}changedSelection(e){e.textEditor&&e.textEditor.selection.anchor&&this.triggerUpdate(e.textEditor)}triggerUpdate(e){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>this.update(e),100)}computeDecorations(){this.currentCellTopUnfocused=Em.window.createTextEditorDecorationType({borderColor:new Si.ThemeColor("interactive.inactiveCodeBorder"),borderWidth:"2px 0px 0px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellBottomUnfocused=Em.window.createTextEditorDecorationType({borderColor:new Si.ThemeColor("interactive.inactiveCodeBorder"),borderWidth:"0px 0px 1px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellTop=Em.window.createTextEditorDecorationType({borderColor:new Si.ThemeColor("interactive.activeCodeBorder"),borderWidth:"2px 0px 0px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellBottom=Em.window.createTextEditorDecorationType({borderColor:new Si.ThemeColor("interactive.activeCodeBorder"),borderWidth:"0px 0px 1px 0px",borderStyle:"solid",isWholeLine:!0})}cellDecorationEnabled(e){return e.decorateCells===!1?!1:e.decorateCells==="currentCell"||e.decorateCells==="allCells"}update(e){let t=e===void 0?Em.window.visibleTextEditors:[e];for(let n of t)if(n&&n.document&&n.document.languageId===$e&&!iI(n.document)&&this.currentCellTop&&this.currentCellBottom&&this.currentCellTopUnfocused&&this.currentCellBottomUnfocused&&this.extensionChecker.isPythonExtensionInstalled){let i=this.configuration.getSettings(n.document.uri);if(this.cellDecorationEnabled(i)){let o=this.cellRangeCache.getCellRanges(n.document),s=o.map(c=>c.range).filter(c=>c.contains(n.selection.anchor)),a=s.length>0?[new Si.Range(s[0].start,s[0].start)]:[],l=i.decorateCells!=="allCells"&&s.length>0?[new Si.Range(s[0].end,s[0].end)]:[],u=[];i.decorateCells==="allCells"&&o.forEach(c=>{let d=c.range.start;d!==s[0].start&&u.push(new Si.Range(d,d))}),Em.window.activeTextEditor===n?(n.setDecorations(this.currentCellTop,a),n.setDecorations(this.currentCellBottom,l),n.setDecorations(this.currentCellTopUnfocused,u),n.setDecorations(this.currentCellBottomUnfocused,[])):(n.setDecorations(this.currentCellTop,[]),n.setDecorations(this.currentCellBottom,[]),n.setDecorations(this.currentCellTopUnfocused,[...u,...a]),n.setDecorations(this.currentCellBottomUnfocused,l))}else n.setDecorations(this.currentCellTop,[]),n.setDecorations(this.currentCellBottom,[]),n.setDecorations(this.currentCellTopUnfocused,[]),n.setDecorations(this.currentCellBottomUnfocused,[])}}};T_=U([(0,Ev.injectable)(),x(0,(0,Ev.inject)(ve)),x(1,(0,Ev.inject)(Ke)),x(2,(0,Ev.inject)(bo)),x(3,(0,Ev.inject)(Sm))],T_);p();var po=ae(he()),Zt=require("vscode");p();var gt=require("vscode");var ip=class{constructor(e,t,n,i,o){this.serviceContainer=e;this._owner=t;this.controllerFactory=n;this.inputUri=o;this._onDidChangeViewState=new gt.EventEmitter;this.closedEvent=new gt.EventEmitter;this._submitters=[];this.internalDisposables=[];var s;this.fs=this.serviceContainer.get(Pt),this.configuration=this.serviceContainer.get(Ke),this.jupyterExporter=this.serviceContainer.get(TI),this.interactiveWindowDebugger=this.serviceContainer.tryGet(Lne),this.errorHandler=this.serviceContainer.get(mn),this.codeGeneratorFactory=this.serviceContainer.get(x_),this.storageFactory=this.serviceContainer.get(Ra),this.kernelProvider=this.serviceContainer.get(qe),this.debuggingManager=this.serviceContainer.get(tO),this.notebookUri=i instanceof gt.TabInputInteractiveWindow||i instanceof gt.TabInputNotebook?i.uri:i.notebook.uri,this._owner&&this._submitters.push(this._owner),gt.window.onDidChangeActiveNotebookEditor(a=>{(a==null?void 0:a.notebook.uri.toString())===this.notebookUri.toString()&&this._onDidChangeViewState.fire()},this.internalDisposables),gt.workspace.onDidCloseNotebookDocument(a=>{a.uri.toString()===this.notebookUri.toString()&&this.closedEvent.fire()},this.internalDisposables),((s=gt.window.activeNotebookEditor)==null?void 0:s.notebook.uri.toString())===this.notebookUri.toString()&&this._onDidChangeViewState.fire(),this.cellMatcher=new vs(this.configuration.getSettings(this.owningResource)),this.notebookDocument&&this.codeGeneratorFactory.getOrCreate(this.notebookDocument)}get onDidChangeViewState(){return this._onDidChangeViewState.event}get closed(){return this.closedEvent.event}get owner(){return this._owner}get submitters(){return this._submitters}get notebookDocument(){return this._notebookDocument||(this._notebookDocument=gt.workspace.notebookDocuments.find(e=>e.uri.toString()===this.notebookUri.toString())),this._notebookDocument}get kernelConnectionMetadata(){var e;return(e=this.controller)==null?void 0:e.metadata}async notifyConnectionReset(){if(this.notebookDocument)this.controller||(this.controller=this.initController()),this.controller.setInfoMessageCell(W.noKernelConnected);else{let e=gt.workspace.onDidOpenNotebookDocument(async t=>{t.uri.toString()===this.notebookUri.toString()&&(this._notebookDocument=t,this.controller=this.initController(),this.internalDisposables.push(this.controller.listenForControllerSelection()),this.controller.setInfoMessageCell(W.noKernelConnected),e.dispose())})}}initController(){let e=this.controllerFactory.create(this,this.errorHandler,this.kernelProvider,this._owner);return this.internalDisposables.push(e.listenForControllerSelection()),e}async ensureInitialized(){if(!this.notebookDocument&&(C.debug("Showing Interactive editor to initialize codeGenerator from notebook document"),await this.showInteractiveEditor(),!this.notebookDocument))throw new Error("Could not open notebook document for Interactive Window");this.codeGeneratorFactory.get(this.notebookDocument)||this.codeGeneratorFactory.getOrCreate(this.notebookDocument),this.controller||(this.controller=this.initController()),this.controller.controller?(this.controller.startKernel().catch(E),await this.controller.resolveSysInfoCell()):(C.info("No controller selected for Interactive Window initialization"),this.controller.setInfoMessageCell(W.selectKernelForEditor))}async showInteractiveEditor(){let e;gt.window.tabGroups.all.find(i=>{i.tabs.find(o=>{(o.input instanceof gt.TabInputNotebook||o.input instanceof gt.TabInputInteractiveWindow)&&o.input.uri.toString()==this.notebookUri.toString()&&(e=o.group.viewColumn)})});let t=this.notebookDocument||await this.openNotebookDocument();return await gt.window.showNotebookDocument(t,{preserveFocus:!0,viewColumn:e,asRepl:!0})}async openNotebookDocument(){return C.debug(`Opening notebook document ${this.notebookUri}`),await gt.workspace.openNotebookDocument(this.notebookUri)}dispose(){var e;this.internalDisposables.forEach(t=>t.dispose()),(e=this.controller)==null||e.disconnect()}async showErrorForCell(e,t){var o,s,a;let n=(o=this.controller)==null?void 0:o.controller,i=vy(e);if(n&&i&&t){let l=so.getOrCreate(t,new fv(n));try{await l.appendOutput(i)}catch(u){C.warn(`Could not append error message "${i}" to cell: ${u}`)}finally{l.end(!1,(a=(s=t.executionSummary)==null?void 0:s.timing)==null?void 0:a.endTime)}}else C.info(`Could not append error message to cell "${i}"`)}changeMode(e){var t;(t=this.controller)==null||t.updateMode(e)}async addCode(e,t,n){return this.submitCode(e,t,n,!1)}useNewDebugMode(){var t;return!!(this.configuration.getSettings(this.owner).forceIPyKernelDebugger||(t=this.controller)!=null&&t.metadata&&!jt(this.controller.metadata))}async debugCode(e,t,n){let i=!0,o=gt.workspace.textDocuments.find(a=>this.fs.arePathsSame(a.uri,t));if(!this.useNewDebugMode()&&o&&o.isUntitled){let a=[...gt.workspace.textDocuments];if(i=await o.save(),i){let l=gt.workspace.textDocuments.filter(u=>a.indexOf(u)===-1);l&&l.length>0&&(t=(l.find(c=>c.languageId==="python")||l.find(c=>!c.fileName.endsWith(".interactive"))||l[0]).uri,await gt.workspace.openTextDocument(t))}}let s=!0;return i?this.submitCode(e,t,n,!0):s}async submitCode(e,t,n,i){var c;if(this.cellMatcher.isEmptyCell(e)||!((c=this.controller)!=null&&c.controller))return!0;this.updateOwners(t);let o=ct(e,{trim:!1}),s=new vs(this.configuration.getSettings(t)),a=-1;s.isMarkdown(o[0])&&Og(o,(d,f)=>void 0,(d,f)=>{d&&d.length>0&&a===-1&&(a=f)});let u=(a>0?[o.slice(0,a).join(`
`),o.slice(a).join(`
`)]:[e]).map(d=>{let f=Oe();this.controller.setPendingCellAdd(f.promise);let m=this.addNotebookCell(d,t,n),g=this.createExecutionPromise(m,i);return g.catch(b=>{b instanceof _v?m.then(v=>{b.cell!==v&&this.showErrorForCell(W.cellStopOnErrorMessage,v).then(E,E)}).catch(E):m.then(v=>this.errorHandler.getErrorMessageForDisplayInCellOutput(b,"execution",this.owningResource).then(k=>this.showErrorForCell(k,v))).catch(E)}).finally(()=>{f==null||f.resolve()}),g});return u[u.length-1]}async createExecutionPromise(e,t){var a,l;if(!this.controller||!this.notebookDocument)return!1;C.ci("InteractiveWindow.ts.createExecutionPromise.start");let n=this.controller.startKernel(),i=await e,o=!0,s=async()=>void 0;try{let u=await n;await this.generateCodeAndAddMetadata(i,t,u),t&&this.useNewDebugMode()?await this.debuggingManager.start(this.notebookDocument,i):t&&jt(u.kernelConnectionMetadata)&&this.interactiveWindowDebugger&&(s=async()=>{var f;return(f=this.interactiveWindowDebugger)==null?void 0:f.detach(u)},await this.interactiveWindowDebugger.attach(u),await this.interactiveWindowDebugger.updateSourceMaps(((a=this.storageFactory.get({notebook:i.notebook}))==null?void 0:a.all)||[]),this.interactiveWindowDebugger.enable(u)),C.ci("InteractiveWindow.ts.createExecutionPromise.kernel.executeCell");let c=Gl(i);o=await this.kernelProvider.getKernelExecution(u).executeCell(i,(l=c==null?void 0:c.generatedCode)==null?void 0:l.code).then(()=>!0,()=>!1),C.ci("InteractiveWindow.ts.createExecutionPromise.kernel.executeCell.finished")}finally{await s(),C.ci("InteractiveWindow.ts.createExecutionPromise.end")}if(!o)throw new _v(i);return o}async expandAllCells(){this.notebookDocument&&await Promise.all(this.notebookDocument.getCells().map(async(e,t)=>{await gt.commands.executeCommand("notebook.cell.expandCellInput",{ranges:[{start:t,end:t+1}],document:this.notebookUri})}))}async collapseAllCells(){this.notebookDocument&&await Promise.all(this.notebookDocument.getCells().map(async(e,t)=>{e.kind===gt.NotebookCellKind.Code&&await gt.commands.executeCommand("notebook.cell.collapseCellInput",{ranges:[{start:t,end:t+1}],document:this.notebookUri})}))}async scrollToCell(e){let t=await this.showInteractiveEditor(),n=t.notebook.getCells().find(i=>{var o;return((o=Gl(i))==null?void 0:o.id)===e});if(n){let i=new gt.NotebookRange(n.index,n.index+1);t.revealRange(i,gt.NotebookEditorRevealType.Default),t.selection=i}}async hasCell(e){let t=this.notebookDocument;return!!t&&t.getCells().some(n=>{var i;return((i=Gl(n))==null?void 0:i.id)===e})}get owningResource(){if(this.owner)return this.owner;let e=nI();if(e)return e}updateOwners(e){var t;this._owner||(this._owner=e,(t=this.controller)==null||t.updateOwners(e)),this._submitters.find(n=>n.toString()==e.toString())||this._submitters.push(e)}async addNotebookCell(e,t,n){var g,b;let i=this.notebookDocument;if(!i)throw new Error("No notebook document");let o=this.configuration.getSettings(this.owningResource),s=this.cellMatcher.getCellType(e)===KE,a=s?QN(ct(e)).join(""):Bne(e,o,this.cellMatcher),l=this.cellMatcher.getFirstMarker(e),u=(b=(g=gt.workspace.textDocuments.find(v=>{var k;return v.uri.toString()===((k=this.owner)==null?void 0:k.toString())}))==null?void 0:g.languageId)!=null?b:$e,c=new gt.NotebookCellData(s?gt.NotebookCellKind.Markup:gt.NotebookCellKind.Code,a,s?KE:u),d={uristring:t.toString(),lineIndex:n,originalSource:e},f={interactiveWindowCellMarker:l,interactive:d,id:Oi()};c.metadata=f;let m;return await Eu(i,async v=>{m=await this.getAppendIndex();let k=gt.NotebookEdit.insertCells(m,[c]);v.set(i.uri,[k])}),i.cellAt(m)}async getAppendIndex(){if(!this.notebookDocument)throw new Error("No notebook document");return this.notebookDocument.cellCount}async generateCodeAndAddMetadata(e,t,n){let i=Gl(e);if(!i)return;let o=!jt(n.kernelConnectionMetadata)||this.configuration.getSettings(void 0).forceIPyKernelDebugger,s=await this.codeGeneratorFactory.getOrCreate(this.notebookDocument).generateCode(i,e.index,t,o),a={...i,generatedCode:s},l=new gt.WorkspaceEdit,u=gt.NotebookEdit.updateCellMetadata(e.index,a);l.set(e.notebook.uri,[u]),await gt.workspace.applyEdit(l)}async export(){var n;if(!this.notebookDocument)throw new Error("no notebook to export.");let e=jne(this.notebookDocument),t=await new ym().showDialog("ipynb",this.owningResource);t&&await((n=this.jupyterExporter)==null?void 0:n.exportToFile(e,ut(t)))}async exportAs(){var n;if(await this.ensureInitialized(),!this.controller)throw new Error("An active kernel is required to export the notebook.");let e=(n=this.controller.kernel)==null?void 0:n.value,t;if(this.submitters&&this.submitters.length){let i=this.submitters[this.submitters.length-1];t=Ht(i.path,Sp(i.path))}zr()?gt.commands.executeCommand(de.ExportAsPythonScript,this.notebookDocument,e==null?void 0:e.kernelConnectionMetadata.interpreter).then(E,E):gt.commands.executeCommand(de.Export,this.notebookDocument,t,e==null?void 0:e.kernelConnectionMetadata.interpreter).then(E,E)}};U([fL()],ip.prototype,"showErrorForCell",1),U([fL()],ip.prototype,"createExecutionPromise",1);p();function qne(r){return W.interactiveWindowTitleFormat(Ht(r.path))}p();var N9=class{constructor(e,t,n,i,o,s,a){this.controllerService=e;this.mode=t;this.interactiveWindow=n;this.errorHandler=i;this.kernelProvider=o;this.owner=s;this.disposables=[];this.controller=a==null?void 0:a.controller,this.metadata=a==null?void 0:a.connection}updateMode(e){this.mode=e}updateOwners(e){this.owner=e}async startKernel(){var e;if((e=this.connectingListener)==null||e.dispose(),this.kernel)return this.kernel.promise;if(!this.controller||!this.metadata)throw new Error("Interactive Window kernel not selected");this.setInfoMessage(this.metadata,0);try{let t=await this.createKernel(),n=async()=>{this.interactiveWindow.notebookDocument&&this.metadata&&(this.systemInfoCell=void 0,this.setInfoMessage(this.metadata,1))};return this.disposables.push(t.addHook("willRestart",n)),t.onRestarted(async()=>{C.debug("Restart event handled in IW"),this.fileInKernel=void 0;try{await this.setFileInKernel(t)}catch(i){C.error("Failed to run initialization after restarting")}finally{this.finishSysInfoMessage(t,1)}},this,this.disposables),this.fileInKernel=void 0,await this.setFileInKernel(t),this.finishSysInfoMessage(t,0),t}catch(t){throw this.owner?this.deleteSysInfoCell():await this.finishSysInfoWithFailureMessage(t),t}}async createKernel(){if(this.kernel)return this.kernel.promise;if(!this.controller||!this.metadata)throw new Error("Controller not selected");let e=Oe();e.promise.catch(E),this.kernel=e;try{let{kernel:t,actualController:n}=await this.controllerService.createKernel(this.metadata,this.controller,this.owner,this.interactiveWindow.notebookDocument,this.disposables);return this.metadata=t.kernelConnectionMetadata,this.controller=n,this.disposables.push(t),e.resolve(t),t}catch(t){throw e.reject(t),this.disconnect(),t}}async setFileInKernel(e){let t=this.owner;if(!t){C.ci("Unable to run initialization for IW");return}let n=ut(t),i=this.kernelProvider.getKernelExecution(e);this.mode==="perFile"&&!this.fileInKernel?(C.debug(`Initializing __file__ in setFileInKernel with ${t} for mode ${this.mode}`),this.fileInKernel=t,await i.executeHidden(`__file__ = '${n.replace(/\\/g,"\\\\")}'`)):(!this.fileInKernel||this.fileInKernel.toString()!==t.toString())&&this.mode!=="perFile"?(C.debug(`Initializing __file__ in setFileInKernel with ${t} for mode ${this.mode}`),this.fileInKernel=t,await i.executeHidden(`__file__ = '${n.replace(/\\/g,"\\\\")}'`)):C.debug(`Not Initializing __file__ in setFileInKernel with ${n} for mode ${this.mode} currently ${this.fileInKernel}`)}setPendingCellAdd(e){if(this.metadata&&this.interactiveWindow.notebookDocument){let t=this.controllerService.getRegisteredController(this.metadata);t==null||t.setPendingCellAddition(this.interactiveWindow.notebookDocument,e)}}listenForControllerSelection(){return this.controllerService.onControllerSelected(e=>{var t,n,i,o;if(!(!this.interactiveWindow.notebookDocument||e.notebook.uri.toString()!==((n=(t=this.interactiveWindow.notebookDocument)==null?void 0:t.uri)==null?void 0:n.toString()))&&e.controller.id!==((i=this.controller)==null?void 0:i.id)){let s=!!this.kernel;this.disconnect(),this.controller=e.controller.controller,this.metadata=e.controller.connection,s?this.startKernel().catch(E):((o=this.connectingListener)==null||o.dispose(),this.connectingListener=e.controller.onConnecting(()=>{this.startKernel().catch(E)}),this.disposables.push(this.connectingListener))}},this)}setInfoMessageCell(e){if(!this.interactiveWindow.notebookDocument){C.warn("Could not set info cell: no notebook document");return}this.systemInfoCell?this.systemInfoCell.updateMessage(e).catch(t=>C.warn(`could not update info cell with message: "${e}", error: ${t}`)):this.systemInfoCell=new iO(this.interactiveWindow,this.interactiveWindow.notebookDocument,e)}async resolveSysInfoCell(){var e;await((e=this.systemInfoCell)==null?void 0:e.resolveCell())}setInfoMessage(e,t){let n=Kne(e,t);this.setInfoMessageCell(n)}finishSysInfoMessage(e,t){var i;let n=Fne(e.kernelConnectionMetadata,t);(i=this.systemInfoCell)==null||i.updateMessage(n).catch(o=>C.warn(`System info message was not updated: "${n}" because of error: ${o}`)),this.systemInfoCell=void 0}async finishSysInfoWithFailureMessage(e){var n;let t=await this.errorHandler.getErrorMessageForDisplayInCell(e,"start",this.owner);t=t.split(`
`).join(`  
`),(n=this.systemInfoCell)==null||n.updateMessage(t).catch(i=>C.warn(`System info message was not updated: "${t}" because of error: ${i}`)),this.systemInfoCell=void 0}deleteSysInfoCell(){var e;(e=this.systemInfoCell)==null||e.deleteCell().then(E,E),this.systemInfoCell=void 0}disconnect(){this.disposables.forEach(e=>e.dispose()),this.disposables=[],this.kernel=void 0}},Cv=class{constructor(e,t,n){this.controllerService=e;this.mode=t;this.initialController=n}create(e,t,n,i){if(!e.notebookDocument)throw Error("could not create controller: no notebook document");let o=this.initialController,s=this.controllerService.getSelectedController(e.notebookDocument);return s&&(o=s),new N9(this.controllerService,this.mode,e,t,n,i,o)}};p();var BP=class extends ip{async getAppendIndex(){var e,t;if((e=this.editor)!=null&&e.replOptions||(this.editor=await this.showInteractiveEditor()),!((t=this.editor)!=null&&t.replOptions))throw new Error("Interactive editor not found");return this.editor.replOptions.appendIndex}};var Jne="ds_asked_per_file_interactive",Gne="ds_interactive_window_cache",k_=class{constructor(e){this.serviceContainer=e}isForReplEditor(e){return this.interactiveWindowProvider||(this.interactiveWindowProvider=this.serviceContainer.get(uo)),this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e.uri)!==void 0}};k_=U([(0,po.injectable)(),x(0,(0,po.inject)(Ar))],k_);var N_=class{constructor(e,t,n,i,o,s,a,l){this.serviceContainer=e;this.disposables=t;this.fs=n;this.configService=i;this.globalMemento=o;this.workspaceMemento=s;this.notebookEditorProvider=a;this.controllerHelper=l;this._onDidChangeActiveInteractiveWindow=new Zt.EventEmitter;this._windows=[];this.notebookEditorProvider.registerEmbedNotebookProvider(this),this.restoreWindows()}get onDidChangeActiveInteractiveWindow(){return this._onDidChangeActiveInteractiveWindow.event}get activeWindow(){var t;let e=(t=Zt.window.activeNotebookEditor)==null?void 0:t.notebook.uri.toString();return e?this._windows.find(n=>{var i;return((i=n.notebookUri)==null?void 0:i.toString())===e}):void 0}restoreWindows(){let e=new Map;Zt.window.tabGroups.all.forEach(t=>{t.tabs.forEach(n=>{let i=n.input;(i instanceof Zt.TabInputInteractiveWindow||i instanceof Zt.TabInputNotebook)&&e.set(i.uri.toString(),i)})}),this.workspaceMemento.get(Gne,[]).forEach(t=>{if(!t.uriString||!e.get(t.uriString))return;let n=e.get(t.uriString);if(!n)return;let i=this.configService.getSettings(n.uri).interactiveWindowMode,o=n instanceof Zt.TabInputInteractiveWindow?new ip(this.serviceContainer,Zt.Uri.parse(t.owner),new Cv(this.controllerHelper,i),n,Zt.Uri.parse(t.inputBoxUriString)):new BP(this.serviceContainer,Zt.Uri.parse(t.owner),new Cv(this.controllerHelper,i),n,Zt.Uri.parse(t.inputBoxUriString));o.notifyConnectionReset().catch(E),this._windows.push(o),ne("DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",{windowCount:this._windows.length},{hasKernel:!1,hasOwner:!!t.owner,mode:i,restored:!0});let s=o.closed(this.onInteractiveWindowClosed.bind(this,o));this.disposables.push(o),this.disposables.push(s),this.disposables.push(o.onDidChangeViewState(this.raiseOnDidChangeActiveInteractiveWindow.bind(this)))}),this._updateWindowCache()}async getOrCreate(e,t){if(!Zt.workspace.isTrusted)throw new Error("Workspace not trusted");let n=await this.getInteractiveMode(e);this.pendingCreations&&await this.pendingCreations.catch(E);let i=this.getExisting(e,n,t);return i||(i=await this.create(e,n,t)),await i.ensureInitialized(),i}get(e){let t=this.configService.getSettings(e).interactiveWindowMode;return this.getExisting(e,t)}async create(e,t,n){let i=Oe();this.pendingCreations=i.promise;try{let o=this.configService.getSettings(e).interactiveReplNotebook,s=o?St:yr,a=await this.controllerHelper.getInitialController(e,s,n);C.info(`Starting interactive window for resource '${Ee(e)}' with controller '${a==null?void 0:a.id}'`);let[l,u]=await this.createEditor(a,e,t,o);a&&a.controller.updateNotebookAffinity(u.notebook,Zt.NotebookControllerAffinity.Preferred),C.debug(`Interactive Window Editor Created: ${u.notebook.uri.toString()} with input box: ${l.toString()}`);let c=o?new BP(this.serviceContainer,e,new Cv(this.controllerHelper,t,a),u,l):new ip(this.serviceContainer,e,new Cv(this.controllerHelper,t,a),u,l);this._windows.push(c),ne("DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",{windowCount:this._windows.length},{hasKernel:!!a,hasOwner:!!e,mode:t,restored:!1}),this._updateWindowCache(),this.lastActiveInteractiveWindow=c;let d=c.closed(this.onInteractiveWindowClosed.bind(this,c));return this.disposables.push(c),this.disposables.push(d),this.disposables.push(c.onDidChangeViewState(this.raiseOnDidChangeActiveInteractiveWindow.bind(this))),c}finally{i.resolve()}}async createEditor(e,t,n,i){let o=t&&n==="perFile"?qne(t):void 0,s=t!==void 0,a=this.getInteractiveViewColumn(t);if(i)return this.createNotebookBackedEditor(a,s,e==null?void 0:e.controller,o);let{inputUri:l,notebookEditor:u}=await Zt.commands.executeCommand("interactive.open",{viewColumn:a,preserveFocus:s},void 0,e?`${Ge}/${e.id}`:void 0,o);if(!u)throw new Error("Failed to request creation of interactive window from VS Code.");return[l,u]}async createNotebookBackedEditor(e,t,n,i){i=i||"Interactive-1";let o=await Zt.workspace.openNotebookDocument(St),s=await Zt.window.showNotebookDocument(o,{preserveFocus:n?!1:t,viewColumn:e,asRepl:i});if(!s.replOptions)throw new Error("Wrong type of editor created");return n&&await Zt.commands.executeCommand("notebook.selectKernel",{editor:s,id:n.id,extension:Ge}),[o.cellAt(s.replOptions.appendIndex).document.uri,s]}getInteractiveViewColumn(e){if(e)return Zt.ViewColumn.Beside;let t=this.configService.getSettings(e).interactiveWindowViewColumn;return t==="secondGroup"?Zt.ViewColumn.One:t==="active"?Zt.ViewColumn.Active:Zt.ViewColumn.Beside}async getInteractiveMode(e){let t=this.configService.getSettings(e).interactiveWindowMode;if(t==="multiple"&&e&&!this.globalMemento.get(Jne)&&this._windows.length===1&&(!this._windows[0].owner||!this.fs.arePathsSame(this._windows[0].owner,e))){this.globalMemento.update(Jne,!0).then(E,E);let n=[W.interactiveWindowModeBannerSwitchYes,W.interactiveWindowModeBannerSwitchNo];await Zt.window.showInformationMessage(W.interactiveWindowModeBannerTitle,...n)===n[0]&&(t="perFile",this._windows[0].changeMode(t),await this.configService.updateSetting("interactiveWindow.creationMode",t,e,Zt.ConfigurationTarget.Global))}return t}_updateWindowCache(){let e=this._windows.map(t=>{var n;return{owner:(n=t.owner)==null?void 0:n.toString(),uriString:t.notebookUri.toString(),inputBoxUriString:t.inputUri.toString()}});this.workspaceMemento.update(Gne,e).then(E,E)}getExisting(e,t,n){return t==="single"?this._windows.length>0?this._windows[0]:void 0:t==="multiple"?e?this.activeWindow||this.lastActiveInteractiveWindow||this._windows[0]:void 0:this._windows.find(i=>{var o;return!e&&!i.owner&&!n?!0:e&&i.owner&&this.fs.arePathsSame(e,i.owner)?!n||((o=i.kernelConnectionMetadata)==null?void 0:o.id)===n.id:!1})}raiseOnDidChangeActiveInteractiveWindow(){this.lastActiveInteractiveWindow=this.activeWindow?this.activeWindow:this.lastActiveInteractiveWindow,this._onDidChangeActiveInteractiveWindow.fire(this.activeWindow)}onInteractiveWindowClosed(e){var t;C.debug(`Closing interactive window: ${(t=e.notebookUri)==null?void 0:t.toString()}`),e.dispose(),this._windows=this._windows.filter(n=>n!==e),this._updateWindowCache(),this.lastActiveInteractiveWindow===e&&(this.lastActiveInteractiveWindow=this._windows[0]),this.raiseOnDidChangeActiveInteractiveWindow()}getActiveOrAssociatedInteractiveWindow(){if(this.activeWindow)return this.activeWindow;if(Zt.window.activeTextEditor===void 0)return;let e=Zt.window.activeTextEditor.document.uri;if(e.scheme!==ec)return this.get(e)}findNotebookEditor(e){var n,i;let t;if(e&&e.path.endsWith(".interactive"))t=(n=this.get(e))==null?void 0:n.notebookDocument;else{let o=this.configService.getSettings(e).interactiveWindowMode;t=(i=this.getExisting(e,o))==null?void 0:i.notebookDocument}return t?Zt.window.visibleNotebookEditors.find(o=>o.notebook===t):void 0}findAssociatedNotebookDocument(e){let t=this._windows.find(i=>{var o;return((o=i.inputUri)==null?void 0:o.toString())===e.toString()});return t==null?void 0:t.notebookDocument}getInteractiveWindowWithNotebook(e){let t;return e!==void 0?t=this._windows.find(n=>{var i;return((i=n.notebookUri)==null?void 0:i.toString())===e.toString()}):t=this.getActiveOrAssociatedInteractiveWindow(),t}getInteractiveWindowsWithSubmitter(e){return this._windows.filter(t=>t.submitters.find(n=>this.fs.arePathsSame(e,n)))}};N_=U([(0,po.injectable)(),x(0,(0,po.inject)(Ar)),x(1,(0,po.inject)(ve)),x(2,(0,po.inject)(Pt)),x(3,(0,po.inject)(Ke)),x(4,(0,po.inject)(Et)),x(4,(0,po.named)(rr)),x(5,(0,po.inject)(Et)),x(5,(0,po.named)(Es)),x(6,(0,po.inject)(Oo)),x(7,(0,po.inject)(eO))],N_);p();var A_=ae(he());p();var xu=require("vscode");var lO=class{constructor(e,t,n,i){this.configService=e;this.storage=t;this.notebook=n;this.executionCount=0;this.cellIndexesCounted={};this.disposables=[];i.push(this),xu.workspace.onDidChangeTextDocument(this.onChangedDocument,this,this.disposables),Mr.onDidChangeNotebookCellExecutionState(this.onDidCellStateChange,this,this.disposables)}dispose(){this.disposed||(this.disposed=!0,this.storage.clear(),this.disposables.forEach(e=>e.dispose()))}reset(){this.storage.clear(),this.executionCount=0}async generateCode(e,t,n,i){let{executableLines:o}=this.extractExecutableLines(e);if(this.executionCount+=1,this.cellIndexesCounted[t]=!0,o.length>0&&o.find(s=>s.trim().length>0))return this.generateCodeImpl(e,this.executionCount,n,i)}extractExecutableLines(e){let t=e.interactive.originalSource,n=this.configService.getSettings(this.notebook.uri),i=new vs(n),o=oI(t);if(n.magicCommandsAsComments&&o.forEach((s,a)=>o[a]=oO(s)),e.interactiveWindowCellMarker&&o.length&&o[0].trim()===e.interactiveWindowCellMarker.trim()){let s=o.slice(1).filter(a=>a.trim().length>0);if(s.length>0&&s[0].trim().startsWith("%%")){let a=o.slice(o.indexOf(s[0]));return{lines:a,executableLines:a}}}return o.length>0&&(i.isCode(o[0])||i.isMarkdown(o[0]))?{lines:o,executableLines:o.slice(1)}:{lines:o,executableLines:o}}onDidCellStateChange(e){var t;e.state===1&&(e.state!==1||e.cell.notebook!==this.notebook||!((t=e.cell.executionSummary)!=null&&t.executionOrder)||this.cellIndexesCounted[e.cell.index]||(this.executionCount+=1,this.cellIndexesCounted[e.cell.index]=!0))}async generateCodeImpl(e,t,n,i){let{lineIndex:o,uristring:s}=e.interactive,a=xu.workspace.textDocuments.find(O=>O.uri.toString()===s);if(!a)return;let{stripped:l,trueStartLine:u}=this.extractStrippedLines(e),c=a.lineAt(u),d=a.lineAt(Math.min(u+l.length-1,a.lineCount-1)),f=0;for(;f<l.length&&l[f].trim().length===0;)f+=1;let m=f+u,g=a.offsetAt(new xu.Position(o,0)),b=a.offsetAt(d.rangeIncludingLineBreak.end),v=(e.interactiveWindowCellMarker||"").length>0,{runtimeLine:k,debuggerStartLine:R}=this.addHiddenLines(n,l,u,m,v,i),P=l.join(""),D=a.getText(new xu.Range(new xu.Position(o,0),d.rangeIncludingLineBreak.end)),K=(await Ha(P,"SHA-1")).substring(0,12),L=this.getRuntimeFile(K,t),B=n?-1:0,N={line:c?c.lineNumber+1:1,endLine:d?d.lineNumber+1:1,firstNonBlankLineIndex:m,debuggerStartLine:R,executionCount:t,startOffset:g,endOffset:b,deleted:!1,code:P,trimmedRightCode:l.map(O=>O.replace(/[ \t\r]+\n$/g,`
`)).join(""),realCode:D,runtimeLine:k,runtimeFile:L,id:e.id,timestamp:Date.now(),lineOffsetRelativeToIndexOfFirstLineInCell:B,hasCellMarker:v};return C.info(`Generated code for ${t} = ${L} with ${l.length} lines`),this.storage.store(xu.Uri.parse(e.interactive.uristring),N),N}getRuntimeFile(e,t){return`<ipython-input-${t}-${e}>`}onChangedDocument(e){let t=this.storage.getFileGeneratedCode(e.document.uri);if(t){let n=e.document.getText();e.contentChanges.forEach(i=>{this.handleContentChange(n,i,t)})}}extractStrippedLines(e){let t=oI(e.interactive.originalSource),{lines:n}=this.extractExecutableLines(e),i=e.interactive.lineIndex+1;if(!e.interactiveWindowCellMarker){i=e.interactive.lineIndex;for(let l=0;l<n.length;l+=1)if(n[l]!==t[l]){i+=l+1;break}}let o=0;for(;o<n.length&&n[o].trim().length===0;)o+=1;let s=n.length-1,a=n.length-2;for(;a>0;){let l=n[s],u=n[a];if((l.length===0||l===`
`)&&(u.length===0||u===`
`))n.splice(s,1),s-=1,a-=1;else break}!n[s].endsWith(`
`)&&n[s].length>0&&(n[s]=`${n[s]}
`);for(let l=0;l<n.length;l++)n[l]=n[l].replace(/\r\n/g,`
`);return{stripped:n,trueStartLine:i}}handleContentChange(e,t,n){let i=t.range.start.line-t.range.end.line+t.text.split(`
`).length-1,o=t.text.length-t.rangeLength,s=t.rangeLength<=0?t.rangeOffset:t.rangeOffset+t.rangeLength-1;n.forEach(a=>{a.endOffset<t.rangeOffset||(a.startOffset>s?(a.line+=i,a.endLine+=i,a.startOffset+=o,a.endOffset+=o):a.startOffset===s?a.deleted||t.rangeLength>0||i===0?a.deleted=e.substr(a.startOffset,a.endOffset-a.startOffset)!==a.realCode:(a.line+=i,a.endLine+=i,a.startOffset+=o,a.endOffset+=o):a.deleted=e.substr(a.startOffset,a.endOffset-a.startOffset)!==a.realCode)})}addHiddenLines(e,t,n,i,o,s){let a=s||this.configService.getSettings(void 0).forceIPyKernelDebugger===!0;return e&&this.configService.getSettings(this.notebook.uri).stopOnFirstLineWhileDebugging?a?(t.splice(0,0,`breakpoint()
`),{runtimeLine:1,debuggerStartLine:n+1}):(t.splice(0,0,`breakpoint()
`),{runtimeLine:2,debuggerStartLine:n}):{runtimeLine:1,debuggerStartLine:o?i:i+1}}};var Yne=require("vscode");var R_=class{constructor(e,t,n){this.configService=e;this.storageFactory=t;this.disposables=n;this.codeGenerators=new WeakMap}activate(){Yne.workspace.onDidCloseNotebookDocument(this.onDidCloseNotebook,this,this.disposables)}getOrCreate(e){let t=this.get(e);if(t)return t;let n=new lO(this.configService,this.storageFactory.getOrCreate(e),e,this.disposables);return this.codeGenerators.set(e,n),n}get(e){return this.codeGenerators.get(e)}onDidCloseNotebook(e){var t;(t=this.codeGenerators.get(e))==null||t.dispose(),this.codeGenerators.delete(e)}};R_=U([(0,A_.injectable)(),x(0,(0,A_.inject)(Ke)),x(1,(0,A_.inject)(Ra)),x(2,(0,A_.inject)(ve))],R_);p();var $ne=ae(he()),zne=require("vscode");p();var cO=class{constructor(){this.codeGeneratorsByFile=new bu}clear(){this.codeGeneratorsByFile.clear()}get all(){return[...this.codeGeneratorsByFile.entries()].map(e=>({uri:e[0],generatedCodes:e[1].filter(t=>!t.deleted)})).filter(e=>e.generatedCodes.length>0)}getFileGeneratedCode(e){return this.codeGeneratorsByFile.get(e)||[]}store(e,t){let n=this.codeGeneratorsByFile.get(e)||[],i=!1;for(let o=0;o<n.length&&!i;o+=1){let s=n[o];t.line>=s.line&&t.line<=s.endLine?(n.splice(o,1,t),i=!0):s.line>t.line&&(n.splice(o,0,t),i=!0)}i||n.push(t),this.codeGeneratorsByFile.set(e,n)}};var M_=class{constructor(){this.storages=new WeakMap}getOrCreate(e){return this.storages.has(e)||this.storages.set(e,new cO),this.storages.get(e)}get(e){if("notebook"in e)return this.storages.get(e.notebook);{let t=zne.workspace.notebookDocuments.find(n=>{let i=this.storages.get(n);return i==null?void 0:i.all.find(o=>o.uri.toString()===e.fileUri.toString())});return t?this.storages.get(t):void 0}}};M_=U([(0,$ne.injectable)()],M_);p();var op=ae(he());var O_=class{constructor(e,t,n,i,o,s){this.kernelProvider=e;this.codeGeneratorFactory=n;this.storageFactory=i;this.controllers=o;this.replTracker=s;this.disposables=[];t.push(this)}dispose(){Ce(this.disposables)}activate(){this.kernelProvider.onDidCreateKernel(this.onDidCreateKernel,this,this.disposables),this.controllers.onControllerSelected(this.onNotebookControllerSelected,this,this.disposables)}onNotebookControllerSelected({notebook:e}){var t,n;(t=this.storageFactory.get({notebook:e}))==null||t.clear(),(n=this.codeGeneratorFactory.get(e))==null||n.reset()}onDidCreateKernel(e){var n;let t=e.notebook;e.creator!=="jupyterExtension"||this.replTracker.isForReplEditor(t)||((n=this.storageFactory.get({notebook:t}))==null||n.clear(),e.onRestarted(()=>{var i;(i=this.storageFactory.get({notebook:t}))==null||i.clear(),this.codeGeneratorFactory.getOrCreate(t).reset()},this,this.disposables))}};O_=U([(0,op.injectable)(),x(0,(0,op.inject)(qe)),x(1,(0,op.inject)(ve)),x(2,(0,op.inject)(x_)),x(3,(0,op.inject)(Ra)),x(4,(0,op.inject)(Nt)),x(5,(0,op.inject)(Cu))],O_);p();var wv=ae(he()),Rie=require("vscode");var Nie=kie(),dO=/(;32m[ ->]*?)(\d+)(.*)/g,L_=class{constructor(e,t,n,i){this.storageFactory=e;this.platformService=t;this.configurationService=n;this.replTracker=i}format(e,t){var a;if(!this.replTracker.isForReplEditor(e.notebook))return t;let n=this.storageFactory.get({notebook:e.notebook}),i=t.some(l=>/^[Input|Cell|File].*?\n.*/.test(l));if(!i&&!n)return t;let o=this.configurationService.getSettings(e.document.uri),s=(a=o==null?void 0:o.formatStackTraces)!=null?a:!1;return t.map(l=>i?this.modifyTracebackFrameIPython8(l,n==null?void 0:n.all,s):s?this.modifyTracebackFrameIPython7(l,n.all):l)}modifyTracebackFrameIPython8(e,t,n){var c,d,f,m,g;e=e.replace(/\u001b\[4\dm/g,""),e=e.replace(/\u001b\[38;.*?\d+m/g,"\x1B[39m"),e=e.replace(/(;32m[ ->]*?)(\d+)(.*)\n/g,(b,v,k,R)=>(R=R.replace(/\u001b\[3\d+m/g,"\x1B[39m"),`${v}${k}${R}
`)),C.ci(`Trace frame to match: ${e}`);let i,o,s=/Cell\s+(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\],\s*line (?<lineNumber>\d+).*/,l=/Input\s+?(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\].*line: (?<lineNumber>\d).*/.exec(e),u=s.exec(e);if(l&&((c=l.groups)!=null&&c.executionCount)&&((d=l.groups)!=null&&d.lineNumber)?(i=parseInt(l.groups.executionCount),o=(f=l.groups)==null?void 0:f.lineNumber):u&&((m=u.groups)!=null&&m.executionCount)&&((g=u.groups)!=null&&g.lineNumber)&&(i=parseInt(u.groups.executionCount),o=u.groups.lineNumber),t&&i){let b,v;for(let k of t)if(v=k.generatedCodes.find(R=>R.executionCount===i),v){b=k.uri;break}if(v&&b){let k=e;return n&&(k=k.replace(dO,(R,P,D,K)=>{let L=parseInt(D,10),O=(v.hasCellMarker?v.line-1:v.line)-1+v.lineOffsetRelativeToIndexOfFirstLineInCell+L;return`${P}<a href='${b==null?void 0:b.toString()}?line=${O-1}'>${O}</a>${K}`})),k.replace(/.*?\n/,`File \x1B[1;32m${ut(b)}:${o}\x1B[0m
`)}}if(n){let b=/^File.*?\[\d;32m(.*):\d+.*\u001b.*\n/.exec(e);if(b&&b.length>1){let v=TD(b[1],ut(this.platformService.homeDir)),k=Rie.Uri.file(v);return e.replace(dO,(R,P,D,K)=>{let L=parseInt(D,10);return`${P}<a href='${k==null?void 0:k.toString()}?line=${L-1}'>${L}</a>${K}`})}}return e}modifyTracebackFrameIPython7(e,t){return t.map(i=>i.uri).forEach(i=>{let o=ut(i),s=Ee(i),a=this.storageFactory.get({fileUri:i});if(a){if(e.includes(o)&&new RegExp(`\\[.*?;32m${Nie(o)}`).test(e)||e.includes(s)&&new RegExp(`\\[.*?;32m${Nie(s)}`).test(e)){let l="",u=/(;32m[ ->]*?)(\d+)(.*)/g;for(let d=u.exec(e);d&&d.length>3;d=u.exec(e)){let f=yu(d[3]).substr(1);l=`${l}${f}
`}let c=this.findCellOffset(a.getFileGeneratedCode(i),l);c!==void 0&&(e=e.replace(dO,(d,f,m,g)=>{let b=parseInt(m,10),v=c+b-1;return`${f}<a href='${i.toString()}?line=${v}'>${v+1}</a>${g}`}))}if(e.includes(o)){let l=this.findCellOffset(a.getFileGeneratedCode(i),e);if(l)return e.replace(dO,(u,c,d,f)=>{let m=parseInt(d,10),g=l+m-1;return`${c}<a href='${i.toString()}?line=${g}'>${g+1}</a>${f}`})}}}),e}findCellOffset(e,t){if(e){for(let n of e)if(n.trimmedRightCode.indexOf(t)>=0)return n.firstNonBlankLineIndex}}};L_=U([(0,wv.injectable)(),x(0,(0,wv.inject)(Ra)),x(1,(0,wv.inject)(fs)),x(2,(0,wv.inject)(Ke)),x(3,(0,wv.inject)(Cu))],L_);p();var Pu=ae(he()),Cm=require("vscode");p();function Aie(r){let e={source:{path:ut(r.uri)},pydevdSourceMaps:[]};return e.pydevdSourceMaps=r.generatedCodes.map(t=>({line:t.debuggerStartLine,endLine:t.endLine,runtimeSource:{path:t.runtimeFile},runtimeLine:t.runtimeLine})),e}p();var pO=class{constructor(e,t,n){this.debugAdapter=e;this.debugCell=t;this.execution=n;this._ready=Oe();this.ready=this._ready.promise;ne("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL")}trace(e,t){C.debug(`[Debug-IW] ${e}: ${t}`)}async willSendEvent(e){return w9(e)?(this.trace("intercept","debugpyAttach request for subprocess, not supported"),!0):e.event==="output"&&MP(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){let t=Gl(this.debugCell);e.command==="setBreakpoints"&&t&&t.generatedCode&&!this.cellDumpInvoked&&(this.debugCellDumped||(this.debugCellDumped=vv(this.execution,this.debugAdapter)),await this.debugCellDumped),e.command==="configurationDone"&&t&&t.generatedCode&&(this.debugCellDumped||(this.debugCellDumped=vv(this.execution,this.debugAdapter)),await this.debugCellDumped,this._ready.resolve())}};p();var fO=class extends a_{constructor(){super(...arguments);this._ready=Oe();this.ready=this._ready.promise}resolve(){this._ready.resolve()}};p();var R9=require("vscode");var mO=class extends c_{constructor(t,n,i,o,s,a,l){super(t,n,i,o,s,a);this.cellToDebugFileSortedInReverseOrderByLineNumber=[];l&&(this.debugLocationTracker=l.createDebugAdapterTracker(t),this.debugLocationTracker.onWillStartSession&&this.debugLocationTracker.onWillStartSession(),this.onDidSendMessage(u=>{var c;(c=this.debugLocationTracker)!=null&&c.onDidSendMessage&&this.debugLocationTracker.onDidSendMessage(u)},this,this.disposables),this.onDidEndSession(()=>{var u;(u=this.debugLocationTracker)!=null&&u.onWillStopSession&&this.debugLocationTracker.onWillStopSession()},this,this.disposables))}handleClientMessageAsync(t){var n,i;return C.ci(`KernelDebugAdapter::handleMessage ${JSON.stringify(t,void 0," ")}`),t.type==="request"&&((n=this.debugLocationTracker)!=null&&n.onWillReceiveMessage)&&this.debugLocationTracker.onWillReceiveMessage(t),t.type==="response"&&((i=this.debugLocationTracker)!=null&&i.onDidSendMessage)&&this.debugLocationTracker.onDidSendMessage(t),super.handleClientMessageAsync(t)}async dumpCell(t){var o,s;let n=this.notebookDocument.cellAt(t),i=Gl(n);if(!i)throw new Error("Not an interactive window cell");try{let a=(((o=i.generatedCode)==null?void 0:o.code)||n.document.getText()).replace(/\r\n/g,`
`),l=await this.session.customRequest("dumpCell",{code:a}),u=Ss(l.sourcePath);this.fileToCell.set(u,R9.Uri.parse(i.interactive.uristring));let c=0;i.generatedCode&&!i.generatedCode.hasCellMarker&&(c=i.generatedCode.firstNonBlankLineIndex),this.cellToDebugFileSortedInReverseOrderByLineNumber.push({debugFilePath:u,interactiveWindow:R9.Uri.parse(i.interactive.uristring),metadata:i,lineOffset:c+i.interactive.lineIndex+(((s=i.generatedCode)==null?void 0:s.lineOffsetRelativeToIndexOfFirstLineInCell)||0)}),this.cellToDebugFileSortedInReverseOrderByLineNumber.sort((d,f)=>f.metadata.interactive.lineIndex-d.metadata.interactive.lineIndex)}catch(a){C.error(`Failed to dump cell for ${n.index} with code ${i.interactive.originalSource}`,a)}}translateDebuggerLocationToRealLocation(t,n){var o;if(n=(o=t==null?void 0:t.source)!=null?o:n,!n||!n.path)return;let i=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(s=>s.debugFilePath===n.path);i&&(n.name=Ht(i.interactiveWindow.path),n.path=i.interactiveWindow.toString(),typeof(t==null?void 0:t.endLine)=="number"&&(t.endLine=t.endLine+(i.lineOffset||0)),typeof(t==null?void 0:t.line)=="number"&&(t.line=t.line+(i.lineOffset||0)))}translateRealLocationToDebuggerLocation(t,n){var s;let i=t.line;if(n=(s=t==null?void 0:t.source)!=null?s:n,!n||!n.path||typeof i!="number")return;let o=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(a=>i>=a.metadata.interactive.lineIndex+1);!o||o.interactiveWindow.path!==n.path||(n.path=o.debugFilePath,typeof(t==null?void 0:t.endLine)=="number"&&(t.endLine=t.endLine-(o.lineOffset||0)),typeof(t==null?void 0:t.line)=="number"&&(t.line=t.line-(o.lineOffset||0)))}async sendRequestToJupyterSession(t){var n,i;if(t.command==="setBreakpoints"){let o=t.arguments;if(delete o.lines,o.source.path!==((n=this.cellToDebugFileSortedInReverseOrderByLineNumber[0])==null?void 0:n.interactiveWindow.path))return super.sendRequestToJupyterSession(t);let s,a=[],l=[],u=()=>{if(a.length){let f=JSON.parse(JSON.stringify(t));f.arguments.breakpoints=a,l.push(super.sendRequestToJupyterSession(f))}};for(let f of(i=t.arguments.breakpoints)!=null?i:[]){let m=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(g=>f.line>=g.metadata.generatedCode.line&&f.line<=g.metadata.generatedCode.endLine);if(m&&m.metadata.interactive.lineIndex!==s)u(),s=m.metadata.interactive.lineIndex,a=[f];else if(m)a.push(f);else{let g={...f,verified:!0};l.push(Promise.resolve({body:{breakpoints:[g]}}))}}u();let c=await Promise.all(l),d=JSON.parse(JSON.stringify(c[0]));return c.slice(1).forEach(f=>{var m;d.body.breakpoints=d.body.breakpoints.concat((m=f.body.breakpoints)!=null?m:[])}),d.command="setBreakpoints",d.type="response",d.success=!0,d.request_seq=t.seq,d}return super.sendRequestToJupyterSession(t)}getDumpFilesForDeletion(){return this.cellToDebugFileSortedInReverseOrderByLineNumber.map(t=>t.debugFilePath)}};p();var Mie=require("vscode");var hO=class{constructor(e){this.debugCell=e}trace(e,t){C.debug(`[Debug-IWRestart] ${e}: ${t}`)}async willSendResponse(e){e.command==="initialize"&&e.body&&(e.body.supportsRestartRequest=!0)}async willSendRequest(e){if(e.command==="restart")return this.trace("restart","Showing warning for unsupported restart request"),Mie.window.showWarningMessage(W.restartNotSupported,{modal:!0}).then(E,E),{command:e.command,request_seq:e.seq,seq:e.seq,success:!0,type:"response"}}};var K_=class extends l_{constructor(t,n,i,o,s,a,l){super(t,n,l);this.platform=i;this.debugLocationTrackerFactory=o;this.configService=s;this.debugService=a}activate(){super.activate(),this.disposables.push(Cm.debug.registerDebugAdapterDescriptorFactory(gK,{createDebugAdapterDescriptor:async t=>this.createDebugAdapterDescriptor(t)}))}getDebugMode(t){return 2}async start(t,n){C.ci("Starting debugging IW"),await this.checkIpykernelAndPrompt(n)===1&&await this.startDebuggingCell(t,n)}async startDebuggingCell(t,n){let i=this.configService.getSettings(t.uri),o={type:gK,name:Ht(t.uri.toString()),request:"attach",justMyCode:i.debugJustMyCode,__notebookUri:t.uri.toString(),__mode:2,__cellIndex:n.index},s={suppressSaveBeforeStart:!0};await this.startDebuggingConfig(o,s);let a=this.notebookToDebugger.get(t);if(!a){C.error("Debugger not found, could not start debugging.");return}await a.ready}async createDebugAdapterDescriptor(t){let n=t.configuration;wne(n);let i=Cm.workspace.notebookDocuments.find(s=>s.uri.toString()===n.__notebookUri);if(!i||typeof n.__cellIndex!="number"){C.error("Invalid debug session for debugging of IW using Jupyter Protocol");return}if(this.notebookInProgress.has(i)){C.info("Cannot start debugging. Already debugging this notebook");return}if(this.isDebugging(i)){C.info("Cannot start debugging. Already debugging this notebook document. Toolbar should update");return}let o=new fO(i,n,t);this.notebookToDebugger.set(i,o);try{return this.notebookInProgress.add(i),await this.doCreateDebugAdapterDescriptor(n,t,i,o)}finally{this.notebookInProgress.delete(i)}}async doCreateDebugAdapterDescriptor(t,n,i,o){let s=await this.ensureKernelIsRunning(i);if(!(s!=null&&s.session)){Cm.window.showInformationMessage(W.kernelWasNotStarted).then(E,E);return}let a=new mO(n,i,s.session,s,this.platform,this.debugService,this.debugLocationTrackerFactory);this.disposables.push(a.onDidEndSession(this.endSession.bind(this)));let l=i.cellAt(t.__cellIndex),u=new pO(a,l,this.kernelProvider.getKernelExecution(s));return a.addDebuggingDelegates([u,new hO(l)]),u.ready.then(()=>o.resolve()).catch(c=>console.error("Failed waiting for controller to be ready",c)),this.trackDebugAdapter(i,a),new Cm.DebugAdapterInlineImplementation(a)}async updateSourceMaps(t,n){let i=this.getDebugSession(t.notebook);i&&(C.ci("Sending debug request for source map"),await Promise.all(n.map(async o=>{if(i)return i.customRequest("setPydevdSourceMap",Aie(o))})))}};K_=U([(0,Pu.injectable)(),x(0,(0,Pu.inject)(qe)),x(1,(0,Pu.inject)(Nt)),x(2,(0,Pu.inject)(fs)),x(3,(0,Pu.inject)(NM)),x(4,(0,Pu.inject)(Ke)),x(5,(0,Pu.inject)(lo)),x(6,(0,Pu.inject)(Ar))],K_);p();var xv=ae(he()),Oie=require("vscode");var F_=class{constructor(e,t,n,i){this.configService=e;this.fs=t;this.context=n;this.registry=i;this.priority=5}activate(){this.registry.register(this,yr)}async getCode(e){if(!Qt(e.kernelConnectionMetadata))return[];if(!zr()){if(this.configService.getSettings(void 0).forceIPyKernelDebugger===!0)return[];if(!jt(e.kernelConnectionMetadata))return[]}if(!jt(e.kernelConnectionMetadata))return[];this.addRunCellHookContents||(this.addRunCellHookContents=this.fs.readFile(Oie.Uri.joinPath(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","kernel","addRunCellHook.py")));let t=await this.addRunCellHookContents;return ct(t,{trim:!1})}};F_=U([(0,xv.injectable)(),x(0,(0,xv.inject)(Ke)),x(1,(0,xv.inject)(Pt)),x(2,(0,xv.inject)(st)),x(3,(0,xv.inject)(Md))],F_);p();var W_=ae(he()),V_=require("vscode");var U_=class{constructor(e,t,n){this.dataScienceCodeLensProvider=e;this.extensionContext=t;this.configurationService=n}activate(){this.configurationService.getSettings().pythonCellFolding&&this.extensionContext.subscriptions.push(V_.languages.registerFoldingRangeProvider([uD],this))}provideFoldingRanges(e,t,n){if([ec,jv].includes(e.uri.scheme))return;let i=this.dataScienceCodeLensProvider.getCodeWatcher(e);if(i){let o=i.getCodeLenses();return n.isCancellationRequested||o.length==0?void 0:o.map(s=>new V_.FoldingRange(s.range.start.line,s.range.end.line,V_.FoldingRangeKind.Region))}}};U_=U([(0,W_.injectable)(),x(0,(0,W_.inject)(Im)),x(1,(0,W_.inject)(st)),x(2,(0,W_.inject)(Ke))],U_);p();var B_=ae(he());var Lie=require("vscode");var j_=class{constructor(e,t,n){this.dataScienceCodeLensProvider=e;this.extensionContext=t}activate(){this.extensionContext.subscriptions.push(Lie.languages.registerCodeLensProvider([uD],this.dataScienceCodeLensProvider))}};j_=U([(0,B_.injectable)(),x(0,(0,B_.inject)(Im)),x(1,(0,B_.inject)(st)),x(2,(0,B_.inject)(Sm))],j_);p();var Ma=ae(he());var A9="LastInteractiveKernelSelected",H_=class{constructor(e,t,n,i,o){this.controllerRegistration=e;this.interpreterService=t;this.disposables=n;this.workspaceMemento=i;this.serviceContainer=o;this.onControllerSelected=this.controllerRegistration.onControllerSelected}async getInitialController(e,t,n){if(n){let i=this.controllerRegistration.get(n,t);if(i)return i}if(this.workspaceMemento.get(A9)){let i=this.workspaceMemento.get(A9),o=i?this.controllerRegistration.get(i,t):void 0;if(o)return o}if(this.interpreterService)return await gEe(t,e,this.interpreterService,this.controllerRegistration)}getSelectedController(e){return this.controllerRegistration.getSelected(e)}getRegisteredController(e){return this.controllerRegistration.get(e,"interactive")}async createKernel(e,t,n,i,o){await Ll(n,e);let s=(c,d)=>{c!=="start"&&c!=="restart"||C.ci(`(onStart) Looking for controller ${d.controller.id} in ${this.controllerRegistration.all.map(f=>`${f.kind}:${f.id}`).join(", ")}`)},a=await Ta.connectToNotebookKernel(e,this.serviceContainer,{resource:n||i.uri,notebook:i,controller:t},new fr(!1),o,"jupyterExtension",s),l=this.controllerRegistration.registered.find(c=>c.id===a.controller.id);if(!l)throw Error(`Controller ${a.controller.id} not found or not yet created`);let u=l.controller;return this.interpreterService&&vEe(a.kernelConnectionMetadata,n,this.interpreterService).then(async c=>{await this.workspaceMemento.update(A9,c?void 0:a.kernelConnectionMetadata)}).catch(c=>{C.warn("Failed to store kernel connection metadata",c)}),{kernel:a,actualController:u}}};H_=U([(0,Ma.injectable)(),x(0,(0,Ma.inject)(Nt)),x(1,(0,Ma.inject)(im)),x(1,(0,Ma.optional)()),x(2,(0,Ma.inject)(ve)),x(3,(0,Ma.inject)(Et)),x(3,(0,Ma.named)(Es)),x(4,(0,Ma.inject)(Ar))],H_);async function gEe(r,e,t,n){let i=await t.getActiveInterpreter(e);if(i){let o=await Qx(i),s=Jx.create({kernelSpec:o,interpreter:i,id:yR(o,i)}),a=n.addOrUpdate(s,[r]),l=a[0];return n.trackActiveInterpreterControllers(a),C.ci(`Active Interpreter Controller ${l.connection.kind}:${l.id} created for View ${r} with resource ${Ee(e)}`),l}}async function vEe(r,e,t){var i;let n=await t.getActiveInterpreter(e);return(n==null?void 0:n.id)===((i=r.interpreter)==null?void 0:i.id)}p();var Pv=ae(require("vscode")),gO=ae(he());var q_=class{constructor(e){this.configService=e;this.cache=new Map;this.disposables=[];this.cachedOwnsSetting=this.configService.getSettings(void 0).sendSelectionToInteractiveWindow,Pv.workspace.onDidChangeConfiguration(this.onSettingChanged,this,this.disposables),Pv.window.onDidChangeActiveTextEditor(this.onChangedActiveTextEditor,this,this.disposables),this.onChangedActiveTextEditor(),Pv.workspace.onDidCloseTextDocument(this.onClosedDocument,this,this.disposables)}getCellRanges(e){let t=this.cache.get(e.uri);if(t&&t.version===e.version)return t.ranges;let n=this.configService.getSettings(e.uri),i=T9(e,n);return this.cache.set(e.uri,{version:e.version,ranges:i}),this.updateContextKeys(e),i}clear(){this.cache.clear()}onChangedActiveTextEditor(){let e=Pv.window.activeTextEditor;!e||e.document.languageId!=$e||[ec,jv].includes(e.document.uri.scheme)?(new mr(vr.HasCodeCells).set(!1).catch(n=>C.warn("Failed to set jupyter.HasCodeCells context",n)),this.updateContextKeys(!1)):this.updateContextKeys(e.document)}onSettingChanged(e){if(this.cache.clear(),e.affectsConfiguration("jupyter.interactiveWindow.textEditor.executeSelection")){let t=this.configService.getSettings(void 0);this.cachedOwnsSetting=t.sendSelectionToInteractiveWindow,this.updateContextKeys()}}updateContextKeys(e){var n;let t=!1;if(typeof e=="boolean")t=e;else{let i=e!=null?e:(n=Pv.window.activeTextEditor)==null?void 0:n.document;t=i?this.getCellRanges(i).length>0:!1}new mr(vr.OwnsSelection).set(this.cachedOwnsSetting||t).catch(E),new mr(vr.HasCodeCells).set(t).catch(E)}onClosedDocument(e){this.cache.delete(e.uri)}dispose(){this.disposables.forEach(e=>e.dispose())}};q_=U([(0,gO.injectable)(),x(0,(0,gO.inject)(Ke))],q_);function Kie(r){r.addSingleton(uo,N_),r.addSingleton(Cu,k_),r.addSingleton(eO,H_),r.addSingleton(Ve,qs),r.addSingleton(Sm,q_),r.add(XM,tr),r.addSingleton(ZM,P_),r.addSingleton(Im,D_),r.addSingleton(Ve,j_),r.addSingleton(Ve,U_),r.addSingleton(Ve,T_),r.addSingleton(Ve,O_),r.addSingleton(x_,R_,void 0,[Ve]),r.addSingleton(Ra,M_),r.addSingleton(SI,L_),r.addSingleton(tO,K_,void 0,[Ve]),r.addSingleton(Ve,F_)}p();p();var fo=require("vscode");var Fie=ae(he());var J_=class{async getFileToExecute(){let e=fo.window.activeTextEditor;if(!e){fo.window.showErrorMessage("No open file to run in terminal").then(E,E);return}if(e.document.isUntitled){fo.window.showErrorMessage("The active file needs to be saved before it can be run").then(E,E);return}if(e.document.languageId!==$e){fo.window.showErrorMessage("The active file is not a Python source file").then(E,E);return}return e.document.isDirty&&await e.document.save(),e.document.uri}getSelectedTextToExecute(e){if(!e)return;let t=e.selection,n;return t.isEmpty?n=e.document.lineAt(t.start.line).text:t.isSingleLine?n=this.getSingleLineSelectionText(e):n=this.getMultiLineSelectionText(e),zv(n.trimEnd())}async saveFileIfDirty(e){let t=fo.workspace.textDocuments.filter(n=>n.uri.path===e.path);t.length===1&&t[0].isDirty&&await t[0].save()}getSingleLineSelectionText(e){let t=e.selection,n=new fo.Range(t.start,t.end),i=e.document.getText(n),o=e.document.lineAt(t.start.line).text;return i.trim()===o.trim()?o:i}getMultiLineSelectionText(e){let t=e.selection,n=new fo.Range(t.start,t.end),i=e.document.getText(n),o=new fo.Range(new fo.Position(t.start.line,0),new fo.Position(t.end.line,e.document.lineAt(t.end.line).text.length)),s=e.document.getText(o);if(i.trim()===s.trim())return s;let a=e.document.lineAt(t.start.line).text,l=new fo.Range(t.start,new fo.Position(t.start.line,a.length)),u=e.document.getText(l);return u.trimStart()===a.trimStart()?a+i.substring(u.length):i}};J_=U([(0,Fie.injectable)()],J_);function Uie(r){r.addSingleton(aO,J_)}p();p();var Oa=ae(he());p();var Js=require("vscode");var vO=class{constructor(e,t,n,i,o,s){this.fileConverter=e;this.fs=t;this.interactiveProvider=n;this.controllerRegistration=i;this.preferredKernel=o;this.kernelFinder=s;this.disposables=[]}register(){this.registerCommand(de.ExportAsPythonScript,(e,t)=>this.export(e,"python",void 0,t)),this.registerCommand(de.ExportToHTML,(e,t,n)=>this.export(e,"html",t,n)),this.registerCommand(de.ExportToPDF,(e,t,n)=>this.export(e,"pdf",t,n)),this.registerCommand(de.Export,(e,t,n)=>this.export(e,void 0,t,n)),this.registerCommand(de.NativeNotebookExport,e=>this.nativeNotebookExport(e))}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommand(e,t){let n=Js.commands.registerCommand(e,t,this);this.disposables.push(n)}async nativeNotebookExport(e){var i,o,s;let t=ci(e)?e:(i=e==null?void 0:e.notebookEditor)==null?void 0:i.notebookUri,n=t?Js.workspace.notebookDocuments.find(a=>this.fs.arePathsSame(a.uri,t)):(o=Js.window.activeNotebookEditor)==null?void 0:o.notebook;if(n){let a,l=this.kernelFinder.registered.find(d=>d.kind==="localPythonEnvironment"),u=new Js.CancellationTokenSource;try{a=l?await this.preferredKernel.findPreferredLocalKernelSpecConnection(n,l,u.token).then(d=>d==null?void 0:d.interpreter):void 0}finally{u.dispose()}let c=((s=this.controllerRegistration.getSelected(n))==null?void 0:s.connection.interpreter)||a;return this.export(n,void 0,void 0,c)}else return this.export(void 0,void 0,void 0,void 0)}async export(e,t,n,i){var o,s,a,l;if(!e){if(e=((o=Js.window.activeNotebookEditor)==null?void 0:o.notebook)||((a=(s=this.interactiveProvider)==null?void 0:s.getActiveOrAssociatedInteractiveWindow())==null?void 0:a.notebookDocument),!e){C.info("Export called without a valid exportable document active");return}i=i||((l=this.controllerRegistration.getSelected(e))==null?void 0:l.connection.interpreter),t&&ne("DATASCIENCE.EXPORT_NOTEBOOK_AS_COMMAND",void 0,{format:t})}if(t)await this.fileConverter.export(t,e,n,i);else{let u=await this.showExportQuickPickMenu(e,n,i).then(c=>c);u!==void 0?u.handler():ne("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK")}}getExportQuickPickItems(e,t,n){let i=[];return(n||e.metadata&&gR(_a(e)))&&i.push({label:W.exportPythonQuickPickLabel,picked:!0,handler:()=>{ne("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"python"}),Js.commands.executeCommand(de.ExportAsPythonScript,e,n).then(E,E)}}),i.push({label:W.exportHTMLQuickPickLabel,picked:!1,handler:()=>{ne("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"html"}),Js.commands.executeCommand(de.ExportToHTML,e,t,n).then(E,E)}},{label:W.exportPDFQuickPickLabel,picked:!1,handler:()=>{ne("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"pdf"}),Js.commands.executeCommand(de.ExportToPDF,e,t,n).then(E,E)}}),i}async showExportQuickPickMenu(e,t,n){let i=this.getExportQuickPickItems(e,t,n),o={ignoreFocusOut:!1,matchOnDescription:!0,matchOnDetail:!0,placeHolder:W.exportAsQuickPickPlaceholder};return Js.window.showQuickPick(i,o)}};var yO=require("vscode");var G_=class{constructor(e,t,n,i,o,s,a){this.disposables=e;this.fileConverter=t;this.fs=n;this.interactiveProvider=i;this.controllerSelection=o;this.kernelFinder=s;this.jupyterConnection=a;this.exportCommand=new vO(this.fileConverter,this.fs,this.interactiveProvider,o,new t_(a),s),yO.workspace.isTrusted||yO.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted()}registerCommandsIfTrusted(){var e;yO.workspace.isTrusted&&((e=this.exportCommand)==null||e.register())}};G_=U([(0,Oa.injectable)(),x(0,(0,Oa.inject)(ve)),x(1,(0,Oa.inject)(f_)),x(2,(0,Oa.inject)(Pt)),x(3,(0,Oa.inject)(uo)),x(3,(0,Oa.optional)()),x(4,(0,Oa.inject)(Nt)),x(5,(0,Oa.inject)(ri)),x(6,(0,Oa.inject)(hn))],G_);p();var Du=ae(he()),Gs=require("vscode");var Y_=class{constructor(e,t,n,i,o){this.interactiveProvider=e;this.kernelProvider=n;this.controllers=i;this.jupyterUriProviderRegistration=o;this.disposables=[];this.isPythonFileActive=!1;this.ownedOpenNotebooks=new Set;t.push(this),this.nativeContext=new mr(vr.IsNativeActive),this.canRestartNotebookKernelContext=new mr(vr.CanRestartNotebookKernel),this.canInterruptNotebookKernelContext=new mr(vr.CanInterruptNotebookKernel),this.canRestartInteractiveWindowKernelContext=new mr(vr.CanRestartInteractiveWindowKernel),this.canInterruptInteractiveWindowKernelContext=new mr(vr.CanInterruptInteractiveWindowKernel),this.interactiveContext=new mr(vr.IsInteractiveActive),this.interactiveOrNativeContext=new mr(vr.IsInteractiveOrNativeActive),this.pythonOrNativeContext=new mr(vr.IsPythonOrNativeActive),this.pythonOrInteractiveContext=new mr(vr.IsPythonOrInteractiveActive),this.pythonOrInteractiveOrNativeContext=new mr(vr.IsPythonOrInteractiveOrNativeActive),this.hasNativeNotebookCells=new mr(vr.HaveNativeCells),this.isPythonNotebook=new mr(vr.IsPythonNotebook),this.isJupyterKernelSelected=new mr(vr.IsJupyterKernelSelected),this.hasNativeNotebookOrInteractiveWindowOpen=new mr(vr.HasNativeNotebookOrInteractiveWindowOpen),this.kernelSourceContext=new mr(vr.KernelSource)}dispose(){this.disposables.forEach(e=>e.dispose())}activate(){var e;Gs.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,this.disposables),this.kernelProvider.onKernelStatusChanged(this.onDidKernelStatusChange,this,this.disposables),this.interactiveProvider&&(this.interactiveProvider.onDidChangeActiveInteractiveWindow(this.onDidChangeActiveInteractiveWindow,this,this.disposables),this.interactiveProvider.activeWindow&&this.onDidChangeActiveInteractiveWindow()),Gs.window.activeNotebookEditor&&this.onDidChangeActiveNotebookEditor(Gs.window.activeNotebookEditor),Gs.window.onDidChangeActiveNotebookEditor(this.onDidChangeActiveNotebookEditor,this,this.disposables),((e=Gs.window.activeTextEditor)==null?void 0:e.document.languageId)===$e&&this.onDidChangeActiveTextEditor(Gs.window.activeTextEditor),Gs.workspace.onDidCloseNotebookDocument(this.updateNativeNotebookInteractiveWindowOpenContext,this,this.disposables),this.controllers.onControllerSelectionChanged(()=>this.updateSelectedKernelContext(),this,this.disposables),this.updateSelectedKernelContext()}updateNativeNotebookCellContext(){var t;let e=(((t=Gs.window.activeNotebookEditor)==null?void 0:t.notebook.cellCount)||0)>0;this.hasNativeNotebookCells.set(e).catch(E)}onDidChangeActiveInteractiveWindow(e){this.interactiveContext.set(!!e).catch(E),this.updateMergedContexts(),this.updateContextOfActiveInteractiveWindowKernel()}onDidChangeActiveNotebookEditor(e){let t=e?e.notebook.notebookType===St:!1;this.nativeContext.set(t).catch(E),this.isPythonNotebook.set(e&&t?gR(_a(e.notebook)):!1).catch(E),this.updateContextOfActiveNotebookKernel(e),this.updateContextOfActiveInteractiveWindowKernel(),this.updateNativeNotebookCellContext(),this.updateMergedContexts()}updateNativeNotebookInteractiveWindowOpenContext(e,t){t?this.ownedOpenNotebooks.add(e):this.ownedOpenNotebooks.delete(e),this.hasNativeNotebookOrInteractiveWindowOpen.set(this.ownedOpenNotebooks.size>0).catch(E)}updateContextOfActiveNotebookKernel(e){let t=e&&e.notebook.notebookType===St?this.kernelProvider.get(e.notebook):void 0;if(t){let n=this.kernelProvider.getKernelExecution(t),i=t.status!=="unknown"||n.executionCount>0||t.startedAtLeastOnce;this.canRestartNotebookKernelContext.set(!!i).catch(E);let o=t.status==="busy";this.canInterruptNotebookKernelContext.set(!!o).catch(E)}else this.canRestartNotebookKernelContext.set(!1).catch(E),this.canInterruptNotebookKernelContext.set(!1).catch(E);this.updateKernelSourceContext(t).catch(E),this.updateSelectedKernelContext()}async updateKernelSourceContext(e){if(!e||!Wt(e.kernelConnectionMetadata)){this.kernelSourceContext.set("").catch(E);return}let t=e.kernelConnectionMetadata,n=await this.jupyterUriProviderRegistration.jupyterCollections.find(i=>i.extensionId===t.serverProviderHandle.extensionId&&i.id===t.serverProviderHandle.id);if(!n){this.kernelSourceContext.set("").catch(E);return}this.kernelSourceContext.set(n.id).catch(E)}updateSelectedKernelContext(){var t,n,i;let e=((t=Gs.window.activeNotebookEditor)==null?void 0:t.notebook)||((i=(n=this.interactiveProvider)==null?void 0:n.getActiveOrAssociatedInteractiveWindow())==null?void 0:i.notebookDocument);e&&gr(e)&&this.controllers.getSelected(e)?(this.isJupyterKernelSelected.set(!0).catch(E),this.updateNativeNotebookInteractiveWindowOpenContext(e,!0)):this.isJupyterKernelSelected.set(!1).catch(E)}updateContextOfActiveInteractiveWindowKernel(){var n,i;let e=(i=(n=this.interactiveProvider)==null?void 0:n.getActiveOrAssociatedInteractiveWindow())==null?void 0:i.notebookDocument,t=e?this.kernelProvider.get(e):void 0;if(t){let o=t.status!=="unknown";this.canRestartInteractiveWindowKernelContext.set(!!o).catch(E);let s=t.status==="busy";this.canInterruptInteractiveWindowKernelContext.set(!!s).catch(E)}else this.canRestartInteractiveWindowKernelContext.set(!1).catch(E),this.canInterruptInteractiveWindowKernelContext.set(!1).catch(E);this.updateSelectedKernelContext()}onDidKernelStatusChange({kernel:e}){var n;let t=e.notebook;t.notebookType===yr?this.updateContextOfActiveInteractiveWindowKernel():t.notebookType===St&&t===((n=Gs.window.activeNotebookEditor)==null?void 0:n.notebook)&&this.updateContextOfActiveNotebookKernel(Gs.window.activeNotebookEditor)}onDidChangeActiveTextEditor(e){this.isPythonFileActive=(e==null?void 0:e.document.languageId)===$e&&!SB(e.document.uri),this.updateNativeNotebookCellContext(),this.updateMergedContexts(),this.updateContextOfActiveInteractiveWindowKernel()}updateMergedContexts(){this.interactiveOrNativeContext.set(this.nativeContext.value===!0||this.interactiveContext.value===!0).catch(E),this.pythonOrNativeContext.set(this.nativeContext.value===!0||this.isPythonFileActive===!0).catch(E),this.pythonOrInteractiveContext.set(this.interactiveContext.value===!0||this.isPythonFileActive===!0).catch(E),this.pythonOrInteractiveOrNativeContext.set(this.nativeContext.value===!0||this.interactiveContext.value===!0&&this.isPythonFileActive===!0).catch(E)}};Y_=U([(0,Du.injectable)(),x(0,(0,Du.inject)(uo)),x(0,(0,Du.optional)()),x(1,(0,Du.inject)(ve)),x(2,(0,Du.inject)(qe)),x(3,(0,Du.inject)(Nt)),x(4,(0,Du.inject)(sr))],Y_);p();var sp=ae(he());var $_=class{constructor(e,t,n){this.disposableRegistry=e;this.rawSupported=t;this.commandListeners=n;this.isDisposed=!1;this.startTime=Date.now()}get activationStartTime(){return this.startTime}activate(){this.disposableRegistry.push(this),this.computeZmqAvailable(),this.commandListeners&&this.commandListeners.forEach(e=>e.register())}async dispose(){this.changeHandler&&(this.changeHandler.dispose(),this.changeHandler=void 0)}computeZmqAvailable(){new mr(vr.ZmqAvailable).set(this.rawSupported?this.rawSupported.isSupported:!1).then(E,E)}};$_=U([(0,sp.injectable)(),x(0,(0,sp.inject)(ve)),x(1,(0,sp.inject)(Hd)),x(1,(0,sp.optional)()),x(2,(0,sp.multiInject)(_T))],$_);p();var wm=ae(he()),Tu=require("vscode");var z_=class{constructor(e,t,n){this.jupyterServerHelper=e;this.fileSystem=t;this.errorHandler=n;this.extractPythonMainVersion=async()=>{if(!this.jupyterServerHelper)return 3;let e=await this.jupyterServerHelper.getUsableJupyterPython(),t=await Dp(e);return e&&t&&t.major||3}}async exportToFile(e,t,n=!0){let i=await this.serialize(e);try{if(await this.fileSystem.writeFile(Tu.Uri.file(t),i||""),!n)return;let o=W.exportOpenQuestion1;Tu.window.showInformationMessage(W.exportDialogComplete(t),o).then(async s=>{try{s===o&&await nO(Tu.Uri.file(t))}catch(a){await this.errorHandler.handleError(a)}},E)}catch(o){C.error("Error in exporting notebook file"),Tu.window.showInformationMessage(W.exportDialogFailed(o)).then(E,E)}}async serialize(e,t){var a;let n=await this.extractPythonMainVersion(),i={language_info:{codemirror_mode:{name:"ipython",version:n},file_extension:".py",mimetype:"text/x-python",name:"python",nbconvert_exporter:"python",pygments_lexer:`ipython${n}`,version:n},kernelspec:t},o=(a=Tu.extensions.getExtension("vscode.ipynb"))==null?void 0:a.exports;if(!o)throw new Error("vscode.ipynb extension not found");let s=new Tu.NotebookData(e);return s.metadata={metadata:i,nbformat:dL.major,nbformat_minor:dL.minor},o.exportNotebook(s)}};z_=U([(0,wm.injectable)(),x(0,(0,wm.inject)(Dee)),x(0,(0,wm.optional)()),x(1,(0,wm.inject)(Pt)),x(2,(0,wm.inject)(mn))],z_);p();var Fi=ae(he()),bO=require("vscode");p();var Tv=ae(he()),Dv=require("vscode");var Vie=require("vscode");var M9="JUPYTER_API_ACCESS_INFORMATION",Wie=new Set([Ge.split(".")[0],"rchiodo","donjayamanne","SynapseVSCode"]),O9=new Set(["rchiodo","nuant"]),ap=class{constructor(e,t){this.globalState=e;this.context=t;this.extensionAccess=new Map;this.promiseChain=new qv}async getAccessInformation(e){var s,a;let t=!e.extensionId||e.extensionId===mD?"":e.extensionId.split(".")[0]||"";if(this.context.extensionMode===Dv.ExtensionMode.Test||!t||Ud()==="insiders"){if(!Wie.has(t)&&!O9.has(t)){C.warn(`Publisher ${t} is allowed to access the Kernel API with a message.`);let l=((a=(s=Vie.extensions.getExtension(e.extensionId))==null?void 0:s.packageJSON)==null?void 0:a.displayName)||"",u=l&&e.extensionId?`${l} (${e.extensionId})`:e.extensionId||t;Dv.window.showErrorMessage(W.thanksForUsingJupyterKernelApiPleaseRegisterWithUs(u)).then(E,E)}if(!O9.has(t)||!t||this.context.extensionMode===Dv.ExtensionMode.Test)return{extensionId:e.extensionId,accessAllowed:!0}}if(Wie.has(t))return{extensionId:e.extensionId,accessAllowed:!0};if(!O9.has(t))return Dv.window.showErrorMessage(`Please contact the Jupyter Extension to get access to the Kernel API. Publisher ${t}`).then(E,E),C.error(`Publisher ${t} is not allowed to access the Kernel API.`),{extensionId:e.extensionId,accessAllowed:!1};let n=this.globalState.get(M9),i=n==null?void 0:n.find(l=>l.extensionId===e.extensionId);if(i)return ne("DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",void 0,{extensionId:e.extensionId,allowed:i.allowed}),{extensionId:e.extensionId,accessAllowed:i.allowed==="yes"};if(this.extensionAccess.get(e.extensionId))return this.extensionAccess.get(e.extensionId);let o=(async()=>{let l=W.allowExtensionToUseJupyterKernelApi(`${e.displayName} (${e.extensionId})`,Ue.bannerLabelYes),c=await Dv.window.showInformationMessage(l,{modal:!0},Ue.bannerLabelYes,Ue.bannerLabelNo)===Ue.bannerLabelYes;return this.promiseChain.chainFinally(async()=>{let d=[...this.globalState.get(M9,[])];return d=d.filter(f=>f.extensionId!==e.extensionId),d.push({allowed:c?"yes":"no",extensionId:e.extensionId}),this.globalState.update(M9,d)}).then(E,E),ne("DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",void 0,{extensionId:e.extensionId,allowed:c?"yes":"no"}),{extensionId:e.extensionId,accessAllowed:c}})();return this.extensionAccess.set(e.extensionId,o),o}};ap=U([(0,Tv.injectable)(),x(0,(0,Tv.inject)(Et)),x(0,(0,Tv.named)(rr)),x(1,(0,Tv.inject)(st))],ap);p();var jie=new WeakMap;function L9(r){let e=jie.get(r);return e||(e=yEe(r),jie.set(r,e)),e}function yEe(r){return new Proxy(r,{get(e,t){return t==="kernel"?e.kernel?bEe(e.kernel):void 0:Reflect.get(e,t)}})}var Bie=new WeakMap;function bEe(r){let e=Bie.get(r);return e||(e=IEe(r),Bie.set(r,e)),e}function IEe(r){return new Proxy(r,{get(e,t){return t==="registerCommTarget"?(n,i)=>(Mre(r,n),Reflect.get(e,t).apply(e,[n,i])):t==="removeCommTarget"?(n,i)=>(Ore(r,n),Reflect.get(e,t).apply(e,[n,i])):Reflect.get(e,t)}})}var Q_=class{constructor(e,t,n,i,o,s,a,l){this.kernelProvider=e;this.kernelFinder=t;this.thirdPartyKernelProvider=n;this.disposables=i;this.controllerRegistration=o;this.apiAccess=s;this.extensions=a;this.serviceContainer=l;this.chainedApiAccess=new qv;this.extensionApi=new Map}async getService(){let e=this.extensions.determineExtensionFromCallStack(),t=await this.chainedApiAccess.chainFinally(()=>this.apiAccess.getAccessInformation(e));if(!t.accessAllowed)return;if(this.extensionApi.get(t.extensionId))return this.extensionApi.get(t.extensionId);let n=new JP(t.extensionId,this.kernelProvider,this.kernelFinder,this.thirdPartyKernelProvider,this.disposables,this.controllerRegistration,this.serviceContainer);return this.extensionApi.set(t.extensionId,n),n}};Q_=U([(0,Fi.injectable)(),x(0,(0,Fi.inject)(qe)),x(1,(0,Fi.inject)(ri)),x(2,(0,Fi.inject)(jg)),x(3,(0,Fi.inject)(ve)),x(4,(0,Fi.inject)(Nt)),x(5,(0,Fi.inject)(ap)),x(6,(0,Fi.inject)(qa)),x(7,(0,Fi.inject)(Ar))],Q_);var JP=class{constructor(e,t,n,i,o,s,a){this.callingExtensionId=e;this.kernelProvider=t;this.kernelFinder=n;this.thirdPartyKernelProvider=i;this.disposables=o;this.controllerRegistration=s;this.serviceContainer=a;this._onDidChangeKernelSpecifications=new bO.EventEmitter;this._onDidChangeKernels=new bO.EventEmitter;this.translatedConnections=new WeakMap;this._onDidChangeStatus=new bO.EventEmitter;this._status=this.kernelFinder.status,this.kernelFinder.onDidChangeStatus(()=>{this._status=this.kernelFinder.status,this._onDidChangeStatus.fire()},this,o),this.kernelProvider.onDidDisposeKernel(l=>{var u;C.ci(`Kernel ${l.kernelConnectionMetadata.id}, ${(u=l.kernelConnectionMetadata.interpreter)==null?void 0:u.uri.toString()} disposed`),this._onDidChangeKernels.fire()},this,o),this.kernelProvider.onDidStartKernel(l=>{var u;C.ci(`Kernel ${l.kernelConnectionMetadata.id}, ${(u=l.kernelConnectionMetadata.interpreter)==null?void 0:u.uri.toString()} started`),this._onDidChangeKernels.fire()},this,o),this.thirdPartyKernelProvider.onDidDisposeKernel(l=>{var u;C.ci(`Third party Kernel ${l.kernelConnectionMetadata.id}, ${(u=l.kernelConnectionMetadata.interpreter)==null?void 0:u.uri.toString()} disposed`),this._onDidChangeKernels.fire()},this,o),this.thirdPartyKernelProvider.onDidStartKernel(l=>{var u;C.ci(`Third party Kernel ${l.kernelConnectionMetadata.id}, ${(u=l.kernelConnectionMetadata.interpreter)==null?void 0:u.uri.toString()} started`),this._onDidChangeKernels.fire()},this,o),this.controllerRegistration.onDidChange(()=>this._onDidChangeKernelSpecifications.fire(),this,o)}get onDidChangeKernelSpecifications(){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"onDidChangeKernelSpecifications"}),C.debug(`API called from ${this.callingExtensionId}`),this._onDidChangeKernelSpecifications.event}get onDidChangeKernels(){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"onDidChangeKernels"}),this._onDidChangeKernels.event}get status(){return this._status}get onDidChangeStatus(){return this._onDidChangeStatus.event}async getKernelSpecifications(){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getKernelSpecifications"}),this.kernelFinder.kernels.map(e=>this.translateKernelConnectionMetadataToExportedType(e))}getActiveKernels(){ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getActiveKernels"});let e=[],t=new Set;return this.kernelProvider.kernels.filter(n=>n.startedAtLeastOnce||n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel").forEach(n=>{var o,s;let i=this.kernelProvider.get(n.notebook);i&&((s=(o=i.session)==null?void 0:o.kernel)!=null&&s.id)&&t.add(i.session.kernel.id),e.push({metadata:this.translateKernelConnectionMetadataToExportedType(n.kernelConnectionMetadata),uri:n.uri,id:n.id})}),this.thirdPartyKernelProvider.kernels.filter(n=>n.startedAtLeastOnce||n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel").forEach(n=>{var o,s;let i=this.thirdPartyKernelProvider.get(n.uri);i&&((s=(o=i.session)==null?void 0:o.kernel)!=null&&s.id)&&t.add(i.session.kernel.id),e.push({metadata:this.translateKernelConnectionMetadataToExportedType(n.kernelConnectionMetadata),uri:n.uri,id:n.id})}),this.controllerRegistration.registered.forEach(n=>{n.controller.notebookType===St&&n.connection.kind==="connectToLiveRemoteKernel"&&(!n.connection.kernelModel.id||t.has(n.connection.kernelModel.id)||e.push({metadata:n.connection,uri:void 0,id:n.id}))}),e}getKernel(e){var n;ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getKernel"});let t=(n=this.thirdPartyKernelProvider.get(e))!=null?n:this.kernelProvider.get(e);if(t!=null&&t.session)return{metadata:this.translateKernelConnectionMetadataToExportedType(t.kernelConnectionMetadata),connection:L9(t.session)}}async startKernel(e,t){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"startKernel"}),this.startOrConnect(e,t)}async connect(e,t){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"connect"}),this.startOrConnect(e,t)}async startOrConnect(e,t){let n=this.kernelFinder.kernels.find(o=>o.id===e.id);if(!n)throw new Error("Not found");let i=await Ta.connectToKernel(n,this.serviceContainer,{resource:t},new fr(!1),this.disposables,"3rdPartyExtension");if(!(i!=null&&i.session))throw new Error("Not found");return L9(i.session)}translateKernelConnectionMetadataToExportedType(e){if(!this.translatedConnections.has(e)){let t=Object.freeze(tu.fromJSON(e.toJSON()));this.translatedConnections.set(e,t)}return this.translatedConnections.get(e)}};JP=U([x(1,(0,Fi.inject)(qe)),x(2,(0,Fi.inject)(ri)),x(3,(0,Fi.inject)(jg)),x(4,(0,Fi.inject)(ve)),x(5,(0,Fi.inject)(Nt)),x(6,(0,Fi.inject)(Ar))],JP);p();var Z_=ae(he());var X_=class{constructor(e){this.syncActivationServices=e}activate(){this.syncActivationServices.map(e=>{try{e.activate()}catch(t){C.error(`Error in activating extension, failed in ${e.constructor.name}`,t)}})}};X_=U([(0,Z_.injectable)(),x(0,(0,Z_.optional)()),x(0,(0,Z_.multiInject)(Ve))],X_);p();p();var zl=require("vscode");p();var $l=require("vscode");var qie="version";function Hie(r){return`${qie}-${r.extension.packageJSON.version||"version"}`}async function Jie(r,e){if(ic())return $l.Uri.joinPath(r.globalStorageUri,Hie(r));{let t=$l.Uri.joinPath($l.Uri.file(r.globalStorageUri.fsPath),Hie(r));if(e)try{await e.createDirectory(t)}catch(n){C.warn(`Failed to create temp directory (${t.fsPath}), falling back to extension dir`,n),t=$l.Uri.joinPath(r.extensionUri,"temp"),await e.createDirectory(t)}return t}}async function Gie(r){try{let e=await $l.workspace.fs.readDirectory(r.globalStorageUri);await Promise.all(e.filter(([t,n])=>t.startsWith(qie)&&n===$l.FileType.Directory).map(([t])=>$l.workspace.fs.delete($l.Uri.joinPath(r.globalStorageUri,t),{recursive:!0}))).catch(E)}catch(e){}}function Yie(r,e){e&&zl.commands.registerCommand("dataScience.ClearCache",async()=>{let t=[];for(let n of r.globalState.keys())t.push(r.globalState.update(n,void 0).then(E,E));for(let n of r.workspaceState.keys())t.push(r.workspaceState.update(n,void 0).then(E,E));t.push(zl.commands.executeCommand(de.ClearSavedJupyterUris).then(E,E)),await Promise.all(t).catch(E),await Promise.all([zl.workspace.fs.delete(zl.Uri.joinPath(r.globalStorageUri,"lastExecutedRemoteCell.json")).then(E,E),zl.workspace.fs.delete(zl.Uri.joinPath(r.globalStorageUri,"remoteServersMRUList.json")).then(E,E),zl.workspace.fs.delete(zl.Uri.joinPath(r.globalStorageUri,ES)).then(E,E),Gie(r).then(E,E)]),C.info("Cache cleared")})}function $ie(r,e){Yie(r,e)}p();p();var _O=ae(he()),Gt=require("vscode");var IO=W.percentPipCondaInstallInsteadOfBang("pip"),K9=W.percentPipCondaInstallInsteadOfBang("conda"),zie=W.matplotlibWidgetInsteadOfOther,SO="Jupyter",eE=class{constructor(e){this.disposables=[];this.notebooksProcessed=new WeakMap;this.cellsToProcess=new Set;this.problems=Gt.languages.createDiagnosticCollection(SO),this.disposables.push(this.problems),e.push(this)}dispose(){Ce(this.disposables),this.problems.dispose()}activate(){this.disposables.push(Gt.languages.registerCodeActionsProvider($e,this)),this.disposables.push(Gt.languages.registerHoverProvider($e,this)),Gt.workspace.onDidChangeTextDocument(t=>{let n=iI(t.document);if(!n)return;let i=n.getCells().find(o=>o.document===t.document);i&&this.analyzeNotebookCell(i)},this,this.disposables),Gt.workspace.onDidCloseNotebookDocument(t=>{this.problems.delete(t.uri);let n=this.notebooksProcessed.get(t);this.notebooksProcessed.delete(t),n&&n.forEach((i,o)=>this.problems.delete(Gt.Uri.parse(o)))},this,this.disposables),Gt.workspace.onDidOpenNotebookDocument(t=>this.analyzeNotebook(t),this,this.disposables);let e=new rc(300);this.disposables.push(e),Gt.workspace.onDidChangeNotebookDocument(t=>{e.trigger(()=>{let n=this.notebooksProcessed.get(t.notebook);t.contentChanges.forEach(i=>{i.removedCells.forEach(o=>{n==null||n.delete(o.document.uri.toString())}),i.addedCells.forEach(o=>this.queueCellForProcessing(o))}),t.cellChanges.forEach(i=>this.queueCellForProcessing(i.cell))})},this,this.disposables),Gt.workspace.notebookDocuments.map(t=>this.analyzeNotebook(t))}provideHover(e,t,n){let i=iI(e);if((i==null?void 0:i.notebookType)!==St)return;let o=this.problems.get(e.uri);if(!o)return;let s=o.find(l=>l.message===IO||l.message===K9);if(!s||!s.range.contains(t))return;let a=s.message===IO?"pip":"conda";return new Gt.Hover(W.pipCondaInstallHoverWarning(a,"https://aka.ms/jupyterCellMagicBangInstall"),s.range)}provideCodeActions(e,t,n,i){if(!iI(e))return[];let o=[];return n.diagnostics.forEach(s=>{switch(s.message){case IO:o.push(this.createReplaceCodeAction(e,"pip",s));break;case K9:o.push(this.createReplaceCodeAction(e,"conda",s));break;case zie:o.push(this.createGotoWikiAction(e,Gt.Uri.parse("https://aka.ms/vscodejupytermatplotlibwidget"),s));break;default:break}}),o}createReplaceCodeAction(e,t,n){let i=new Gt.CodeAction(W.replacePipCondaInstallCodeAction(t),Gt.CodeActionKind.QuickFix);i.isPreferred=!0,i.diagnostics=[n];let o=new Gt.WorkspaceEdit;return o.replace(e.uri,new Gt.Range(n.range.start,new Gt.Position(n.range.start.line,n.range.start.character+1)),"%"),i.edit=o,i}createGotoWikiAction(e,t,n){let i=new Gt.CodeAction(W.matplotlibWidgetCodeActionTitle,Gt.CodeActionKind.QuickFix);return i.isPreferred=!0,i.diagnostics=[n],i.command={title:W.matplotlibWidgetCodeActionTitle,command:"vscode.open",arguments:[t]},i}analyzeNotebook(e){e.notebookType===St&&e.getCells().forEach((t,n)=>n<100?this.queueCellForProcessing(t):void 0)}queueCellForProcessing(e){this.cellsToProcess.add(e),this.analyzeNotebookCells()}analyzeNotebookCells(){if(this.cellsToProcess.size===0)return;let e=this.cellsToProcess.values().next().value;e&&(this.cellsToProcess.delete(e),this.analyzeNotebookCell(e)),setTimeout(()=>this.analyzeNotebookCells(),0)}analyzeNotebookCell(e){var n;if(e.kind!==Gt.NotebookCellKind.Code||e.document.languageId!==$e||e.notebook.isClosed||e.document.isClosed||((n=this.notebooksProcessed.get(e.notebook))==null?void 0:n.get(e.document.uri.toString()))===e.document.version)return;this.problems.delete(e.document.uri);let t=this.notebooksProcessed.get(e.notebook)||new Map;t.set(e.document.uri.toString(),e.document.version),this.notebooksProcessed.set(e.notebook,t);for(let i=0;i<Math.min(e.document.lineCount,50);i++){let o=e.document.lineAt(i),s=o.text;if(s.trim().startsWith("!pip install")){let a=s.indexOf("!"),l=s.indexOf("l"),u=new Gt.Range(o.lineNumber,a,o.lineNumber,l+2);this.problems.set(e.document.uri,[{message:IO,range:u,severity:Gt.DiagnosticSeverity.Warning,source:SO}])}else if(s.trim().startsWith("!conda install")){let a=s.indexOf("!"),l=s.indexOf("l"),u=new Gt.Range(o.lineNumber,a,o.lineNumber,l+2);this.problems.set(e.document.uri,[{message:K9,range:u,severity:Gt.DiagnosticSeverity.Warning,source:SO}])}else if(s.trim().startsWith("%matplotlib")&&!s.trim().endsWith("widget")&&!s.trim().endsWith("inline")){let a=s.indexOf("%"),l=s.length,u=new Gt.Range(o.lineNumber,a,o.lineNumber,l);this.problems.set(e.document.uri,[{message:zie,range:u,severity:Gt.DiagnosticSeverity.Warning,source:SO}])}}}};eE=U([(0,_O.injectable)(),x(0,(0,_O.inject)(ve))],eE);p();var PO=ae(he()),Sr=require("vscode");p();var Qie=new Map([["method",0],["function",1],["constructor",2],["field",3],["variable",4],["class",5],["struct",6],["interface",7],["module",8],["property",9],["event",10],["operator",11],["unit",12],["value",13],["constant",14],["enum",15],["enumMember",16],["keyword",17],["text",18],["color",19],["file",20],["reference",21],["customcolor",22],["folder",23],["typeParameter",24],["snippet",25],["<unknown>",3]]);p();function EO(r){if(r>=300)return"ZZZZZZZ";if(r<=25)return`A${String.fromCharCode(65+r)}`;let e=String.fromCharCode(65+Math.ceil(r/25)),t=String.fromCharCode(65+r%25);return`${e}${t}`}p();var ioe=require("vscode");p();var kv=require("vscode");var SEe=new Map([["julia",wEe],["python",EEe],["r",xEe]]);function Xie(r,e){let t=SEe.get(e.toLowerCase());return t?t(r):r}var _Ee=["Docstring:","Options:","Parameters","Returns","See Also","Notes","Examples","Usage:","Subclasses:"];function EEe(r){let e=ct(r,{trim:!1,removeEmptyEntries:!1}),t=-1,n=!1,i=!1,o=[],s=new Set,a=!1,l="",u=!1,c=!1;if(e.map((f,m)=>{if(m===0){let b=["Signature:","Init signature:"].find(v=>f.toLowerCase().startsWith(v.toLowerCase()));if(b){n=!0,f=f.substring(b.length).trim(),o.push("```python"),f.trim().length&&(o.push(f),u=!0);return}}if(f.startsWith("File:")&&m===e.length-1||f.startsWith("Type:")&&m===0)return;if(!a&&f.toLowerCase().startsWith("String form:".toLowerCase())){i=!0;return}let g=_Ee.find(b=>f.trim().toLowerCase().startsWith(b.toLowerCase()));if(g&&!s.has(g)){l=g.toLowerCase(),s.add(g),a=!0,t=m,i=!1,n&&o.push("```","----------"),n=!1,c=!1,l!=="docstring:"&&o.push(`## ${g}`);let b=f.includes(":")?f.split(":")[1].replace("<no docstring>","").trim():"";b.length&&(o.push(b),u=!0);return}if(!i){if(t+1===m&&f.replace(/-/g,"").replace(/:/g,"").replace("<no docstring>","").trim().length===0){t=m,i=!1,n=!1,c=!1;return}if(l==="parameters"||l==="see also"){f.trim().length&&f.includes(":")&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),u=u||f.trim().length>0;return}if(l==="options:"){f.startsWith("-")&&f.trim().length&&f.includes(":")&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),u=u||f.trim().length>0;return}if(l==="returns"){f.trim().length&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),u=u||f.trim().length>0;return}if(l==="examples"&&!n&&(t+1===m||t+2===m))return i=!1,n=!0,u=u||f.trim().length>0,o.push("```python",f);if(!n&&f.startsWith("class ")&&f.trim().endsWith("):")){n=!0,c=!0,o.push("```python",f),u=u||f.trim().length>0;return}if(n&&c&&f.trim().length>0&&f.substring(0,1)!==" "&&f.substring(0,1)!=="	")return n=!1,c=!1,o.push(f,"```");u=u||f.trim().length>0,o.push(f)}}),!u)return"";let d=o.join(`  
`);return n?new kv.MarkdownString(d+"  \n```"):new kv.MarkdownString(d)}var CEe=[{section:"Examples:",header:"Examples",nextLine://g},{section:"Usage note",header:"Usage note",nextLine://g},{section:"Note:",header:"\u2502 Note",nextLine:"\u2502"},{section:"Note:",header:"\u2502 Note",nextLine:"\u2502"}];function wEe(r){let e=ct(r,{trim:!1,removeEmptyEntries:!1}),t=!1,n=[],i=new Set,o="",s=!1,a=!1;e.every(u=>u.trim().length===0||u.startsWith("  "))&&e.forEach((u,c)=>e[c]=u.trim().length?u.substring(2):u),e.map((u,c)=>{if(u.trim()==="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500")return a=!1,n.push(u);if(!a)return o="signature",t=!0,a=!0,u.trim().length?(s=!0,n.push("```julia",u)):n.push("```julia");o==="signature"&&u.trim()===""&&(o="",t=!1,s=!1,n.push("```"));let d=CEe.find(f=>u.trim().toLowerCase().startsWith(f.header.toLowerCase()));if(d&&(typeof d.nextLine=="string"?e[c+1].trim()===d.nextLine.trim():e[c+1].trim().replace(d.nextLine,"").length===0)){e[c+1]="",o=d.section.toLowerCase(),i.add(d.header),t&&n.push("```"),t=!1,n.push(`## ${d.section}`),o==="note:"&&!e.slice(c+1).every(f=>f.trim().length===0||f.trim().startsWith("|")||f.trim().startsWith("\u2502"))&&(o="");return}if(o==="examples:"&&!t)return t=!0,u.trim().length?(s=!0,n.push("```julia",u)):n.push("```julia");if(o==="note:"){n.push(u.trim()?u.trim().substring(1):"");return}t&&!s&&u.trim().length===0||n.push(u)});let l=n.join(`  
`);return t?new kv.MarkdownString(l+"  \n```"):new kv.MarkdownString(l)}function xEe(r){let e=ct(r,{trim:!1,removeEmptyEntries:!1}),t=[];e.forEach((a,l)=>e[l]=a.indexOf("     ")===0?a.substring(5):a);let n="",i=!1,o=!1;e.map(a=>{let l=a.replace(/_/g,"").trim();if(a.startsWith("_")&&a.includes("\b")&&a.split("_").length===a.split("\b").length&&l){i&&t.push("```"),i=!1,n=l.trim().toLowerCase(),t.push(`## ${l}`);return}if((n==="examples"||n==="examples:"||n==="usage"||n==="usage:")&&!i)return i=!0,a.trim().length?(o=!0,t.push("```r",a)):t.push("```r");if(n==="note:"){t.push(a.trim()?a.trim().substring(1):"");return}i&&!o&&a.trim().length===0||t.push(a)});let s=t.join(`  
`);return i?new kv.MarkdownString(s+"  \n```"):new kv.MarkdownString(s)}p();var Zie=new WeakMap;async function Nv(r,e,t){var f;let n=Zie.get(r)||0;Zie.set(r,n+1);let{api:i}=kR(Ge,r),o=`application/vnd.vscode.bg.execution.${n}`,s=`application/vnd.vscode.bg.execution.${n}.result`,a=`application/vnd.vscode.bg.execution.${n}.error`,l="",u=`
def __jupyter_exec_background__():
    from IPython.display import display
    from threading import Thread
    from traceback import format_exc

    # First send a dummy response to get the display id.
    # Later we'll send the real response with the actual data.
    # And that can happen much later even after the execution completes,
    # as that response will be sent from a bg thread.
    output = display({"${o}": ""}, raw=True, display_id=True)

    def do_implementation():
        ${e.map((m,g)=>g===0?m:`        ${m}`).join(`
`)}

    def bg_main():
        try:
            output.update({"${s}": do_implementation()}, raw=True)
        except Exception as e:
            output.update({"${a}": format_exc()}, raw=True)


    Thread(target=bg_main, daemon=True).start()


__jupyter_exec_background__()
del __jupyter_exec_background__
`.trim(),c=new ln;c.add(t.onCancellationRequested(()=>c.dispose()));let d=Ls(t,new Promise((m,g)=>{c.add(i.onDidReceiveDisplayUpdate(async b=>{var R;if(t.isCancellationRequested)return m(void 0);let v=Hg(b);if(!l||((R=v==null?void 0:v.transient)==null?void 0:R.display_id)!==l)return;let k=b.items.find(P=>P.mime===s);if(k)try{return m(JSON.parse(new TextDecoder().decode(k.data)))}catch(P){return g(new Error("Failed to parse the result",P))}}))})).finally(()=>{r.session&&hee(r.session,l),c.dispose()});for await(let m of i.executeCode(u,t)){if(t.isCancellationRequested)return;let g=Hg(m);if(!((f=g==null?void 0:g.transient)!=null&&f.display_id))continue;if(m.items.find(v=>v.mime===o)){l=g.transient.display_id;continue}if(l===g.transient.display_id){let v=m.items.find(k=>k.mime===s||k.mime===a);if((v==null?void 0:v.mime)===s)return JSON.parse(new TextDecoder().decode(v.data));if((v==null?void 0:v.mime)===a){C.warn(`Error in background execution:
`,new TextDecoder().decode(v.data));return}}}if(!t.isCancellationRequested){if(!l){C.warn("Failed to get display id for completions");return}return d}}var PEe=1,xm=ai.IntellisenseResolveTimeout,eoe=5,F9=new WeakSet,CO=class extends Error{constructor(){super("Request timed out")}};async function ooe(r,e,t,n,i,o,s,a){var d;if(!r.range||!((d=n.session)!=null&&d.kernel)||F9.has(n)||!Qt(n.kernelConnectionMetadata)&&n.status!=="idle")return r;let l=KEe(e||r,s,a),u=LEe(l,n,t),c=Oee(t);try{let f=await Jv(xm,new CO,Ls(c.token,u));if(!t.isCancellationRequested&&(f==null?void 0:f.status)==="ok"&&(f!=null&&f.found)){let m=DEe(f);r.documentation=Xie(m,o)}}catch(f){if(f instanceof ioe.CancellationError)return r;f instanceof CO&&(c.cancel(),TEe(n,o,i))}finally{c.dispose()}return r}function DEe(r){return!r||r.status!=="ok"||!r.found?";":!r.data||typeof r.data!="object"?"":"text/plain"in r.data?yu(r.data["text/plain"]):""}var toe=new WeakSet;function TEe(r,e,t){Qt(r.kernelConnectionMetadata)||F9.has(r)||(F9.add(r),C.warn(`Failed to inspect code in kernel ${lt(r.kernelConnectionMetadata)}`),toe.has(r)||(toe.add(r),ne("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION_CANNOT_RESOLVE",void 0,{kernelId:t,kernelConnectionType:r.kernelConnectionMetadata.kind,kernelLanguage:e})))}var U9=new WeakMap,W9=new WeakMap;async function kEe(r,e,t){let n=`return get_ipython().kernel.do_inspect("${Yx(e.code)}", ${e.cursor_pos}, ${e.detail_level})`;return{content:await Nv(r,[n],t)}}var roe={data:{},found:!1,status:"ok",metadata:{}};function NEe(r,e){var i;if(!((i=r.session)!=null&&i.kernel))return;let t=JSON.stringify(e),n=U9.get(r.session.kernel);return n==null?void 0:n.get(t)}function REe(r,e,t){var o;if(!((o=r.session)!=null&&o.kernel)||t.status!=="ok"||!t.found)return;let n=JSON.stringify(e),i=U9.get(r.session.kernel)||new Map;U9.set(r.session.kernel,i),i.size>100&&i.clear(),i.set(n,t)}function AEe(r){var t;if(!((t=r.session)!=null&&t.kernel))return!1;let e=W9.get(r.session.kernel)||{maxTime:0,lastRequestTime:0,numberOfTimesMaxedOut:0};return!Qt(r.kernelConnectionMetadata)&&e.maxTime>xm?(C.warn(`Not sending inspect request as previous requests took over ${xm}s.`),!1):e.numberOfTimesMaxedOut>eoe?(C.warn(`Not sending inspect request as there have been at least ${eoe} requests that took over ${xm}s.`),!1):e.maxTime>xm&&Date.now()-e.lastRequestTime<3e4?(C.warn(`Not sending inspect request as previous requests took over ${xm}s.`),!1):!0}async function MEe(r,e){var i;if(!((i=r.session)!=null&&i.kernel)||!noe(r))return;C.info(`Too many pending requests ${soe(r)} for kernel ${r.id}, waiting for it to be ready.`);let t=r.session.kernel,n=new ln;await Ls(e,new Promise(o=>{let s=()=>{if(e.isCancellationRequested)return;if(!noe(r)){o(),Ce(n);return}let a=setTimeout(s,100);n.add({dispose:()=>clearTimeout(a)})};n.add(Ag(e.onCancellationRequested)(()=>{o(),t.statusChanged.disconnect(s)})),t.statusChanged.connect(s),n.add({dispose:()=>{t.statusChanged.disconnect(s)}})})).finally(()=>Ce(n))}function OEe(r,e){var n;if(!((n=r.session)!=null&&n.kernel))return;let t=W9.get(r.session.kernel)||{maxTime:0,lastRequestTime:0,numberOfTimesMaxedOut:0};t.maxTime=Math.max(t.maxTime,e),t.lastRequestTime=Date.now(),e>xm&&(t.numberOfTimesMaxedOut+=1),W9.set(r.session.kernel,t)}async function LEe(r,e,t){var l;if(!((l=e.session)!=null&&l.kernel))return;let n=NEe(e,r);if(n)return n;if(!AEe(e)||(await MEe(e,t),t.isCancellationRequested))return roe;let i=FEe(e),o=new bt,s=ct(r.code).reverse()[0].slice(-50);C.trace(`Inspecting code ${s}`);let a=Qt(e.kernelConnectionMetadata)?kEe(e,r,t):e.session.kernel.requestInspect(r);return a.finally(()=>i.dispose()),a.then(({content:u})=>{var d;if(!((d=e.session)!=null&&d.kernel))return;REe(e,r,u),OEe(e,o.elapsedTime);let c=o.elapsedTime>xm?C.warn:C.debug;return t.isCancellationRequested?c(`Inspected code ${s} in ${o.elapsedTime}ms (but cancelled)`):c(`Inspected code ${s} in ${o.elapsedTime}ms`),u})}function KEe(r,e,t){var l;let n=e.getText(),i=(typeof r.insertText=="string"?r.insertText:(l=r.insertText)==null?void 0:l.value)||(typeof r.label=="string"?r.label:r.label.label)||"",o=n.substring(0,t.character)+i,s=t.character+i.length;return{code:o,cursor_pos:s,detail_level:0}}var GP=new WeakMap;function noe(r){var e;return(e=r.session)!=null&&e.kernel?soe(r)>=PEe:!1}function soe(r){var e,t,n,i,o;return(e=r.session)!=null&&e.kernel?(GP.has((t=r.session)==null?void 0:t.kernel)||GP.set((n=r.session)==null?void 0:n.kernel,{count:0}),((o=GP.get((i=r.session)==null?void 0:i.kernel))==null?void 0:o.count)||0):0}function FEe(r){var t,n,i;if(!((t=r.session)!=null&&t.kernel))return{dispose:E};let e=GP.get((n=r.session)==null?void 0:n.kernel)||{count:0};return GP.set((i=r.session)==null?void 0:i.kernel,e),e.count+=1,{dispose:()=>{e.count-=1}}}var xO=class extends Error{constructor(){super("Request timed out")}},V9=class{constructor(e,t,n){this.kernelId=e;this.kernel=t;this.monacoLanguage=n;this.pendingCompletionRequest=new WeakMap;this.previousCompletionItems=new WeakMap}async provideCompletionItems(e,t,n,i){var a;if(!((a=this.kernel.session)!=null&&a.kernel))return[];let o=e.version;if(this.pendingCompletionRequest.has(e))return[];this.pendingCompletionRequest.set(e,{position:t,version:o});let s=new Sr.Disposable(()=>{var l,u;(l=this.pendingCompletionRequest.get(e))!=null&&l.position.isEqual(t)&&((u=this.pendingCompletionRequest.get(e))==null?void 0:u.version)===o&&this.pendingCompletionRequest.delete(e)});try{let l=Ka(Ls(n,Promise.resolve(Sr.commands.executeCommand("vscode.executeCompletionItemProvider",e.uri,t)).then(m=>(m==null?void 0:m.items)||[]))),u=new bt;if(await nc(50),n.isCancellationRequested)return[];let c=await Jv(ai.IntellisenseTimeout,new xO,this.provideCompletionItemsFromKernel(e,t,n,i));if(n.isCancellationRequested||!c||!c.length)return[];let d=await Ui(0,l.promise);Qt(this.kernel.kernelConnectionMetadata)&&!l.completed&&u.elapsedTime<ai.IntellisenseTimeout+50&&(d=await Ui(ai.IntellisenseTimeout-u.elapsedTime,l.promise));let f=new Set((d||[]).map(m=>{let g=typeof m.label=="string"?m.label:m.label.label,b=m.insertText,v=[g,`.${g}`];return typeof b=="string"&&v.push(b),v}).flat());return c.filter(m=>{let g=typeof m.label=="string"?m.label:m.label.label;return!f.has(g)&&!f.has(`* ${g}`)})}catch(l){if(l instanceof xO)return[];throw l instanceof Sr.CancellationError||C.debug("Completions failed",l),l}finally{s.dispose()}}async provideCompletionItemsFromKernel(e,t,n,i){var v,k,R,P,D;if(n.isCancellationRequested||!((v=this.kernel.session)!=null&&v.kernel))return[];let o=new bt,s={duration:0,timesExceededTimeout:0,requestDuration:0,completionItems:0},a={kernelId:this.kernelId,kernelConnectionType:this.kernel.kernelConnectionMetadata.kind,kernelLanguage:TO(this.kernel),monacoLanguage:this.monacoLanguage,cancelled:!1,kernelStatusBeforeRequest:this.kernel.status,completed:!1,requestSent:!1};if(!Qt(this.kernel.kernelConnectionMetadata)&&this.kernel.status!=="idle")return[];let l=e.getText(),u=e.offsetAt(t);a.requestSent=!0;let c=await Ls(n,this.getKernelCompletion(l,u,n));if(C.debug(`Jupyter completion time: ${o.elapsedTime}`),a.cancelled=n.isCancellationRequested,a.completed=!n.isCancellationRequested,a.kernelStatusAfterRequest=this.kernel.status,s.requestDuration=n.isCancellationRequested?0:o.elapsedTime,n.isCancellationRequested)return[];if(((k=c==null?void 0:c.content)==null?void 0:k.status)!=="ok"||((D=(P=(R=c==null?void 0:c.content)==null?void 0:R.matches)==null?void 0:P.length)!=null?D:0)===0)return loe(this.kernel,s,a),[];let d={matches:c.content.matches,cursor:{start:c.content.cursor_start,end:c.content.cursor_end},metadata:c.content.metadata},f=d.metadata?d.metadata._jupyter_types_experimental:[];s.completionItems=d.matches.length,loe(this.kernel,s,a);let m={code:l,cursor:d.cursor,documentRef:new WeakRef(e),position:e.positionAt(d.cursor.start)},g=new Sr.Range(e.positionAt(d.cursor.start),e.positionAt(d.cursor.end)),b=[];return Array.isArray(f)&&f.length>=d.matches.length&&f.every(K=>K&&typeof K.text=="string")?b=c.content.matches.map((K,L)=>{let B=f[L],N=B.type?Qie.get(B.type):Sr.CompletionItemKind.Field,O=new Sr.CompletionItem(K,N);return typeof B.start=="number"&&typeof B.end=="number"?O.range=new Sr.Range(e.positionAt(B.start),e.positionAt(B.end)):O.range=g,O.insertText=B.text,O.sortText=EO(L),Qt(this.kernel.kernelConnectionMetadata)&&(K.startsWith("%")||K.startsWith("!"))&&(O.sortText=`ZZZ${O.sortText}`),this.previousCompletionItems.set(O,{...m,originalCompletionItem:JSON.parse(JSON.stringify(O))}),O}):b=d.matches.map((K,L)=>{let B=new Sr.CompletionItem(K);return B.range=g,B.sortText=EO(L),Qt(this.kernel.kernelConnectionMetadata)&&(K.startsWith("%")||K.startsWith("!"))&&(B.sortText=`ZZZ${B.sortText}`),this.previousCompletionItems.set(B,{...m,originalCompletionItem:B}),B}),Qt(this.kernel.kernelConnectionMetadata)?jEe(i.triggerCharacter,this.allowStringFilterForPython,b,e,t):b}async resolveCompletionItem(e,t){var l;if(!e.range||!((l=this.kernel.session)!=null&&l.kernel))return e;let n=this.previousCompletionItems.get(e);if(!n)return e;let{documentRef:i,position:o,originalCompletionItem:s}=n,a=i.deref();return a?ooe(e,s,t,this.kernel,this.kernelId,this.monacoLanguage,a,o):e}async getKernelCompletion(e,t,n){var i;if((i=this.kernel.session)!=null&&i.kernel)return Qt(this.kernel.kernelConnectionMetadata)?this.getPythonKernelCompletion(e,t,n):Ls(n,this.kernel.session.kernel.requestComplete({code:e,cursor_pos:t}))}async getPythonKernelCompletion(e,t,n){let i=`return get_ipython().kernel.do_complete("${Yx(e)}", ${t})`;return{content:await Nv(this.kernel,[i],n)}}},aoe=new WeakMap,wO=new WeakMap;function loe(r,e,t){var o;let n=aoe.get(r),i=((o=wO.get(r))==null?void 0:o.count)||0;e.duration>=ai.IntellisenseTimeout&&wO.set(r,{count:i+1,measures:e,properties:t}),e.timesExceededTimeout=i,n?n.elapsedTime>6e4&&(ne("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",e,t),n.reset(),wO.delete(r)):(ne("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",e,t),n=new bt,aoe.set(r,new bt),wO.delete(r))}var j9=class extends Pr{constructor(t,n){super();this.kernel=t;this.notebookEditorProvider=n;this.cellCompletionProviders=new WeakMap;this.completionItemsSent=new WeakMap;this.monacoLanguage=DO(this.kernel);this.registerCompletionProvider(),this._register(Sr.workspace.onDidChangeConfiguration(i=>{var o;if(i.affectsConfiguration("jupyter.enableKernelCompletions"))if(coe(this.kernel.notebook.uri))this.completionProvider||this.registerCompletionProvider();else{(o=this.completionProvider)==null||o.dispose(),this.completionProvider=void 0;return}!i.affectsConfiguration("jupyter.completionTriggerCharacters")&&!i.affectsConfiguration("jupyter.pythonCompletionTriggerCharacters")||this.registerCompletionProvider()}))}registerCompletionProvider(){var n;if(!coe(this.kernel.notebook.uri))return;let t=UEe(this.kernel);if(t.length===0){WEe(this.kernel);return}C.trace(`Registering Kernel Completion Provider from kernel ${lt(this.kernel.kernelConnectionMetadata)} for language ${this.monacoLanguage}`),this.allowStringFilterForPython=t.includes("'")||t.includes('"'),(n=this.completionProvider)==null||n.dispose(),this.completionProvider=void 0,this.completionProvider=Sr.languages.registerCompletionItemProvider(this.monacoLanguage,this,...t)}dispose(){var t;super.dispose(),(t=this.completionProvider)==null||t.dispose()}async provideCompletionItems(t,n,i,o){if(this.notebookEditorProvider.findAssociatedNotebookDocument(t.uri)!==this.kernel.notebook)return[];let s=this.cellCompletionProviders.get(t);if(!s){let a=await Rt(this.kernel.kernelConnectionMetadata.id);s=new V9(a,this.kernel,this.monacoLanguage),this.cellCompletionProviders.set(t,s)}return s.allowStringFilterForPython=this.allowStringFilterForPython,s.provideCompletionItems(t,n,i,o).then(a=>(a.forEach(l=>this.completionItemsSent.set(l,s)),a))}async resolveCompletionItem(t,n){let i=this.completionItemsSent.get(t);return i?i.resolveCompletionItem(t,n):t}},Pm=class extends Pr{constructor(t){super();this.kernelCompletionProviders=new WeakMap;t.push(this)}activate(){let t=et.instance.get(qe);this._register(t.onDidStartKernel(async n=>{var a;if((a=n.session)!=null&&a.kernel&&Qt(n.kernelConnectionMetadata)&&n.session.kernel.requestComplete({code:"__file__.",cursor_pos:9}),!DO(n)||this.kernelCompletionProviders.has(n))return;let o=et.instance.get(Oo),s=this._register(new j9(n,o));this.kernelCompletionProviders.set(n,s)})),this._register(t.onDidDisposeKernel(n=>{var i;(i=this.kernelCompletionProviders.get(n))==null||i.dispose()}))}};Pm=U([(0,PO.injectable)(),x(0,(0,PO.inject)(ve))],Pm);function DO(r){return Vc(TO(r))}function TO(r){let e="";switch(r.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":e=r.kernelConnectionMetadata.kernelModel.language;break;case"startUsingRemoteKernelSpec":e=r.kernelConnectionMetadata.kernelSpec.language;break;case"startUsingLocalKernelSpec":e=r.kernelConnectionMetadata.kernelSpec.language;break;default:e=r.kernelConnectionMetadata.kernelSpec.language;break}return(e||"").toLowerCase()}function coe(r){return Sr.workspace.getConfiguration("jupyter",r).get("enableKernelCompletions",!1)}function UEe(r){let e=Sr.workspace.getConfiguration("jupyter",r.notebook.uri).get("completionTriggerCharacters");if(!e||typeof e!="object")return[];let t=TO(r),n=DO(r);return t in e?Array.isArray(e[t])?e[t]:[]:n in e?Array.isArray(e[n])?e[n]:[]:[]}function WEe(r){let e=TO(r),t=DO(r);e.toLowerCase()===t.toLowerCase()?C.warn(Sr.l10n.t(`Kernel completions not enabled for '{0}'. 
To enable Kernel completion for this language please add the following setting 
jupyter.completionTriggerCharacters = {1}: [<List of characters that will trigger completions>]}. 
For more information please see https://aka.ms/vscodeJupyterCompletion`,lt(r.kernelConnectionMetadata),`{${e}`)):C.warn(Sr.l10n.t(`Kernel completions not enabled for '{0}'. 
To enable Kernel completion for this language please add the following setting 
jupyter.completionTriggerCharacters = {1}: [<List of characters that will trigger completions>]}. 
 or the following: 
jupyter.completionTriggerCharacters = {2}: [<List of characters that will trigger completions>]}. 
For more information please see https://aka.ms/vscodeJupyterCompletion`,lt(r.kernelConnectionMetadata),`{${e}`,`{${t}`))}function VEe(r,e){let t=r.indexOf('"'),n=r.indexOf("'"),i=r.lastIndexOf('"'),o=r.lastIndexOf("'"),s=t>=0?t:n,a=i>=0?i:o;return s>=0&&e.character>s&&e.character<=a}function jEe(r,e,t,n,i){let o=i.character===0?void 0:new Sr.Range(i.line,i.character-1,i.line,i.character),a=(o?n.getText(o):void 0)===".",l=n.getWordRangeAtPosition(a||r==="."?new Sr.Position(i.line,i.character-1):i),u=l&&o?l.union(o):void 0,c=n.lineAt(i.line).text,d=u?n.getText(u):c,f=d.endsWith(".")||a,m=e&&(r=="'"||r=='"'||VEe(c,i));C.ci(`Jupyter completions filtering applied: ${m} on ${c}`);let g=t.map((b,v)=>{let k=typeof b.label=="string"?b.label:b.label.label,R=typeof b.label=="string"?b.label:b.label.label;if(R.startsWith("%")||R.startsWith("!"))return{...b,sortText:`ZZZ${b.sortText}`};if(m)return b;let P=d?R.indexOf(d):-1,D,K,L;if(d&&f&&R.includes(d)){D=R.substring(R.indexOf(d)+(f?d.length:0)),K=R.substring(R.indexOf(d)+d.length);let B=(typeof b.label=="string"?b.label.length:b.label.label.length)-K.length;L=b.range&&"start"in b.range?new Sr.Range(new Sr.Position(b.range.start.line,b.range.start.character+B),b.range.end):b.range}if(!K&&P>0){D=R.substring(R.indexOf(d)+(f?d.length:0)),K=R.substring(R.indexOf(d)+d.length);let B=(typeof b.label=="string"?b.label.length:b.label.label.length)-K.length;L=b.range&&"start"in b.range?new Sr.Range(new Sr.Position(b.range.start.line,b.range.start.character+B),b.range.end):b.range}return D&&K&&L&&(b.label=D,k=K,b.insertText=K,b.filterText=f?`.${K}`:K,b.range=L,b.sortText=EO(v)),k.endsWith("/")?{...b,command:{command:"editor.action.triggerSuggest",title:""}}:(k.includes(" ")&&(k=k.replace(/\\ /g," "),typeof b.label=="string"?b.label=b.label.replace(/\\ /g," "):b.label.label=b.label.label.replace(/\\ /g," ")),m||!k.includes(".")&&!k.endsWith("/")||k.startsWith(".")&&!k.endsWith("/")?b:void 0)}).filter(b=>b!==void 0);return C.ci(`Jupyter completions for ${d} at pos ${i.line}:${i.character} with trigger: ${r}
   ${t.map(b=>b.label).join(",")}`),C.ci(`Jupyter results for ${d} at pos ${i.line}:${i.character} with trigger: ${r}
   ${g.map(b=>b.label).join(",")}`),g}function uoe(r,e){r.addSingleton(Ve,eE),r.addSingleton(Pm,Pm),r.addBinding(Pm,Ve)}p();var rE=ae(he());var doe=require("vscode");var tE=class{constructor(e,t,n){this.extensionChecker=e;this.disposables=t;this.kernelProvider=n}activate(){this.extensionChecker.onPythonExtensionInstallationStatusChanged(this.onPythonExtensionInstallationStatusChanged,this,this.disposables)}async onPythonExtensionInstallationStatusChanged(e){e==="installed"&&this.anyKernelsAreActive()&&doe.window.showInformationMessage(W.pythonExtensionInstalled,Ue.ok).then(E,E)}anyKernelsAreActive(){return this.kernelProvider.kernels.length>0}};tE=U([(0,rE.injectable)(),x(0,(0,rE.inject)(bo)),x(1,(0,rE.inject)(ve)),x(2,(0,rE.inject)(qe))],tE);p();var kO=ae(he()),ku=require("vscode");var BEe=/^\s*(from (?<fromImport>\w+)(?:\.\w+)* import \w+(?:, \w+)*(?: as \w+)?|import (?<importImport>\w+(?:, \w+)*)(?: as \w+)?)$/,HEe=1e3,qEe=vn(),nE=class{constructor(e,t=1e3){this.pendingChecks=new bu;this.disposables=new ln;this.sentMatches=new Set;this.processedNotebookCells=new WeakMap;e.push(this.disposables),this.disposables.add(new ku.Disposable(()=>Ce(this.pendingChecks.values()))),this.isTelemetryDisabled=MN(),this.disposables.add(ku.workspace.onDidOpenNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave"))),this.disposables.add(ku.workspace.onDidCloseNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave"))),this.disposables.add(ku.workspace.onDidSaveNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave")));let n=this.disposables.add(new rc(t));this.disposables.add(Mr.onDidChangeNotebookCellExecutionState(i=>{n.trigger(()=>{i.state==2&&!this.isTelemetryDisabled&&this.checkNotebookCell(i.cell,"onExecution").catch(E)})},this)),this.disposables.add(ON(i=>this.isTelemetryDisabled=i))}activate(){ku.workspace.notebookDocuments.forEach(e=>this.checkNotebookDocument(e,"onOpenCloseOrSave"))}getDocumentLines(e){let t=[];for(let n=0;n<Math.min(HEe,e.lineCount);n++){let i=e.lineAt(n);i.isEmptyOrWhitespace||t.push(i.text.trim())}return t}onOpenedOrClosedNotebookDocument(e,t){!gr(e)||this.isTelemetryDisabled||this.scheduleCheck(e.uri,this.checkNotebookDocument.bind(this,e,t))}scheduleCheck(e,t){let n=this.pendingChecks.get(e);if(n&&(n.dispose(),this.pendingChecks.delete(e)),qEe)t();else{let i=setTimeout(t,5e3);this.pendingChecks.set(e,new ku.Disposable(()=>clearTimeout(i)))}}async checkNotebookDocument(e,t){!gr(e)||this.isTelemetryDisabled||await Promise.all(e.getCells().map(async n=>this.checkNotebookCell(n,t)))}async checkNotebookCell(e,t){if(!(!gr(e.notebook)||e.kind!==ku.NotebookCellKind.Code||e.document.languageId!==$e||this.processedNotebookCells.get(e)===e.document.version))try{this.processedNotebookCells.set(e,e.document.version);let n=e.notebook.notebookType===St?"notebook":"interactive";await this.sendTelemetryForImports(this.getDocumentLines(e.document),n,t)}catch(n){if(!li)throw n}}lookForImports(e){let t=[];try{for(let n of e){if(!n.includes("import")&&!n.includes("from"))continue;let i=n?BEe.exec(n):null;i!==null&&i.groups!==void 0&&(i.groups.fromImport!==void 0?t.push(i.groups.fromImport):i.groups.importImport!==void 0&&t.push(...i.groups.importImport.split(",").map(o=>o.trim())))}}catch(n){}return t}async sendTelemetryForImports(e,t,n){await Promise.all(this.lookForImports(e).map(async i=>{let o=`${i}_${t||""}_${n}`;if(this.sentMatches.has(o))return;this.sentMatches.add(o);let s=await Rt(i);ne("HASHED_PACKAGE_NAME",void 0,{hashedNamev2:s,resourceType:t,when:n})}))}};nE=U([(0,kO.injectable)(),x(0,(0,kO.inject)(ve))],nE);p();var sn=ae(he()),vt=require("vscode");p();var Nu=require("vscode");var NO=class{constructor(e,t,n,i,o){this.configService=e;this.agentCreator=t;this.requestCreator=n;this.serverUriStorage=i;this.disposables=o;this.savedConnectInfo=new Map;this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}getPasswordConnectionInfo(e){if(!e.url||e.url.length<1)throw new Error("Invalid URL");let t=iE(e.url),n=e.disposables||[],i=!Array.isArray(e.disposables),o=this.savedConnectInfo.get(e.handle);return o||(o=this.getJupyterConnectionInfo({url:t,isTokenEmpty:e.isTokenEmpty,disposables:n,validationErrorMessage:e.validationErrorMessage}).then(s=>((!s||s.requiresPassword&&Object.keys(s).length===1)&&(C.warn(`Password for ${t} was invalid.`),this.savedConnectInfo.delete(e.handle)),s)),o.catch(()=>this.savedConnectInfo.delete(e.handle)),o.finally(()=>{i&&Ce(n)}).catch(E),this.savedConnectInfo.set(e.handle,o)),o}async getJupyterConnectionInfo(e){let t,n,i,o,s=await this.needPassword(e.url);if(s||e.isTokenEmpty){if(s&&e.isTokenEmpty){let a=Nu.window.createInputBox();e.disposables.push(a),a.title=W.jupyterSelectPasswordTitle,a.placeholder=W.jupyterSelectPasswordPrompt,a.ignoreFocusOut=!0,a.password=!0,a.validationMessage=e.validationErrorMessage||"",a.show(),a.buttons=[Nu.QuickInputButtons.Back],o=await new Promise((l,u)=>{a.onDidTriggerButton(c=>{c===Nu.QuickInputButtons.Back&&u(ze.back)},this,e.disposables),a.onDidChangeValue(()=>a.validationMessage="",this,e.disposables),a.onDidAccept(()=>l(a.value),this,e.disposables),a.onDidHide(()=>u(ze.cancel),this,e.disposables)})}if(typeof o===void 0&&!o&&e.isTokenEmpty)throw new Nu.CancellationError;if(o||e.isTokenEmpty)if(t=await this.getXSRFToken(e.url,""),t){let a=await this.getSessionCookie(e.url,t,o||"");n=a.sessionCookieName,i=a.sessionCookieValue}else n="authservice_session",i=o,t=await this.getXSRFToken(e.url,`${n}=${i}`);else return{requiresPassword:s}}else return{requiresPassword:s};return t&&n&&(i||e.isTokenEmpty)?(ne("DS_INTERNAL.GET_PASSWORD_SUCCESS"),{requestHeaders:{Cookie:`_xsrf=${t}; ${n}=${i||""}`,"X-XSRFToken":t},requiresPassword:s}):(ne("DS_INTERNAL.GET_PASSWORD_FAILURE"),{requiresPassword:s})}addAllowUnauthorized(e,t,n){if(e.startsWith("https")&&t&&this.agentCreator){let i=this.agentCreator.createHttpRequestAgent();return{...n,agent:i}}return n}async getXSRFToken(e,t){var a;let n,i,o=new URL("login?",iE(e)).toString();t!=""?(o=new URL("tree",iE(e)).toString(),i={Connection:"keep-alive",Cookie:t}):i={Connection:"keep-alive"};let s=await this.makeRequest(o,{method:"get",redirect:"manual",headers:i});if(s!==void 0&&s.ok){let l=this.getCookies(s);l.has("_xsrf")&&(n=(a=l.get("_xsrf"))==null?void 0:a.split(";")[0])}return n}async needPassword(e){let t=await this.makeRequest(iE(e),{method:"get",redirect:"follow",headers:{Connection:"keep-alive"}});if(t.status===200&&t.redirected){if(t.url.toLowerCase().includes("/login?"))return!0;if(t.url.toLowerCase().includes("/lab?"))return!1}let n=new URL("tree?",iE(e)).toString();return t=await this.makeRequest(n,{method:"get",redirect:"manual",headers:{Connection:"keep-alive"}}),t.status===404?(C.error(`Jupyter Server not found at ${e}, got 404 for ${n}`),!1):t.status!==200}async makeRequest(e,t){let n=this.configService.getSettings(void 0).allowUnauthorizedRemoteConnection;try{return await this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!!n,t))}catch(i){if(Mi.isSelfCertsError(i)){let o=W.jupyterSelfCertEnable,s=W.jupyterSelfCertClose,a=await Nu.window.showErrorMessage(W.jupyterSelfCertFail(i.message),{modal:!0},o,s);if(a===o)return ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await this.configService.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,Nu.ConfigurationTarget.Workspace),this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!0,t));a===s&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE")}throw i}}async getSessionCookie(e,t,n){let i,o,s=new URLSearchParams;s.append("_xsrf",t),s.append("password",n);let a=await this.makeRequest(new URL("login?",iE(e)).toString(),{method:"post",headers:{Cookie:`_xsrf=${t}`,Connection:"keep-alive","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},body:s.toString(),redirect:"manual"});if(a.status===302){let l=this.getCookies(a);if(l.size>0){let u=l.entries().next().value;u&&(i=u[0],o=u[1])}}return{sessionCookieName:i,sessionCookieValue:o}}getCookies(e){let t=new Map,i=(e.headers.raw?e.headers.raw():e.headers)["set-cookie"];return i&&i.forEach(o=>{let s=o.substring(0,o.indexOf("=")),a=o.substring(o.indexOf("=")+1);t.set(s,a)}),t}onDidRemoveServers(e){e.forEach(t=>{t.id.startsWith("_builtin")&&this.savedConnectInfo.delete(t.handle)})}};function iE(r){let e=r;return e[e.length-1]!=="/"&&(e=`${e}/`),e}p();var AO=require("vscode");var RO=class{constructor(e,t,n){this.configService=e;this.agentCreator=t;this.requestCreator=n}async isJupyterHub(e){try{if(e.toLowerCase().includes("/user/")&&e.includes("token="))return!1;if(e.toLowerCase().includes("/user/")&&!e.includes("token="))return!0;let t=await this.makeRequest(new URL("hub/api",JEe(e)).toString(),{method:"get"});if(t.status!==200)return!1;try{let n=await t.json();return C.trace(`JupyterHub version is ${n&&n.version} for url ${e}`),n&&n.version}catch(n){}return!1}catch(t){return C.debug(`Error in detecting whether url is isJupyterHub: ${t}`),!1}}addAllowUnauthorized(e,t,n){if(e.startsWith("https")&&t&&this.agentCreator){let i=this.agentCreator.createHttpRequestAgent();return{...n,agent:i}}return n}async makeRequest(e,t){let n=this.configService.getSettings(void 0).allowUnauthorizedRemoteConnection;try{return await this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!!n,t))}catch(i){if(Mi.isSelfCertsError(i)){let o=W.jupyterSelfCertEnable,s=W.jupyterSelfCertClose,a=await AO.window.showErrorMessage(W.jupyterSelfCertFail(i.message),{modal:!0},o,s);if(a===o)return ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await this.configService.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,AO.ConfigurationTarget.Workspace),this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!0,t));a===s&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE")}throw i}}};function JEe(r){let e=r;return e[e.length-1]!=="/"&&(e=`${e}/`),e}var MO="user-jupyter-server-uri-list-version2";var GEe="DataScienceAllowInsecureConnections",oE=class extends Pr{constructor(t,n,i,o,s,a,l,u,c,d,f,m=ME){super();this.jupyterConnection=n;this.context=c;this.fs=d;this.jupyterServerProviderRegistry=f;this.id=m;this.extensionId=Ge;this.documentation=vt.Uri.parse("https://aka.ms/vscodeJuptyerExtKernelPickerExistingServer");this.displayName=W.UserJupyterServerUrlProviderDisplayName;this.detail=W.UserJupyterServerUrlProviderDetail;this._onDidChangeHandles=this._register(new vt.EventEmitter);this.onDidChangeHandles=this._onDidChangeHandles.event;this._onDidChangeServers=this._register(new vt.EventEmitter);this.onDidChangeServers=this._onDidChangeServers.event;a.push(this),this.newStorage=new zP(i),this.secureConnectionValidator=new $P(s),this.jupyterServerUriInput=new YP(u),this.jupyterServerUriDisplayName=new B9,this.jupyterPasswordConnect=new NO(t,l,u,o,a),this.jupyterHubPasswordConnect=new RO(t,l,u)}activate(){let t=this._register(this.jupyterServerProviderRegistry.createJupyterServerCollection(Ge,this.id,this.displayName,this));t.commandProvider=this,t.documentation=this.documentation,this._register(this.onDidChangeHandles(()=>this._onDidChangeServers.fire(),this)),this._register(vt.commands.registerCommand("dataScience.ClearUserProviderJupyterServerCache",async()=>{await Promise.all([this.newStorage.clear().catch(E),this.fs.delete(vt.Uri.joinPath(this.context.globalStorageUri,ES)).catch(E)]),this._onDidChangeHandles.fire()})),this.initializeServers().catch(E)}async resolveJupyterServer(t,n){let i=await this.getServerUri(t.id);return{...t,connectionInformation:{id:t.id,label:t.label,baseUrl:vt.Uri.parse(i.baseUrl),token:i.token,headers:i.authorizationHeader,mappedRemoteNotebookDir:i.mappedRemoteNotebookDir?vt.Uri.file(i.mappedRemoteNotebookDir):void 0}}}async handleCommand(t,n){let i=new vt.CancellationTokenSource;this._register(new vt.Disposable(()=>{i.cancel(),i.dispose()}));try{let o="url"in t?t.url:void 0,s=await this.captureRemoteJupyterUrl(i.token,o);if(!s||s===ze.cancel)throw new vt.CancellationError;if(s&&s instanceof ze)return;let l=(await this.provideJupyterServers(i.token)).find(u=>u.id===s);if(!l)throw new Error(`Server ${s} not found`);return l}catch(o){if(o instanceof vt.CancellationError)throw o;C.error("Failed to select a Jupyter Server",o);return}finally{i.cancel(),i.dispose()}}async provideCommands(t,n){let i="";try{t=(t||"").trim(),["http:","https:"].includes(new URL(t.trim()).protocol.toLowerCase())&&(i=t)}catch(o){}return i?[{label:W.connectToToTheJupyterServer(i),url:i}]:[{label:W.jupyterSelectUriCommandLabel,canBeAutoSelected:!0}]}async provideJupyterServers(t){return await this.initializeServers(),(await this.newStorage.getServers(!1)).map(i=>({id:i.handle,label:i.serverInfo.displayName}))}async removeJupyterServer(t){await this.initializeServers(),await this.newStorage.remove(t.id),this._onDidChangeHandles.fire()}initializeServers(){if(this._cachedServerInfoInitialized)return this._cachedServerInfoInitialized;let t=Oe();return this._cachedServerInfoInitialized=t.promise,(async()=>{this.newStorage.getServers(!1).catch(E),t.resolve()})().then(()=>t.resolve(),n=>t.reject(n)).catch(E),this._cachedServerInfoInitialized}recommendInstallingJupyterHubExtension(){throw vt.extensions.getExtension(Bv)?vt.window.showInformationMessage(W.useJupyterHubExtension,{modal:!0,detail:W.useJupyterHubExtensionDetail}).then(()=>{vt.commands.executeCommand("notebook.selectKernel",{notebookEditor:vt.window.activeNotebookEditor}).then(E,E)},E):vt.window.showInformationMessage(W.installJupyterHub,{modal:!0,detail:W.installJupyterHubDetail},Ue.install,Ue.moreInfo).then(t=>{t===Ue.install?vt.commands.executeCommand("workbench.extensions.installExtension",Bv,{context:{skipWalkthrough:!0}}).then(E,E):t===Ue.moreInfo&&vt.env.openExternal(vt.Uri.parse("https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter-hub")).then(E,E)},E),new vt.CancellationError}async captureRemoteJupyterUrl(t,n=""){await this.initializeServers();let i=[],o={baseUrl:"",displayName:"",token:""},s="",a=!1,l=!1,u,c="Get Url",d="Get Url",f=n,m=!1;if(n){let g=await this.jupyterServerUriInput.parseUserUriAndGetValidationError(n);typeof g.validationError=="string"?(s=g.validationError,c="Get Url"):(m=!0,o=g.jupyterServerUri,c="Check Passwords")}try{let g=!1;for(;;)try{if(u=Oi(),c==="Get Url"){m=!1,c="Check Passwords",d=void 0;let v=s;s="";let k=await this.jupyterServerUriInput.getUrlFromUser(f||n,v,i);o=k.jupyterServerUri,f=k.url}if(t.isCancellationRequested)return ze.cancel;let b=[];if(c==="Check Passwords"){c="Check Insecure Connections",d=m&&n?void 0:"Get Url";try{let v=s;if(s="",!o.token&&await this.jupyterHubPasswordConnect.isJupyterHub(o.baseUrl))return this.recommendInstallingJupyterHubExtension(),ze.cancel;let k=await this.jupyterPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,isTokenEmpty:o.token.length===0,handle:u,validationErrorMessage:v,disposables:b});a=k.requiresPassword,o.authorizationHeader=k.requestHeaders,g=!1}catch(v){if(g=!1,v instanceof vt.CancellationError||v==ze.back||v==ze.cancel)throw v;if(!Mi.isSelfCertsError(v)){if(!nu.isSelfCertsExpiredError(v)){Rv(u,o.baseUrl,!1,"ConnectionFailure");let k=/(https?:\/\/[^\s]+)/g,R=(v.message||v.toString()).replace(k,P=>`[${P}](${P})`);if(s=(zr()?W.remoteJupyterConnectionFailedWithoutServerWithErrorWeb:W.remoteJupyterConnectionFailedWithoutServerWithError)(R),o.token.length>0&&(v.message||"").toLowerCase()==="Failed to fetch".toLowerCase())g=!0;else{c="Get Url";continue}}}}finally{b.forEach(v=>this._register(v))}}if(t.isCancellationRequested)return ze.cancel;if(c==="Check Insecure Connections"&&(c="Verify Connection",d=a&&o.token.length===0?"Check Passwords":"Get Url",d==="Get Url"&&(d=m&&n?void 0:"Get Url"),!a&&o.token.length===0&&new URL(o.baseUrl).protocol.toLowerCase()==="http:"&&(l=!0,Ce(b),!await this.secureConnectionValidator.promptToUseInsecureConnections())))return Rv(u,o.baseUrl,!1,"InsecureHTTP"),ze.cancel;if(t.isCancellationRequested)return ze.cancel;if(c==="Verify Connection")try{c="Get Display Name",await this.jupyterConnection.validateRemoteUri({id:this.id,handle:u,extensionId:Ge},o,!0)}catch(v){if(C.warn("Uri verification error",v),g&&s){c="Get Url";continue}if(v instanceof vt.CancellationError||v==ze.back||v==ze.cancel)throw v;if(Mi.isSelfCertsError(v)){s=W.jupyterSelfCertFailErrorMessageOnly,c="Get Url",Rv(u,o.baseUrl,!1,"SelfCert");continue}else if(nu.isSelfCertsExpiredError(v)){s=W.jupyterSelfCertExpiredErrorMessageOnly,c="Get Url",Rv(u,o.baseUrl,!1,"ExpiredCert");continue}else if(a&&o.token.length===0){s=W.passwordFailure,c="Check Passwords",Rv(u,o.baseUrl,!1,"AuthFailure");continue}else{Rv(u,o.baseUrl,!1,"ConnectionFailure");let k=/(https?:\/\/[^\s]+)/g,R=(v.message||v.toString()).replace(k,P=>`[${P}](${P})`);s=(zr()?W.remoteJupyterConnectionFailedWithoutServerWithErrorWeb:W.remoteJupyterConnectionFailedWithoutServerWithError)(R),c="Get Url";continue}}finally{Ce(b)}if(t.isCancellationRequested)return ze.cancel;if(c==="Get Display Name"){Ce(b),d=l?"Check Insecure Connections":a&&o.token.length===0?"Check Passwords":"Get Url",d==="Get Url"&&(d=m&&n?void 0:"Get Url"),o.displayName=await this.jupyterServerUriDisplayName.getDisplayName(u,o.displayName||new URL(o.baseUrl).hostname);break}}catch(b){if(b instanceof vt.CancellationError||b===ze.cancel)return ze.cancel;if(b===ze.back){if(!d)return ze.back;c=d;continue}throw b}return t.isCancellationRequested?ze.cancel:(await this.addNewServer({handle:u,uri:f,serverInfo:o}),xA({extensionId:this.extensionId,id:this.id,handle:u},o.displayName),Rv(u,o.baseUrl,!1),u)}catch(g){if(g instanceof vt.CancellationError)return ze.cancel;throw g}finally{Ce(i)}}async addNewServer(t){await this.newStorage.add(t),this._onDidChangeHandles.fire()}async getServerUri(t){let i=(await this.newStorage.getServers(!1)).find(l=>l.handle===t);if(!i)throw new Error("Server not found");let o=i.serverInfo,s=this.jupyterServerUriDisplayName.displayNamesOfHandles.get(t);s&&(o.displayName=s);let a=Object.assign({},o);try{let l=await this.jupyterPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,isTokenEmpty:o.token.length===0,handle:t});a=Object.assign({},o,{authorizationHeader:l.requestHeaders||o.authorizationHeader})}catch(l){C.error("Failed to validate Password info",l)}return a}};oE=U([(0,sn.injectable)(),x(0,(0,sn.inject)(Ke)),x(1,(0,sn.inject)(hn)),x(2,(0,sn.inject)(rP)),x(3,(0,sn.inject)(pr)),x(4,(0,sn.inject)(Et)),x(4,(0,sn.named)(rr)),x(5,(0,sn.inject)(ve)),x(6,(0,sn.inject)(MR)),x(6,(0,sn.optional)()),x(7,(0,sn.inject)(Jg)),x(8,(0,sn.inject)(st)),x(9,(0,sn.inject)(Pt)),x(10,(0,sn.inject)(sr)),x(11,(0,sn.optional)()),x(11,(0,sn.inject)(Date.now().toString()))],oE);var YP=class{constructor(e){this.requestCreator=e}async getUrlFromUser(e,t="",n){if(!e&&!ED)try{let s=await vt.env.clipboard.readText(),a=s.trim().startsWith("https://github.com/")?void 0:vt.Uri.parse(s.trim(),!0);e=s&&a&&a.scheme.toLowerCase().startsWith("http")?s:""}catch(s){e=""}let i=vt.window.createInputBox();n.push(i),i.title=W.jupyterSelectUriInputTitle,i.placeholder=W.jupyterSelectUriInputPlaceholder,i.value=e,i.validationMessage=t,i.buttons=[vt.QuickInputButtons.Back],i.ignoreFocusOut=!0,i.show();let o=Oe();return i.onDidChangeValue(()=>i.validationMessage="",this,n),i.onDidHide(()=>o.reject(ze.cancel),this,n),i.onDidTriggerButton(s=>{s===vt.QuickInputButtons.Back&&o.reject(ze.back)},this,n),i.onDidAccept(async()=>{let s=await this.parseUserUriAndGetValidationError(i.value);if(typeof s.validationError=="string"){i.validationMessage=s.validationError;return}o.resolve(s)}),o.promise}async parseUserUriAndGetValidationError(e){let t=e.trim().replace(/\/(lab|tree)(\??)$/,""),n=H9(t,"");return n?(n.baseUrl=await YEe(t,this.requestCreator)||n.baseUrl,!t.toLowerCase().startsWith("http:")&&!t.toLowerCase().startsWith("https:")?{validationError:W.jupyterSelectURIMustBeHttpOrHttps}:{jupyterServerUri:n,url:t,validationError:void 0}):{validationError:W.jupyterSelectURIInvalidURI}}};YP=U([x(0,(0,sn.inject)(Jg))],YP);async function YEe(r,e){var t;try{if(r=((t=H9(r,""))==null?void 0:t.baseUrl)||r,new URL(r).pathname==="/")return r;let n=r.indexOf("token=")>0?r.substring(0,r.indexOf("token=")):r,s=(await e.getFetchMethod()(n,{method:"GET",redirect:"manual"})).headers.get("location");if(s&&s.includes("login?"))return s.substring(0,s.indexOf("login?"))}catch(n){C.debug("Unable to identify the baseUrl of the Jupyter Server",n)}}function Rv(r,e,t,n){e=e.trim().toLowerCase();let i=Vt({handle:r,extensionId:Ge,id:ME});Promise.all([Rt(e.toLowerCase()),Rt(i.toLowerCase())]).then(([o,s])=>{ne("DATASCIENCE.ENTER_REMOTE_JUPYTER_URL",void 0,{serverIdHash:s,failed:!!n,baseUrlHash:o,isJupyterHub:t,isLocalHost:["localhost","127.0.0.1","::1"].includes(new URL(e).hostname),reason:n})}).catch(o=>C.error(`Failed to hash remote url ${e}`,o))}var B9=class{constructor(){this.displayNamesOfHandles=new Map}async getDisplayName(e,t){let n=[];try{let i=vt.window.createInputBox();n.push(i),i.ignoreFocusOut=!0,i.title=W.jupyterRenameServer,i.value=t,i.placeholder=W.jupyterServerUriDisplayNameInputPlaceholder,i.buttons=[vt.QuickInputButtons.Back],i.show();let o=Oe();return n.push(i.onDidHide(()=>o.reject(ze.cancel))),i.onDidTriggerButton(s=>{s===vt.QuickInputButtons.Back&&o.reject(ze.back)},this,n),i.onDidAccept(()=>{let s=i.value.trim()||t;this.displayNamesOfHandles.set(e,s),o.resolve(s)},this,n),await o.promise}finally{Ce(n)}}},$P=class{constructor(e){this.globalMemento=e}async promptToUseInsecureConnections(){if(this.globalMemento.get(GEe,!1))return!0;let e=[],t=Oe();try{let n=vt.window.createQuickPick();return e.push(n),n.canSelectMany=!1,n.ignoreFocusOut=!0,n.title=W.insecureSessionMessage,n.buttons=[vt.QuickInputButtons.Back],n.items=[{label:Ue.bannerLabelYes},{label:Ue.bannerLabelNo}],n.show(),e.push(n.onDidHide(()=>t.reject(ze.cancel))),n.onDidTriggerButton(i=>{i===vt.QuickInputButtons.Back&&t.reject(ze.back)},this,e),n.onDidAccept(()=>t.resolve(n.selectedItems.some(i=>i.label===Ue.bannerLabelYes)),this,e),await t.promise}finally{Ce(e)}}};$P=U([x(0,(0,sn.inject)(Et)),x(0,(0,sn.named)(rr))],$P);function H9(r,e){if(!r.startsWith(nt.REMOTE_URI))try{let t=new URL(r);return{baseUrl:`${t.protocol}//${t.host}${t.pathname==="/lab"||t.pathname==="/tree"?"":t.pathname}`,token:t.searchParams.get("token")||"",displayName:e||t.hostname}}catch(t){C.error(`Failed to parse URI ${r}`,t);return}}function poe(r){return r.map(e=>({handle:e.handle,uri:e.uri,displayName:e.serverInfo.displayName}))}function $Ee(r){let e=[];return r.forEach(t=>{let n=H9(t.uri,t.displayName);n&&e.push({handle:t.handle,uri:t.uri,serverInfo:n})}),e}var zP=class{constructor(e){this.encryptedStorage=e;this.updatePromise=Promise.resolve()}async getServers(e){if(this.servers&&!e)return this.servers;let t=await this.encryptedStorage.retrieve(ai.JupyterServerRemoteLaunchService,MO);if(!t||t==="[]")return[];try{return this.servers=$Ee(JSON.parse(t))}catch(n){return[]}}async add(e){this.servers&&(this.servers=this.servers.filter(t=>t.handle!==e.handle).concat(e)),await(this.updatePromise=this.updatePromise.then(async()=>{let t=(await this.getServers(!0)).concat(e);this.servers=t,await this.encryptedStorage.store(ai.JupyterServerRemoteLaunchService,MO,JSON.stringify(poe(t)))}).catch(E))}async remove(e){this.servers&&(this.servers=this.servers.filter(t=>t.handle!==e)),await(this.updatePromise=this.updatePromise.then(async()=>{let t=(await this.getServers(!0)).filter(n=>n.handle!==e);return this.servers=t,this.encryptedStorage.store(ai.JupyterServerRemoteLaunchService,MO,JSON.stringify(poe(t)))}).catch(E))}async clear(){this.servers=[],await(this.updatePromise=this.updatePromise.then(async()=>{this.servers=[],await this.encryptedStorage.store(ai.JupyterServerRemoteLaunchService,MO,void 0)}).catch(E))}};zP=U([x(0,(0,sn.inject)(rP))],zP);p();var QP=ae(he()),aE=require("vscode");var sE=class extends Pr{constructor(t,n){super();this.uriProviderRegistration=t;this.serverUriStorage=n;this.handleMappings=new Map;this._onDidChangeHandles=this._register(new aE.EventEmitter);this.extensionId=Ge;this.id=lD;this.displayName="Jupyter Server for Testing";this.onDidChangeServers=this._onDidChangeHandles.event}async provideJupyterServers(t){return Array.from(this.handleMappings.values()).map(n=>n.server)}async resolveJupyterServer(t,n){return t}activate(){this._register(this.uriProviderRegistration.createJupyterServerCollection(Ge,this.id,this.displayName,this)),this._register(aE.commands.registerCommand("jupyter.selectjupyteruri",this.selectJupyterUri,this))}async selectJupyterUri(t){var u;C.info(`Setting Jupyter Server URI to remote: ${t}`);let n=t.toString(!0),i=new URL(n),o=aE.Uri.parse(`${i.protocol}//${i.host}${i.pathname==="/lab"?"":i.pathname}`),s=(u=i.searchParams.get("token"))!=null?u:"",a=await Ha(t.toString(!0),"SHA-1"),l={label:this.displayName,id:a,connectionInformation:{baseUrl:o,token:s}};this.handleMappings.set(a,{uri:t,server:l}),await this.serverUriStorage.add({id:this.id,handle:a,extensionId:Ge}),this._onDidChangeHandles.fire()}};sE=U([(0,QP.injectable)(),x(0,(0,QP.inject)(sr)),x(1,(0,QP.inject)(pr))],sE);p();var OO=ae(he());var XP=require("vscode");var lE=class{constructor(e){this.disposables=e}activate(){this.registerCommandsIfTrusted()}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommandsIfTrusted(){XP.workspace.isTrusted&&this.registerCommand(de.ContinueEditSessionInCodespace,this.continueEditSessionInCodespace)}registerCommand(e,t){let n=XP.commands.registerCommand(e,t,this);this.disposables.push(n)}async continueEditSessionInCodespace(){await XP.commands.executeCommand("_workbench.editSessions.actions.continueEditSession.github.codespaces.continueEditSessionInCodespaceWithJupyterServer")}};lE=U([(0,OO.injectable)(),x(0,(0,OO.inject)(ve))],lE);p();var foe=ae(he());var moe=require("vscode");var cE=class{activate(){this.eagerlyActivateOtherExtensions().catch(E)}async eagerlyActivateOtherExtensions(){await Promise.all(moe.extensions.all.filter(e=>{var t,n;return(n=(t=e.packageJSON)==null?void 0:t.contributes)==null?void 0:n.pythonRemoteServerProvider}).map(e=>e.isActive?Promise.resolve():e.activate().then(E,E)))}};cE=U([(0,foe.injectable)()],cE);p();var LO=ae(he()),hoe=require("vscode");var uE=class{constructor(e){this.uriStorage=e}activate(){hoe.commands.registerCommand("jupyter.getUsedAzMLServerHandles",()=>{let e=[];return this.uriStorage.all.forEach(n=>{n.provider.extensionId.toLowerCase()==="ms-toolsai.vscode-ai".toLowerCase()&&e.push(n.provider)}),e})}};uE=U([(0,LO.injectable)(),x(0,(0,LO.inject)(pr))],uE);p();var lp=require("vscode");var goe=ae(he());var dE=class{activate(){let e=et.instance.get(ve),t=new ln;e.push(t),e.push(lp.commands.registerCommand("jupyter.manageAccessToKernels",()=>zEe(t)))}};dE=U([(0,goe.injectable)()],dE);async function zEe(r){let e=await bee(),t=[];Array.from(e.entries()).forEach(([s])=>{var l,u;let a=(u=(l=lp.extensions.getExtension(s))==null?void 0:l.packageJSON)==null?void 0:u.displayName;a&&t.push({label:a,description:s,extensionId:s})});let n=[];r.add({dispose:()=>{n=Ce(n)}});let i=lp.window.createQuickPick();i.title=lp.l10n.t("Manage Access To Jupyter Kernels"),i.placeholder=lp.l10n.t("Choose which extensions can access Jupyter Kernels"),i.items=t,i.selectedItems=t.filter(s=>e.get(s.extensionId)===!0),i.canSelectMany=!0,i.ignoreFocusOut=!1;let o=!1;n.push(i),i.show(),await Promise.race([bx(i.onDidAccept,void 0,n).then(()=>o=!0),bx(i.onDidHide,void 0,n)]),o&&(await Iee(i.selectedItems.map(s=>s.extensionId)),n=Ce(n))}p();var boe=require("vscode");p();var KO=class{constructor(){this.cache=new Map;this.executionCount=0}getResults(e,t){return this.executionCount!==e&&(this.cache.clear(),this.executionCount=e),this.cache.get(t)}setResults(e,t,n){if(this.executionCount<e)this.cache.clear(),this.executionCount=e;else if(this.executionCount>e)return;this.cache.set(t,n)}},voe=KO,yoe=KO;var Av=ae(he());var pE=class{constructor(e,t){this.variables=e;this.kernelProvider=t;this.variableResultCache=new voe;this.variableSummaryCache=new yoe;this.runningKernels=new Set;this._onDidChangeVariables=new boe.EventEmitter;this.onDidChangeVariables=this._onDidChangeVariables.event;this.kernelProvider.onKernelStatusChanged(this.onKernelStatusChanged,this)}onKernelStatusChanged({kernel:e}){if("variableProvider"in e.controller&&e.controller.variableProvider!==this)return;let t=e.notebook.uri.toString(),n=this.runningKernels.has(t);e.status==="idle"&&!n?this.runningKernels.add(t):e.status!=="busy"&&e.status!=="idle"&&n&&(this.runningKernels.delete(t),this._onDidChangeVariables.fire(e.notebook))}_getVariableResultCacheKey(e,t,n){let i="",o=t;return o&&(i=`${o.name}.${o.propertyChain.join(".")}[[${n}`),`${e}:${i}`}async*provideVariables(e,t,n,i,o){if(o.isCancellationRequested)return;let s=this.kernelProvider.get(e);if(!s||s.status==="dead"||s.status==="terminating")return;let a=this.kernelProvider.getKernelExecution(s).executionCount,l=this._getVariableResultCacheKey(e.uri.toString(),t,i),u=this.variableResultCache.getResults(a,l);if(t){let c=t;if(!u&&c.getChildren)u=(await c.getChildren(i,o)).map(f=>this.createVariableResult(f,s)),this.variableResultCache.setResults(a,l,u);else if(!u)return;for(let d of u)yield d;if(n===2&&c.count&&u.length>0&&c.count>i+u.length)for await(let d of this.provideVariables(e,t,n,i+u.length,o))yield d}else{u||(u=(await this.variables.getAllVariableDiscriptions(s,void 0,i,o)).map(d=>this.createVariableResult(d,s)),this.variableResultCache.setResults(a,l,u));for(let c of u)yield c}}_getVariableSummaryCacheKey(e,t){return`${e}:${t.name}`}async*provideVariablesWithSummarization(e,t,n,i,o){var l;let s=this.kernelProvider.get(e),a=this.provideVariables(e,t,n,i,o);for await(let u of a)if(s&&s.status!=="dead"&&s.status!=="terminating"){let c=this._getVariableSummaryCacheKey(e.uri.toString(),u.variable),d=this.kernelProvider.getKernelExecution(s).executionCount,f=this.variableSummaryCache.getResults(d,c);f==null&&u.variable.type==="pandas.core.frame.DataFrame"&&(f=await this.variables.getVariableValueSummary({name:u.variable.name,value:u.variable.value,supportsDataExplorer:!1,type:(l=u.variable.type)!=null?l:"",size:0,count:0,shape:"",truncated:!0},s,o),this.variableSummaryCache.setResults(d,c,f!=null?f:null)),yield{hasNamedChildren:u.hasNamedChildren,indexedChildrenCount:u.indexedChildrenCount,variable:{name:u.variable.name,value:u.variable.value,expression:u.variable.expression,type:u.variable.type,language:u.variable.language,summary:f!=null?f:""}}}}createVariableResult(e,t){var s;let n=(s=e.count)!=null?s:0,i=!!e.hasNamedChildren,o={getChildren:(a,l)=>this.getChildren(o,a,t,l),expression:QEe(e.root,e.propertyChain),...e};return{variable:o,hasNamedChildren:i,indexedChildrenCount:n}}async getChildren(e,t,n,i){let o=e;return await this.variables.getAllVariableDiscriptions(n,o,t,i)}};pE=U([(0,Av.injectable)(),x(0,(0,Av.inject)(Ki)),x(0,(0,Av.named)(nt.KERNEL_VARIABLES)),x(1,(0,Av.inject)(qe))],pE);function QEe(r,e){let t=r;for(let n of e)typeof n=="string"?t+=`.${n}`:t+=`[${n}]`;return t}p();var cp=ae(he()),FO=require("vscode");var XEe=/Type:\s*(\w+)/,ZEe=/Value:\s*(.*)/,eCe=/String form:\s*([\s\S]+?)\n/,tCe=/Docstring:\s*(.*)/,rCe=/Length:\s+(.*)/,nCe=/^\s+\[(\d+) rows x (\d+) columns\]/m,iCe=new Set(["DataFrame","list","dict","ndarray","Series","Tensor","EagerTensor","DataArray"]),fE=class{constructor(e,t,n,i){this.configService=e;this.disposables=n;this.kernelProvider=i;this.variableRequesters=new Map;this.cachedVariables=new Map;this.refreshEventEmitter=new FO.EventEmitter;this.variableRequesters.set($e,t)}get refreshRequired(){return this.refreshEventEmitter.event}async getAllVariableDiscriptions(e,t,n,i){let o=ru(e.kernelConnectionMetadata)||$e,s=this.variableRequesters.get(o);return s?s.getAllVariableDiscriptions(e,t,n,i):[]}async getVariables(e,t){return this.getVariablesBasedOnKernel(t,e)}async getMatchingVariable(e,t,n){let i=this.cachedVariables.get(t.uri.toString());if(i){let o=i.variables.find(s=>s.name===e);return o&&!o.value&&(o=await this.getVariableValueFromKernel(o,t,n)),o}else{let o=await this.getVariableNamesAndTypesFromKernel(t,n);if(o){let s=o.find(a=>a.name===e);if(s)return this.getVariableValueFromKernel({name:e,value:void 0,supportsDataExplorer:!1,type:s.type,fullType:s.fullType,size:0,count:0,shape:"",truncated:!0},t,n)}}}async getVariableValueSummary(e,t,n){if(!t)return;let i=ru(t==null?void 0:t.kernelConnectionMetadata)||$e,o=this.variableRequesters.get(i);if(o)return o.getVariableValueSummary(e,t,n)}async getDataFrameInfo(e,t,n,i){if(!t)return e;let o=ru(t==null?void 0:t.kernelConnectionMetadata)||$e,s=this.variableRequesters.get(o);if(s){i&&(e=await this.getFullVariable(e,t));let a=e.name;return n&&(a=`${e.name}${n}`),s.getDataFrameInfo(e,t,a)}return e}async getDataFrameRows(e,t,n,i,o){let s=ru(i==null?void 0:i.kernelConnectionMetadata)||$e,a=this.variableRequesters.get(s);if(a){let l=e.name;return o&&(l=`${e.name}${o}`),a.getDataFrameRows(t,n,i,l)}return{data:[]}}async getFullVariable(e,t,n){let i=ru(t==null?void 0:t.kernelConnectionMetadata)||$e,o=this.variableRequesters.get(i);return o?o.getFullVariable(e,t,n):e}async getVariablesBasedOnKernel(e,t){var l;let n=this.cachedVariables.get(e.uri.toString()),i=this.kernelProvider.getKernelExecution(e).pendingCells.length>0,o=this.kernelProvider.getKernelExecution(e);(!n||!i&&(n.currentExecutionCount!==t.executionCount||n.currentExecutionCount!==o.executionCount))&&(n={currentExecutionCount:o.executionCount,variables:(await this.getVariableNamesAndTypesFromKernel(e)).map(u=>({name:u.name,value:void 0,supportsDataExplorer:!1,type:u.type,fullType:u.fullType,size:0,shape:"",count:0,truncated:!0,fileName:e.notebook.uri}))});let s=this.configService.getSettings(e.resourceUri).variableExplorerExclude?(l=this.configService.getSettings().variableExplorerExclude)==null?void 0:l.split(";"):[],a={executionCount:o.executionCount,pageStartIndex:-1,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};if(n){let u=t.sortColumn,c=(m,g)=>{let b=m[u]?m[u]:"",v=g[u]?g[u]:"";return t.sortAscending?b.localeCompare(v,void 0,{sensitivity:"base"}):v.localeCompare(b,void 0,{sensitivity:"base"})};n.variables.sort(c);let d=t.startIndex?t.startIndex:0,f=t.pageSize?t.pageSize:100;a.pageStartIndex=d;for(let m=d;m<d+f&&m<n.variables.length;){if(s&&s.indexOf(n.variables[m].type)>=0){n.variables.splice(m,1);continue}let g=typeof n.variables[m].value=="string"?n.variables[m]:await this.getVariableValueFromKernel(n.variables[m],e);n.variables[m]=g,a.pageResponse.push(g),m+=1}this.cachedVariables.set(e.uri.toString(),n),a.totalCount=n.variables.length}return a}async getVariableProperties(e,t,n){let i=await this.getMatchingVariable(e,t,n),o=ru(t.kernelConnectionMetadata)||$e,s=this.variableRequesters.get(o);return s?s.getVariableProperties(e,n,i):{}}async getVariableNamesAndTypesFromKernel(e,t){let n=ru(e.kernelConnectionMetadata)||$e,i=this.variableRequesters.get(n);return i?i.getVariableNamesAndTypesFromKernel(e,t):[]}inspect(e,t,n=0,i){let o=Oe();try{e.requestInspect({code:t,cursor_pos:n,detail_level:0}).then(s=>{s&&s.content.status==="ok"?o.resolve(s.content.data):o.resolve(void 0)}).catch(s=>{o.reject(s)})}catch(s){o.reject(s)}return i&&this.disposables.push(i.onCancellationRequested(()=>o.reject(new FO.CancellationError))),o.promise}async getVariableValueFromKernel(e,t,n){var o;let i={...e};if(!t.disposed&&((o=t.session)!=null&&o.kernel)){let s=await this.inspect(t.session.kernel,e.name,0,n);if(s&&s.hasOwnProperty("text/plain")){let a=yu(s["text/plain"].toString()),l=XEe.exec(a),u=rCe.exec(a),c=nCe.exec(a);l&&(i.type=l[1]),i.value=[ZEe,eCe,tCe].reduce((d,f)=>{var m;return d||((m=f.exec(a))==null?void 0:m[1])||""},""),u&&(i.count=parseInt(u[1],10)),c&&(i.shape=`(${c[1]}, ${c[2]})`)}s&&s.type&&(i.type=s.type.toString()),s&&s.value&&(i.value=s.value.toString()),iCe.has(i.type)&&(i.supportsDataExplorer=!0)}return i.type&&i.count&&!i.shape&&Qt(t.kernelConnectionMetadata)&&i.supportsDataExplorer&&i.type!=="list"&&(i=await this.getFullVariable(i,t)),i}};fE=U([(0,cp.injectable)(),x(0,(0,cp.inject)(Ke)),x(1,(0,cp.inject)(nM)),x(1,(0,cp.named)(nt.PYTHON_VARIABLES_REQUESTER)),x(2,(0,cp.inject)(ve)),x(3,(0,cp.inject)(qe))],fE);p();var ZP=ae(he());p();var mE=class extends ot{constructor(){super("unknown",W.jupyterDataRateExceeded)}};async function UO(r,{code:e,initializeCode:t,cleanupCode:n},i){var o;if(r.disposed||r.disposing||!((o=r.session)!=null&&o.kernel)||!r.session.kernel||r.session.isDisposed)return[];try{return t&&await Ai(r.session.kernel,t,i),await Ai(r.session.kernel,e,i)}catch(s){if(s instanceof Qr)return[];throw s}finally{n&&await Ai(r.session.kernel,n,i)}}var hE=class{constructor(e,t){this.varScriptGenerator=e;this.dfScriptGenerator=t}async getDataFrameInfo(e,t,n){var u;let{code:i,cleanupCode:o,initializeCode:s}=await this.dfScriptGenerator.generateCodeToGetDataFrameInfo({isDebugging:!1,variableName:n}),a=await UO(t,{code:i,cleanupCode:o,initializeCode:s},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getDataFrameInfo",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"}),l=((u=t.notebook)==null?void 0:u.uri)||t.resourceUri||t.uri;return{...e,...this.deserializeJupyterResult(a),fileName:l}}async getDataFrameRows(e,t,n,i){let{code:o,cleanupCode:s,initializeCode:a}=await this.dfScriptGenerator.generateCodeToGetDataFrameRows({isDebugging:!1,variableName:i,startIndex:e,endIndex:t}),l=await UO(n,{code:o,cleanupCode:s,initializeCode:a},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getDataFrameRows",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});return l.length===0?{data:[]}:OM(this.deserializeJupyterResult(l))}async getVariableProperties(e,t,n){let i={};return n&&n.value&&(i[`${e}`]=n.value),i}async getVariableValueSummary(e,t,n){let i=await this.varScriptGenerator.generateCodeToGetVariableValueSummary(e.name);try{let o=await Nv(t,i.split(/\r?\n/),n);return o==null?void 0:o.summary}catch(o){C.warn(`Exception when getting variable summary for variable "${e.name}": ${o.message}`);return}}async getAllVariableDiscriptions(e,t,n,i){if(!e.session)return[];let o=t?{root:t.root,propertyChain:t.propertyChain,startIndex:n}:void 0,s=await this.varScriptGenerator.generateCodeToGetAllVariableDescriptions(o),a=await Nv(e,s.split(/\r?\n/),i);if(e.disposed||e.disposing||i!=null&&i.isCancellationRequested||!a)return[];try{return a}catch(l){return C.error(l),[]}}async getVariableNamesAndTypesFromKernel(e,t){if(e.session){let{code:n,cleanupCode:i,initializeCode:o}=await this.varScriptGenerator.generateCodeToGetVariableTypes({isDebugging:!1}),s=await UO(e,{code:n,cleanupCode:i,initializeCode:o},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getVariableNamesAndTypesFromKernel",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});if(e.disposed||e.disposing)return[];let a=this.deserializeJupyterResult(s),l=[];for(let u of a){let c={...u,value:void 0,supportsDataExplorer:!1,size:0,shape:"",count:0,truncated:!0};l.push(c)}return l}return[]}async getFullVariable(e,t,n){let{code:i,cleanupCode:o,initializeCode:s}=await this.varScriptGenerator.generateCodeToGetVariableInfo({isDebugging:!1,variableName:e.name}),a=await UO(t,{code:i,cleanupCode:o,initializeCode:s},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getFullVariable",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});return{...e,...this.deserializeJupyterResult(a)}}extractJupyterResultText(e){if(e.length>0){let t=e[0];if(t&&t.output_type==="stream"&&t.name==="stderr"&&t.hasOwnProperty("text")){let n=t.text;if(n.includes("iopub_data_rate_limit"))throw new mE;{let i=W.jupyterGetVariablesExecutionError(n);throw C.error(i),new Error(i)}}if(t&&t.output_type==="execute_result"){let n=t.data;if(n&&n.hasOwnProperty("text/plain"))return n["text/plain"]}if(t&&t.output_type==="stream"&&t.hasOwnProperty("text"))return t.text;if(t&&t.output_type==="error"&&t.hasOwnProperty("traceback")){let i=t.traceback.map(yu).join(`\r
`),o=W.jupyterGetVariablesExecutionError(i);throw C.error(o),new Error(o)}}throw new Error(W.jupyterGetVariablesBadResults)}deserializeJupyterResult(e){let t=this.extractJupyterResultText(e);return JSON.parse(t)}};hE=U([(0,ZP.injectable)(),x(0,(0,ZP.inject)(dy)),x(1,(0,ZP.inject)(py))],hE);function Ioe(r,e,t){e.addSingleton(Ve,$_),e.addSingleton(Ve,Y_),e.addSingleton(Ve,G_),e.addSingleton(Ve,nE),e.addSingleton(Ve,cE),e.addSingleton(Ve,sE),e.add(pA,X_),e.add(TI,z_),e.addSingleton(KR,Q_),e.addSingleton(ap,ap),e.addSingleton(Ve,tE),uoe(e,t),$ie(r,t),e.addSingleton(Ve,oE),e.addSingleton(Ve,lE),e.addSingleton(Ve,uE),e.addSingleton(Ve,dE),e.addSingleton(iM,pE),e.addSingleton(Ki,fE,nt.KERNEL_VARIABLES),e.addSingleton(nM,hE,nt.PYTHON_VARIABLES_REQUESTER)}p();p();var eD=ae(he()),_oe=require("vscode");p();"force_variable_refresh","settings_updated","activate","show_data_explorer","get_variables_request","get_variables_response","variable_explorer_toggle","set_variable_explorer_height","variable_explorer_height_response","open_link","variables_complete","update_settings","loc_init","update_variable_view_execution_count","get_html_by_id_request","get_html_by_id_response","restart_kernel";var Soe=class{},WO=Symbol("INotebookWatcher"),VO=Symbol("IVariableViewProvider");var gE=class{constructor(e,t){this.extensionContext=e;this.variableViewProvider=t}activate(){this.extensionContext.subscriptions.push(_oe.window.registerWebviewViewProvider(this.variableViewProvider.viewType,this.variableViewProvider,{webviewOptions:{retainContextWhenHidden:!1}}))}};gE=U([(0,eD.injectable)(),x(0,(0,eD.inject)(st)),x(1,(0,eD.inject)(VO))],gE);p();var La=ae(he());p();var HO=require("vscode");p();var jO=class{constructor(e,t){this.disposedCallback=t,this.callback=e}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}};p();p();var dp=require("vscode");var up=class{constructor(e,t,n){this.configService=e;this.rootPath=t;this.scripts=n;this.disposed=!1;this.themeIsDarkPromise=Oe();this.webviewInit=Oe();this._disposables=[];this.onMessageListeners=[];this._onDidDisposeWebviewPanel=new dp.EventEmitter;this.onDataScienceSettingsChanged=async()=>{let e=JSON.stringify(await this.generateDataScienceExtraSettings());this.postMessageInternal("update_settings",e).catch(E)};this.onWebViewLoadFailed=async()=>{this.dispose()};this.onPossibleSettingsChange=async e=>{if(e.affectsConfiguration("workbench.colorTheme")||e.affectsConfiguration("editor.fontSize")||e.affectsConfiguration("editor.fontFamily")||e.affectsConfiguration("editor.cursorStyle")||e.affectsConfiguration("editor.cursorBlinking")||e.affectsConfiguration("editor.autoClosingBrackets")||e.affectsConfiguration("editor.autoClosingQuotes")||e.affectsConfiguration("editor.autoSurround")||e.affectsConfiguration("editor.autoIndent")||e.affectsConfiguration("editor.scrollBeyondLastLine")||e.affectsConfiguration("editor.fontLigatures")||e.affectsConfiguration("editor.scrollbar.verticalScrollbarSize")||e.affectsConfiguration("editor.scrollbar.horizontalScrollbarSize")||e.affectsConfiguration("files.autoSave")||e.affectsConfiguration("files.autoSaveDelay")||e.affectsConfiguration("jupyter.widgetScriptSources")){let t=await this.generateDataScienceExtraSettings();if(t){let n=JSON.stringify(t);this.postMessageInternal("update_settings",n).catch(E)}}};this._disposables.push(dp.workspace.onDidChangeConfiguration(this.onPossibleSettingsChange,this)),this._disposables.push(this.configService.getSettings(void 0).onDidChange(this.onDataScienceSettingsChanged.bind(this)))}get onDidDispose(){return this._onDidDisposeWebviewPanel.event}dispose(){this.disposed||(this.disposed=!0,this._disposables.forEach(e=>e.dispose())),this.webviewInit=void 0,this._onDidDisposeWebviewPanel.fire()}getHTMLById(e){if(!this.activeHTMLRequest)this.activeHTMLRequest=Oe(),this.postMessageInternal("get_html_by_id_request",e).catch(E);else throw new Error("getHTMLById request already in progress");return this.activeHTMLRequest.promise}addMessageListener(e){this.onMessageListeners.push(e)}removeMessageListener(e){let t=this.onMessageListeners.indexOf(e);t>=0&&this.onMessageListeners.splice(t,1)}asWebviewUri(e){var t;if(!this.webview)throw new Error("asWebViewUri called too early");return(t=this.webview)==null?void 0:t.asWebviewUri(e)}postMessage(e,t){return this.postMessageInternal(e.toString(),t)}onMessage(e,t){switch(e){case"started":this.webViewRendered();break;case"get_html_by_id_response":this.activeHTMLRequest&&(this.activeHTMLRequest.resolve(t),this.activeHTMLRequest=void 0);break;default:break}this.onMessageListeners.forEach(n=>{n(e,t)})}async loadWebview(e,t){var n;if(this.disposed=!1,this.webviewInit=this.webviewInit||Oe(),this.webview===void 0){let i=await this.generateDataScienceExtraSettings(),o=(n=dp.workspace.getWorkspaceFolder(e))==null?void 0:n.uri;this.webview=await this.provideWebview(e,i,o,t),this._disposables.push(this.webview.loadFailed(this.onWebViewLoadFailed,this))}this.onDataScienceSettingsChanged().catch(E),this.sendLocStrings().catch(E)}async generateDataScienceExtraSettings(){let e=this.owningResource,t=dp.workspace.getConfiguration("editor"),n=dp.workspace.getConfiguration("workbench"),i=n?n.get("colorTheme",uL):uL,o=dp.extensions.getExtension($s);return{...JSON.parse(JSON.stringify(this.configService.getSettings(e))),extraSettings:{editor:{cursor:this.getValue(t,"cursorStyle","line"),cursorBlink:this.getValue(t,"cursorBlinking","blink"),autoClosingBrackets:this.getValue(t,"autoClosingBrackets","languageDefined"),autoClosingQuotes:this.getValue(t,"autoClosingQuotes","languageDefined"),autoSurround:this.getValue(t,"autoSurround","languageDefined"),autoIndent:this.getValue(t,"autoIndent",!1),fontLigatures:this.getValue(t,"fontLigatures",!1),scrollBeyondLastLine:this.getValue(t,"scrollBeyondLastLine",!0),verticalScrollbarSize:this.getValue(t,"scrollbar.verticalScrollbarSize",14),horizontalScrollbarSize:this.getValue(t,"scrollbar.horizontalScrollbarSize",10),fontSize:this.getValue(t,"fontSize",14),fontFamily:this.getValue(t,"fontFamily","Consolas, 'Courier New', monospace")},theme:i,hasPythonExtension:o!==void 0,isWeb:wi()==="Unknown"}}}async sendLocStrings(){let e={collapseSingle:Ft.collapseSingle,expandSingle:Ft.expandSingle,openExportFileYes:W.openExportFileYes,openExportFileNo:W.openExportFileNo,noRowsInDataViewer:Ft.noRowsInDataViewer,sliceIndexError:Ft.sliceIndexError,sliceMismatchedAxesError:Ft.sliceMismatchedAxesError,filterRowsTooltip:Ft.sliceMismatchedAxesError,fetchingDataViewer:Ft.fetchingDataViewer,dataViewerHideFilters:Ft.dataViewerHideFilters,dataViewerShowFilters:Ft.dataViewerShowFilters,refreshDataViewer:Ft.refreshDataViewer,clearFilters:Ft.refreshDataViewer,sliceSummaryTitle:Ft.sliceSummaryTitle,sliceData:Ft.sliceData,sliceSubmitButton:Ft.sliceSubmitButton,sliceDropdownAxisLabel:Ft.sliceDropdownAxisLabel,sliceDropdownIndexLabel:Ft.sliceDropdownIndexLabel,variableExplorerNameColumn:Ft.variableExplorerNameColumn,variableExplorerTypeColumn:Ft.variableExplorerTypeColumn,variableExplorerCountColumn:Ft.variableExplorerCountColumn,variableExplorerValueColumn:Ft.variableExplorerValueColumn,collapseVariableExplorerLabel:Ft.collapseVariableExplorerLabel,variableLoadingValue:Ft.variableLoadingValue,showDataExplorerTooltip:Ft.showDataExplorerTooltip,noRowsInVariableExplorer:Ft.noRowsInVariableExplorer,loadingRowsInVariableExplorer:Ft.loadingRowsInVariableExplorer,previousPlot:Ft.previousPlot,nextPlot:Ft.nextPlot,panPlot:Ft.panPlot,zoomInPlot:Ft.zoomInPlot,zoomOutPlot:Ft.zoomOutPlot,exportPlot:Ft.exportPlot,deletePlot:Ft.deletePlot,selectedImageListLabel:Ft.selectedImageListLabel,selectedImageLabel:Ft.selectedImageLabel,dvDeprecationWarning:Ft.dvDeprecationWarning};this.postMessageInternal("loc_init",JSON.stringify(e)).catch(E)}async postMessageInternal(e,t){var n;this.webviewInit&&(await this.webviewInit.promise,(n=this.webview)==null||n.postMessage({type:e.toString(),payload:t}))}webViewRendered(){this.webviewInit&&!this.webviewInit.resolved&&this.webviewInit.resolve(),this.sendLocStrings().catch(E),this.onDataScienceSettingsChanged().catch(E)}getValue(e,t,n){return e?e.get(t,n):n}};U([Yv()],up.prototype,"getHTMLById",1),U([Yv()],up.prototype,"addMessageListener",1),U([Yv()],up.prototype,"removeMessageListener",1);var BO=class extends up{constructor(t,n,i,o,s){super(t,o,s);this.configService=t;this.provider=i;this.messageListener=n(this.onMessage.bind(this),this.dispose.bind(this))}get isDisposed(){return this.disposed}get webviewView(){return this.webview&&this.webview}async provideWebview(t,n,i,o){if(!o)throw new Error("WebviewViews must be passed an initial VS Code Webview");return this.provider.create({additionalPaths:i?[i]:[],rootPath:this.rootPath,cwd:t,listener:this.messageListener,scripts:this.scripts,settings:n,webviewHost:o})}};var Mv=class extends BO{constructor(t,n,i,o,s,a,l){let u=Vi(i.extensionUri,"dist","webviews","webview-side","viewers");super(t,(c,d)=>new jO(c,d),n,u,[Vi(u,"variableView.js")]);this.variables=o;this.disposables=s;this.notebookWatcher=a;this.dataViewerDelegator=l;this.notebookWatcher.onDidFinishExecutingActiveNotebook(this.activeNotebookExecuted,this,this.disposables),this.notebookWatcher.onDidChangeActiveNotebook(this.activeNotebookChanged,this,this.disposables),this.notebookWatcher.onDidRestartActiveNotebook(this.activeNotebookRestarted,this,this.disposables),this.variables.refreshRequired(this.sendRefreshMessage,this,this.disposables),HO.window.onDidChangeActiveTextEditor(this.activeTextEditorChanged,this,this.disposables)}get owningResource(){}async load(t){await super.loadWebview(HO.Uri.file(process.cwd()),t).catch(C.error),this.webviewView&&this.disposables.push(this.webviewView.onDidChangeVisibility(()=>{this.handleVisibilityChanged()})),this.handleVisibilityChanged()}get title(){return"variableView"}onMessage(t,n){switch(t){case"get_variables_request":this.handleMessage(t,n,this.requestVariables);break;case"show_data_explorer":this.handleMessage(t,n,this.showDataViewer);break;default:break}super.onMessage(t,n)}handleMessage(t,n,i){let o=n;i.bind(this)(o)}handleVisibilityChanged(){let t=new mr("jupyter.variableViewVisible"),n=!1;this.webviewView&&(n=this.webviewView.visible),t.set(n).catch(E),n&&(ne("DS_INTERNAL.NATIVE_VARIABLE_VIEW_MADE_VISIBLE"),this.notebookWatcher.activeNotebookExecutionCount!==void 0?this.postMessage("update_variable_view_execution_count",{executionCount:this.notebookWatcher.activeNotebookExecutionCount}).catch(E):this.postMessage("force_variable_refresh").catch(E))}async showDataViewer(t){var n,i;return t.variable.fileName=(i=t.variable.fileName)!=null?i:(n=this.notebookWatcher.activeKernel)==null?void 0:n.notebook.uri,this.dataViewerDelegator.showContributedDataViewer(t.variable,!0)}postProcessSupportsDataExplorer(t){let n=this.dataViewerDelegator.getVariableViewers();return t.pageResponse.forEach(i=>{i.supportsDataExplorer=n.some(o=>o.jupyterVariableViewers.dataTypes.includes(i.type))}),t}async requestVariables(t){let n=this.notebookWatcher.activeKernel;if(n){let i=await this.variables.getVariables(t,n);this.postMessage("get_variables_response",this.postProcessSupportsDataExplorer(i)).catch(E),ne("DS_INTERNAL.VARIABLE_EXPLORER_VARIABLE_COUNT",{variableCount:i.totalCount})}else{let i={executionCount:t.executionCount,pageStartIndex:-1,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};this.postMessage("get_variables_response",i).catch(E)}}async activeNotebookExecuted(t){this.postMessage("update_variable_view_execution_count",{executionCount:t.executionCount}).catch(E)}async activeNotebookChanged(t){t.executionCount?this.postMessage("update_variable_view_execution_count",{executionCount:t.executionCount}).catch(E):this.postMessage("update_variable_view_execution_count",{executionCount:0}).catch(E),this.postMessage("force_variable_refresh").catch(E)}activeTextEditorChanged(){this.postMessage("force_variable_refresh").catch(E)}async activeNotebookRestarted(){this.postMessage("restart_kernel").catch(E)}async sendRefreshMessage(){this.postMessage("force_variable_refresh").catch(E)}};U([Nr("DS_INTERNAL.NATIVE_VARIABLE_VIEW_LOADED")],Mv.prototype,"load",1),U([yn()],Mv.prototype,"showDataViewer",1),U([yn()],Mv.prototype,"requestVariables",1);p();var Ql=require("vscode");var Eoe=ae(he());var Xl=class{async showContributedDataViewer(e,t){try{let n=this.getMatchingExternalVariableViewers(e);if(n.length===0)return Ql.window.showInformationMessage(W.dataViewerExtensionRequired,{modal:!0},Ue.bannerLabelYes).then(i=>{i===Ue.bannerLabelYes&&Ql.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers").then(E,E)});if(n.length===1){let i=n[0].jupyterVariableViewers.command;return C.info(`Showing data viewer with command ${i} for variable ${JSON.stringify({...e,value:"..."})}`),Ql.commands.executeCommand(i,e)}else{let i=n.filter(s=>s.extension.id!==Ge);if(i.length===1){let s=i[0].jupyterVariableViewers.command;return C.info(`Showing data viewer viewer with command ${s} for variable ${JSON.stringify({...e,value:"..."})}`),Ql.commands.executeCommand(s,e)}let o=Ql.window.createQuickPick();o.title=W.selectExternalDataViewer,o.items=n.map(s=>{var a,l;return{label:s.jupyterVariableViewers.title,detail:(l=(a=s.extension.packageJSON)==null?void 0:a.displayName)!=null?l:s.extension.id,command:s.jupyterVariableViewers.command}}),o.onDidAccept(async()=>{let s=o.selectedItems[0];if(s)return o.hide(),C.info(`Showing data viewer viewer with command ${s.command} for variable ${JSON.stringify({...e,value:"..."})}`),Ql.commands.executeCommand(s.command,e)}),o.show()}}catch(n){C.error(n),ne("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER",void 0,{reason:"exception",fromVariableView:t}),Ql.window.showErrorMessage(W.showDataViewerFail).then(E,E)}}getMatchingExternalVariableViewers(e){return this.getVariableViewers().filter(n=>!e.type||n.jupyterVariableViewers.dataTypes.includes(e.type)).filter(n=>n.extension.id!==Ge)}getVariableViewers(){return Ql.extensions.all.filter(t=>{var n,i,o,s;return((i=(n=t.packageJSON)==null?void 0:n.contributes)==null?void 0:i.jupyterVariableViewers)&&((s=(o=t.packageJSON)==null?void 0:o.contributes)==null?void 0:s.jupyterVariableViewers.length)}).map(t=>{var i;let n=(i=t.packageJSON)==null?void 0:i.contributes;return n!=null&&n.jupyterVariableViewers?n.jupyterVariableViewers.map(o=>({extension:t,jupyterVariableViewers:o})):[]}).flat()}};Xl=U([(0,Eoe.injectable)()],Xl);var vE=class{constructor(e,t,n,i,o,s,a){this.configuration=e;this.webviewViewProvider=t;this.context=n;this.variables=i;this.disposables=o;this.notebookWatcher=s;this.dataViewerDelegator=a;this.viewType="jupyterViewVariables"}get activeVariableView(){if(!vn())throw new Error("activeVariableView only for test code");return this.variableView?Promise.resolve(this.variableView):(this.activeVariableViewPromise=Oe(),this.activeVariableViewPromise.promise)}async resolveWebviewView(e,t,n){e.webview.options={enableScripts:!0},this.variableView=new Mv(this.configuration,this.webviewViewProvider,this.context,this.variables,this.disposables,this.notebookWatcher,this.dataViewerDelegator),this.activeVariableViewPromise&&this.activeVariableViewPromise.resolve(this.variableView),await this.variableView.load(e)}};vE=U([(0,La.injectable)(),x(0,(0,La.inject)(Ke)),x(1,(0,La.inject)(WR)),x(2,(0,La.inject)(st)),x(3,(0,La.inject)(Ki)),x(3,(0,La.named)(nt.ALL_VARIABLES)),x(4,(0,La.inject)(ve)),x(5,(0,La.inject)(WO)),x(6,(0,La.inject)(Xl))],vE);p();var fp=ae(he());p();var woe=1e3,Coe;(t=>(t.Fetching="fetching",t.Skipped="skipped"))(Coe||(Coe={}));var ys;(f=>(f.Started="started",f.UpdateSettings="update_settings",f.InitializeData="init",f.GetAllRowsRequest="get_all_rows_request",f.GetAllRowsResponse="get_all_rows_response",f.GetRowsRequest="get_rows_request",f.GetRowsResponse="get_rows_response",f.CompletedData="complete",f.GetSliceRequest="get_slice_request",f.RefreshDataViewer="refresh_data_viewer",f.SliceEnablementStateChanged="slice_enablement_state_changed",f.DeprecationWarningClicked="deprecation_warning_clicked"))(ys||(ys={}));var yE=Symbol("IDataViewerFactory"),qO=Symbol("IDataViewer"),JO=Symbol("IJupyterVariableDataProvider"),GO=Symbol("IJupyterVariableDataProviderFactory"),bE=Symbol("IDataViewerDependencyService");var pp=class{constructor(e,t){this.variableManager=e;this.dependencyService=t;this.initialized=!1}get kernel(){return this._kernel}static getNormalizedColumns(e){return e.map(t=>{let n;switch(t.type){case"bool":n="bool";break;case"integer":case"int32":case"int64":case"float":case"float32":case"float64":case"number":n="number";break;default:n="string"}return{key:t.key,type:n}})}static parseShape(e){try{if(e.startsWith("(")&&e.endsWith(")"))return e.substring(1,e.length-1).split(",").map(t=>parseInt(t))}catch(t){C.error(`Could not parse IJupyterVariable with malformed shape: ${e}`)}}dispose(){}setDependencies(e,t){this._kernel=t,this.variable=e}async getDataFrameInfo(e,t){let n={};await this.ensureInitialized();let i=this.variable;return i&&((e||t)&&(i=await this.variableManager.getDataFrameInfo(i,this._kernel,e,t)),n={columns:i.columns?pp.getNormalizedColumns(i.columns):i.columns,indexColumn:i.indexColumn,rowCount:i.rowCount,dataDimensionality:i.dataDimensionality,shape:pp.parseShape(i.shape),sliceExpression:e,type:i.type,maximumRowChunkSize:i.maximumRowChunkSize,name:i.name,fileName:ut(i.fileName)}),t&&(this.variable=i),n}async getAllRows(e){let t=[];return await this.ensureInitialized(),this.variable&&this.variable.rowCount&&(t=(await this.variableManager.getDataFrameRows(this.variable,0,this.variable.rowCount,this._kernel,e)).data),t}async getRows(e,t,n){let i=[];return await this.ensureInitialized(),this.variable&&this.variable.rowCount&&(i=(await this.variableManager.getDataFrameRows(this.variable,e,t,this._kernel,n)).data),i}async ensureInitialized(){var e,t;!this.initialized&&this.variable&&(this.initialized=!0,(e=this._kernel)!=null&&e.kernelConnectionMetadata&&this.dependencyService&&await this.dependencyService.checkAndInstallMissingDependencies(ic()?this._kernel:((t=this._kernel)==null?void 0:t.kernelConnectionMetadata.interpreter)||this._kernel),this.variable=await this.variableManager.getDataFrameInfo(this.variable,this._kernel))}};pp=U([(0,fp.injectable)(),x(0,(0,fp.inject)(Ki)),x(0,(0,fp.named)(nt.ALL_VARIABLES)),x(1,(0,fp.inject)(bE)),x(1,(0,fp.optional)())],pp);p();var YO=ae(he());var IE=class{constructor(e){this.serviceContainer=e}async create(e,t){let n=this.serviceContainer.get(JO);return n.setDependencies(e,t),n}};IE=U([(0,YO.injectable)(),x(0,(0,YO.inject)(Ar))],IE);p();var Kr=ae(he()),bs=require("vscode");p();var zO=require("vscode");var $O=class{constructor(e){this.configuration=e}async isRequestedColumnSizeAllowed(e,t){if(e>woe&&await this.shouldAskForLargeData(t)){let n=W.tooManyColumnsMessage,i=W.tooManyColumnsYes,o=W.tooManyColumnsNo,s=W.tooManyColumnsDontAskAgain,a=await zO.window.showWarningMessage(n,i,o,s);return a===s&&await this.disableAskForLargeData(),a===i}return!0}async shouldAskForLargeData(e){let t=e?this.configuration.getSettings(e):this.configuration.getSettings();return t&&t.askForLargeDataFrames===!0}async disableAskForLargeData(e){let t=e?this.configuration.getSettings(e):this.configuration.getSettings();t&&(t.askForLargeDataFrames=!1,this.configuration.updateSetting("askForLargeDataFrames",!1,void 0,zO.ConfigurationTarget.Global).catch(E))}};var xoe="ds_prompt_about_deprecation",SE=class{constructor(e,t,n,i,o,s,a,l,u,c,d,f,m,g,b){this.disposables=e;this.debugService=t;this.jupyterVariableDataProviderFactory=i;this.dataViewerFactory=o;this.variableProvider=s;this.errorHandler=a;this.dataViewerDependencyService=l;this.interpreterService=u;this.platformService=c;this.kernelProvider=d;this.interactiveWindowProvider=f;this.experimentService=m;this.globalMemento=g;this.dataViewerDelegator=b;this.dataViewerChecker=new $O(n),bs.workspace.isTrusted||bs.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted()}registerCommandsIfTrusted(){bs.workspace.isTrusted&&(this.registerCommand(de.ShowDataViewer,this.delegateDataViewer),this.registerCommand(de.ShowJupyterDataViewer,this.delegateDataViewer))}registerCommand(e,t){let n=bs.commands.registerCommand(e,t,this);this.disposables.push(n)}async delegateDataViewer(e){let t="variable"in e?await this.getVariableFromRequest(e):e;if(!t){C.error("Variable info could not be retreived"),ne("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER",void 0,{reason:"no variable info",fromVariableView:!1});return}return this.dataViewerDelegator.showContributedDataViewer(t,!1)}async getVariableFromRequest(e){if(this.variableProvider){let t=MM(e.variable);try{return await this.variableProvider.getFullVariable(t)}catch(n){return C.warn("Full variable info could not be retreived, will attempt with partial info.",n),t}}}async showJupyterVariableView(e){var n,i;ne("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_REQUEST_EX");let t=this.experimentService.inExperiment("DataViewerDeprecation");if(!this.globalMemento.get(xoe)&&t&&(this.globalMemento.update(xoe,!0).then(E,E),bs.window.showInformationMessage(W.dataViewerDeprecationMessage,W.dataViewerDeprecationRecommendationActionMessage).then(o=>{o===W.dataViewerDeprecationRecommendationActionMessage&&bs.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers").then(E,E)},E)),(n=this.debugService)!=null&&n.activeDebugSession&&this.variableProvider&&this.jupyterVariableDataProviderFactory&&this.dataViewerFactory)try{if(this.debugService.activeDebugSession.configuration&&this.dataViewerDependencyService&&this.interpreterService){let l=await this.getDebugAdapterPython(this.debugService.activeDebugSession.configuration);l&&await this.dataViewerDependencyService.checkAndInstallMissingDependencies(l)}let o=await this.jupyterVariableDataProviderFactory.create(e),s=await o.getDataFrameInfo(),a=(i=s==null?void 0:s.columns)==null?void 0:i.length;if(a&&await this.dataViewerChecker.isRequestedColumnSizeAllowed(a)){let l=`${W.dataExplorerTitle} - ${e.name}`,u=await this.dataViewerFactory.create(o,l);return ne("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_SUCCESS_EX"),u}}catch(o){ne("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_ERROR_EX",void 0,void 0,o),C.error(o),this.errorHandler.handleError(o).then(E,E)}else try{let o=this.getActiveKernel();if(o&&this.jupyterVariableDataProviderFactory&&this.dataViewerFactory){let s=await this.jupyterVariableDataProviderFactory.create(e,o),a=`${W.dataExplorerTitle} - ${e.name}`;return await this.dataViewerFactory.create(s,a)}}catch(o){C.error(o),ne("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER"),bs.window.showErrorMessage(W.showDataViewerFail).then(E,E)}}getActiveKernel(){var s,a;let e=(s=bs.window.activeNotebookEditor)==null?void 0:s.notebook,t=(e==null?void 0:e.notebookType)==St?this.kernelProvider.get(e):void 0;if(t)return t;let n=this.getActiveInteractiveWindowDocument(),i=n?this.kernelProvider.get(n):void 0;if(i)return i;let o=(a=this.dataViewerFactory)==null?void 0:a.activeViewer;return o?this.kernelProvider.kernels.find(l=>l===o.kernel):void 0}getActiveInteractiveWindowDocument(){let e=this.interactiveWindowProvider.getActiveOrAssociatedInteractiveWindow();if(e)return bs.workspace.notebookDocuments.find(t=>t===(e==null?void 0:e.notebookDocument))}async getDebugAdapterPython(e){if(!this.interpreterService){C.info("Interpreter Service missing when trying getDebugAdapterPython");return}let t="";if(e.debugAdapterPython!==void 0?(C.info("Found debugAdapterPython on Debug Configuration to use"),t=e.debugAdapterPython):e.pythonPath&&(C.info("Found pythonPath on Debug Configuration to use"),t=e.pythonPath),t){let n=t;return n.startsWith("~")&&this.platformService.homeDir&&(n=TD(n,this.platformService.homeDir.path)),this.interpreterService.getInterpreterDetails(bs.Uri.file(n))}else return this.interpreterService.getActiveInterpreter()}};SE=U([(0,Kr.injectable)(),x(0,(0,Kr.inject)(ve)),x(1,(0,Kr.inject)(lo)),x(1,(0,Kr.optional)()),x(2,(0,Kr.inject)(Ke)),x(3,(0,Kr.inject)(GO)),x(3,(0,Kr.optional)()),x(4,(0,Kr.inject)(yE)),x(4,(0,Kr.optional)()),x(5,(0,Kr.inject)(Ki)),x(5,(0,Kr.named)(nt.DEBUGGER_VARIABLES)),x(6,(0,Kr.inject)(mn)),x(7,(0,Kr.inject)(bE)),x(7,(0,Kr.optional)()),x(8,(0,Kr.inject)(im)),x(8,(0,Kr.optional)()),x(9,(0,Kr.inject)(fs)),x(10,(0,Kr.inject)(qe)),x(11,(0,Kr.inject)(uo)),x(12,(0,Kr.inject)(uy)),x(13,(0,Kr.inject)(Et)),x(13,(0,Kr.named)(rr)),x(14,(0,Kr.inject)(Xl))],SE);p();var Ov=ae(he()),Ru=require("vscode");var _E=class{constructor(e,t,n,i){this.interactiveWindowProvider=e;this.kernelProvider=t;this.dataViewerFactory=n;this.disposables=i;this._onDidFinisheExecutingActiveNotebook=new Ru.EventEmitter;this._onDidChangeActiveNotebook=new Ru.EventEmitter;this._onDidRestartActiveNotebook=new Ru.EventEmitter;this._executionCountTracker=new WeakMap;Ru.window.onDidChangeActiveNotebookEditor(this.activeEditorChanged,this,this.disposables),Ru.workspace.onDidCloseNotebookDocument(this.notebookEditorClosed,this,this.disposables),this.kernelProvider.onDidRestartKernel(o=>{this.handleRestart({state:1,notebook:o.notebook})},this,this.disposables),Mr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,this.disposables)}get onDidChangeActiveNotebook(){return this._onDidChangeActiveNotebook.event}get onDidFinishExecutingActiveNotebook(){return this._onDidFinisheExecutingActiveNotebook.event}get onDidRestartActiveNotebook(){return this._onDidRestartActiveNotebook.event}get activeKernel(){var s;let e=(s=Ru.window.activeNotebookEditor)==null?void 0:s.notebook,t=(e==null?void 0:e.notebookType)==St?this.kernelProvider.get(e):void 0;if(t)return t;let n=this.getActiveInteractiveWindowDocument(),i=n?this.kernelProvider.get(n):void 0;if(i)return i;let o=this.dataViewerFactory.activeViewer;return o?this.kernelProvider.kernels.find(a=>a===o.kernel):void 0}get activeNotebookExecutionCount(){var t;let e=(t=this.activeKernel)==null?void 0:t.notebook;return e?this._executionCountTracker.get(e):void 0}getActiveInteractiveWindowDocument(){let e=this.interactiveWindowProvider.getActiveOrAssociatedInteractiveWindow();if(e)return Ru.workspace.notebookDocuments.find(t=>t===(e==null?void 0:e.notebookDocument))}onDidChangeNotebookCellExecutionState(e){gr(e.cell.notebook)&&e.state===1&&this.handleExecute({notebook:e.cell.notebook,state:0,cell:e.cell})}handleExecute(e){var t,n,i,o,s,a;this.isNonSilentExecution(e)&&(((n=(t=e.cell)==null?void 0:t.executionSummary)==null?void 0:n.executionOrder)!==void 0&&this._executionCountTracker.set(e.notebook,(i=e.cell.executionSummary)==null?void 0:i.executionOrder),this.isActiveNotebookEvent(e)&&((s=(o=e.cell)==null?void 0:o.executionSummary)==null?void 0:s.executionOrder)!==void 0&&this.activeKernel&&this.kernelProvider.getKernelExecution(this.activeKernel).pendingCells.length===0&&this._onDidFinisheExecutingActiveNotebook.fire({executionCount:(a=e.cell.executionSummary)==null?void 0:a.executionOrder}))}handleRestart(e){this._executionCountTracker.delete(e.notebook),this.isActiveNotebookEvent(e)&&this._onDidRestartActiveNotebook.fire()}notebookEditorClosed(e){this._executionCountTracker.delete(e)}activeEditorChanged(e){let t={};if(e&&gr(e.notebook)){let n=this._executionCountTracker.get(e.notebook);n&&(t.executionCount=n)}this._onDidChangeActiveNotebook.fire(t)}isNonSilentExecution(e){var t;return!!(e.state===0&&e.cell&&((t=e.cell.executionSummary)!=null&&t.executionOrder))}isActiveNotebookEvent(e){var t;return((t=this.activeKernel)==null?void 0:t.notebook)===e.notebook}};_E=U([(0,Ov.injectable)(),x(0,(0,Ov.inject)(uo)),x(1,(0,Ov.inject)(qe)),x(2,(0,Ov.inject)(yE)),x(3,(0,Ov.inject)(ve))],_E);p();var tD=ae(he());var Poe=require("vscode");var Dm=class{constructor(e,t){this.serviceContainer=e;this.disposables=t;this.knownViewers=new Set;t.push(this),this.viewContext=new mr(vr.IsDataViewerActive),this.disposables.push(Poe.commands.registerCommand(de.RefreshDataViewer,this.refreshDataViewer,this))}dispose(){for(let e of this.knownViewers)e.dispose()}async create(e,t){let n,i=this.serviceContainer.get(qO);try{this.knownViewers.add(i),i.onDidDisposeDataViewer(this.updateOpenDataViewers,this,this.disposables),i.onDidChangeDataViewerViewState(this.updateViewStateContext,this,this.disposables),await i.showData(e,t),n=i}finally{n||i.dispose()}return n}get activeViewer(){return[...this.knownViewers.values()].find(e=>e.active)}updateOpenDataViewers(e){this.knownViewers.delete(e)}async updateViewStateContext(){let e=!1;this.knownViewers.forEach(t=>{t.active&&(e=!0)}),await this.viewContext.set(e)}refreshDataViewer(){for(let e of this.knownViewers)e.active&&e.refreshData().then(E,E)}};U([Nr("DATASCIENCE.START_SHOW_DATA_EXPLORER")],Dm.prototype,"create",1),U([VR(1e3)],Dm.prototype,"refreshDataViewer",1),Dm=U([(0,tD.injectable)(),x(0,(0,tD.inject)(Ar)),x(1,(0,tD.inject)(ve))],Dm);p();var Au=ae(he()),Is=require("vscode");p();var QO=class{constructor(e,t,n){this.disposedCallback=n,this.callback=e,this.viewChanged=t}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}onChangeViewState(e){this.viewChanged(e)}};p();p();var J9;function G9(r,e){return J9&&J9.hasOwnProperty(r)?J9[r]:e}function Y9(r,...e){return r.replace(/{(\d+)}/g,(t,n)=>e[n]===void 0?t:e[n])}var oCe=/^\s*((?<StartRange>-?\d+:)|(?<StopRange>-?:\d+)|(?:(?<Start>-?\d+)(?::(?<Stop>-?\d+))?(?::(?<Step>-?\d+))?))\s*$/;function $9(r){let e=r.length-2;return"["+r.map(()=>e>0?(e-=1,"0"):":").join(", ")+"]"}function sCe(r,e){if(r.startsWith("[")&&r.endsWith("]")){let t,n=r.substring(1,r.length-1).split(",").map((i,o)=>{var a;let s=oCe.exec(i);if((a=s==null?void 0:s.groups)!=null&&a.Start&&!s.groups.Stop){let l=parseInt(s.groups.Start),u=e[o];return(l>=0&&l>=u||l<0&&l<-u)&&(t={shapeIndex:o,value:l}),l}});if(t){let{shapeIndex:i,value:o}=t,s=G9("sliceIndexError","Index {0} out of range for axis {1} with {2} elements");return Y9(s,o.toString(),i.toString(),e[i].toString())}else if(n&&n.length!==e.length){let i=G9("sliceMismatchedAxesError","Expected {0} axes, got {1} in slice expression");return Y9(i,e.length.toString(),n.length.toString())}}return""}function Doe(r,e){return sCe(r,e)===""}p();var EE=class extends up{constructor(t,n,i,o,s,a,l){super(t,o,s);this.configService=t;this.provider=n;this._title=a;this.viewColumn=l;this.viewState={visible:!1,active:!1};this.webPanelViewStateChanged=t=>{let n=t.isVisible(),i=t.isActive(),o={visible:n,active:i},s={visible:this.viewState.visible,active:this.viewState.active};this.viewState.visible=n,this.viewState.active=i,this.onViewStateChanged({current:o,previous:s})};this.messageListener=i(this.onMessage.bind(this),this.webPanelViewStateChanged.bind(this),this.dispose.bind(this))}get isDisposed(){return this.disposed}get webPanel(){if(this.webview)return this.webview}async show(t){this.isDisposed||this.webPanel&&await this.webPanel.show(t)}dispose(){this.isDisposed||this.webPanel&&this.webPanel.close(),super.dispose()}get title(){return this._title}setTitle(t){this._title=t,!this.isDisposed&&this.webPanel&&this.webPanel.setTitle(t)}onViewStateChanged(t){}async provideWebview(t,n,i,o){return this.provider.create({viewColumn:this.viewColumn,listener:this.messageListener,title:this.title,rootPath:this.rootPath,scripts:this.scripts,settings:n,cwd:t,webviewHost:o,additionalPaths:i?[i]:[]})}};var Toe="JupyterDataViewerPreferredViewColumn",Lv=class extends EE{constructor(t,n,i,o,s){var l;let a=Vi(s.extensionUri,"dist","webviews","webview-side","viewers");super(n,t,(u,c,d)=>new QO(u,c,d),a,[Vi(a,"dataExplorer.js")],W.dataExplorerTitle,(l=i.get(Toe))!=null?l:Is.ViewColumn.One);this.globalMemento=i;this.errorHandler=o;this.context=s;this.pendingRowsCount=0;this.sentDataViewerSliceDimensionalityTelemetry=!1;this._onDidDisposeDataViewer=new Is.EventEmitter;this._onDidChangeDataViewerViewState=new Is.EventEmitter;this.onDidDispose(this.dataViewerDisposed,this)}get active(){var t;return!!((t=this.webPanel)!=null&&t.isActive())}get refreshPending(){return this.pendingRowsCount>0}get onDidDisposeDataViewer(){return this._onDidDisposeDataViewer.event}get onDidChangeDataViewerViewState(){return this._onDidChangeDataViewerViewState.event}async showData(t,n){if(!this.isDisposed){this.dataProvider=t,await super.loadWebview(Is.Uri.file(process.cwd())).catch(C.error),super.setTitle(n),await super.show(!0);let i=await this.prepDataFrameInfo();if(i.shape&&i.shape.length>2){this.maybeSendSliceDataDimensionalityTelemetry(i.shape.length);let o=$9(i.shape);i=await this.getDataFrameInfo(o)}this.postMessage(ys.InitializeData,i).catch(E)}}get kernel(){if(this.dataProvider&&"kernel"in this.dataProvider)return this.dataProvider.kernel}dataViewerDisposed(){this._onDidDisposeDataViewer.fire(this)}async refreshData(){let t=this.currentSliceExpression;this.dataFrameInfoPromise=void 0;let n=await this.getDataFrameInfo(void 0,!0);if(t!==void 0&&n.shape!==void 0)if(Doe(t,n.shape))n=await this.getDataFrameInfo(t);else{let i=$9(n.shape);n=await this.getDataFrameInfo(i)}C.info(`Refreshing data viewer for variable ${n.name}`),this.postMessage(ys.InitializeData,n).catch(E)}dispose(){super.dispose(),this.dataProvider&&(this.dataProvider.dispose(),this.dataProvider=void 0)}async onViewStateChanged(t){var n;t.current.active&&t.current.visible&&t.previous.active&&t.current.visible&&await this.globalMemento.update(Toe,(n=this.webPanel)==null?void 0:n.viewColumn),this._onDidChangeDataViewerViewState.fire()}get owningResource(){}onMessage(t,n){switch(t){case ys.GetAllRowsRequest:this.getAllRows(n).catch(E);break;case ys.GetRowsRequest:this.getRowChunk(n).catch(E);break;case ys.GetSliceRequest:this.getSlice(n).catch(E);break;case ys.RefreshDataViewer:this.refreshData().catch(E),ne("DATASCIENCE.REFRESH_DATA_VIEWER");break;case ys.SliceEnablementStateChanged:ne("DATASCIENCE.DATA_VIEWER_SLICE_ENABLEMENT_STATE_CHANGED",void 0,{newState:n.newState?"checked":"unchecked"});break;case ys.DeprecationWarningClicked:Is.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers").then(E,E);break;default:break}super.onMessage(t,n)}getDataFrameInfo(t,n){return(!this.dataFrameInfoPromise||t!==this.currentSliceExpression)&&(this.dataFrameInfoPromise=this.dataProvider?this.dataProvider.getDataFrameInfo(t,n):Promise.resolve({}),this.currentSliceExpression=t),this.dataFrameInfoPromise}async prepDataFrameInfo(){this.rowsTimer=new bt;let t=await this.getDataFrameInfo();try{ne("DATASCIENCE.SHOW_DATA_EXPLORER",void 0,{rows:t.rowCount?t.rowCount:0,columns:t.columns?t.columns.length:0}),this.pendingRowsCount=t.rowCount?t.rowCount:0}catch(n){}return t}async getAllRows(t){return this.wrapRequest(async()=>{if(this.dataProvider){let n=await this.dataProvider.getAllRows(t);return this.pendingRowsCount=0,this.postMessage(ys.GetAllRowsResponse,n)}})}getSlice(t){return this.wrapRequest(async()=>{var n;if(this.dataProvider){let i=await this.getDataFrameInfo(t.slice);return(n=i.shape)!=null&&n.length&&this.maybeSendSliceDataDimensionalityTelemetry(i.shape.length),ne("DATASCIENCE.DATA_VIEWER_SLICE_OPERATION",void 0,{source:t.source}),this.postMessage(ys.InitializeData,i)}})}getRowChunk(t){return this.wrapRequest(async()=>{if(this.dataProvider){let n=await this.getDataFrameInfo(t.sliceExpression),i=await this.dataProvider.getRows(t.start,Math.min(t.end,n.rowCount?n.rowCount:0),t.sliceExpression);return this.pendingRowsCount=Math.max(0,this.pendingRowsCount-i.length),this.postMessage(ys.GetRowsResponse,{rows:i,start:t.start,end:t.end})}})}async wrapRequest(t){try{return await t()}catch(n){if(n instanceof mE){C.error(n.message);let i=W.pythonInteractiveHelpLink;Is.window.showErrorMessage(W.jupyterDataRateExceeded,i).then(o=>{o===i&&Is.env.openExternal(Is.Uri.parse(cD.JupyterDataRateHelpLink))},E),this.dispose()}C.error(n),this.errorHandler.handleError(n).then(E,E)}finally{this.sendElapsedTimeTelemetry()}}sendElapsedTimeTelemetry(){this.rowsTimer&&this.pendingRowsCount===0&&ne("DATASCIENCE.SHOW_DATA_EXPLORER_ROWS_LOADED",void 0,{rowsTimer:this.rowsTimer.elapsedTime})}maybeSendSliceDataDimensionalityTelemetry(t){this.sentDataViewerSliceDimensionalityTelemetry||(ne("DATASCIENCE.DATA_VIEWER_DATA_DIMENSIONALITY",{numberOfDimensions:t}),this.sentDataViewerSliceDimensionalityTelemetry=!0)}};U([Nr("DATAVIEWER.WEBVIEW_LOADED")],Lv.prototype,"showData",1),Lv=U([(0,Au.injectable)(),x(0,(0,Au.inject)(AI)),x(1,(0,Au.inject)(Ke)),x(2,(0,Au.inject)(Et)),x(2,(0,Au.named)(rr)),x(3,(0,Au.inject)(mn)),x(4,(0,Au.inject)(st))],Lv);p();var koe=ae(he());p();p();p();var XO="0.20.0";var ZO=require("vscode");var rD=class{async getVersion(e,t){try{let n=await this._getVersion(e,t);return typeof n=="string"?mQ(n):n}catch(n){C.warn(W.failedToGetVersionOfPandas,n.message);return}}async promptInstall(e,t,n){let i=n?W.pandasTooOldForViewingFormat(n,XO):W.pandasRequiredForViewing(XO);if((lB()?Ue.install:await ZO.window.showErrorMessage(i,{modal:!0},Ue.install))===Ue.install)await this._doInstall(e,t);else throw ne("DATASCIENCE.USER_DID_NOT_INSTALL_PANDAS"),new Error(i)}async checkOrInstall(e){let t=new ZO.CancellationTokenSource;try{let n=await this.getVersion(e,t.token);if(t.token.isCancellationRequested){ne("DS_INTERNAL.SHOW_DATA_PANDAS_INSTALL_CANCELED");return}if(n){if(n.compare(XO)>0){ne("DS_INTERNAL.SHOW_DATA_PANDAS_OK");return}ne("DS_INTERNAL.SHOW_DATA_PANDAS_TOO_OLD");let i=`${n.major}.${n.minor}.${n.build}`;await this.promptInstall(e,t,i)}ne("DS_INTERNAL.SHOW_DATA_NO_PANDAS"),await this.promptInstall(e,t)}finally{t.dispose()}}};U([Nr("DS_INTERNAL.PYTHON_MODULE_INSTALL",{action:"displayed",moduleName:Ii.get(23)})],rD.prototype,"promptInstall",1);var z9="5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d",aCe=`import pandas as _VSCODE_pandas;print(_VSCODE_pandas.__version__);print("${z9}"); del _VSCODE_pandas`;function lCe(r){return(r.kernelConnectionMetadata.interpreter&&br(r.kernelConnectionMetadata.interpreter))==="Conda"?"%conda":"%pip"}var eL=class extends rD{async execute(e,t){var o;if(!((o=t.session)!=null&&o.kernel))throw new Qr;let n=await Ai(t.session.kernel,e),i=n.find(s=>s.output_type==="error");return i&&C.warn(W.failedToGetVersionOfPandas,i.message),n.map(s=>{var a;return(a=s.text)==null?void 0:a.toString()})}async _getVersion(e){let n=(await this.execute(aCe,e)).map(s=>s?s.toString():void 0).find(s=>s);if(!(n!=null&&n.includes(z9)))return C.warn(W.failedToGetVersionOfPandas,`Output is ${n}`),"";let i=ct(n.trim()),o=i.indexOf(z9);return o>=0?i[o-1]:""}async _doInstall(e){let t=`${lCe(e)} install pandas`;try{await this.execute(t,e),ne("DATASCIENCE.USER_INSTALLED_PANDAS")}catch(n){throw ne("DATASCIENCE.USER_INSTALLED_PANDAS",void 0,void 0,n),new Error(W.failedToInstallPandas)}}async checkAndInstallMissingDependencies(e){var t;if(ne("DATAVIEWER.USING_KERNEL"),!((t=e.session)!=null&&t.kernel))throw ne("DATASCIENCE.NO_ACTIVE_KERNEL_SESSION"),new Error("No no active kernel session.");await this.checkOrInstall(e)}};var CE=class{constructor(){this.withKernel=new eL}async checkAndInstallMissingDependencies(e){return this.withKernel.checkAndInstallMissingDependencies(e)}};CE=U([(0,koe.injectable)()],CE);p();var Ys;(s=>(s.Started="started",s.UpdateSettings="update_settings",s.SendPlot="send_plot",s.CopyPlot="copy_plot",s.ExportPlot="export_plot",s.RemovePlot="remove_plot"))(Ys||(Ys={}));Ys.Started,Ys.UpdateSettings,Ys.SendPlot,Ys.CopyPlot,Ys.ExportPlot,Ys.RemovePlot;var Noe=class{},tL=Symbol("IPlotViewerProvider"),rL=Symbol("IPlotViewer");p();var Kv=ae(he());var Mu=require("vscode");p();var nL=class{constructor(e,t,n){this.disposedCallback=n,this.callback=e,this.viewChanged=t}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}onChangeViewState(e){this.viewChanged&&this.viewChanged(e)}};var wE=class extends EE{constructor(t,n,i,o){let s=new bt,a=Vi(o.extensionUri,"dist","webviews","webview-side","viewers");super(n,t,(l,u,c)=>new nL(l,u,c),a,[Vi(a,"plotViewer.js")],W.plotViewerTitle,Mu.ViewColumn.One);this.fs=i;this.context=o;this.closedEvent=new Mu.EventEmitter;this.removedEvent=new Mu.EventEmitter;this.addPlot=async t=>{this.isDisposed||(await super.show(!1),this.postMessage(Ys.SendPlot,t).catch(E))};super.loadWebview(Mu.Uri.file(process.cwd())).catch(C.error).finally(()=>{ne("PLOTVIEWER.WEBVIEW_LOADED",{duration:s.elapsedTime})})}get closed(){return this.closedEvent.event}get removed(){return this.removedEvent.event}async show(){if(!this.isDisposed)return super.show(!0)}dispose(){super.dispose(),this.removedEvent.dispose(),this.closedEvent&&this.closedEvent.fire(this)}get owningResource(){}onMessage(t,n){switch(t){case Ys.CopyPlot:this.copyPlot(n.toString()).catch(E);break;case Ys.ExportPlot:this.exportPlot(n).catch(E);break;case Ys.RemovePlot:this.removePlot(n);break;default:break}super.onMessage(t,n)}removePlot(t){this.removedEvent.fire(t)}copyPlot(t){return Promise.resolve()}async exportPlot(t){C.info("exporting plot...");let n={};n[W.pngFilter]=["png"],n[W.svgFilter]=["svg"];let i=await Mu.window.showSaveDialog({saveLabel:W.exportPlotTitle,filters:n});try{if(i)switch(Sp(i.path).toLowerCase()){case".png":let s=bR(t.png.replace("data:image/png;base64",""));await this.fs.writeFile(i,s);break;default:case".svg":await this.fs.writeFile(i,t.svg);break}}catch(o){C.error(o),Mu.window.showErrorMessage(W.exportImageFailed(o.toString())).then(E,E)}}};wE=U([(0,Kv.injectable)(),x(0,(0,Kv.inject)(AI)),x(1,(0,Kv.inject)(Ke)),x(2,(0,Kv.inject)(Pt)),x(3,(0,Kv.inject)(st))],wE);p();var nD=ae(he());var xE=class{constructor(e,t){this.serviceContainer=e;this.imageList=[];this.closedViewer=()=>{this.currentViewer&&(this.currentViewer=void 0),this.currentViewerClosed&&(this.currentViewerClosed.dispose(),this.currentViewerClosed=void 0)};this.removedPlot=e=>{this.imageList.splice(e,1)};t.push(this)}dispose(){this.currentViewer&&this.currentViewer.dispose()}async showPlot(e){this.imageList.push(e);let t=this.currentViewer?[e]:this.imageList,n=await this.getOrCreate();await Promise.all(t.map(n.addPlot))}async getOrCreate(){return this.currentViewer||(this.currentViewer=this.serviceContainer.get(rL),this.currentViewerClosed=this.currentViewer.closed(this.closedViewer),this.currentViewer.removed(this.removedPlot),ne("DATASCIENCE.OPEN_PLOT_VIEWER"),await this.currentViewer.show()),this.currentViewer}};xE=U([(0,nD.injectable)(),x(0,(0,nD.inject)(Ar)),x(1,(0,nD.inject)(ve))],xE);p();var oL=ae(he()),Tm=require("vscode");var Roe="image/svg+xml",iL={"image/png":"png","image/jpeg":"jpeg","image/gif":"gif",[Roe]:"svg"},PE=class{constructor(e){this.fs=e}async savePlot(e,t,n){if(e.isClosed)return;let i=cCe(e,t,n);if(!i)return C.error(`No plot to save ${Ee(e.uri)}, id: ${t} for ${n}`);if(!(n.toLowerCase()in iL))return C.error(`Unsupported MimeType ${Ee(e.uri)}, id: ${t} for ${n}`);let o=await this.getSaveTarget(i,n);o&&(o.path.toLowerCase().endsWith("pdf")?await this.saveAsPdf(i,o):await this.saveAsImage(i,o))}getSaveTarget(e,t){var l;let n=iL[t.toLowerCase()],i={};e.items.find(u=>u.mime.toLowerCase()===Roe)&&(i[W.pdfFilter]=["pdf"],i[W.svgFilter]=["svg"]),n==="png"&&(i[W.pngFilter]=["png"]),Object.keys(i).length===0&&(i.Images=[n]);let o=(((l=Tm.workspace.workspaceFolders)==null?void 0:l.length)||0)>0?Tm.workspace.workspaceFolders[0].uri:void 0,s="output",a=o?Tm.Uri.joinPath(o,s):Tm.Uri.file(s);return Tm.window.showSaveDialog({defaultUri:a,saveLabel:W.exportPlotTitle,filters:i})}async saveAsImage(e,t){let n=Sp(t.path).substring(1),i=Object.keys(iL).find(s=>iL[s]===n),o=e.items.find(s=>s.mime===i);if(!o)throw new Error(`Unsupported MimeType ${t.toString()}, available mime Types: ${e.items.map(s=>s.mime).join(", ")}`);await this.fs.writeFile(t,o.data)}async saveAsPdf(e,t){return C.error("Save as PDF is not yet supported on the web.")}};PE=U([(0,oL.injectable)(),x(0,(0,oL.inject)(Pt))],PE);function cCe(r,e,t){for(let n of r.getCells())for(let i of n.outputs)if(i.id===e&&i.items.find(o=>o.mime===t))return i}p();var sL=ae(he());var uCe="image/svg+xml",dCe="image/png",mp=class{constructor(e){this.plotViewProvider=e}async openPlot(e,t){if(e.isClosed)return;let n=Aoe(e,t,uCe),i;if(n)i=new TextDecoder().decode(n.data);else{let o=Aoe(e,t,dCe);if(!o)return C.error(`No SVG or PNG Plot to open ${Ee(e.uri)}, id: ${t}`);i=pCe(o)}i&&await this.plotViewProvider.showPlot(i)}};mp=U([(0,sL.injectable)(),x(0,(0,sL.inject)(tL))],mp);function Aoe(r,e,t){for(let n of r.getCells())for(let i of n.outputs)if(i.id===e)return i.items.find(o=>o.mime===t)}function pCe(r){let e=r.data,t=IR(e),n=fCe(e);return`<?xml version="1.0" encoding="utf-8" standalone="no"?>
<svg height="${n.height}" width="${n.width}" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g>
        <image xmlns="http://www.w3.org/2000/svg" x="0" y="0" height="100%" width="100%" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="data:image/png;base64,${t}"/>
    </g>
</svg>`}function fCe(r){if(!mCe(r))throw new Error("The buffer is not a valid png");let e=new DataView(new Uint8Array(r).buffer);return{width:e.getUint32(16,!1),height:e.getUint32(20,!1)}}function mCe(r){return r[0]===137&&r[1]===80&&r[2]===78&&r[3]===71&&r[4]===13&&r[5]===10&&r[6]===26&&r[7]===10&&r.length>29}p();var iD=ae(he()),oD=require("vscode");p();var aL=Symbol("IPlotSaveHandler");var DE=class{constructor(e,t){this.plotSaveHandler=e;this.plotViewHandler=t;this.disposables=[]}dispose(){Ce(this.disposables)}activate(){this.activateImpl().catch(E)}async activateImpl(){let e=oD.extensions.getExtension(hp);if(!e)return;e.isActive||await e.activate(),e.exports.onDidReceiveMessage(async({editor:n,message:i})=>{var s;let o=n.notebook||((s=oD.window.activeNotebookEditor)==null?void 0:s.notebook);if(o)try{i.type==="saveImageAs"?await this.plotSaveHandler.savePlot(o,i.outputId,i.mimeType):i.type==="openImageInPlotViewer"&&await this.plotViewHandler.openPlot(o,i.outputId)}catch(a){C.error(a),oD.window.showErrorMessage(W.exportImageFailed(a.message)).then(E,E)}},this,this.disposables)}};DE=U([(0,iD.injectable)(),x(0,(0,iD.inject)(aL)),x(1,(0,iD.inject)(mp))],DE);p();var kE=ae(he()),lL=require("vscode");var TE=class{constructor(e,t,n){this.kernelProvider=e;this.controllers=t;this.ipywidgetMessageDispatcher=n;this.disposables=[];this.widgetOutputsPerNotebook=new WeakMap}dispose(){Ce(this.disposables)}activate(){let e=lL.notebooks.createRendererMessaging("jupyter-ipywidget-renderer");e.onDidReceiveMessage(this.onDidReceiveMessage.bind(this,e),this,this.disposables),this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposables)}onDidStartKernel(e){this.hookupKernel(e),e.onStarted(()=>this.hookupKernel(e),this,this.disposables),e.onRestarted(()=>this.hookupKernel(e),this,this.disposables)}hookupKernel(e){var a,l,u;this.widgetOutputsPerNotebook.delete(e.notebook);let t=(a=e.session)==null?void 0:a.kernel,n=(u=(l=e.session)==null?void 0:l.kernel)==null?void 0:u.iopubMessage;if(!n)return;let i=this.ipywidgetMessageDispatcher.create(e.notebook);this.disposables.push(i.onDisplayMessage(c=>{this.trackModelId(e.notebook,c)}));let o=Bn(),s=(c,d)=>{c===t&&(o.KernelMessage.isDisplayDataMsg(d)||o.KernelMessage.isUpdateDisplayDataMsg(d)||o.KernelMessage.isExecuteReplyMsg(d)||o.KernelMessage.isExecuteResultMsg(d))&&this.trackModelId(e.notebook,d)};n.connect(s),this.disposables.push(new lL.Disposable(()=>n.disconnect(s)))}trackModelId(e,t){let n=t.content;if(n.data&&typeof n.data=="object"&&mo in n.data){let i=n.data[mo];if(i&&"model_id"in i){let o=this.widgetOutputsPerNotebook.get(e)||new Set;o.add(i.model_id),this.widgetOutputsPerNotebook.set(e,o)}}}onDidReceiveMessage(e,{editor:t,message:n}){n&&typeof n=="object"&&n.command==="query-widget-state"&&this.queryWidgetState(e,t,n),n&&typeof n=="object"&&n.command==="ipywidget-renderer-loaded"&&this.sendWidgetVersionAndState(e,t)}queryWidgetState(e,t,n){let i=this.widgetOutputsPerNotebook.get(t.notebook),o=!!this.controllers.getSelected(t.notebook),s=!!(i!=null&&i.has(n.model_id));e.postMessage({command:"query-widget-state",model_id:n.model_id,hasWidgetState:s,kernelSelected:o},t).then(E,E)}sendWidgetVersionAndState(e,t){let n=this.kernelProvider.get(t.notebook),i=n==null?void 0:n.ipywidgetsVersion;n!=null&&n.ipywidgetsVersion&&C.trace(`IPyWidget version in Kernel is ${n==null?void 0:n.ipywidgetsVersion}.`);let o=!!this.controllers.getSelected(t.notebook);e.postMessage({command:"ipywidget-renderer-init",version:i,widgetState:void 0,kernelSelected:o},t).then(E,E)}};TE=U([(0,kE.injectable)(),x(0,(0,kE.inject)(qe)),x(1,(0,kE.inject)(Nt)),x(2,(0,kE.inject)(jl))],TE);function Moe(r){r.addSingleton(Ve,DE),r.addSingleton(Ve,SE),r.add(qO,Lv),r.addSingleton(yE,Dm),r.addSingleton(bE,CE),r.addSingleton(Xl,Xl),r.add(rL,wE),r.addSingleton(tL,xE),r.addSingleton(aL,PE),r.addSingleton(mp,mp),r.addSingleton(WO,_E),r.addSingleton(Ve,gE),r.addSingleton(Ve,TE),r.addSingleton(VO,vE),r.add(JO,pp),r.addSingleton(GO,IE)}p();var Voe=ae(eK());p();var Ooe=ae(he());var Fv=class{constructor(e){this.container=e}getContainer(){return this.container}add(e,t,n,i){n?this.container.bind(e).to(t).whenTargetNamed(n):this.container.bind(e).to(t),i&&i.forEach(o=>{this.addBinding(e,o)})}addFactory(e,t){this.container.bind(e).toFactory(t)}addBinding(e,t){this.container.bind(t).toService(e)}addSingleton(e,t,n,i){n?this.container.bind(e).to(t).inSingletonScope().whenTargetNamed(n):this.container.bind(e).to(t).inSingletonScope(),i&&i.forEach(o=>{this.addBinding(e,o)})}addSingletonInstance(e,t,n){n?this.container.bind(e).toConstantValue(t).whenTargetNamed(n):this.container.bind(e).toConstantValue(t)}get(e,t){return t?this.container.getNamed(e,t):this.container.get(e)}tryGet(e,t){try{return t?this.container.getNamed(e,t):this.container.get(e)}catch(n){}}getAll(e,t){return t?this.container.getAllNamed(e,t):this.container.getAll(e)}rebind(e,t,n){n?this.container.rebind(e).to(t).whenTargetNamed(n):this.container.rebind(e).to(t)}rebindSingleton(e,t,n){n?this.container.rebind(e).to(t).inSingletonScope().whenTargetNamed(n):this.container.rebind(e).to(t).inSingletonScope()}rebindInstance(e,t,n){n?this.container.rebind(e).toConstantValue(t).whenTargetNamed(n):this.container.rebind(e).toConstantValue(t)}dispose(){this.container.unbindAll(),this.container.unload()}};U([Yv()],Fv.prototype,"getContainer",1),Fv=U([(0,Ooe.injectable)()],Fv);var Jn=require("vscode");p();var Koe=require("vscode");function Foe(r){let e=Koe.window.createOutputChannel(W.jupyterServerConsoleOutputChannel,"log");r.push(e);let t={get(n,i){let o=n[i];if(typeof o=="function"){if(i==="append")return(...s)=>{e.append(...s),Loe(...s)};if(i==="appendLine")return(...s)=>{e.appendLine(...s),Loe(...s)}}return o}};return new Proxy(e,t)}function Loe(...r){r.length===1?C.debug(ct(r[0]).map((e,t)=>t===0?e:`    ${e}`).join(`
`)):C.debug(...r)}p();var Uoe=require("vscode");function Woe(){let r=Uoe.workspace.getConfiguration("python"),e=r==null?void 0:r.get("languageServer");return!(e!=="Pylance"&&e!=="Default")}async function joe(r,e){let t=W7(e);t.appendLine(`${Jn.env.appName} (${Jn.version}, ${Jn.env.remoteName}, ${Jn.env.appHost})`),t.appendLine(`Jupyter Extension Version: ${r.extension.packageJSON.version}.`);let n=Jn.extensions.getExtension($s);n?t.appendLine(`Python Extension Version: ${n.packageJSON.version}.`):t.appendLine("Python Extension not installed.");let i=Jn.extensions.getExtension(fB);i?t.appendLine(`Python Environment Extension Version: ${i.packageJSON.version}.`):t.appendLine("Python Environment Extension not installed.");let o=Jn.extensions.getExtension(mB);return o?t.appendLine(`Pylance Extension Version${Woe()?"":" (Not Used) "}: ${o.packageJSON.version}.`):t.appendLine("Pylance Extension not installed."),e!=null&&e.platform&&t.appendLine(`Platform: ${e.platform} (${e.arch}).`),t.appendLine(`Home = ${e==null?void 0:e.homePath}`),t.appendLine(`Temp Storage folder ${Ee(await Jie(r))}`),!Jn.workspace.workspaceFolders||Jn.workspace.workspaceFolders.length===0?t.appendLine("No workspace folder opened."):Jn.workspace.workspaceFolders.length===1?t.appendLine(`Workspace folder ${Ee(Jn.workspace.workspaceFolders[0].uri)}`):t.appendLine(`Multiple Workspace folders opened ${Jn.workspace.workspaceFolders.map(s=>Ee(s.uri)).join(", ")}`),t}function Boe(r,e){let t=new Voe.Container({skipBaseClassChecks:!0}),n=new Fv(t),i=new et(t);return n.addSingletonInstance(Ar,i),n.addSingletonInstance(Nre,n),n.addSingletonInstance(ve,r.subscriptions),n.addSingletonInstance(Et,r.globalState,rr),n.addSingletonInstance(Et,r.workspaceState,Es),n.addSingletonInstance(st,r),n.addSingletonInstance(Um,e,Hv),n.addSingletonInstance(Um,Foe(r.subscriptions),pB),[n,i]}function Hoe(r,e,t){hCe(Ue.handleExtensionActivationError),console.error("extension activation failed",r),C.error("extension activation failed",r),Gee(r,e,t)}function hCe(r){try{Jn.window.showErrorMessage(r).then(E,E)}catch(e){C.error("failed to notify user",e)}}async function qoe(r,e){let t=e.get(uy),n=new bt;await t.activate();let i=n.elapsedTime;ne("DS_INTERNAL.EXPERIMENT_LOAD",{duration:i}),Jn.commands.executeCommand("setContext","jupyter.vscode.channel",Ud()).then(E,E),e.get(pA).activate();let o=e.get(ST);o.initialize(),r.subscriptions.push(o)}var Q9=class{constructor(){this.started=Date.now()}get elapsedTime(){return Date.now()-this.started}reset(){this.started=Date.now()}},NE=new Q9,sD={totalActivateTime:0,codeLoadingTime:0,startActivateTime:0,endActivateTime:0,workspaceFolderCount:0};typeof requestAnimationFrame=="undefined"&&typeof setImmediate=="undefined"&&(self.setImmediate=r=>setTimeout(r),self.clearImmediate=r=>clearTimeout(r));sD.codeLoadingTime=NE.elapsedTime;var X9;async function gCe(r){sD.startActivateTime=NE.elapsedTime;let e=await joe(r,{addConsoleLogger:vn()});bQ(NE),YB(r.subscriptions),aB(Zl.env.uiKind==Zl.UIKind.Web),uB(!0),r.subscriptions.push({dispose:()=>AE.isExiting=!0});try{let[t,n]=yCe(r,e);return await n,Jee(sD,NE),t}catch(t){return sD.endActivateTime=NE.elapsedTime,Hoe(t,sD,NE),C.error("Failed to active the Jupyter Extension",t),{ready:Promise.resolve(),registerPythonApi:E,registerRemoteServerProvider:()=>({dispose:E}),getKernelService:()=>Promise.resolve(void 0),addRemoteJupyterServer:()=>Promise.resolve(void 0),openNotebook:()=>Promise.reject(),createJupyterServerCollection:()=>{throw new Error("Not Implemented")},kernels:{getKernel:()=>Promise.resolve(void 0),onDidStart:()=>({dispose:E})},onDidChangePythonEnvironment:void 0,getPythonEnvironment:()=>{}}}}function vCe(){if(AE.isExiting=!0,X9){let r=X9.get(Vu);if(r)return r.dispose()}return Promise.resolve()}function yCe(r,e){let[t,n]=Boe(r,e);X9=n,hQ(()=>Promise.resolve(new Map));let i=bCe(r,t,n);return[Bee(i,t,n,r),i,n]}async function bCe(r,e,t){let n=r.extensionMode===Zl.ExtensionMode.Development||Zl.workspace.getConfiguration("jupyter").get("development",!1);e.addSingletonInstance(q7,n),n&&Zl.commands.executeCommand("setContext","jupyter.development",!0).then(E,E),Zl.commands.executeCommand("setContext","jupyter.webExtension",!0).then(E,E),qte(e),One(e,n),kre(e,n),Kie(e),Uie(e),Ioe(r,e,n),Moe(e),await qoe(r,t)}
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)

@microsoft/dynamicproto-js/lib/dist/esm/dynamicproto-js.js:
  (*!
   * Microsoft Dynamic Proto Utility, 1.1.8
   * Copyright (c) Microsoft and contributors. All rights reserved.
   *)

strip-comments/index.js:
  (*!
   * strip-comments <https://github.com/jonschlinkert/strip-comments>
   * Copyright (c) 2014-present, Jon Schlinkert.
   * Released under the MIT License.
   *)
*/
